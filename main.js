/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&s+1<t.length&&56320==(64512&t.charCodeAt(s+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++s)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let e=0;e<t.length;e+=3){const i=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=i>>2,h=(3&i)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(l=64)),s.push(n[u],n[h],n[l],n[d])}return s.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((31&i)<<6|63&r)}else if(i>239&&i<365){const r=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[s++]=String.fromCharCode(55296+(r>>10)),e[s++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((15&i)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==r||null==o||null==a)throw Error();const c=i<<2|r>>4;if(s.push(c),64!==o){const t=r<<4&240|o>>2;if(s.push(t),64!==a){const t=o<<6&192|a;s.push(t)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},s=function(t){return function(t){const s=e(t);return n.encodeByteArray(s,!0)}(t).replace(/\./g,"")},i=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return n.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}};class r{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}class o extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,a.prototype.create)}}class a{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],r=i?function(t,e){return t.replace(c,((t,n)=>{const s=e[n];return null!=s?String(s):`<${n}?>`}))}(i,n):"Error",a=`${this.serviceName}: ${r} (${s}).`;return new o(s,a,n)}}const c=/\{\$([^}]+)}/g;function u(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const n=t[i],r=e[i];if(h(n)&&h(r)){if(!u(n,r))return!1}else if(n!==r)return!1}for(const t of s)if(!n.includes(t))return!1;return!0}function h(t){return null!==t&&"object"==typeof t}function l(t){return t&&t._delegate?t._delegate:t}class d{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const f="[DEFAULT]";class p{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),s=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(s)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:f})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(s);return s}onInit(t,e){var n;const s=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(s))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&t(r,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===f?void 0:s),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var s;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:f:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class g{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new p(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const m=[];var y,v;(v=y||(y={}))[v.DEBUG=0]="DEBUG",v[v.VERBOSE=1]="VERBOSE",v[v.INFO=2]="INFO",v[v.WARN=3]="WARN",v[v.ERROR=4]="ERROR",v[v.SILENT=5]="SILENT";const w={debug:y.DEBUG,verbose:y.VERBOSE,info:y.INFO,warn:y.WARN,error:y.ERROR,silent:y.SILENT},E=y.INFO,b={[y.DEBUG]:"log",[y.VERBOSE]:"log",[y.INFO]:"info",[y.WARN]:"warn",[y.ERROR]:"error"},T=(t,e,...n)=>{if(e<t.logLevel)return;const s=(new Date).toISOString(),i=b[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${s}]  ${t.name}:`,...n)};class I{constructor(t){this.name=t,this._logLevel=E,this._logHandler=T,this._userLogHandler=null,m.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in y))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?w[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,y.DEBUG,...t),this._logHandler(this,y.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,y.VERBOSE,...t),this._logHandler(this,y.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,y.INFO,...t),this._logHandler(this,y.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,y.WARN,...t),this._logHandler(this,y.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,y.ERROR,...t),this._logHandler(this,y.ERROR,...t)}}let S,C;const A=new WeakMap,_=new WeakMap,D=new WeakMap,k=new WeakMap,N=new WeakMap;let L={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return _.get(t);if("objectStoreNames"===e)return t.objectStoreNames||D.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return x(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function R(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(C||(C=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(O(this),t),x(A.get(this))}:function(...t){return x(e.apply(O(this),t))}:function(t,...n){const s=e.call(O(this),t,...n);return D.set(s,t.sort?t.sort():[t]),x(s)}:(t instanceof IDBTransaction&&function(t){if(_.has(t))return;const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",r),t.removeEventListener("abort",r)},i=()=>{e(),s()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",r),t.addEventListener("abort",r)}));_.set(t,e)}(t),n=t,(S||(S=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,L):t);var e,n}function x(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",r)},i=()=>{e(x(t.result)),s()},r=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&A.set(e,t)})).catch((()=>{})),N.set(e,t),e}(t);if(k.has(t))return k.get(t);const e=R(t);return e!==t&&(k.set(t,e),N.set(e,t)),e}const O=t=>N.get(t),M=["get","getKey","getAll","getAllKeys","count"],V=["put","add","delete","clear"],F=new Map;function P(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(F.get(e))return F.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=V.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!i&&!M.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,i?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&r.done]))[0]};return F.set(e,r),r}var U;U=L,L={...U,get:(t,e,n)=>P(t,e)||U.get(t,e,n),has:(t,e)=>!!P(t,e)||U.has(t,e)};class B{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const j="@firebase/app",q="0.8.4",K=new I("@firebase/app"),H="[DEFAULT]",$={[j]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},G=new Map,z=new Map;function Q(t,e){try{t.container.addComponent(e)}catch(n){K.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function W(t){const e=t.name;if(z.has(e))return K.debug(`There were multiple attempts to register component ${e}.`),!1;z.set(e,t);for(const e of G.values())Q(e,t);return!0}const X=new a("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Y{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new d("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw X.create("app-deleted",{appName:this._name})}}function J(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const s=Object.assign({name:H,automaticDataCollectionEnabled:!1},e),r=s.name;if("string"!=typeof r||!r)throw X.create("bad-app-name",{appName:String(r)});if(n||(n=(()=>{var t;return null===(t=i())||void 0===t?void 0:t.config})()),!n)throw X.create("no-options");const o=G.get(r);if(o){if(u(n,o.options)&&u(s,o.config))return o;throw X.create("duplicate-app",{appName:r})}const a=new g(r);for(const t of z.values())a.addComponent(t);const c=new Y(n,s,a);return G.set(r,c),c}function Z(t,e,n){var s;let i=null!==(s=$[t])&&void 0!==s?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${i}" with version "${e}":`];return r&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void K.warn(t.join(" "))}W(new d(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const tt="firebase-heartbeat-store";let et=null;function nt(){return et||(et=function(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=x(o);return s&&o.addEventListener("upgradeneeded",(t=>{s(x(o.result),t.oldVersion,t.newVersion,x(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),i&&t.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(tt)}}).catch((t=>{throw X.create("idb-open",{originalErrorMessage:t.message})}))),et}async function st(t,e){var n;try{const n=(await nt()).transaction(tt,"readwrite"),s=n.objectStore(tt);return await s.put(e,it(t)),n.done}catch(t){if(t instanceof o)K.warn(t.message);else{const e=X.create("idb-set",{originalErrorMessage:null===(n=t)||void 0===n?void 0:n.message});K.warn(e.message)}}}function it(t){return`${t.name}!${t.options.appId}`}class rt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new at(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=ot();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=ot(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let s=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),ct(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ct(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}(this._heartbeatsCache.heartbeats),i=s(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function ot(){return(new Date).toISOString().substring(0,10)}class at{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return"object"==typeof indexedDB&&new Promise(((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){var e;try{return(await nt()).transaction(tt).objectStore(tt).get(it(t))}catch(t){if(t instanceof o)K.warn(t.message);else{const n=X.create("idb-get",{originalErrorMessage:null===(e=t)||void 0===e?void 0:e.message});K.warn(n.message)}}}(this.app);return t||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return st(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return st(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function ct(t){return s(JSON.stringify({version:2,heartbeats:t})).length}W(new d("platform-logger",(t=>new B(t)),"PRIVATE")),W(new d("heartbeat",(t=>new rt(t)),"PRIVATE")),Z(j,q,""),Z(j,q,"esm2017"),Z("fire-js",""),Z("firebase","9.14.0","app");var ut,ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},lt={},dt=dt||{},ft=ht||self;function pt(){}function gt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function mt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var yt="closure_uid_"+(1e9*Math.random()>>>0),vt=0;function wt(t,e,n){return t.call.apply(t.bind,arguments)}function Et(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,s),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function bt(t,e,n){return(bt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?wt:Et).apply(null,arguments)}function Tt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function It(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(t,n,s){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return e.prototype[n].apply(t,i)}}function St(){this.s=this.s,this.o=this.o}St.prototype.s=!1,St.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,yt)&&t[yt]||(t[yt]=++vt))},St.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ct=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function At(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function _t(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(gt(n)){const e=t.length||0,s=n.length||0;t.length=e+s;for(let i=0;i<s;i++)t[e+i]=n[i]}else t.push(n)}}function Dt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Dt.prototype.h=function(){this.defaultPrevented=!0};var kt=function(){if(!ft.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ft.addEventListener("test",pt,e),ft.removeEventListener("test",pt,e)}catch(t){}return t}();function Nt(t){return/^[\s\xa0]*$/.test(t)}var Lt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Rt(t,e){return t<e?-1:t>e?1:0}function xt(){var t=ft.navigator;return t&&(t=t.userAgent)?t:""}function Ot(t){return-1!=xt().indexOf(t)}function Mt(t){return Mt[" "](t),t}Mt[" "]=pt;var Vt,Ft,Pt=Ot("Opera"),Ut=Ot("Trident")||Ot("MSIE"),Bt=Ot("Edge"),jt=Bt||Ut,qt=Ot("Gecko")&&!(-1!=xt().toLowerCase().indexOf("webkit")&&!Ot("Edge"))&&!(Ot("Trident")||Ot("MSIE"))&&!Ot("Edge"),Kt=-1!=xt().toLowerCase().indexOf("webkit")&&!Ot("Edge");function Ht(){var t=ft.document;return t?t.documentMode:void 0}t:{var $t="",Gt=(Ft=xt(),qt?/rv:([^\);]+)(\)|;)/.exec(Ft):Bt?/Edge\/([\d\.]+)/.exec(Ft):Ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ft):Kt?/WebKit\/(\S+)/.exec(Ft):Pt?/(?:Version)[ \/]?(\S+)/.exec(Ft):void 0);if(Gt&&($t=Gt?Gt[1]:""),Ut){var zt=Ht();if(null!=zt&&zt>parseFloat($t)){Vt=String(zt);break t}}Vt=$t}var Qt,Wt={};function Xt(){return function(t){var e=Wt;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let t=0;const e=Lt(String(Vt)).split("."),n=Lt("9").split("."),s=Math.max(e.length,n.length);for(let o=0;0==t&&o<s;o++){var i=e[o]||"",r=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==i[0].length&&0==r[0].length)break;t=Rt(0==i[1].length?0:parseInt(i[1],10),0==r[1].length?0:parseInt(r[1],10))||Rt(0==i[2].length,0==r[2].length)||Rt(i[2],r[2]),i=i[3],r=r[3]}while(0==t)}return 0<=t}()}()}ft.document&&Ut?Qt=Ht()||parseInt(Vt,10)||void 0:Qt=void 0;var Yt=Qt;function Jt(t,e){if(Dt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qt){t:{try{Mt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Zt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Jt.X.h.call(this)}}It(Jt,Dt);var Zt={2:"touch",3:"pen",4:"mouse"};Jt.prototype.h=function(){Jt.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var te="closure_listenable_"+(1e6*Math.random()|0),ee=0;function ne(t,e,n,s,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ha=i,this.key=++ee,this.ba=this.ea=!1}function se(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function ie(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function re(t){const e={};for(const n in t)e[n]=t[n];return e}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ae(t,e){let n,s;for(let e=1;e<arguments.length;e++){for(n in s=arguments[e],s)t[n]=s[n];for(let e=0;e<oe.length;e++)n=oe[e],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function ce(t){this.src=t,this.g={},this.h=0}function ue(t,e){var n=e.type;if(n in t.g){var s,i=t.g[n],r=Ct(i,e);(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(se(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function he(t,e,n,s){for(var i=0;i<t.length;++i){var r=t[i];if(!r.ba&&r.listener==e&&r.capture==!!n&&r.ha==s)return i}return-1}ce.prototype.add=function(t,e,n,s,i){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=he(t,e,s,i);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new ne(e,this.src,r,!!s,i)).ea=n,t.push(e)),e};var le="closure_lm_"+(1e6*Math.random()|0),de={};function fe(t,e,n,s,i){if(s&&s.once)return ge(t,e,n,s,i);if(Array.isArray(e)){for(var r=0;r<e.length;r++)fe(t,e[r],n,s,i);return null}return n=Te(n),t&&t[te]?t.N(e,n,mt(s)?!!s.capture:!!s,i):pe(t,e,n,!1,s,i)}function pe(t,e,n,s,i,r){if(!e)throw Error("Invalid event type");var o=mt(i)?!!i.capture:!!i,a=Ee(t);if(a||(t[le]=a=new ce(t)),(n=a.add(e,n,s,o,r)).proxy)return n;if(s=function(){const t=we;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)kt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),s,i);else if(t.attachEvent)t.attachEvent(ve(e.toString()),s);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(s)}return n}function ge(t,e,n,s,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)ge(t,e[r],n,s,i);return null}return n=Te(n),t&&t[te]?t.O(e,n,mt(s)?!!s.capture:!!s,i):pe(t,e,n,!0,s,i)}function me(t,e,n,s,i){if(Array.isArray(e))for(var r=0;r<e.length;r++)me(t,e[r],n,s,i);else s=mt(s)?!!s.capture:!!s,n=Te(n),t&&t[te]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=he(r=t.g[e],n,s,i))&&(se(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=Ee(t))&&(e=t.g[e.toString()],t=-1,e&&(t=he(e,n,s,i)),(n=-1<t?e[t]:null)&&ye(n))}function ye(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[te])ue(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(ve(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=Ee(e))?(ue(n,t),0==n.h&&(n.src=null,e[le]=null)):se(t)}}}function ve(t){return t in de?de[t]:de[t]="on"+t}function we(t,e){if(t.ba)t=!0;else{e=new Jt(e,this);var n=t.listener,s=t.ha||t.src;t.ea&&ye(t),t=n.call(s,e)}return t}function Ee(t){return(t=t[le])instanceof ce?t:null}var be="__closure_events_fn_"+(1e9*Math.random()>>>0);function Te(t){return"function"==typeof t?t:(t[be]||(t[be]=function(e){return t.handleEvent(e)}),t[be])}function Ie(){St.call(this),this.i=new ce(this),this.P=this,this.I=null}function Se(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,"string"==typeof e)e=new Dt(e,t);else if(e instanceof Dt)e.target=e.target||t;else{var i=e;ae(e=new Dt(s,t),i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];i=Ce(o,s,!0,e)&&i}if(i=Ce(o=e.g=t,s,!0,e)&&i,i=Ce(o,s,!1,e)&&i,n)for(r=0;r<n.length;r++)i=Ce(o=e.g=n[r],s,!1,e)&&i}function Ce(t,e,n,s){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&ue(t.i,o),i=!1!==a.call(c,s)&&i}}return i&&!s.defaultPrevented}It(Ie,St),Ie.prototype[te]=!0,Ie.prototype.removeEventListener=function(t,e,n,s){me(this,t,e,n,s)},Ie.prototype.M=function(){if(Ie.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],s=0;s<n.length;s++)se(n[s]);delete e.g[t],e.h--}}this.I=null},Ie.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)},Ie.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};var Ae=ft.JSON.stringify;function _e(){var t=Oe;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var De,ke=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Ne),(t=>t.reset()));class Ne{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Le(t){ft.setTimeout((()=>{throw t}),0)}function Re(t,e){De||function(){var t=ft.Promise.resolve(void 0);De=function(){t.then(Me)}}(),xe||(De(),xe=!0),Oe.add(t,e)}var xe=!1,Oe=new class{constructor(){this.h=this.g=null}add(t,e){const n=ke.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Me(){for(var t;t=_e();){try{t.h.call(t.g)}catch(t){Le(t)}var e=ke;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}xe=!1}function Ve(t,e){Ie.call(this),this.h=t||1,this.g=e||ft,this.j=bt(this.lb,this),this.l=Date.now()}function Fe(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function Pe(t,e,n){if("function"==typeof t)n&&(t=bt(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=bt(t.handleEvent,t)}return 2147483647<Number(e)?-1:ft.setTimeout(t,e||0)}function Ue(t){t.g=Pe((()=>{t.g=null,t.i&&(t.i=!1,Ue(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}It(Ve,Ie),(ut=Ve.prototype).ca=!1,ut.R=null,ut.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Se(this,"tick"),this.ca&&(Fe(this),this.start()))}},ut.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ut.M=function(){Ve.X.M.call(this),Fe(this),delete this.g};class Be extends St{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ue(this)}M(){super.M(),this.g&&(ft.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function je(t){St.call(this),this.h=t,this.g={}}It(je,St);var qe=[];function Ke(t,e,n,s){Array.isArray(n)||(n&&(qe[0]=n.toString()),n=qe);for(var i=0;i<n.length;i++){var r=fe(e,n[i],s||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function He(t){ie(t.g,(function(t,e){this.g.hasOwnProperty(e)&&ye(t)}),t),t.g={}}function $e(){this.g=!0}function Ge(t,e,n,s){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var i=s[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Ae(n)}catch(t){return e}}(t,n)+(s?" "+s:"")}))}je.prototype.M=function(){je.X.M.call(this),He(this)},je.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$e.prototype.Aa=function(){this.g=!1},$e.prototype.info=function(){};var ze={},Qe=null;function We(){return Qe=Qe||new Ie}function Xe(t){Dt.call(this,ze.Pa,t)}function Ye(t){const e=We();Se(e,new Xe(e))}function Je(t,e){Dt.call(this,ze.STAT_EVENT,t),this.stat=e}function Ze(t){const e=We();Se(e,new Je(e,t))}function tn(t,e){Dt.call(this,ze.Qa,t),this.size=e}function en(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ft.setTimeout((function(){t()}),e)}ze.Pa="serverreachability",It(Xe,Dt),ze.STAT_EVENT="statevent",It(Je,Dt),ze.Qa="timingevent",It(tn,Dt);var nn={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},sn={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function rn(){}function on(t){return t.h||(t.h=t.i())}function an(){}rn.prototype.h=null;var cn,un={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function hn(){Dt.call(this,"d")}function ln(){Dt.call(this,"c")}function dn(){}function fn(t,e,n,s){this.l=t,this.j=e,this.m=n,this.U=s||1,this.S=new je(this),this.O=gn,t=jt?125:void 0,this.T=new Ve(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new pn}function pn(){this.i=null,this.g="",this.h=!1}It(hn,Dt),It(ln,Dt),It(dn,rn),dn.prototype.g=function(){return new XMLHttpRequest},dn.prototype.i=function(){return{}},cn=new dn;var gn=45e3,mn={},yn={};function vn(t,e,n){t.K=1,t.v=Fn(Rn(e)),t.s=n,t.P=!0,wn(t,null)}function wn(t,e){t.F=Date.now(),In(t),t.A=Rn(t.v);var n=t.A,s=t.U;Array.isArray(s)||(s=[String(s)]),Xn(n.i,"t",s),t.C=0,n=t.l.H,t.h=new pn,t.g=Ws(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Be(bt(t.La,t,t.g),t.N)),Ke(t.S,t.g,"readystatechange",t.ib),e=t.H?re(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Ye(),function(t,e,n,s,i,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+s+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.U,t.s)}function En(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function bn(t,e,n){let s,i=!0;for(;!t.I&&t.C<n.length;){if(s=Tn(t,n),s==yn){4==e&&(t.o=4,Ze(14),i=!1),Ge(t.j,t.m,null,"[Incomplete Response]");break}if(s==mn){t.o=4,Ze(15),Ge(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Ge(t.j,t.m,s,null),Dn(t,s)}En(t)&&s!=yn&&s!=mn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ze(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),js(e),e.K=!0,Ze(11))):(Ge(t.j,t.m,n,"[Invalid Chunked Response]"),_n(t),An(t))}function Tn(t,e){var n=t.C,s=e.indexOf("\n",n);return-1==s?yn:(n=Number(e.substring(n,s)),isNaN(n)?mn:(s+=1)+n>e.length?yn:(e=e.substr(s,n),t.C=s+n,e))}function In(t){t.V=Date.now()+t.O,Sn(t,t.O)}function Sn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=en(bt(t.gb,t),e)}function Cn(t){t.B&&(ft.clearTimeout(t.B),t.B=null)}function An(t){0==t.l.G||t.I||Hs(t.l,t)}function _n(t){Cn(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Fe(t.T),He(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Dn(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||ns(n.h,t)))if(!t.J&&ns(n.h,t)&&3==n.G){try{var s=n.Fa.g.parse(e)}catch(t){s=null}if(Array.isArray(s)&&3==s.length){var i=s;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ks(n),xs(n)}Bs(n),Ze(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=en(bt(n.cb,n),6e3));if(1>=es(n.h)&&n.ja){try{n.ja()}catch(t){}n.ja=void 0}}else Gs(n,11)}else if((t.J||n.g==t)&&Ks(n),!Nt(e))for(i=n.Fa.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const e=u[3];null!=e&&(n.ma=e,n.j.info("VER="+n.ma));const i=u[4];null!=i&&(n.Ca=i,n.j.info("SVER="+n.Ca));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(s=1.5*h,n.J=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=s.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(ss(r,r.h),r.h=null))}if(s.D){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(s.za=t,Vn(s.F,s.D,t))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((s=n).sa=Qs(s,s.H?s.ka:null,s.V),o.J){is(s.h,o);var a=o,c=s.J;c&&a.setTimeout(c),a.B&&(Cn(a),In(a)),s.g=o}else Us(s);0<n.i.length&&Ms(n)}else"stop"!=u[0]&&"close"!=u[0]||Gs(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Gs(n,7):Rs(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}Ye()}catch(t){}}function kn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(gt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(gt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const s in t)e[n++]=s;return e}}}(t),s=function(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(gt(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}for(s in e=[],n=0,t)e[n++]=t[s];return e}(t),i=s.length,r=0;r<i;r++)e.call(void 0,s[r],n&&n[r],t)}(ut=fn.prototype).setTimeout=function(t){this.O=t},ut.ib=function(t){t=t.target;const e=this.L;e&&3==As(t)?e.l():this.La(t)},ut.La=function(t){try{if(t==this.g)t:{const h=As(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>h)&&(3!=h||jt||this.g&&(this.h.h||this.g.fa()||_s(this.g)))){this.I||4!=h||7==e||Ye(),Cn(this);var n=this.g.aa();this.Y=n;e:if(En(this)){var s=_s(this.g);t="";var i=s.length,r=4==As(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){_n(this),An(this);var o="";break e}this.h.i=new ft.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:r&&e==i-1});s.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(t,e,n,s,i,r,o){t.info((function(){return"XMLHTTP RESP ("+s+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nt(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,Ze(12),_n(this),An(this);break t}Ge(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Dn(this,n)}this.P?(bn(this,h,o),jt&&this.i&&3==h&&(Ke(this.S,this.T,"tick",this.hb),this.T.start())):(Ge(this.j,this.m,o,null),Dn(this,o)),4==h&&_n(this),this.i&&!this.I&&(4==h?Hs(this.l,this):(this.i=!1,In(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Ze(12)):(this.o=0,Ze(13)),_n(this),An(this)}}}catch(t){}},ut.hb=function(){if(this.g){var t=As(this.g),e=this.g.fa();this.C<e.length&&(Cn(this),bn(this,t,e),this.i&&4!=t&&In(this))}},ut.cancel=function(){this.I=!0,_n(this)},ut.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Ye(),Ze(17)),_n(this),this.o=2,An(this)):Sn(this,this.V-t)};var Nn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ln(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ln){this.h=void 0!==e?e:t.h,xn(this,t.j),this.s=t.s,this.g=t.g,On(this,t.m),this.l=t.l,e=t.i;var n=new Gn;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Mn(this,n),this.o=t.o}else t&&(n=String(t).match(Nn))?(this.h=!!e,xn(this,n[1]||"",!0),this.s=Pn(n[2]||""),this.g=Pn(n[3]||"",!0),On(this,n[4]),this.l=Pn(n[5]||"",!0),Mn(this,n[6]||"",!0),this.o=Pn(n[7]||"")):(this.h=!!e,this.i=new Gn(null,this.h))}function Rn(t){return new Ln(t)}function xn(t,e,n){t.j=n?Pn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function On(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Mn(t,e,n){e instanceof Gn?(t.i=e,function(t,e){e&&!t.j&&(zn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qn(this,e),Xn(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Un(e,Hn)),t.i=new Gn(e,t.h))}function Vn(t,e,n){t.i.set(e,n)}function Fn(t){return Vn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Pn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Bn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Bn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Un(e,jn,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Un(e,jn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Un(n,"/"==n.charAt(0)?Kn:qn,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Un(n,$n)),t.join("")};var jn=/[#\/\?@]/g,qn=/[#\?:]/g,Kn=/[#\?]/g,Hn=/[#\?@]/g,$n=/#/g;function Gn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function zn(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),i=null;if(0<=s){var r=t[n].substring(0,s);i=t[n].substring(s+1)}else r=t[n];e(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Qn(t,e){zn(t),e=Yn(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Wn(t,e){return zn(t),e=Yn(t,e),t.g.has(e)}function Xn(t,e,n){Qn(t,e),0<n.length&&(t.i=null,t.g.set(Yn(t,e),At(n)),t.h+=n.length)}function Yn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Jn(t){this.l=t||Zn,t=ft.PerformanceNavigationTiming?0<(t=ft.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(ft.g&&ft.g.Ga&&ft.g.Ga()&&ft.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(ut=Gn.prototype).add=function(t,e){zn(this),this.i=null,t=Yn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},ut.forEach=function(t,e){zn(this),this.g.forEach((function(n,s){n.forEach((function(n){t.call(e,n,s,this)}),this)}),this)},ut.oa=function(){zn(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let s=0;s<e.length;s++){const i=t[s];for(let t=0;t<i.length;t++)n.push(e[s])}return n},ut.W=function(t){zn(this);let e=[];if("string"==typeof t)Wn(this,t)&&(e=e.concat(this.g.get(Yn(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},ut.set=function(t,e){return zn(this),this.i=null,Wn(this,t=Yn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},ut.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},ut.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var s=e[n];const r=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var i=r;""!==o[s]&&(i+="="+encodeURIComponent(String(o[s]))),t.push(i)}}return this.i=t.join("&")};var Zn=10;function ts(t){return!!t.h||!!t.g&&t.g.size>=t.j}function es(t){return t.h?1:t.g?t.g.size:0}function ns(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ss(t,e){t.g?t.g.add(e):t.h=e}function is(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function rs(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return At(t.i)}function os(){}function as(){this.g=new os}function cs(t,e,n){const s=n||"";try{kn(t,(function(t,n){let i=t;mt(t)&&(i=Ae(t)),e.push(s+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}function us(t,e,n,s,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(s)}catch(t){}}function hs(t){this.l=t.ac||null,this.j=t.jb||!1}function ls(t,e){Ie.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ds,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Jn.prototype.cancel=function(){if(this.i=rs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},os.prototype.stringify=function(t){return ft.JSON.stringify(t,void 0)},os.prototype.parse=function(t){return ft.JSON.parse(t,void 0)},It(hs,rn),hs.prototype.g=function(){return new ls(this.l,this.j)},hs.prototype.i=function(t){return function(){return t}}({}),It(ls,Ie);var ds=0;function fs(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function ps(t){t.readyState=4,t.l=null,t.j=null,t.A=null,gs(t)}function gs(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(ut=ls.prototype).open=function(t,e){if(this.readyState!=ds)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,gs(this)},ut.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ft).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},ut.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ps(this)),this.readyState=ds},ut.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,gs(this)),this.g&&(this.readyState=3,gs(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==ft.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;fs(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},ut.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ps(this):gs(this),3==this.readyState&&fs(this)}},ut.Va=function(t){this.g&&(this.response=this.responseText=t,ps(this))},ut.Ua=function(t){this.g&&(this.response=t,ps(this))},ut.ga=function(){this.g&&ps(this)},ut.setRequestHeader=function(t,e){this.v.append(t,e)},ut.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},ut.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ls.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var ms=ft.JSON.parse;function ys(t){Ie.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=vs,this.K=this.L=!1}It(ys,Ie);var vs="",ws=/^https?$/i,Es=["POST","PUT"];function bs(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ts(t),Ss(t)}function Ts(t){t.D||(t.D=!0,Se(t,"complete"),Se(t,"error"))}function Is(t){if(t.h&&void 0!==dt&&(!t.C[1]||4!=As(t)||2!=t.aa()))if(t.v&&4==As(t))Pe(t.Ha,0,t);else if(Se(t,"readystatechange"),4==As(t)){t.h=!1;try{const a=t.aa();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===a){var i=String(t.H).match(Nn)[1]||null;if(!i&&ft.self&&ft.self.location){var r=ft.self.location.protocol;i=r.substr(0,r.length-1)}s=!ws.test(i?i.toLowerCase():"")}n=s}if(n)Se(t,"complete"),Se(t,"success");else{t.m=6;try{var o=2<As(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.aa()+"]",Ts(t)}}finally{Ss(t)}}}function Ss(t,e){if(t.g){Cs(t);const n=t.g,s=t.C[0]?pt:null;t.g=null,t.C=null,e||Se(t,"ready");try{n.onreadystatechange=s}catch(t){}}}function Cs(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ft.clearTimeout(t.A),t.A=null)}function As(t){return t.g?t.g.readyState:0}function _s(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case vs:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ds(t){let e="";return ie(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function ks(t,e,n){t:{for(s in n){var s=!1;break t}s=!0}s||(n=Ds(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Vn(t,e,n))}function Ns(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ls(t){this.Ca=0,this.i=[],this.j=new $e,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Ns("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Ns("baseRetryDelayMs",5e3,t),this.bb=Ns("retryDelaySeedMs",1e4,t),this.$a=Ns("forwardChannelMaxRetries",2,t),this.ta=Ns("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Jn(t&&t.concurrentRequestLimit),this.Fa=new as,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Rs(t){if(Os(t),3==t.G){var e=t.U++,n=Rn(t.F);Vn(n,"SID",t.I),Vn(n,"RID",e),Vn(n,"TYPE","terminate"),Fs(t,n),(e=new fn(t,t.j,e,void 0)).K=2,e.v=Fn(Rn(n)),n=!1,ft.navigator&&ft.navigator.sendBeacon&&(n=ft.navigator.sendBeacon(e.v.toString(),"")),!n&&ft.Image&&((new Image).src=e.v,n=!0),n||(e.g=Ws(e.l,null),e.g.da(e.v)),e.F=Date.now(),In(e)}zs(t)}function xs(t){t.g&&(js(t),t.g.cancel(),t.g=null)}function Os(t){xs(t),t.u&&(ft.clearTimeout(t.u),t.u=null),Ks(t),t.h.cancel(),t.m&&("number"==typeof t.m&&ft.clearTimeout(t.m),t.m=null)}function Ms(t){ts(t.h)||t.m||(t.m=!0,Re(t.Ja,t),t.C=0)}function Vs(t,e){var n;n=e?e.m:t.U++;const s=Rn(t.F);Vn(s,"SID",t.I),Vn(s,"RID",n),Vn(s,"AID",t.T),Fs(t,s),t.o&&t.s&&ks(s,t.o,t.s),n=new fn(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Ps(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),ss(t.h,n),vn(n,s,e)}function Fs(t,e){t.ia&&ie(t.ia,(function(t,n){Vn(e,n,t)})),t.l&&kn({},(function(t,n){Vn(e,n,t)}))}function Ps(t,e,n){n=Math.min(t.i.length,n);var s=t.l?bt(t.l.Ra,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=e,0>n)e=Math.max(0,i[o].h-100),r=!1;else try{cs(a,t,"req"+n+"_")}catch(t){s&&s(a)}}if(r){s=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,s}function Us(t){t.g||t.u||(t.Z=1,Re(t.Ia,t),t.A=0)}function Bs(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=en(bt(t.Ia,t),$s(t,t.A)),t.A++,0))}function js(t){null!=t.B&&(ft.clearTimeout(t.B),t.B=null)}function qs(t){t.g=new fn(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=Rn(t.sa);Vn(e,"RID","rpc"),Vn(e,"SID",t.I),Vn(e,"CI",t.L?"0":"1"),Vn(e,"AID",t.T),Vn(e,"TYPE","xmlhttp"),Fs(t,e),t.o&&t.s&&ks(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=Fn(Rn(e)),n.s=null,n.P=!0,wn(n,t)}function Ks(t){null!=t.v&&(ft.clearTimeout(t.v),t.v=null)}function Hs(t,e){var n=null;if(t.g==e){Ks(t),js(t),t.g=null;var s=2}else{if(!ns(t.h,e))return;n=e.D,is(t.h,e),s=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==s){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Se(s=We(),new tn(s,n)),Ms(t)}else Us(t);else if(3==(i=e.o)||0==i&&0<t.pa||!(1==s&&function(t,e){return!(es(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=en(bt(t.Ja,t,e),$s(t,t.C)),t.C++,0)))}(t,e)||2==s&&Bs(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:Gs(t,5);break;case 4:Gs(t,10);break;case 3:Gs(t,6);break;default:Gs(t,2)}}function $s(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Gs(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var s=bt(t.kb,t);n||(n=new Ln("//www.google.com/images/cleardot.gif"),ft.location&&"http"==ft.location.protocol||xn(n,"https"),Fn(n)),function(t,e){const n=new $e;if(ft.Image){const s=new Image;s.onload=Tt(us,n,s,"TestLoadImage: loaded",!0,e),s.onerror=Tt(us,n,s,"TestLoadImage: error",!1,e),s.onabort=Tt(us,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=Tt(us,n,s,"TestLoadImage: timeout",!1,e),ft.setTimeout((function(){s.ontimeout&&s.ontimeout()}),1e4),s.src=t}else e(!1)}(n.toString(),s)}else Ze(2);t.G=0,t.l&&t.l.va(e),zs(t),Os(t)}function zs(t){if(t.G=0,t.la=[],t.l){const e=rs(t.h);0==e.length&&0==t.i.length||(_t(t.la,e),_t(t.la,t.i),t.h.i.length=0,At(t.i),t.i.length=0),t.l.ua()}}function Qs(t,e,n){var s=n instanceof Ln?Rn(n):new Ln(n,void 0);if(""!=s.g)e&&(s.g=e+"."+s.g),On(s,s.m);else{var i=ft.location;s=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var r=new Ln(null,void 0);s&&xn(r,s),e&&(r.g=e),i&&On(r,i),n&&(r.l=n),s=r}return n=t.D,e=t.za,n&&e&&Vn(s,n,e),Vn(s,"VER",t.ma),Fs(t,s),s}function Ws(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Da&&!t.ra?new ys(new hs({jb:!0})):new ys(t.ra)).Ka(t.H),e}function Xs(){}function Ys(){if(Ut&&!(10<=Number(Yt)))throw Error("Environmental error: no available transport.")}function Js(t,e){Ie.call(this),this.g=new Ls(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Nt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nt(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ei(this)}function Zs(t){hn.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ti(){ln.call(this),this.status=1}function ei(t){this.g=t}(ut=ys.prototype).Ka=function(t){this.L=t},ut.da=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():cn.g(),this.C=this.u?on(this.u):on(cn),this.g.onreadystatechange=bt(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void bs(this,t)}if(t=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var i in s)n.set(i,s[i]);else{if("function"!=typeof s.keys||"function"!=typeof s.get)throw Error("Unknown input type for opt_headers: "+String(s));for(const t of s.keys())n.set(t,s.get(t))}s=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=ft.FormData&&t instanceof ft.FormData,!(0<=Ct(Es,e))||s||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Cs(this),0<this.B&&((this.K=function(t){return Ut&&Xt()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=bt(this.qa,this)):this.A=Pe(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){bs(this,t)}},ut.qa=function(){void 0!==dt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Se(this,"timeout"),this.abort(8))},ut.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Se(this,"complete"),Se(this,"abort"),Ss(this))},ut.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ss(this,!0)),ys.X.M.call(this)},ut.Ha=function(){this.s||(this.F||this.v||this.l?Is(this):this.fb())},ut.fb=function(){Is(this)},ut.aa=function(){try{return 2<As(this)?this.g.status:-1}catch(t){return-1}},ut.fa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},ut.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ms(e)}},ut.Ea=function(){return this.m},ut.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(ut=Ls.prototype).ma=8,ut.G=1,ut.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new fn(this,this.j,t,void 0);let r=this.s;if(this.S&&(r?(r=re(r),ae(r,this.S)):r=this.S),null!==this.o||this.N||(i.H=r,r=null),this.O)t:{for(var e=0,n=0;n<this.i.length;n++){var s=this.i[n];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(e+=s)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Ps(this,i,e),Vn(n=Rn(this.F),"RID",t),Vn(n,"CVER",22),this.D&&Vn(n,"X-HTTP-Session-Id",this.D),Fs(this,n),r&&(this.N?e="headers="+encodeURIComponent(String(Ds(r)))+"&"+e:this.o&&ks(n,this.o,r)),ss(this.h,i),this.Ya&&Vn(n,"TYPE","init"),this.O?(Vn(n,"$req",e),Vn(n,"SID","null"),i.Z=!0,vn(i,n,null)):vn(i,n,e),this.G=2}}else 3==this.G&&(t?Vs(this,t):0==this.i.length||ts(this.h)||Vs(this))},ut.Ia=function(){if(this.u=null,qs(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=en(bt(this.eb,this),t)}},ut.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Ze(10),xs(this),qs(this))},ut.cb=function(){null!=this.v&&(this.v=null,xs(this),Bs(this),Ze(19))},ut.kb=function(t){t?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))},(ut=Xs.prototype).xa=function(){},ut.wa=function(){},ut.va=function(){},ut.ua=function(){},ut.Ra=function(){},Ys.prototype.g=function(t,e){return new Js(t,e)},It(Js,Ie),Js.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;Ze(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=Qs(t,null,t.V),Ms(t)},Js.prototype.close=function(){Rs(this.g)},Js.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Ae(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Ms(e)},Js.prototype.M=function(){this.g.l=null,delete this.j,Rs(this.g),delete this.g,Js.X.M.call(this)},It(Zs,hn),It(ti,ln),It(ei,Xs),ei.prototype.xa=function(){Se(this.g,"a")},ei.prototype.wa=function(t){Se(this.g,new Zs(t))},ei.prototype.va=function(t){Se(this.g,new ti)},ei.prototype.ua=function(){Se(this.g,"b")},Ys.prototype.createWebChannel=Ys.prototype.g,Js.prototype.send=Js.prototype.u,Js.prototype.open=Js.prototype.m,Js.prototype.close=Js.prototype.close,nn.NO_ERROR=0,nn.TIMEOUT=8,nn.HTTP_ERROR=6,sn.COMPLETE="complete",an.EventType=un,un.OPEN="a",un.CLOSE="b",un.ERROR="c",un.MESSAGE="d",Ie.prototype.listen=Ie.prototype.N,ys.prototype.listenOnce=ys.prototype.O,ys.prototype.getLastError=ys.prototype.Oa,ys.prototype.getLastErrorCode=ys.prototype.Ea,ys.prototype.getStatus=ys.prototype.aa,ys.prototype.getResponseJson=ys.prototype.Sa,ys.prototype.getResponseText=ys.prototype.fa,ys.prototype.send=ys.prototype.da,ys.prototype.setWithCredentials=ys.prototype.Ka;var ni=lt.createWebChannelTransport=function(){return new Ys},si=lt.getStatEventTarget=function(){return We()},ii=lt.ErrorCode=nn,ri=lt.EventType=sn,oi=lt.Event=ze,ai=lt.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},ci=lt.FetchXmlHttpFactory=hs,ui=lt.WebChannel=an,hi=lt.XhrIo=ys;const li="@firebase/firestore";class di{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}di.UNAUTHENTICATED=new di(null),di.GOOGLE_CREDENTIALS=new di("google-credentials-uid"),di.FIRST_PARTY=new di("first-party-uid"),di.MOCK_USER=new di("mock-user");let fi="9.14.0";const pi=new I("@firebase/firestore");function gi(){return pi.logLevel}function mi(t,...e){if(pi.logLevel<=y.DEBUG){const n=e.map(wi);pi.debug(`Firestore (${fi}): ${t}`,...n)}}function yi(t,...e){if(pi.logLevel<=y.ERROR){const n=e.map(wi);pi.error(`Firestore (${fi}): ${t}`,...n)}}function vi(t,...e){if(pi.logLevel<=y.WARN){const n=e.map(wi);pi.warn(`Firestore (${fi}): ${t}`,...n)}}function wi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ei(t="Unexpected state"){const e=`FIRESTORE (${fi}) INTERNAL ASSERTION FAILED: `+t;throw yi(e),new Error(e)}function bi(t,e){t||Ei()}function Ti(t,e){return t}const Ii={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Si extends o{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ci{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Ai{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class _i{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(di.UNAUTHENTICATED)))}shutdown(){}}class Di{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ki{constructor(t){this.t=t,this.currentUser=di.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const s=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ci,t.enqueueRetryable((()=>s(this.currentUser)))};const r=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await s(this.currentUser)}))},o=t=>{mi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(mi("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ci)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(mi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(bi("string"==typeof e.accessToken),new Ai(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return bi(null===t||"string"==typeof t),new di(t)}}class Ni{constructor(t,e,n,s){this.h=t,this.l=e,this.m=n,this.g=s,this.type="FirstParty",this.user=di.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(bi(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Li{constructor(t,e,n,s){this.h=t,this.l=e,this.m=n,this.g=s}getToken(){return Promise.resolve(new Ni(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(di.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ri{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xi{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&mi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,mi("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const s=t=>{mi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>s(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?s(t):mi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(bi("string"==typeof t.token),this.A=t.token,new Ri(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Oi(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Mi{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=Oi(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<e&&(n+=t.charAt(s[i]%t.length))}return n}}function Vi(t,e){return t<e?-1:t>e?1:0}function Fi(t,e,n){return t.length===e.length&&t.every(((t,s)=>n(t,e[s])))}class Pi{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Si(Ii.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Si(Ii.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Si(Ii.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Si(Ii.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Pi.fromMillis(Date.now())}static fromDate(t){return Pi.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Pi(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Vi(this.nanoseconds,t.nanoseconds):Vi(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ui{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ui(t)}static min(){return new Ui(new Pi(0,0))}static max(){return new Ui(new Pi(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Bi{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ei(),void 0===n?n=t.length-e:n>t.length-e&&Ei(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Bi.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Bi?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),i=e.get(s);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class ji extends Bi{construct(t,e,n){return new ji(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Si(Ii.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new ji(e)}static emptyPath(){return new ji([])}}const qi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ki extends Bi{construct(t,e,n){return new Ki(t,e,n)}static isValidIdentifier(t){return qi.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ki.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ki(["__name__"])}static fromServerFormat(t){const e=[];let n="",s=0;const i=()=>{if(0===n.length)throw new Si(Ii.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new Si(Ii.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Si(Ii.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(r=!r,s++):"."!==e||r?(n+=e,s++):(i(),s++)}if(i(),r)throw new Si(Ii.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ki(e)}static emptyPath(){return new Ki([])}}class Hi{constructor(t){this.path=t}static fromPath(t){return new Hi(ji.fromString(t))}static fromName(t){return new Hi(ji.fromString(t).popFirst(5))}static empty(){return new Hi(ji.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===ji.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return ji.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Hi(new ji(t.slice()))}}function $i(t){return new Gi(t.readTime,t.key,-1)}class Gi{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Gi(Ui.min(),Hi.empty(),-1)}static max(){return new Gi(Ui.max(),Hi.empty(),-1)}}function zi(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Hi.comparator(t.documentKey,e.documentKey),0!==n?n:Vi(t.largestBatchId,e.largestBatchId))}class Qi{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Wi(t){if(t.code!==Ii.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;mi("LocalStore","Unexpectedly lost primary lease")}class Xi{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ei(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Xi(((n,s)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,s)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Xi?e:Xi.resolve(e)}catch(t){return Xi.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Xi.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Xi.reject(e)}static resolve(t){return new Xi(((e,n)=>{e(t)}))}static reject(t){return new Xi(((e,n)=>{n(t)}))}static waitFor(t){return new Xi(((e,n)=>{let s=0,i=0,r=!1;t.forEach((t=>{++s,t.next((()=>{++i,r&&i===s&&e()}),(t=>n(t)))})),r=!0,i===s&&e()}))}static or(t){let e=Xi.resolve(!1);for(const n of t)e=e.next((t=>t?Xi.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,s)=>{n.push(e.call(this,t,s))})),this.waitFor(n)}static mapArray(t,e){return new Xi(((n,s)=>{const i=t.length,r=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===i&&n(r)}),(t=>s(t)))}}))}static doWhile(t,e){return new Xi(((n,s)=>{const i=()=>{!0===t()?e().next((()=>{i()}),s):n()};i()}))}}function Yi(t){return"IndexedDbTransactionError"===t.name}class Ji{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function Zi(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function tr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function er(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Ji.at=-1;class nr{constructor(t,e){this.comparator=t,this.root=e||ir.EMPTY}insert(t,e){return new nr(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,ir.BLACK,null,null))}remove(t){return new nr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,ir.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(0===s)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new sr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new sr(this.root,t,this.comparator,!1)}getReverseIterator(){return new sr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new sr(this.root,t,this.comparator,!0)}}class sr{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class ir{constructor(t,e,n,s,i){this.key=t,this.value=e,this.color=null!=n?n:ir.RED,this.left=null!=s?s:ir.EMPTY,this.right=null!=i?i:ir.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,i){return new ir(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=s?s:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const i=n(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,n),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ir.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return ir.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ei();if(this.right.isRed())throw Ei();const t=this.left.check();if(t!==this.right.check())throw Ei();return t+(this.isRed()?0:1)}}ir.EMPTY=null,ir.RED=!0,ir.BLACK=!1,ir.EMPTY=new class{constructor(){this.size=0}get key(){throw Ei()}get value(){throw Ei()}get color(){throw Ei()}get left(){throw Ei()}get right(){throw Ei()}copy(t,e,n,s,i){return this}insert(t,e,n){return new ir(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rr{constructor(t){this.comparator=t,this.data=new nr(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new or(this.data.getIterator())}getIteratorFrom(t){return new or(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof rr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(0!==this.comparator(t,s))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new rr(this.comparator);return e.data=t,e}}class or{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ar{constructor(t){this.fields=t,t.sort(Ki.comparator)}static empty(){return new ar([])}unionWith(t){let e=new rr(Ki.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new ar(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Fi(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class cr{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new cr(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new cr(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Vi(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}cr.EMPTY_BYTE_STRING=new cr("");const ur=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hr(t){if(bi(!!t),"string"==typeof t){let e=0;const n=ur.exec(t);if(bi(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:lr(t.seconds),nanos:lr(t.nanos)}}function lr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function dr(t){return"string"==typeof t?cr.fromBase64String(t):cr.fromUint8Array(t)}function fr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pr(t){const e=t.mapValue.fields.__previous_value__;return fr(e)?pr(e):e}function gr(t){const e=hr(t.mapValue.fields.__local_write_time__.timestampValue);return new Pi(e.seconds,e.nanos)}class mr{constructor(t,e,n,s,i,r,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class yr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new yr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof yr&&t.projectId===this.projectId&&t.database===this.database}}function vr(t){return null==t}function wr(t){return 0===t&&1/t==-1/0}const Er={fields:{__type__:{stringValue:"__max__"}}};function br(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fr(t)?4:Or(t)?9007199254740991:10:Ei()}function Tr(t,e){if(t===e)return!0;const n=br(t);if(n!==br(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gr(t).isEqual(gr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=hr(t.timestampValue),s=hr(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return dr(t.bytesValue).isEqual(dr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return lr(t.geoPointValue.latitude)===lr(e.geoPointValue.latitude)&&lr(t.geoPointValue.longitude)===lr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return lr(t.integerValue)===lr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=lr(t.doubleValue),s=lr(e.doubleValue);return n===s?wr(n)===wr(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return Fi(t.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(Zi(n)!==Zi(s))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===s[t]||!Tr(n[t],s[t])))return!1;return!0}(t,e);default:return Ei()}}function Ir(t,e){return void 0!==(t.values||[]).find((t=>Tr(t,e)))}function Sr(t,e){if(t===e)return 0;const n=br(t),s=br(e);if(n!==s)return Vi(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Vi(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=lr(t.integerValue||t.doubleValue),s=lr(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return Cr(t.timestampValue,e.timestampValue);case 4:return Cr(gr(t),gr(e));case 5:return Vi(t.stringValue,e.stringValue);case 6:return function(t,e){const n=dr(t),s=dr(e);return n.compareTo(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let t=0;t<n.length&&t<s.length;t++){const e=Vi(n[t],s[t]);if(0!==e)return e}return Vi(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Vi(lr(t.latitude),lr(e.latitude));return 0!==n?n:Vi(lr(t.longitude),lr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let t=0;t<n.length&&t<s.length;++t){const e=Sr(n[t],s[t]);if(e)return e}return Vi(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Er&&e===Er)return 0;if(t===Er)return 1;if(e===Er)return-1;const n=t.fields||{},s=Object.keys(n),i=e.fields||{},r=Object.keys(i);s.sort(),r.sort();for(let t=0;t<s.length&&t<r.length;++t){const e=Vi(s[t],r[t]);if(0!==e)return e;const o=Sr(n[s[t]],i[r[t]]);if(0!==o)return o}return Vi(s.length,r.length)}(t.mapValue,e.mapValue);default:throw Ei()}}function Cr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vi(t,e);const n=hr(t),s=hr(e),i=Vi(n.seconds,s.seconds);return 0!==i?i:Vi(n.nanos,s.nanos)}function Ar(t){return _r(t)}function _r(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=hr(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?dr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Hi.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const s of t.values||[])n?n=!1:e+=",",e+=_r(s);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",s=!0;for(const i of e)s?s=!1:n+=",",n+=`${i}:${_r(t.fields[i])}`;return n+"}"}(t.mapValue):Ei();var e,n}function Dr(t){return!!t&&"integerValue"in t}function kr(t){return!!t&&"arrayValue"in t}function Nr(t){return!!t&&"nullValue"in t}function Lr(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rr(t){return!!t&&"mapValue"in t}function xr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return tr(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=xr(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=xr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Or(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Mr{constructor(t){this.value=t}static empty(){return new Mr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Rr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=xr(e)}setAll(t){let e=Ki.emptyPath(),n={},s=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,s),n={},s=[],e=i.popLast()}t?n[i.lastSegment()]=xr(t):s.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,s)}delete(t){const e=this.field(t.popLast());Rr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Tr(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];Rr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){tr(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Mr(xr(this.value))}}function Vr(t){const e=[];return tr(t.fields,((t,n)=>{const s=new Ki([t]);if(Rr(n)){const t=Vr(n.mapValue).fields;if(0===t.length)e.push(s);else for(const n of t)e.push(s.child(n))}else e.push(s)})),new ar(e)}class Fr{constructor(t,e,n,s,i,r){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.data=i,this.documentState=r}static newInvalidDocument(t){return new Fr(t,0,Ui.min(),Ui.min(),Mr.empty(),0)}static newFoundDocument(t,e,n){return new Fr(t,1,e,Ui.min(),n,0)}static newNoDocument(t,e){return new Fr(t,2,e,Ui.min(),Mr.empty(),0)}static newUnknownDocument(t,e){return new Fr(t,3,e,Ui.min(),Mr.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Mr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ui.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Fr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Fr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pr{constructor(t,e=null,n=[],s=[],i=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=r,this.endAt=o,this.ht=null}}function Ur(t,e=null,n=[],s=[],i=null,r=null,o=null){return new Pr(t,e,n,s,i,r,o)}function Br(t){const e=Ti(t);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Ar(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),vr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Ar(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Ar(t))).join(",")),e.ht=t}return e.ht}function jr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!to(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],s=e.filters[i],n.op!==s.op||!n.field.isEqual(s.field)||!Tr(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!no(t.startAt,e.startAt)&&no(t.endAt,e.endAt)}function qr(t){return Hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Kr extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,n):new Hr(t,e,n):"array-contains"===e?new Qr(t,n):"in"===e?new Wr(t,n):"not-in"===e?new Xr(t,n):"array-contains-any"===e?new Yr(t,n):new Kr(t,e,n)}static lt(t,e,n){return"in"===e?new $r(t,n):new Gr(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(Sr(e,this.value)):null!==e&&br(this.value)===br(e)&&this.ft(Sr(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ei()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Hr extends Kr{constructor(t,e,n){super(t,e,n),this.key=Hi.fromName(n.referenceValue)}matches(t){const e=Hi.comparator(t.key,this.key);return this.ft(e)}}class $r extends Kr{constructor(t,e){super(t,"in",e),this.keys=zr(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Gr extends Kr{constructor(t,e){super(t,"not-in",e),this.keys=zr(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function zr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Hi.fromName(t.referenceValue)))}class Qr extends Kr{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return kr(e)&&Ir(e.arrayValue,this.value)}}class Wr extends Kr{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ir(this.value.arrayValue,e)}}class Xr extends Kr{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ir(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ir(this.value.arrayValue,e)}}class Yr extends Kr{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!kr(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ir(this.value.arrayValue,t)))}}class Jr{constructor(t,e){this.position=t,this.inclusive=e}}class Zr{constructor(t,e="asc"){this.field=t,this.dir=e}}function to(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function eo(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(s=r.field.isKeyField()?Hi.comparator(Hi.fromName(o.referenceValue),n.key):Sr(o,n.data.field(r.field)),"desc"===r.dir&&(s*=-1),0!==s)break}return s}function no(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tr(t.position[n],e.position[n]))return!1;return!0}class so{constructor(t,e=null,n=[],s=[],i=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=r,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function io(t){return new so(t)}function ro(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function oo(t){const e=Ti(t);if(null===e._t){e._t=[];const t=function(t){for(const e of t.filters)if(e.dt())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e._t.push(new Zr(t)),e._t.push(new Zr(Ki.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e._t.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new Zr(Ki.keyField(),t))}}}return e._t}function ao(t){const e=Ti(t);if(!e.wt)if("F"===e.limitType)e.wt=Ur(e.path,e.collectionGroup,oo(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of oo(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Zr(n.field,e))}const n=e.endAt?new Jr(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Jr(e.startAt.position,e.startAt.inclusive):null;e.wt=Ur(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e.wt}function co(t,e,n){return new so(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function uo(t,e){return jr(ao(t),ao(e))&&t.limitType===e.limitType}function ho(t){return`${Br(ao(t))}|lt:${t.limitType}`}function lo(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Ar(e.value)}`;var e})).join(", ")}]`),vr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Ar(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Ar(t))).join(",")),`Target(${e})`}(ao(t))}; limitType=${t.limitType})`}function fo(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Hi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const s=eo(t,e,n);return t.inclusive?s<=0:s<0}(t.startAt,oo(t),e)||t.endAt&&!function(t,e,n){const s=eo(t,e,n);return t.inclusive?s>=0:s>0}(t.endAt,oo(t),e))}(t,e)}function po(t){return(e,n)=>{let s=!1;for(const i of oo(t)){const t=go(i,e,n);if(0!==t)return t;s=s||i.field.isKeyField()}return 0}}function go(t,e,n){const s=t.field.isKeyField()?Hi.comparator(e.key,n.key):function(t,e,n){const s=e.data.field(t),i=n.data.field(t);return null!==s&&null!==i?Sr(s,i):Ei()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Ei()}}function mo(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wr(e)?"-0":e}}function yo(t){return{integerValue:""+t}}function vo(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!wr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?yo(e):mo(t,e)}class wo{constructor(){this._=void 0}}function Eo(t,e,n){return t instanceof Io?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof So?Co(t,e):t instanceof Ao?_o(t,e):function(t,e){const n=To(t,e),s=ko(n)+ko(t.yt);return Dr(n)&&Dr(t.yt)?yo(s):mo(t.It,s)}(t,e)}function bo(t,e,n){return t instanceof So?Co(t,e):t instanceof Ao?_o(t,e):n}function To(t,e){return t instanceof Do?Dr(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Io extends wo{}class So extends wo{constructor(t){super(),this.elements=t}}function Co(t,e){const n=No(e);for(const e of t.elements)n.some((t=>Tr(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ao extends wo{constructor(t){super(),this.elements=t}}function _o(t,e){let n=No(e);for(const e of t.elements)n=n.filter((t=>!Tr(t,e)));return{arrayValue:{values:n}}}class Do extends wo{constructor(t,e){super(),this.It=t,this.yt=e}}function ko(t){return lr(t.integerValue||t.doubleValue)}function No(t){return kr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Lo{constructor(t,e){this.version=t,this.transformResults=e}}class Ro{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ro}static exists(t){return new Ro(void 0,t)}static updateTime(t){return new Ro(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function xo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Oo{}function Mo(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new $o(t.key,Ro.none()):new Bo(t.key,t.data,Ro.none());{const n=t.data,s=Mr.empty();let i=new rr(Ki.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?s.delete(t):s.set(t,e),i=i.add(t)}return new jo(t.key,s,new ar(i.toArray()),Ro.none())}}function Vo(t,e,n){t instanceof Bo?function(t,e,n){const s=t.value.clone(),i=Ko(t.fieldTransforms,e,n.transformResults);s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):t instanceof jo?function(t,e,n){if(!xo(t.precondition,e))return void e.convertToUnknownDocument(n.version);const s=Ko(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(qo(t)),i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Fo(t,e,n,s){return t instanceof Bo?function(t,e,n,s){if(!xo(t.precondition,e))return n;const i=t.value.clone(),r=Ho(t.fieldTransforms,s,e);return i.setAll(r),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,s):t instanceof jo?function(t,e,n,s){if(!xo(t.precondition,e))return n;const i=Ho(t.fieldTransforms,s,e),r=e.data;return r.setAll(qo(t)),r.setAll(i),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,s):function(t,e,n){return xo(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Po(t,e){let n=null;for(const s of t.fieldTransforms){const t=e.data.field(s.field),i=To(s.transform,t||null);null!=i&&(null===n&&(n=Mr.empty()),n.set(s.field,i))}return n||null}function Uo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Fi(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof So&&e instanceof So||t instanceof Ao&&e instanceof Ao?Fi(t.elements,e.elements,Tr):t instanceof Do&&e instanceof Do?Tr(t.yt,e.yt):t instanceof Io&&e instanceof Io}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Bo extends Oo{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class jo extends Oo{constructor(t,e,n,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function qo(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function Ko(t,e,n){const s=new Map;bi(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,bo(o,a,n[i]))}return s}function Ho(t,e,n){const s=new Map;for(const i of t){const t=i.transform,r=n.data.field(i.field);s.set(i.field,Eo(t,r,e))}return s}class $o extends Oo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Go extends Oo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class zo{constructor(t){this.count=t}}var Qo,Wo;function Xo(t){if(void 0===t)return yi("GRPC error has no .code"),Ii.UNKNOWN;switch(t){case Qo.OK:return Ii.OK;case Qo.CANCELLED:return Ii.CANCELLED;case Qo.UNKNOWN:return Ii.UNKNOWN;case Qo.DEADLINE_EXCEEDED:return Ii.DEADLINE_EXCEEDED;case Qo.RESOURCE_EXHAUSTED:return Ii.RESOURCE_EXHAUSTED;case Qo.INTERNAL:return Ii.INTERNAL;case Qo.UNAVAILABLE:return Ii.UNAVAILABLE;case Qo.UNAUTHENTICATED:return Ii.UNAUTHENTICATED;case Qo.INVALID_ARGUMENT:return Ii.INVALID_ARGUMENT;case Qo.NOT_FOUND:return Ii.NOT_FOUND;case Qo.ALREADY_EXISTS:return Ii.ALREADY_EXISTS;case Qo.PERMISSION_DENIED:return Ii.PERMISSION_DENIED;case Qo.FAILED_PRECONDITION:return Ii.FAILED_PRECONDITION;case Qo.ABORTED:return Ii.ABORTED;case Qo.OUT_OF_RANGE:return Ii.OUT_OF_RANGE;case Qo.UNIMPLEMENTED:return Ii.UNIMPLEMENTED;case Qo.DATA_LOSS:return Ii.DATA_LOSS;default:return Ei()}}(Wo=Qo||(Qo={}))[Wo.OK=0]="OK",Wo[Wo.CANCELLED=1]="CANCELLED",Wo[Wo.UNKNOWN=2]="UNKNOWN",Wo[Wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wo[Wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wo[Wo.NOT_FOUND=5]="NOT_FOUND",Wo[Wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wo[Wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wo[Wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wo[Wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wo[Wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wo[Wo.ABORTED=10]="ABORTED",Wo[Wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wo[Wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wo[Wo.INTERNAL=13]="INTERNAL",Wo[Wo.UNAVAILABLE=14]="UNAVAILABLE",Wo[Wo.DATA_LOSS=15]="DATA_LOSS";class Yo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,s]of n)if(this.equalsFn(e,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(void 0===s)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<s.length;n++)if(this.equalsFn(s[n][0],t))return void(s[n]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return 1===n.length?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){tr(this.inner,((e,n)=>{for(const[e,s]of n)t(e,s)}))}isEmpty(){return er(this.inner)}size(){return this.innerSize}}const Jo=new nr(Hi.comparator);function Zo(){return Jo}const ta=new nr(Hi.comparator);function ea(...t){let e=ta;for(const n of t)e=e.insert(n.key,n);return e}function na(t){let e=ta;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function sa(){return ra()}function ia(){return ra()}function ra(){return new Yo((t=>t.toString()),((t,e)=>t.isEqual(e)))}const oa=new nr(Hi.comparator),aa=new rr(Hi.comparator);function ca(...t){let e=aa;for(const n of t)e=e.add(n);return e}const ua=new rr(Vi);function ha(){return ua}class la{constructor(t,e,n,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,da.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new la(Ui.min(),s,ha(),Zo(),ca())}}class da{constructor(t,e,n,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new da(n,e,ca(),ca(),ca())}}class fa{constructor(t,e,n,s){this.Tt=t,this.removedTargetIds=e,this.key=n,this.Et=s}}class pa{constructor(t,e){this.targetId=t,this.At=e}}class ga{constructor(t,e,n=cr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class ma{constructor(){this.Rt=0,this.bt=wa(),this.Pt=cr.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=ca(),e=ca(),n=ca();return this.bt.forEach(((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:Ei()}})),new da(this.Pt,this.vt,t,e,n)}Nt(){this.Vt=!1,this.bt=wa()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class ya{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=Zo(),this.qt=va(),this.Kt=new rr(Vi)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,(e=>{const n=this.zt(e);switch(t.state){case 0:this.Ht(e)&&n.Ct(t.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(t.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(n.$t(),n.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),n.Ct(t.resumeToken));break;default:Ei()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach(((t,n)=>{this.Ht(n)&&e(n)}))}Yt(t){const e=t.targetId,n=t.At.count,s=this.Xt(e);if(s){const t=s.target;if(qr(t))if(0===n){const n=new Hi(t.path);this.jt(e,n,Fr.newNoDocument(n,Ui.min()))}else bi(1===n);else this.Zt(e)!==n&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach(((n,s)=>{const i=this.Xt(s);if(i){if(n.current&&qr(i.target)){const e=new Hi(i.target.path);null!==this.Ut.get(e)||this.ee(s,e)||this.jt(s,e,Fr.newNoDocument(e,t))}n.Dt&&(e.set(s,n.xt()),n.Nt())}}));let n=ca();this.qt.forEach(((t,e)=>{let s=!0;e.forEachWhile((t=>{const e=this.Xt(t);return!e||2===e.purpose||(s=!1,!1)})),s&&(n=n.add(t))})),this.Ut.forEach(((e,n)=>n.setReadTime(t)));const s=new la(t,e,this.Kt,this.Ut,n);return this.Ut=Zo(),this.qt=va(),this.Kt=new rr(Vi),s}Qt(t,e){if(!this.Ht(t))return;const n=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,n),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,n){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),n&&(this.Ut=this.Ut.insert(e,n))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new ma,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new rr(Vi),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||mi("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new ma),this.Bt.getRemoteKeysForTarget(t).forEach((e=>{this.jt(t,e,null)}))}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function va(){return new nr(Hi.comparator)}function wa(){return new nr(Hi.comparator)}const Ea={asc:"ASCENDING",desc:"DESCENDING"},ba={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Ta{constructor(t,e){this.databaseId=t,this.gt=e}}function Ia(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sa(t,e){return t.gt?e.toBase64():e.toUint8Array()}function Ca(t,e){return Ia(t,e.toTimestamp())}function Aa(t){return bi(!!t),Ui.fromTimestamp(function(t){const e=hr(t);return new Pi(e.seconds,e.nanos)}(t))}function _a(t,e){return function(t){return new ji(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Da(t){const e=ji.fromString(t);return bi(Ga(e)),e}function ka(t,e){return _a(t.databaseId,e.path)}function Na(t,e){const n=Da(e);if(n.get(1)!==t.databaseId.projectId)throw new Si(Ii.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Si(Ii.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Hi(xa(n))}function La(t,e){return _a(t.databaseId,e)}function Ra(t){return new ji(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function xa(t){return bi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Oa(t,e,n){return{name:ka(t,e),fields:n.value.mapValue.fields}}function Ma(t,e){return{documents:[La(t,e.path)]}}function Va(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=La(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=La(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const i=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Lr(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NAN"}};if(Nr(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lr(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NAN"}};if(Nr(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ja(t.field),op:Ba(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const r=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:ja(t.field),direction:Ua(t.dir)}}(t)))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const o=function(t,e){return t.gt||vr(e)?e:{value:e}}(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Fa(t){let e=function(t){const e=Da(t);return 4===e.length?ji.emptyPath():xa(e)}(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){bi(1===s);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=Pa(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new Zr(qa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,vr(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new Jr(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new Jr(n,e)}(n.endAt)),function(t,e,n,s,i,r,o,a){return new so(t,e,n,s,i,r,o,a)}(e,i,o,r,a,"F",c,u)}function Pa(t){return t?void 0!==t.unaryFilter?[Ha(t)]:void 0!==t.fieldFilter?[Ka(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Pa(t))).reduce(((t,e)=>t.concat(e))):Ei():[]}function Ua(t){return Ea[t]}function Ba(t){return ba[t]}function ja(t){return{fieldPath:t.canonicalString()}}function qa(t){return Ki.fromServerFormat(t.fieldPath)}function Ka(t){return Kr.create(qa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ei()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ha(t){switch(t.unaryFilter.op){case"IS_NAN":const e=qa(t.unaryFilter.field);return Kr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=qa(t.unaryFilter.field);return Kr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qa(t.unaryFilter.field);return Kr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=qa(t.unaryFilter.field);return Kr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ei()}}function $a(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ga(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class za{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const s=this.mutations[e];s.key.isEqual(t.key)&&Vo(s,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Fo(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Fo(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ia();return this.mutations.forEach((s=>{const i=t.get(s.key),r=i.overlayedDocument;let o=this.applyToLocalView(r,i.mutatedFields);o=e.has(s.key)?null:o;const a=Mo(r,o);null!==a&&n.set(s.key,a),r.isValidDocument()||r.convertToNoDocument(Ui.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),ca())}isEqual(t){return this.batchId===t.batchId&&Fi(this.mutations,t.mutations,((t,e)=>Uo(t,e)))&&Fi(this.baseMutations,t.baseMutations,((t,e)=>Uo(t,e)))}}class Qa{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){bi(t.mutations.length===n.length);let s=oa;const i=t.mutations;for(let t=0;t<i.length;t++)s=s.insert(i[t].key,n[t].version);return new Qa(t,e,n,s)}}class Wa{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Xa{constructor(t,e,n,s,i=Ui.min(),r=Ui.min(),o=cr.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o}withSequenceNumber(t){return new Xa(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class Ya{constructor(t){this.re=t}}function Ja(t){const e=Fa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?co(e,e.limit,"L"):e}class Za{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(lr(t.integerValue));else if("doubleValue"in t){const n=lr(t.doubleValue);isNaN(n)?this.le(e,13):(this.le(e,15),wr(n)?e.fe(0):e.fe(n))}else if("timestampValue"in t){const n=t.timestampValue;this.le(e,20),"string"==typeof n?e.de(n):(e.de(`${n.seconds||""}`),e.fe(n.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(dr(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.le(e,45),e.fe(n.latitude||0),e.fe(n.longitude||0)}else"mapValue"in t?Or(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):Ei()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const n=t.fields||{};this.le(e,55);for(const t of Object.keys(n))this._e(t,e),this.ae(n[t],e)}pe(t,e){const n=t.values||[];this.le(e,50);for(const t of n)this.ae(t,e)}ge(t,e){this.le(e,37),Hi.fromName(t).path.forEach((t=>{this.le(e,60),this.Ie(t,e)}))}le(t,e){t.fe(e)}we(t){t.fe(2)}}Za.Te=new Za;class tc{constructor(){this.Ye=new ec}addToCollectionParentIndex(t,e){return this.Ye.add(e),Xi.resolve()}getCollectionParents(t,e){return Xi.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Xi.resolve()}deleteFieldIndex(t,e){return Xi.resolve()}getDocumentsMatchingTarget(t,e){return Xi.resolve(null)}getIndexType(t,e){return Xi.resolve(0)}getFieldIndexes(t,e){return Xi.resolve([])}getNextCollectionGroupToUpdate(t){return Xi.resolve(null)}getMinOffset(t,e){return Xi.resolve(Gi.min())}getMinOffsetFromCollectionGroup(t,e){return Xi.resolve(Gi.min())}updateCollectionGroup(t,e,n){return Xi.resolve()}updateIndexEntries(t,e){return Xi.resolve()}}class ec{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new rr(ji.comparator),i=!s.has(n);return this.index[e]=s.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new rr(ji.comparator)).toArray()}}new Uint8Array(0);class nc{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new nc(t,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}nc.DEFAULT_COLLECTION_PERCENTILE=10,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nc.DEFAULT=new nc(41943040,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nc.DISABLED=new nc(-1,0,0);class sc{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new sc(0)}static vn(){return new sc(-1)}}class ic{constructor(){this.changes=new Yo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Fr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Xi.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class rc{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class oc{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.getBaseDocument(t,e,n)))).next((t=>(null!==n&&Fo(n.mutation,t,ar.empty(),Pi.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,ca()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=ca()){const s=sa();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((t=>{let e=ea();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=sa();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,ca())))}populateOverlays(t,e,n){const s=[];return n.forEach((t=>{e.has(t)||s.push(t)})),this.documentOverlayCache.getOverlays(t,s).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,s){let i=Zo();const r=ra(),o=ra();return e.forEach(((t,e)=>{const o=n.get(e.key);s.has(e.key)&&(void 0===o||o.mutation instanceof jo)?i=i.insert(e.key,e):void 0!==o&&(r.set(e.key,o.mutation.getFieldMask()),Fo(o.mutation,e,o.mutation.getFieldMask(),Pi.now()))})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new rc(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=ra();let s=new nr(((t,e)=>t-e)),i=ca();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||ar.empty();o=i.applyToLocalView(r,o),n.set(t,o);const a=(s.get(i.batchId)||ca()).add(t);s=s.insert(i.batchId,a)}))})).next((()=>{const r=[],o=s.getReverseIterator();for(;o.hasNext();){const s=o.getNext(),a=s.key,c=s.value,u=ia();c.forEach((t=>{if(!i.has(t)){const s=Mo(e.get(t),n.get(t));null!==s&&u.set(t,s),i=i.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,u))}return Xi.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((i=>{const r=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-i.size):Xi.resolve(sa());let o=-1,a=i;return r.next((e=>Xi.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?Xi.resolve():this.getBaseDocument(t,e,n).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,ca()))).next((t=>({batchId:o,changes:na(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Hi(e)).next((t=>{let e=ea();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const s=e.collectionGroup;let i=ea();return this.indexManager.getCollectionParents(t,s).next((r=>Xi.forEach(r,(r=>{const o=function(t,e){return new so(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(s));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{i=i.insert(t,e)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(t,e,n){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)))).next((t=>{t.forEach(((t,e)=>{const n=e.getKey();null===s.get(n)&&(s=s.insert(n,Fr.newInvalidDocument(n)))}));let n=ea();return s.forEach(((s,i)=>{const r=t.get(s);void 0!==r&&Fo(r.mutation,i,ar.empty(),Pi.now()),fo(e,i)&&(n=n.insert(s,i))})),n}))}getBaseDocument(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):Xi.resolve(Fr.newInvalidDocument(e))}}class ac{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Xi.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:Aa(n.createTime)}),Xi.resolve()}getNamedQuery(t,e){return Xi.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,function(t){return{name:t.name,query:Ja(t.bundledQuery),readTime:Aa(t.readTime)}}(e)),Xi.resolve()}}class cc{constructor(){this.overlays=new nr(Hi.comparator),this.es=new Map}getOverlay(t,e){return Xi.resolve(this.overlays.get(e))}getOverlays(t,e){const n=sa();return Xi.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,s)=>{this.ue(t,e,s)})),Xi.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.es.get(n);return void 0!==s&&(s.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),Xi.resolve()}getOverlaysForCollection(t,e,n){const s=sa(),i=e.length+1,r=new Hi(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===i&&t.largestBatchId>n&&s.set(t.getKey(),t)}return Xi.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let i=new nr(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=sa(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=sa(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=s)););return Xi.resolve(o)}ue(t,e,n){const s=this.overlays.get(n.key);if(null!==s){const t=this.es.get(s.largestBatchId).delete(n.key);this.es.set(s.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Wa(e,n));let i=this.es.get(e);void 0===i&&(i=ca(),this.es.set(e,i)),this.es.set(e,i.add(n.key))}}class uc{constructor(){this.ns=new rr(hc.ss),this.rs=new rr(hc.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new hc(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new hc(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new Hi(new ji([])),n=new hc(e,t),s=new hc(e,t+1),i=[];return this.rs.forEachInRange([n,s],(t=>{this.cs(t),i.push(t.key)})),i}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Hi(new ji([])),n=new hc(e,t),s=new hc(e,t+1);let i=ca();return this.rs.forEachInRange([n,s],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new hc(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class hc{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Hi.comparator(t.key,e.key)||Vi(t._s,e._s)}static os(t,e){return Vi(t._s,e._s)||Hi.comparator(t.key,e.key)}}class lc{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new rr(hc.ss)}checkEmpty(t){return Xi.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,s){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new za(i,e,n,s);this.mutationQueue.push(r);for(const e of s)this.gs=this.gs.add(new hc(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Xi.resolve(r)}lookupMutationBatch(t,e){return Xi.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.ps(n),i=s<0?0:s;return Xi.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Xi.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Xi.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new hc(e,0),s=new hc(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([n,s],(t=>{const e=this.ys(t._s);i.push(e)})),Xi.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new rr(Vi);return e.forEach((t=>{const e=new hc(t,0),s=new hc(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,s],(t=>{n=n.add(t._s)}))})),Xi.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let i=n;Hi.isDocumentKey(i)||(i=i.child(""));const r=new hc(new Hi(i),0);let o=new rr(Vi);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===s&&(o=o.add(t._s)),!0)}),r),Xi.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){bi(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Xi.forEach(e.mutations,(s=>{const i=new hc(s.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new hc(e,0),s=this.gs.firstAfterOrEqual(n);return Xi.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,Xi.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class dc{constructor(t){this.Es=t,this.docs=new nr(Hi.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),i=s?s.size:0,r=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Xi.resolve(n?n.document.mutableCopy():Fr.newInvalidDocument(e))}getEntries(t,e){let n=Zo();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Fr.newInvalidDocument(t))})),Xi.resolve(n)}getAllFromCollection(t,e,n){let s=Zo();const i=new Hi(e.child("")),r=this.docs.getIteratorFrom(i);for(;r.hasNext();){const{key:t,value:{document:i}}=r.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||zi($i(i),n)<=0||(s=s.insert(i.key,i.mutableCopy()))}return Xi.resolve(s)}getAllFromCollectionGroup(t,e,n,s){Ei()}As(t,e){return Xi.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new fc(this)}getSize(t){return Xi.resolve(this.size)}}class fc extends ic{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(n)})),Xi.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class pc{constructor(t){this.persistence=t,this.Rs=new Yo((t=>Br(t)),jr),this.lastRemoteSnapshotVersion=Ui.min(),this.highestTargetId=0,this.bs=0,this.Ps=new uc,this.targetCount=0,this.vs=sc.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),Xi.resolve()}getLastRemoteSnapshotVersion(t){return Xi.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Xi.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Xi.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),Xi.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new sc(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Xi.resolve()}updateTargetData(t,e){return this.Dn(e),Xi.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Xi.resolve()}removeTargets(t,e,n){let s=0;const i=[];return this.Rs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(r),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)})),Xi.waitFor(i).next((()=>s))}getTargetCount(t){return Xi.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return Xi.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),Xi.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach((e=>{i.push(s.markPotentiallyOrphaned(t,e))})),Xi.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Xi.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return Xi.resolve(n)}containsKey(t,e){return Xi.resolve(this.Ps.containsKey(e))}}class gc{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new Ji(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new pc(this),this.indexManager=new tc,this.remoteDocumentCache=function(t){return new dc(t)}((t=>this.referenceDelegate.xs(t))),this.It=new Ya(e),this.Ns=new ac(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new cc,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new lc(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){mi("MemoryPersistence","Starting transaction:",t);const s=new mc(this.Ss.next());return this.referenceDelegate.ks(),n(s).next((t=>this.referenceDelegate.Os(s).next((()=>t)))).toPromise().then((t=>(s.raiseOnCommittedEvent(),t)))}Ms(t,e){return Xi.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class mc extends Qi{constructor(t){super(),this.currentSequenceNumber=t}}class yc{constructor(t){this.persistence=t,this.Fs=new uc,this.$s=null}static Bs(t){return new yc(t)}get Ls(){if(this.$s)return this.$s;throw Ei()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),Xi.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),Xi.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Xi.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xi.forEach(this.Ls,(n=>{const s=Hi.fromPath(n);return this.Us(t,s).next((t=>{t||e.removeEntry(s,Ui.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.Us(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}Us(t,e){return Xi.or([()=>Xi.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class vc{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=s}static Ci(t,e){let n=ca(),s=ca();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:s=s.add(t.doc.key)}return new vc(t,e.fromCache,n,s)}}class wc{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,s){return this.ki(t,e).next((i=>i||this.Oi(t,e,s,n))).next((n=>n||this.Mi(t,e)))}ki(t,e){if(ro(e))return Xi.resolve(null);let n=ao(e);return this.indexManager.getIndexType(t,n).next((s=>0===s?null:(null!==e.limit&&1===s&&(e=co(e,null,"F"),n=ao(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((s=>{const i=ca(...s);return this.Ni.getDocuments(t,i).next((s=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.Fi(e,s);return this.$i(e,r,i,n.readTime)?this.ki(t,co(e,null,"F")):this.Bi(t,r,e,n)}))))})))))}Oi(t,e,n,s){return ro(e)||s.isEqual(Ui.min())?this.Mi(t,e):this.Ni.getDocuments(t,n).next((i=>{const r=this.Fi(e,i);return this.$i(e,r,n,s)?this.Mi(t,e):(gi()<=y.DEBUG&&mi("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lo(e)),this.Bi(t,r,e,function(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,i=Ui.fromTimestamp(1e9===s?new Pi(n+1,0):new Pi(n,s));return new Gi(i,Hi.empty(),e)}(s,-1)))}))}Fi(t,e){let n=new rr(po(t));return e.forEach(((e,s)=>{fo(t,s)&&(n=n.add(s))})),n}$i(t,e,n,s){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return gi()<=y.DEBUG&&mi("QueryEngine","Using full collection scan to execute query:",lo(e)),this.Ni.getDocumentsMatchingQuery(t,e,Gi.min())}Bi(t,e,n,s){return this.Ni.getDocumentsMatchingQuery(t,n,s).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Ec{constructor(t,e,n,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new nr(Vi),this.qi=new Yo((t=>Br(t)),jr),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new oc(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ui)))}}async function bc(t,e){const n=Ti(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.mutationQueue.getAllMutationBatches(t).next((i=>(s=i,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],r=[];let o=ca();for(const t of s){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:i,addedBatchIds:r})))}))}))}function Tc(t){const e=Ti(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}function Ic(t,e){const n=Ti(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Sc(t,e,n){const s=Ti(t),i=s.Ui.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,(t=>s.persistence.referenceDelegate.removeTarget(t,i)))}catch(t){if(!Yi(t))throw t;mi("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}s.Ui=s.Ui.remove(e),s.qi.delete(i.target)}function Cc(t,e,n){const s=Ti(t);let i=Ui.min(),r=ca();return s.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const s=Ti(t),i=s.qi.get(n);return void 0!==i?Xi.resolve(s.Ui.get(i)):s.Cs.getTargetData(e,n)}(s,t,ao(e)).next((e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,s.Cs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>s.Li.getDocumentsMatchingQuery(t,e,n?i:Ui.min(),n?r:ca()))).next((t=>(function(t,e,n){let s=t.Ki.get(e)||Ui.min();n.forEach(((t,e)=>{e.readTime.compareTo(s)>0&&(s=e.readTime)})),t.Ki.set(e,s)}(s,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,Hi:r})))))}class Ac{constructor(){this.activeTargetIds=ha()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class _c{constructor(){this.Lr=new Ac,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,n){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Ac,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Dc{qr(t){}shutdown(){}}class kc{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){mi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){mi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Nc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Lc{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Rc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,n,s,i){const r=this.ho(t,e);mi("RestConnection","Sending: ",r,n);const o={};return this.lo(o,s,i),this.fo(t,r,o,n).then((t=>(mi("RestConnection","Received: ",t),t)),(e=>{throw vi("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}_o(t,e,n,s,i,r){return this.ao(t,e,n,s,i)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+fi,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=Nc[t];return`${this.oo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,s){return new Promise(((i,r)=>{const o=new hi;o.setWithCredentials(!0),o.listenOnce(ri.COMPLETE,(()=>{var e;try{switch(o.getLastErrorCode()){case ii.NO_ERROR:const n=o.getResponseJson();mi("Connection","XHR received:",JSON.stringify(n)),i(n);break;case ii.TIMEOUT:mi("Connection",'RPC "'+t+'" timed out'),r(new Si(Ii.DEADLINE_EXCEEDED,"Request time out"));break;case ii.HTTP_ERROR:const s=o.getStatus();if(mi("Connection",'RPC "'+t+'" failed with status:',s,"response text:",o.getResponseText()),s>0){let t=o.getResponseJson();Array.isArray(t)&&(t=t[0]);const n=null===(e=t)||void 0===e?void 0:e.error;if(n&&n.status&&n.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ii).indexOf(e)>=0?e:Ii.UNKNOWN}(n.status);r(new Si(t,n.message))}else r(new Si(Ii.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Si(Ii.UNAVAILABLE,"Connection failed."));break;default:Ei()}}finally{mi("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(s);o.send(e,"POST",a,n,15)}))}wo(t,e,n){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=ni(),r=si(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new ci({})),this.lo(o.initMessageHeaders,e,n),o.encodeInitMessageHeaders=!0;const a=s.join("");mi("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let u=!1,h=!1;const l=new Lc({Hr:t=>{h?mi("Connection","Not sending because WebChannel is closed:",t):(u||(mi("Connection","Opening WebChannel transport."),c.open(),u=!0),mi("Connection","WebChannel sending:",t),c.send(t))},Jr:()=>c.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(c,ui.EventType.OPEN,(()=>{h||mi("Connection","WebChannel transport opened.")})),d(c,ui.EventType.CLOSE,(()=>{h||(h=!0,mi("Connection","WebChannel transport closed"),l.io())})),d(c,ui.EventType.ERROR,(t=>{h||(h=!0,vi("Connection","WebChannel transport errored:",t),l.io(new Si(Ii.UNAVAILABLE,"The operation could not be completed")))})),d(c,ui.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];bi(!!n);const s=n,i=s.error||(null===(e=s[0])||void 0===e?void 0:e.error);if(i){mi("Connection","WebChannel received error:",i);const t=i.status;let e=function(t){const e=Qo[t];if(void 0!==e)return Xo(e)}(t),n=i.message;void 0===e&&(e=Ii.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),h=!0,l.io(new Si(e,n)),c.close()}else mi("Connection","WebChannel received:",n),l.ro(n)}})),d(r,oi.STAT_EVENT,(t=>{t.stat===ai.PROXY?mi("Connection","Detected buffering proxy"):t.stat===ai.NOPROXY&&mi("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.so()}),0),l}}function xc(){return"undefined"!=typeof document?document:null}function Oc(t){return new Ta(t,!0)}class Mc{constructor(t,e,n=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=n,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-n);s>0&&mi("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Vc{constructor(t,e,n,s,i,r,o,a){this.Hs=t,this.vo=n,this.Vo=s,this.connection=i,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Mc(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Ii.RESOURCE_EXHAUSTED?(yi(e.toString()),yi("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):e&&e.code===Ii.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.So===e&&this.Go(t,n)}),(e=>{t((()=>{const t=new Si(Ii.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(t){return mi("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(mi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Fc extends Vc{constructor(t,e,n,s,i,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,r),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ei()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(t,e){return t.gt?(bi(void 0===e||"string"==typeof e),cr.fromBase64String(e||"")):(bi(void 0===e||e instanceof Uint8Array),cr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Ii.UNKNOWN:Xo(t.code);return new Si(e,t.message||"")}(o);n=new ga(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=Na(t,s.document.name),r=Aa(s.document.updateTime),o=new Mr({mapValue:{fields:s.document.fields}}),a=Fr.newFoundDocument(i,r,o),c=s.targetIds||[],u=s.removedTargetIds||[];n=new fa(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=Na(t,s.document),r=s.readTime?Aa(s.readTime):Ui.min(),o=Fr.newNoDocument(i,r),a=s.removedTargetIds||[];n=new fa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=Na(t,s.document),r=s.removedTargetIds||[];n=new fa([],r,i,null)}else{if(!("filter"in e))return Ei();{e.filter;const t=e.filter;t.targetId;const s=t.count||0,i=new zo(s),r=t.targetId;n=new pa(r,i)}}return n}(this.It,t),n=function(t){if(!("targetChange"in t))return Ui.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Ui.min():e.readTime?Aa(e.readTime):Ui.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=Ra(this.It),e.addTarget=function(t,e){let n;const s=e.target;return n=qr(s)?{documents:Ma(t,s)}:{query:Va(t,s)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Sa(t,e.resumeToken):e.snapshotVersion.compareTo(Ui.min())>0&&(n.readTime=Ia(t,e.snapshotVersion.toTimestamp())),n}(this.It,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ei()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=Ra(this.It),e.removeTarget=t,this.Bo(e)}}class Pc extends Vc{constructor(t,e,n,s,i,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,r),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(bi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(bi(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Aa(t.updateTime):Aa(e);return n.isEqual(Ui.min())&&(n=Aa(e)),new Lo(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Aa(t.commitTime);return this.listener.Zo(n,e)}return bi(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Ra(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Bo)n={update:Oa(t,e.key,e.value)};else if(e instanceof $o)n={delete:ka(t,e.key)};else if(e instanceof jo)n={update:Oa(t,e.key,e.data),updateMask:$a(e.fieldMask)};else{if(!(e instanceof Go))return Ei();n={verify:ka(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Io)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof So)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ao)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Do)return{fieldPath:e.field.canonicalString(),increment:n.yt};throw Ei()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ca(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ei()}(t,e.precondition)),n}(this.It,t)))};this.Bo(e)}}class Uc extends class{}{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.It=s,this.nu=!1}su(){if(this.nu)throw new Si(Ii.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.ao(t,e,n,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ii.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Si(Ii.UNKNOWN,t.toString())}))}_o(t,e,n,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection._o(t,e,n,i,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ii.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Si(Ii.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class Bc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(yi(e),this.ou=!1):mi("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class jc{constructor(t,e,n,s,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr((t=>{n.enqueueAndForget((async()=>{Xc(this)&&(mi("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Ti(t);e._u.add(4),await Kc(e),e.gu.set("Unknown"),e._u.delete(4),await qc(e)}(this))}))})),this.gu=new Bc(n,s)}}async function qc(t){if(Xc(t))for(const e of t.wu)await e(!0)}async function Kc(t){for(const e of t.wu)await e(!1)}function Hc(t,e){const n=Ti(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Wc(n)?Qc(n):fu(n).ko()&&Gc(n,e))}function $c(t,e){const n=Ti(t),s=fu(n);n.du.delete(e),s.ko()&&zc(n,e),0===n.du.size&&(s.ko()?s.Fo():Xc(n)&&n.gu.set("Unknown"))}function Gc(t,e){t.yu.Mt(e.targetId),fu(t).zo(e)}function zc(t,e){t.yu.Mt(e),fu(t).Ho(e)}function Qc(t){t.yu=new ya({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t.du.get(e)||null}),fu(t).start(),t.gu.uu()}function Wc(t){return Xc(t)&&!fu(t).No()&&t.du.size>0}function Xc(t){return 0===Ti(t)._u.size}function Yc(t){t.yu=void 0}async function Jc(t){t.du.forEach(((e,n)=>{Gc(t,e)}))}async function Zc(t,e){Yc(t),Wc(t)?(t.gu.hu(e),Qc(t)):t.gu.set("Unknown")}async function tu(t,e,n){if(t.gu.set("Online"),e instanceof ga&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const s of e.targetIds)t.du.has(s)&&(await t.remoteSyncer.rejectListen(s,n),t.du.delete(s),t.yu.removeTarget(s))}(t,e)}catch(n){mi("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await eu(t,n)}else if(e instanceof fa?t.yu.Gt(e):e instanceof pa?t.yu.Yt(e):t.yu.Wt(e),!n.isEqual(Ui.min()))try{const e=await Tc(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.yu.te(e);return n.targetChanges.forEach(((n,s)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.du.get(s);i&&t.du.set(s,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(cr.EMPTY_BYTE_STRING,n.snapshotVersion)),zc(t,e);const s=new Xa(n.target,e,1,n.sequenceNumber);Gc(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){mi("RemoteStore","Failed to raise snapshot:",e),await eu(t,e)}}async function eu(t,e,n){if(!Yi(e))throw e;t._u.add(1),await Kc(t),t.gu.set("Offline"),n||(n=()=>Tc(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{mi("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await qc(t)}))}function nu(t,e){return e().catch((n=>eu(t,n,e)))}async function su(t){const e=Ti(t),n=pu(e);let s=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;iu(e);)try{const t=await Ic(e.localStore,s);if(null===t){0===e.fu.length&&n.Fo();break}s=t.batchId,ru(e,t)}catch(t){await eu(e,t)}ou(e)&&au(e)}function iu(t){return Xc(t)&&t.fu.length<10}function ru(t,e){t.fu.push(e);const n=pu(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function ou(t){return Xc(t)&&!pu(t).No()&&t.fu.length>0}function au(t){pu(t).start()}async function cu(t){pu(t).eu()}async function uu(t){const e=pu(t);for(const n of t.fu)e.Xo(n.mutations)}async function hu(t,e,n){const s=t.fu.shift(),i=Qa.from(s,e,n);await nu(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await su(t)}async function lu(t,e){e&&pu(t).Yo&&await async function(t,e){if(function(t){switch(t){default:return Ei();case Ii.CANCELLED:case Ii.UNKNOWN:case Ii.DEADLINE_EXCEEDED:case Ii.RESOURCE_EXHAUSTED:case Ii.INTERNAL:case Ii.UNAVAILABLE:case Ii.UNAUTHENTICATED:return!1;case Ii.INVALID_ARGUMENT:case Ii.NOT_FOUND:case Ii.ALREADY_EXISTS:case Ii.PERMISSION_DENIED:case Ii.FAILED_PRECONDITION:case Ii.ABORTED:case Ii.OUT_OF_RANGE:case Ii.UNIMPLEMENTED:case Ii.DATA_LOSS:return!0}}(n=e.code)&&n!==Ii.ABORTED){const n=t.fu.shift();pu(t).Mo(),await nu(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await su(t)}var n}(t,e),ou(t)&&au(t)}async function du(t,e){const n=Ti(t);n.asyncQueue.verifyOperationInProgress(),mi("RemoteStore","RemoteStore received new credentials");const s=Xc(n);n._u.add(3),await Kc(n),s&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await qc(n)}function fu(t){return t.pu||(t.pu=function(t,e,n){const s=Ti(t);return s.su(),new Fc(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,n)}(t.datastore,t.asyncQueue,{Yr:Jc.bind(null,t),Zr:Zc.bind(null,t),Wo:tu.bind(null,t)}),t.wu.push((async e=>{e?(t.pu.Mo(),Wc(t)?Qc(t):t.gu.set("Unknown")):(await t.pu.stop(),Yc(t))}))),t.pu}function pu(t){return t.Iu||(t.Iu=function(t,e,n){const s=Ti(t);return s.su(),new Pc(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,n)}(t.datastore,t.asyncQueue,{Yr:cu.bind(null,t),Zr:lu.bind(null,t),tu:uu.bind(null,t),Zo:hu.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Mo(),await su(t)):(await t.Iu.stop(),t.fu.length>0&&(mi("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))}))),t.Iu}class gu{constructor(t,e,n,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,s,i){const r=Date.now()+n,o=new gu(t,e,r,s,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Si(Ii.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mu(t,e){if(yi("AsyncQueue",`${e}: ${t}`),Yi(t))return new Si(Ii.UNAVAILABLE,`${e}: ${t}`);throw t}class yu{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Hi.comparator(e.key,n.key):(t,e)=>Hi.comparator(t.key,e.key),this.keyedMap=ea(),this.sortedSet=new nr(this.comparator)}static emptySet(t){return new yu(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof yu))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,s=n.getNext().key;if(!t.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new yu;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class vu{constructor(){this.Tu=new nr(Hi.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):Ei():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class wu{constructor(t,e,n,s,i,r,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,s,i){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new wu(t,e,yu.emptySet(e),r,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&uo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Eu{constructor(){this.Au=void 0,this.listeners=[]}}class bu{constructor(){this.queries=new Yo((t=>ho(t)),uo),this.onlineState="Unknown",this.Ru=new Set}}function Tu(t,e){const n=Ti(t);let s=!1;for(const t of e){const e=t.query,i=n.queries.get(e);if(i){for(const e of i.listeners)e.Pu(t)&&(s=!0);i.Au=t}}s&&Su(n)}function Iu(t,e,n){const s=Ti(t),i=s.queries.get(e);if(i)for(const t of i.listeners)t.onError(n);s.queries.delete(e)}function Su(t){t.Ru.forEach((t=>{t.next()}))}class Cu{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new wu(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Nu||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){if(t.docChanges.length>0)return!0;const e=this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}xu(t){t=wu.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class Au{constructor(t){this.key=t}}class _u{constructor(t){this.key=t}}class Du{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=ca(),this.mutatedKeys=ca(),this.Gu=po(t),this.Qu=new yu(this.Gu)}get ju(){return this.Uu}Wu(t,e){const n=e?e.zu:new vu,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,r=s,o=!1;const a="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,c="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((t,e)=>{const u=s.get(t),h=fo(this.query,e)?e:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Hu(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Gu(h,a)>0||c&&this.Gu(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(r=r.add(h),i=d?i.add(t):i.delete(t)):(r=r.delete(t),i=i.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{Qu:r,zu:n,$i:o,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ei()}};return n(t)-n(e)}(t.type,e.type)||this.Gu(t.doc,e.doc))),this.Ju(n);const r=e?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.qu;return this.qu=o,0!==i.length||a?{snapshot:new wu(this.query,t.Qu,s,i,t.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:r}:{Xu:r}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new vu,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach((t=>this.Uu=this.Uu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Uu=this.Uu.delete(t))),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=ca(),this.Qu.forEach((t=>{this.Zu(t.key)&&(this.Ku=this.Ku.add(t.key))}));const e=[];return t.forEach((t=>{this.Ku.has(t)||e.push(new _u(t))})),this.Ku.forEach((n=>{t.has(n)||e.push(new Au(n))})),e}tc(t){this.Uu=t.Hi,this.Ku=ca();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return wu.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class ku{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Nu{constructor(t){this.key=t,this.nc=!1}}class Lu{constructor(t,e,n,s,i,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=r,this.sc={},this.ic=new Yo((t=>ho(t)),uo),this.rc=new Map,this.oc=new Set,this.uc=new nr(Hi.comparator),this.cc=new Map,this.ac=new uc,this.hc={},this.lc=new Map,this.fc=sc.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function Ru(t,e){const n=function(t){const e=Ti(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ou.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qu.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vu.bind(null,e),e.sc.Wo=Tu.bind(null,e.eventManager),e.sc.wc=Iu.bind(null,e.eventManager),e}(t);let s,i;const r=n.ic.get(e);if(r)s=r.targetId,n.sharedClientState.addLocalQueryTarget(s),i=r.view.ec();else{const t=await function(t,e){const n=Ti(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let s;return n.Cs.getTargetData(t,e).next((i=>i?(s=i,Xi.resolve(s)):n.Cs.allocateTargetId(t).next((i=>(s=new Xa(e,i,0,t.currentSequenceNumber),n.Cs.addTargetData(t,s).next((()=>s)))))))})).then((t=>{const s=n.Ui.get(t.targetId);return(null===s||t.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(t.targetId,t),n.qi.set(e,t.targetId)),t}))}(n.localStore,ao(e));n.isPrimaryClient&&Hc(n.remoteStore,t);const r=n.sharedClientState.addLocalQueryTarget(t.targetId);s=t.targetId,i=await async function(t,e,n,s,i){t._c=(e,n,s)=>async function(t,e,n,s){let i=e.view.Wu(n);i.$i&&(i=await Cc(t.localStore,e.query,!1).then((({documents:t})=>e.view.Wu(t,i))));const r=s&&s.targetChanges.get(e.targetId),o=e.view.applyChanges(i,t.isPrimaryClient,r);return Ku(t,e.targetId,o.Xu),o.snapshot}(t,e,n,s);const r=await Cc(t.localStore,e,!0),o=new Du(e,r.Hi),a=o.Wu(r.documents),c=da.createSynthesizedTargetChangeForCurrentChange(n,s&&"Offline"!==t.onlineState,i),u=o.applyChanges(a,t.isPrimaryClient,c);Ku(t,n,u.Xu);const h=new ku(e,n,o);return t.ic.set(e,h),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),u.snapshot}(n,e,s,"current"===r,t.resumeToken)}return i}async function xu(t,e){const n=Ti(t),s=n.ic.get(e),i=n.rc.get(s.targetId);if(i.length>1)return n.rc.set(s.targetId,i.filter((t=>!uo(t,e)))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Sc(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),$c(n.remoteStore,s.targetId),ju(n,s.targetId)})).catch(Wi)):(ju(n,s.targetId),await Sc(n.localStore,s.targetId,!0))}async function Ou(t,e){const n=Ti(t);try{const t=await function(t,e){const n=Ti(t),s=e.snapshotVersion;let i=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.Ui;const o=[];e.targetChanges.forEach(((r,a)=>{const c=i.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(t,r.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(t,r.addedDocuments,a))));let u=c.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?u=u.withResumeToken(cr.EMPTY_BYTE_STRING,Ui.min()).withLastLimboFreeSnapshotVersion(Ui.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,s)),i=i.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,r)&&o.push(n.Cs.updateTargetData(t,u))}));let a=Zo(),c=ca();if(e.documentUpdates.forEach((s=>{e.resolvedLimboDocuments.has(s)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,s))})),o.push(function(t,e,n){let s=ca(),i=ca();return n.forEach((t=>s=s.add(t))),e.getEntries(t,s).next((t=>{let s=Zo();return n.forEach(((n,r)=>{const o=t.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),r.isNoDocument()&&r.version.isEqual(Ui.min())?(e.removeEntry(n,r.readTime),s=s.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(r),s=s.insert(n,r)):mi("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{Wi:s,zi:i}}))}(t,r,e.documentUpdates).next((t=>{a=t.Wi,c=t.zi}))),!s.isEqual(Ui.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next((e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,s)));o.push(e)}return Xi.waitFor(o).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.Ui=i,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const s=n.cc.get(e);s&&(bi(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?s.nc=!0:t.modifiedDocuments.size>0?bi(s.nc):t.removedDocuments.size>0&&(bi(s.nc),s.nc=!1))})),await Gu(n,t,e)}catch(t){await Wi(t)}}function Mu(t,e,n){const s=Ti(t);if(s.isPrimaryClient&&0===n||!s.isPrimaryClient&&1===n){const t=[];s.ic.forEach(((n,s)=>{const i=s.view.bu(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=Ti(t);n.onlineState=e;let s=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.bu(e)&&(s=!0)})),s&&Su(n)}(s.eventManager,e),t.length&&s.sc.Wo(t),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Vu(t,e,n){const s=Ti(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.cc.get(e),r=i&&i.key;if(r){let t=new nr(Hi.comparator);t=t.insert(r,Fr.newNoDocument(r,Ui.min()));const n=ca().add(r),i=new la(Ui.min(),new Map,new rr(Vi),t,n);await Ou(s,i),s.uc=s.uc.remove(r),s.cc.delete(e),$u(s)}else await Sc(s.localStore,e,!1).then((()=>ju(s,e,n))).catch(Wi)}async function Fu(t,e){const n=Ti(t),s=e.batch.batchId;try{const t=await function(t,e){const n=Ti(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const s=e.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,s){const i=n.batch,r=i.keys();let o=Xi.resolve();return r.forEach((t=>{o=o.next((()=>s.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);bi(null!==r),e.version.compareTo(r)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),s.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=ca();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(n.localStore,e);Bu(n,s,null),Uu(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Gu(n,t)}catch(t){await Wi(t)}}async function Pu(t,e,n){const s=Ti(t);try{const t=await function(t,e){const n=Ti(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let s;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(bi(null!==e),s=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,s,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,s))).next((()=>n.localDocuments.getDocuments(t,s)))}))}(s.localStore,e);Bu(s,e,n),Uu(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Gu(s,t)}catch(n){await Wi(n)}}function Uu(t,e){(t.lc.get(e)||[]).forEach((t=>{t.resolve()})),t.lc.delete(e)}function Bu(t,e,n){const s=Ti(t);let i=s.hc[s.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),s.hc[s.currentUser.toKey()]=i}}function ju(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.rc.get(e))t.ic.delete(s),n&&t.sc.wc(s,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach((e=>{t.ac.containsKey(e)||qu(t,e)}))}function qu(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);null!==n&&($c(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),$u(t))}function Ku(t,e,n){for(const s of n)s instanceof Au?(t.ac.addReference(s.key,e),Hu(t,s)):s instanceof _u?(mi("SyncEngine","Document no longer in limbo: "+s.key),t.ac.removeReference(s.key,e),t.ac.containsKey(s.key)||qu(t,s.key)):Ei()}function Hu(t,e){const n=e.key,s=n.path.canonicalString();t.uc.get(n)||t.oc.has(s)||(mi("SyncEngine","New document in limbo: "+n),t.oc.add(s),$u(t))}function $u(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new Hi(ji.fromString(e)),s=t.fc.next();t.cc.set(s,new Nu(n)),t.uc=t.uc.insert(n,s),Hc(t.remoteStore,new Xa(ao(io(n.path)),s,2,Ji.at))}}async function Gu(t,e,n){const s=Ti(t),i=[],r=[],o=[];s.ic.isEmpty()||(s.ic.forEach(((t,a)=>{o.push(s._c(a,e,n).then((t=>{if((t||n)&&s.isPrimaryClient&&s.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=vc.Ci(a.targetId,t);r.push(e)}})))})),await Promise.all(o),s.sc.Wo(i),await async function(t,e){const n=Ti(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Xi.forEach(e,(e=>Xi.forEach(e.Si,(s=>n.persistence.referenceDelegate.addReference(t,e.targetId,s))).next((()=>Xi.forEach(e.Di,(s=>n.persistence.referenceDelegate.removeReference(t,e.targetId,s)))))))))}catch(t){if(!Yi(t))throw t;mi("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Ui.get(e),s=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(s);n.Ui=n.Ui.insert(e,i)}}}(s.localStore,r))}async function zu(t,e){const n=Ti(t);if(!n.currentUser.isEqual(e)){mi("SyncEngine","User change. New user:",e.toKey());const t=await bc(n.localStore,e);n.currentUser=e,function(t,e){t.lc.forEach((t=>{t.forEach((t=>{t.reject(new Si(Ii.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.lc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Gu(n,t.ji)}}function Qu(t,e){const n=Ti(t),s=n.cc.get(e);if(s&&s.nc)return ca().add(s.key);{let t=ca();const s=n.rc.get(e);if(!s)return t;for(const e of s){const s=n.ic.get(e);t=t.unionWith(s.view.ju)}return t}}function Wu(t){const e=Ti(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Fu.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pu.bind(null,e),e}class Xu{constructor(){this.synchronizeTabs=!1}async initialize(t){this.It=Oc(t.databaseInfo.databaseId),this.sharedClientState=this.gc(t),this.persistence=this.yc(t),await this.persistence.start(),this.localStore=this.Ic(t),this.gcScheduler=this.Tc(t,this.localStore),this.indexBackfillerScheduler=this.Ec(t,this.localStore)}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function(t,e,n,s){return new Ec(t,e,n,s)}(this.persistence,new wc,t.initialUser,this.It)}yc(t){return new gc(yc.Bs,this.It)}gc(t){return new _c}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Yu{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Mu(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=zu.bind(null,this.syncEngine),await async function(t,e){const n=Ti(t);e?(n._u.delete(2),await qc(n)):e||(n._u.add(2),await Kc(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new bu}createDatastore(t){const e=Oc(t.databaseInfo.databaseId),n=(s=t.databaseInfo,new Rc(s));var s;return function(t,e,n,s){return new Uc(t,e,n,s)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,s=t.asyncQueue,i=t=>Mu(this.syncEngine,t,0),r=kc.C()?new kc:new Dc,new jc(e,n,s,i,r);var e,n,s,i,r}createSyncEngine(t,e){return function(t,e,n,s,i,r,o){const a=new Lu(t,e,n,s,i,r);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Ti(t);mi("RemoteStore","RemoteStore shutting down."),e._u.add(5),await Kc(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}function Ju(t,e,n){if(!n)throw new Si(Ii.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Zu(t){if(!Hi.isDocumentKey(t))throw new Si(Ii.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function th(t){if(Hi.isDocumentKey(t))throw new Si(Ii.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function eh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ei()}function nh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Si(Ii.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=eh(t);throw new Si(Ii.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}const sh=new Map;class ih{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Si(Ii.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Si(Ii.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,s){if(!0===e&&!0===s)throw new Si(Ii.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class rh{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ih({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Si(Ii.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Si(Ii.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ih(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new _i;switch(t.type){case"gapi":const e=t.client;return new Li(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Si(Ii.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=sh.get(t);e&&(mi("ComponentProvider","Removing Datastore"),sh.delete(t),e.terminate())}(this),Promise.resolve()}}class oh{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ch(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new oh(this.firestore,t,this._key)}}class ah{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ah(this.firestore,t,this._query)}}class ch extends ah{constructor(t,e,n){super(t,e,io(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new oh(this.firestore,null,new Hi(t))}withConverter(t){return new ch(this.firestore,t,this._path)}}function uh(t,e,...n){if(t=l(t),Ju("collection","path",e),t instanceof rh){const s=ji.fromString(e,...n);return th(s),new ch(t,null,s)}{if(!(t instanceof oh||t instanceof ch))throw new Si(Ii.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ji.fromString(e,...n));return th(s),new ch(t.firestore,null,s)}}function hh(t,e,...n){if(t=l(t),1===arguments.length&&(e=Mi.R()),Ju("doc","path",e),t instanceof rh){const s=ji.fromString(e,...n);return Zu(s),new oh(t,null,new Hi(s))}{if(!(t instanceof oh||t instanceof ch))throw new Si(Ii.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ji.fromString(e,...n));return Zu(s),new oh(t.firestore,t instanceof ch?t.converter:null,new Hi(s))}}class lh{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):yi("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class dh{constructor(t,e,n,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=di.UNAUTHENTICATED,this.clientId=Mi.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{mi("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(mi("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Si(Ii.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=mu(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function fh(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(mi("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),mi("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async t=>{s.isEqual(t)||(await bc(e.localStore,t),s=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Xu)),t.offlineComponents}(t);mi("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener((t=>du(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>du(e.remoteStore,n))),t.onlineComponents=e}async function ph(t){return t.onlineComponents||(mi("FirestoreClient","Using default OnlineComponentProvider"),await fh(t,new Yu)),t.onlineComponents}async function gh(t){const e=await ph(t),n=e.eventManager;return n.onListen=Ru.bind(null,e.syncEngine),n.onUnlisten=xu.bind(null,e.syncEngine),n}function mh(t,e,n={}){const s=new Ci;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,s,i){const r=new lh({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=Ti(t),s=e.query;let i=!1;const r=n.queries.get(s);if(r){const t=r.listeners.indexOf(e);t>=0&&(r.listeners.splice(t,1),i=0===r.listeners.length)}if(i)return n.queries.delete(s),n.onUnlisten(s)}(t,o))),n.fromCache&&"server"===s.source?i.reject(new Si(Ii.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:t=>i.reject(t)}),o=new Cu(n,r,{includeMetadataChanges:!0,Nu:!0});return async function(t,e){const n=Ti(t),s=e.query;let i=!1,r=n.queries.get(s);if(r||(i=!0,r=new Eu),i)try{r.Au=await n.onListen(s)}catch(t){const n=mu(t,`Initialization of query '${lo(e.query)}' failed`);return void e.onError(n)}n.queries.set(s,r),r.listeners.push(e),e.bu(n.onlineState),r.Au&&e.Pu(r.Au)&&Su(n)}(t,o)}(await gh(t),t.asyncQueue,e,n,s))),s.promise}class yh{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Mc(this,"async_queue_retry"),this.Wc=()=>{const t=xc();t&&mi("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const t=xc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=xc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise((()=>{}));const e=new Ci;return this.Hc((()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Lc.push(t),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(t){if(!Yi(t))throw t;mi("AsyncQueue","Operation failed with retryable error: "+t)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(t){const e=this.Bc.then((()=>(this.Gc=!0,t().catch((t=>{this.Kc=t,this.Gc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw yi("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Gc=!1,t))))));return this.Bc=e,e}enqueueAfterDelay(t,e,n){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=gu.createAndSchedule(this,t,e,n,(t=>this.Yc(t)));return this.qc.push(s),s}zc(){this.Kc&&Ei()}verifyOperationInProgress(){}async Xc(){let t;do{t=this.Bc,await t}while(t!==this.Bc)}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then((()=>{this.qc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()}))}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}class vh extends rh{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new yh,this._persistenceKey=(null==s?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||bh(this),this._firestoreClient.terminate()}}function wh(t,e){const n="string"==typeof t?t:e||"(default)",r=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}("object"==typeof t?t:function(t="[DEFAULT]"){const e=G.get(t);if(!e&&t===H)return J();if(!e)throw X.create("no-app",{appName:t});return e}(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=i())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),s]:[e.substring(0,n),s]})("firestore");t&&function(t,e,n,i={}){var r;const o=(t=nh(t,rh))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&vi("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=di.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Si(Ii.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new di(o)}t._authCredentials=new Di(new Ai(e,n))}}(r,...t)}return r}function Eh(t){return t._firestoreClient||bh(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function bh(t){var e;const n=t._freezeSettings(),s=function(t,e,n,s){return new mr(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,s.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new dh(t._authCredentials,t._appCheckCredentials,t._queue,s)}class Th{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Th(cr.fromBase64String(t))}catch(t){throw new Si(Ii.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Th(cr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Ih{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Si(Ii.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ki(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Sh{constructor(t){this._methodName=t}}class Ch{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Si(Ii.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Si(Ii.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Vi(this._lat,t._lat)||Vi(this._long,t._long)}}const Ah=/^__.*__$/;class _h{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new jo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Bo(t,this.data,e,this.fieldTransforms)}}class Dh{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new jo(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function kh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ei()}}class Nh{constructor(t,e,n,s,i,r){this.settings=t,this.databaseId=e,this.It=n,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=r||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new Nh(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:n,oa:!1});return s.ua(t),s}ca(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:n,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return qh(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(kh(this.sa)&&Ah.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class Lh{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=n||Oc(t)}da(t,e,n,s=!1){return new Nh({sa:t,methodName:e,fa:n,path:Ki.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Rh(t){const e=t._freezeSettings(),n=Oc(t._databaseId);return new Lh(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xh(t,e,n,s,i,r={}){const o=t.da(r.merge||r.mergeFields?2:0,e,n,i);Ph("Data must be an object, but it was:",o,s);const a=Vh(s,o);let c,u;if(r.merge)c=new ar(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const s of r.mergeFields){const i=Uh(e,s,n);if(!o.contains(i))throw new Si(Ii.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Kh(t,i)||t.push(i)}c=new ar(t),u=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,u=o.fieldTransforms;return new _h(new Mr(a),c,u)}class Oh extends Sh{_toFieldTransform(t){if(2!==t.sa)throw 1===t.sa?t.ha(`${this._methodName}() can only appear at the top level of your update data`):t.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Oh}}function Mh(t,e){if(Fh(t=l(t)))return Ph("Unsupported field value:",e,t),Vh(t,e);if(t instanceof Sh)return function(t,e){if(!kh(e.sa))throw e.ha(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ha(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const i of t){let t=Mh(i,e.aa(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=l(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return vo(e.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Pi.fromDate(t);return{timestampValue:Ia(e.It,n)}}if(t instanceof Pi){const n=new Pi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ia(e.It,n)}}if(t instanceof Ch)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Th)return{bytesValue:Sa(e.It,t._byteString)};if(t instanceof oh){const n=e.databaseId,s=t.firestore._databaseId;if(!s.isEqual(n))throw e.ha(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:_a(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ha(`Unsupported field value: ${eh(t)}`)}(t,e)}function Vh(t,e){const n={};return er(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):tr(t,((t,s)=>{const i=Mh(s,e.ra(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Fh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pi||t instanceof Ch||t instanceof Th||t instanceof oh||t instanceof Sh)}function Ph(t,e,n){if(!Fh(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const s=eh(n);throw"an object"===s?e.ha(t+" a custom object"):e.ha(t+" "+s)}}function Uh(t,e,n){if((e=l(e))instanceof Ih)return e._internalPath;if("string"==typeof e)return jh(t,e);throw qh("Field path arguments must be of type string or ",t,!1,void 0,n)}const Bh=new RegExp("[~\\*/\\[\\]]");function jh(t,e,n){if(e.search(Bh)>=0)throw qh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ih(...e.split("."))._internalPath}catch(s){throw qh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function qh(t,e,n,s,i){const r=s&&!s.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new Si(Ii.INVALID_ARGUMENT,a+t+c)}function Kh(t,e){return t.some((t=>t.isEqual(e)))}class Hh{constructor(t,e,n,s,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new oh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new $h(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Gh("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class $h extends Hh{data(){return super.data()}}function Gh(t,e){return"string"==typeof e?jh(t,e):e instanceof Ih?e._internalPath:e._delegate._internalPath}class zh{convertValue(t,e="none"){switch(br(t)){case 0:return null;case 1:return t.booleanValue;case 2:return lr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(dr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ei()}}convertObject(t,e){const n={};return tr(t.fields,((t,s)=>{n[t]=this.convertValue(s,e)})),n}convertGeoPoint(t){return new Ch(lr(t.latitude),lr(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=pr(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(gr(t));default:return null}}convertTimestamp(t){const e=hr(t);return new Pi(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=ji.fromString(t);bi(Ga(n));const s=new yr(n.get(1),n.get(3)),i=new Hi(n.popFirst(5));return s.isEqual(e)||yi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}class Qh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Wh extends Hh{constructor(t,e,n,s,i,r){super(t,e,n,s,r),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Xh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Gh("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Xh extends Wh{data(t={}){return super.data(t)}}class Yh{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new Qh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Xh(this._firestore,this._userDataWriter,n.key,n,new Qh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Si(Ii.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const s=new Xh(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Qh(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:s,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const s=new Xh(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Qh(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,r=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:Jh(e.type),doc:s,oldIndex:i,newIndex:r}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Jh(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ei()}}class Zh extends zh{constructor(t){super(),this.firestore=t}convertBytes(t){return new Th(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new oh(this.firestore,null,e)}}function tl(t,e,n,...s){t=nh(t,oh);const i=nh(t.firestore,vh),r=Rh(i);let o;return o="string"==typeof(e=l(e))||e instanceof Ih?function(t,e,n,s,i,r){const o=t.da(1,e,n),a=[Uh(e,s,n)],c=[i];if(r.length%2!=0)throw new Si(Ii.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<r.length;t+=2)a.push(Uh(e,r[t])),c.push(r[t+1]);const u=[],h=Mr.empty();for(let t=a.length-1;t>=0;--t)if(!Kh(u,a[t])){const e=a[t];let n=c[t];n=l(n);const s=o.ca(e);if(n instanceof Oh)u.push(e);else{const t=Mh(n,s);null!=t&&(u.push(e),h.set(e,t))}}const d=new ar(u);return new Dh(h,d,o.fieldTransforms)}(r,"updateDoc",t._key,e,n,s):function(t,e,n,s){const i=t.da(1,e,n);Ph("Data must be an object, but it was:",i,s);const r=[],o=Mr.empty();tr(s,((t,s)=>{const a=jh(e,t,n);s=l(s);const c=i.ca(a);if(s instanceof Oh)r.push(a);else{const t=Mh(s,c);null!=t&&(r.push(a),o.set(a,t))}}));const a=new ar(r);return new Dh(o,a,i.fieldTransforms)}(r,"updateDoc",t._key,e),el(i,[o.toMutation(t._key,Ro.exists(!0))])}function el(t,e){return function(t,e){const n=new Ci;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const s=Wu(t);try{const t=await function(t,e){const n=Ti(t),s=Pi.now(),i=e.reduce(((t,e)=>t.add(e.key)),ca());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Zo(),c=ca();return n.Gi.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{r=i;const o=[];for(const t of e){const e=Po(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new jo(t.key,e,Vr(e.value.mapValue),Ro.exists(!0)))}return n.mutationQueue.addMutationBatch(t,s,o,e)})).next((e=>{o=e;const s=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,s)}))})).then((()=>({batchId:o.batchId,changes:na(r)})))}(s.localStore,e);s.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let s=t.hc[t.currentUser.toKey()];s||(s=new nr(Vi)),s=s.insert(e,n),t.hc[t.currentUser.toKey()]=s}(s,t.batchId,n),await Gu(s,t.changes),await su(s.remoteStore)}catch(t){const e=mu(t,"Failed to persist write");n.reject(e)}}(await function(t){return ph(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(Eh(t),e)}!function(t,e=!0){fi="9.14.0",W(new d("firestore",((t,{instanceIdentifier:n,options:s})=>{const i=t.getProvider("app").getImmediate(),r=new vh(new ki(t.getProvider("auth-internal")),new xi(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Si(Ii.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yr(t.options.projectId,e)}(i,n),i);return s=Object.assign({useFetchStreams:e},s),r._setSettings(s),r}),"PUBLIC").setMultipleInstances(!0)),Z(li,"3.7.3",t),Z(li,"3.7.3","esm2017")}(),J({apiKey:"AIzaSyDGxGCxfJN1YNj74DpHoBaqk1lBncXA-tU",authDomain:"library-fbfa2.firebaseapp.com",projectId:"library-fbfa2",storageBucket:"library-fbfa2.appspot.com",messagingSenderId:"120582080353",appId:"1:120582080353:web:0e2f68673ccfb78a9de720"});const nl=wh();let sl=document.querySelector("#book"),il=document.querySelector("#author"),rl=document.querySelector("#pages"),ol=document.querySelector("#read"),al=document.querySelector(".submit"),cl=document.querySelector(".shelfMain");document.addEventListener("click",(t=>async function(t){let e=t.target;if(e.classList.contains("deleteBtn")){const t=hh(nl,"books",e.parentNode.id);await function(t){return el(nh(t.firestore,vh),[new $o(t._key,Ro.none())])}(t),cl.innerHTML="",hl()}}(t))),al.addEventListener("click",(()=>{""==sl.value||""==il.value||""==rl.value?alert("one of the values is empty"):(async function(t,e,n,s){try{await function(t,e){const n=nh(t.firestore,vh),s=hh(t),i=function(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}(t.converter,e);return el(n,[xh(Rh(t.firestore),"addDoc",s._key,i,null!==t.converter,{}).toMutation(s._key,Ro.exists(!1))]).then((()=>s))}(uh(wh(),"books"),{title:t,author:e,pages:n,read:s})}catch(t){console.error("mf uh: ",t)}}(sl.value,il.value,rl.value,ol.value),cl.innerHTML="",hl())}));let ul=[];async function hl(){ul.splice(0,ul.length);const t=uh(nl,"books"),e=await function(t){t=nh(t,ah);const e=nh(t.firestore,vh),n=Eh(e),s=new Zh(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Si(Ii.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),mh(n,t._query).then((n=>new Yh(e,s,t,n)))}(t);e.forEach((t=>{ul.push({id:t.id,...t.data()})})),function(){for(let t of ul){let e=document.createElement("p"),n=document.createElement("p"),s=document.createElement("p"),i=document.createElement("button"),r=document.createElement("button");i.classList.add("readBtn"),r.classList.add("deleteBtn"),r.textContent+="DELETE";for(let r in t)"title"==r?e.textContent+=t[r]:"author"==r?n.textContent+=t[r]:"pages"==r?s.textContent+=t[r]:"read"==r&&(i.textContent+=t[r]);let o=document.createElement("div");o.dataset.num=ul.indexOf(t),o.classList.add("bookObj"),o.setAttribute("id",t.id),o.appendChild(e),o.appendChild(n),o.appendChild(s),o.appendChild(i),o.appendChild(r),cl.appendChild(o)}}()}document.addEventListener("click",(async function(t){let e=t.target;if(e.classList.contains("readBtn"))if("READ"==e.innerText){const t=hh(nl,"books",e.parentNode.id);await tl(t,{read:"UNREAD"}),e.innerText="UNREAD"}else{const t=hh(nl,"books",e.parentNode.id);await tl(t,{read:"READ"}),e.innerText="READ"}})),hl()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0ksYUFBZVAsRUFBS1EsR0FDWCxTQUFUQSxFQUNUSixFQUFPRyxhQUFlUCxFQUFLUSxHQUNULFFBQVRBLElBQ1RILEVBQU9FLGFBQWVQLEVBQUtRLElBRy9CLElBQUlDLEVBQVV2d0QsU0FBU2d3RCxjQUFjLE9BQ3JDTyxFQUFRQyxRQUFRQyxJQUFNZixHQUFVcDZDLFFBQVF3NkMsR0FDeENTLEVBQVF4QixVQUFVNW5ELElBQUksV0FDdEJvcEQsRUFBUUcsYUFBYSxLQUFNWixFQUFLdm9DLElBQ2hDZ3BDLEVBQVFJLFlBQVlaLEdBQ3BCUSxFQUFRSSxZQUFZVixHQUNwQk0sRUFBUUksWUFBWVQsR0FDcEJLLEVBQVFJLFlBQVlSLEdBQ3BCSSxFQUFRSSxZQUFZUCxHQUNwQnZCLEdBQU04QixZQUFZSixFQUNwQixDQUNGLENBaERFSyxFQUNGLENBaURBNXdELFNBQVMrTCxpQkFBaUIsU0FFMUI1RixlQUE0QnpLLEdBQzFCLElBQUlvekQsRUFBVXB6RCxFQUFFNE8sT0FDaEIsR0FBSXdrRCxFQUFRQyxVQUFVcEUsU0FBUyxXQUM3QixHQUF5QixRQUFyQm1FLEVBQVErQixVQUFxQixDQUMvQixNQUFNN0IsRUFBUyxHQUFJLEdBQUksUUFBU0YsRUFBUUcsV0FBVzFuQyxVQUM3QyxHQUFVeW5DLEVBQVEsQ0FBRWw5QyxLQUFNLFdBQ2hDZzlDLEVBQVErQixVQUFZLFFBQ3RCLEtBQU8sQ0FDTCxNQUFNN0IsRUFBUyxHQUFJLEdBQUksUUFBU0YsRUFBUUcsV0FBVzFuQyxVQUM3QyxHQUFVeW5DLEVBQVEsQ0FBRWw5QyxLQUFNLFNBQ2hDZzlDLEVBQVErQixVQUFZLE1BQ3RCLENBRUosSUFFQTFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGlicmFyeS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9saWJyYXJ5L3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvY29tcG9uZW50L2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9pZGIvYnVpbGQvd3JhcC1pZGItdmFsdWUuanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9pZGIvYnVpbGQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9maXJlYmFzZS9hcHAvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vbGlicmFyeS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3QvaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly9saWJyYXJ5Ly4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL2xpYnJhcnkvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgRmlyZWJhc2UgY29uc3RhbnRzLiAgU29tZSBvZiB0aGVzZSAoQGRlZmluZXMpIGNhbiBiZSBvdmVycmlkZGVuIGF0IGNvbXBpbGUtdGltZS5cclxuICovXHJcbmNvbnN0IENPTlNUQU5UUyA9IHtcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBjbGllbnQgTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQ0xJRU5UOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBBZG1pbiBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9BRE1JTjogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEZpcmViYXNlIFNESyBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIGFzc2VydGlvbiBpcyBmYWxzeVxyXG4gKi9cclxuY29uc3QgYXNzZXJ0ID0gZnVuY3Rpb24gKGFzc2VydGlvbiwgbWVzc2FnZSkge1xyXG4gICAgaWYgKCFhc3NlcnRpb24pIHtcclxuICAgICAgICB0aHJvdyBhc3NlcnRpb25FcnJvcihtZXNzYWdlKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgYW4gRXJyb3Igb2JqZWN0IHN1aXRhYmxlIGZvciB0aHJvd2luZy5cclxuICovXHJcbmNvbnN0IGFzc2VydGlvbkVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgRXJyb3IoJ0ZpcmViYXNlIERhdGFiYXNlICgnICtcclxuICAgICAgICBDT05TVEFOVFMuU0RLX1ZFUlNJT04gK1xyXG4gICAgICAgICcpIElOVEVSTkFMIEFTU0VSVCBGQUlMRUQ6ICcgK1xyXG4gICAgICAgIG1lc3NhZ2UpO1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBzdHJpbmdUb0J5dGVBcnJheSQxID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIGNvbnN0IG91dCA9IFtdO1xyXG4gICAgbGV0IHAgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKGMgJiAweGZjMDApID09PSAweGQ4MDAgJiZcclxuICAgICAgICAgICAgaSArIDEgPCBzdHIubGVuZ3RoICYmXHJcbiAgICAgICAgICAgIChzdHIuY2hhckNvZGVBdChpICsgMSkgJiAweGZjMDApID09PSAweGRjMDApIHtcclxuICAgICAgICAgICAgLy8gU3Vycm9nYXRlIFBhaXJcclxuICAgICAgICAgICAgYyA9IDB4MTAwMDAgKyAoKGMgJiAweDAzZmYpIDw8IDEwKSArIChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHgwM2ZmKTtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufTtcclxuLyoqXHJcbiAqIFR1cm5zIGFuIGFycmF5IG9mIG51bWJlcnMgaW50byB0aGUgc3RyaW5nIGdpdmVuIGJ5IHRoZSBjb25jYXRlbmF0aW9uIG9mIHRoZVxyXG4gKiBjaGFyYWN0ZXJzIHRvIHdoaWNoIHRoZSBudW1iZXJzIGNvcnJlc3BvbmQuXHJcbiAqIEBwYXJhbSBieXRlcyBBcnJheSBvZiBudW1iZXJzIHJlcHJlc2VudGluZyBjaGFyYWN0ZXJzLlxyXG4gKiBAcmV0dXJuIFN0cmluZ2lmaWNhdGlvbiBvZiB0aGUgYXJyYXkuXHJcbiAqL1xyXG5jb25zdCBieXRlQXJyYXlUb1N0cmluZyA9IGZ1bmN0aW9uIChieXRlcykge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIGNvbnN0IG91dCA9IFtdO1xyXG4gICAgbGV0IHBvcyA9IDAsIGMgPSAwO1xyXG4gICAgd2hpbGUgKHBvcyA8IGJ5dGVzLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnN0IGMxID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgIGlmIChjMSA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYzEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjMSA+IDE5MSAmJiBjMSA8IDIyNCkge1xyXG4gICAgICAgICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAzMSkgPDwgNikgfCAoYzIgJiA2MykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjMSA+IDIzOSAmJiBjMSA8IDM2NSkge1xyXG4gICAgICAgICAgICAvLyBTdXJyb2dhdGUgUGFpclxyXG4gICAgICAgICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgY29uc3QgYzMgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIGNvbnN0IGM0ID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBjb25zdCB1ID0gKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cclxuICAgICAgICAgICAgICAgIDB4MTAwMDA7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGQ4MDAgKyAodSA+PiAxMCkpO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkYzAwICsgKHUgJiAxMDIzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgY29uc3QgYzMgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMxICYgMTUpIDw8IDEyKSB8ICgoYzIgJiA2MykgPDwgNikgfCAoYzMgJiA2MykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQuam9pbignJyk7XHJcbn07XHJcbi8vIFdlIGRlZmluZSBpdCBhcyBhbiBvYmplY3QgbGl0ZXJhbCBpbnN0ZWFkIG9mIGEgY2xhc3MgYmVjYXVzZSBhIGNsYXNzIGNvbXBpbGVkIGRvd24gdG8gZXM1IGNhbid0XHJcbi8vIGJlIHRyZWVzaGFrZWQuIGh0dHBzOi8vZ2l0aHViLmNvbS9yb2xsdXAvcm9sbHVwL2lzc3Vlcy8xNjkxXHJcbi8vIFN0YXRpYyBsb29rdXAgbWFwcywgbGF6aWx5IHBvcHVsYXRlZCBieSBpbml0XygpXHJcbmNvbnN0IGJhc2U2NCA9IHtcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byBjaGFyYWN0ZXJzLlxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byB3ZWJzYWZlIGNoYXJhY3RlcnMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgd2Vic2FmZSBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldCwgc2hhcmVkIGJldHdlZW5cclxuICAgICAqIEVOQ09ERURfVkFMUyBhbmQgRU5DT0RFRF9WQUxTX1dFQlNBRkVcclxuICAgICAqL1xyXG4gICAgRU5DT0RFRF9WQUxTX0JBU0U6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzAxMjM0NTY3ODknLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMU19XRUJTQUZFKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJy1fLic7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXHJcbiAgICAgKiBzdGFydGVkIGF0IE1vemlsbGEgYnV0IGlzIG5vdyBpbXBsZW1lbnRlZCBieSBtYW55IGJyb3dzZXJzLiBXZSB1c2UgdGhlXHJcbiAgICAgKiBBU1NVTUVfKiB2YXJpYWJsZXMgdG8gYXZvaWQgcHVsbGluZyBpbiB0aGUgZnVsbCB1c2VyYWdlbnQgZGV0ZWN0aW9uIGxpYnJhcnlcclxuICAgICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhbiBhcnJheSBvZiBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgQW4gYXJyYXkgb2YgYnl0ZXMgKG51bWJlcnMgd2l0aFxyXG4gICAgICogICAgIHZhbHVlIGluIFswLCAyNTVdKSB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBCb29sZWFuIGluZGljYXRpbmcgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlQnl0ZUFycmF5KGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGlucHV0KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignZW5jb2RlQnl0ZUFycmF5IHRha2VzIGFuIGFycmF5IGFzIGEgcGFyYW1ldGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICBjb25zdCBieXRlVG9DaGFyTWFwID0gd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5ieXRlVG9DaGFyTWFwXztcclxuICAgICAgICBjb25zdCBvdXRwdXQgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSArPSAzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUxID0gaW5wdXRbaV07XHJcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMiA9IGhhdmVCeXRlMiA/IGlucHV0W2kgKyAxXSA6IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlMyA9IGkgKyAyIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IG91dEJ5dGUxID0gYnl0ZTEgPj4gMjtcclxuICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTIgPSAoKGJ5dGUxICYgMHgwMykgPDwgNCkgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIGxldCBvdXRCeXRlMyA9ICgoYnl0ZTIgJiAweDBmKSA8PCAyKSB8IChieXRlMyA+PiA2KTtcclxuICAgICAgICAgICAgbGV0IG91dEJ5dGU0ID0gYnl0ZTMgJiAweDNmO1xyXG4gICAgICAgICAgICBpZiAoIWhhdmVCeXRlMykge1xyXG4gICAgICAgICAgICAgICAgb3V0Qnl0ZTQgPSA2NDtcclxuICAgICAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3V0Qnl0ZTMgPSA2NDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChieXRlVG9DaGFyTWFwW291dEJ5dGUxXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlMl0sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTNdLCBieXRlVG9DaGFyTWFwW291dEJ5dGU0XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXRwdXQuam9pbignJyk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZW5jb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpbnB1dCBBIHN0cmluZyB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBJZiB0cnVlLCB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBlbmNvZGVTdHJpbmcoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJ0b2EoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVCeXRlQXJyYXkoc3RyaW5nVG9CeXRlQXJyYXkkMShpbnB1dCksIHdlYlNhZmUpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgdG8gZGVjb2RlLlxyXG4gICAgICogQHBhcmFtIHdlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBkZWNvZGVkIHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBkZWNvZGVTdHJpbmcoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF0b2IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYnl0ZUFycmF5VG9TdHJpbmcodGhpcy5kZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBJbiBiYXNlLTY0IGRlY29kaW5nLCBncm91cHMgb2YgZm91ciBjaGFyYWN0ZXJzIGFyZSBjb252ZXJ0ZWQgaW50byB0aHJlZVxyXG4gICAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxyXG4gICAgICogYmUgYSBtdWx0aXBsZSBvZiA0LlxyXG4gICAgICpcclxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcclxuICAgICAqIHBhZGRpbmcgd2lsbCBiZSBpbmZlcnJlZC4gIElmIHRoZSBncm91cCBoYXMgb25lIG9yIHR3byBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzXHJcbiAgICAgKiB0byBvbmUgYnl0ZS4gIElmIHRoZSBncm91cCBoYXMgdGhyZWUgY2hhcmFjdGVycywgaXQgZGVjb2RlcyB0byB0d28gYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IElucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGUgd2ViLXNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICB0aGlzLmluaXRfKCk7XHJcbiAgICAgICAgY29uc3QgY2hhclRvQnl0ZU1hcCA9IHdlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XHJcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUxID0gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSsrKV07XHJcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlMiA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUyID0gaGF2ZUJ5dGUyID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogMDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTMgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMyA9IGhhdmVCeXRlMyA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlNCA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGU0ID0gaGF2ZUJ5dGU0ID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUxID09IG51bGwgfHwgYnl0ZTIgPT0gbnVsbCB8fCBieXRlMyA9PSBudWxsIHx8IGJ5dGU0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUzICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTIgPSAoKGJ5dGUyIDw8IDQpICYgMHhmMCkgfCAoYnl0ZTMgPj4gMik7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYnl0ZTQgIT09IDY0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTMgPSAoKGJ5dGUzIDw8IDYpICYgMHhjMCkgfCBieXRlNDtcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIExhenkgc3RhdGljIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uLiBDYWxsZWQgYmVmb3JlXHJcbiAgICAgKiBhY2Nlc3NpbmcgYW55IG9mIHRoZSBzdGF0aWMgbWFwIHZhcmlhYmxlcy5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGluaXRfKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ieXRlVG9DaGFyTWFwXykge1xyXG4gICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgLy8gV2Ugd2FudCBxdWljayBtYXBwaW5ncyBiYWNrIGFuZCBmb3J0aCwgc28gd2UgcHJlY29tcHV0ZSB0d28gbWFwcy5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLkVOQ09ERURfVkFMUy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwX1tpXSA9IHRoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5ieXRlVG9DaGFyTWFwX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV0gPSB0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldXSA9IGk7XHJcbiAgICAgICAgICAgICAgICAvLyBCZSBmb3JnaXZpbmcgd2hlbiBkZWNvZGluZyBhbmQgY29ycmVjdGx5IGRlY29kZSBib3RoIGVuY29kaW5ncy5cclxuICAgICAgICAgICAgICAgIGlmIChpID49IHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwX1t0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nXHJcbiAqL1xyXG5jb25zdCBiYXNlNjRFbmNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICBjb25zdCB1dGY4Qnl0ZXMgPSBzdHJpbmdUb0J5dGVBcnJheSQxKHN0cik7XHJcbiAgICByZXR1cm4gYmFzZTY0LmVuY29kZUJ5dGVBcnJheSh1dGY4Qnl0ZXMsIHRydWUpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nICh3aXRob3V0IFwiLlwiIHBhZGRpbmcgaW4gdGhlIGVuZCkuXHJcbiAqIGUuZy4gVXNlZCBpbiBKU09OIFdlYiBUb2tlbiAoSldUKSBwYXJ0cy5cclxuICovXHJcbmNvbnN0IGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgLy8gVXNlIGJhc2U2NHVybCBlbmNvZGluZyBhbmQgcmVtb3ZlIHBhZGRpbmcgaW4gdGhlIGVuZCAoZG90IGNoYXJhY3RlcnMpLlxyXG4gICAgcmV0dXJuIGJhc2U2NEVuY29kZShzdHIpLnJlcGxhY2UoL1xcLi9nLCAnJyk7XHJcbn07XHJcbi8qKlxyXG4gKiBVUkwtc2FmZSBiYXNlNjQgZGVjb2RpbmdcclxuICpcclxuICogTk9URTogRE8gTk9UIHVzZSB0aGUgZ2xvYmFsIGF0b2IoKSBmdW5jdGlvbiAtIGl0IGRvZXMgTk9UIHN1cHBvcnQgdGhlXHJcbiAqIGJhc2U2NFVybCB2YXJpYW50IGVuY29kaW5nLlxyXG4gKlxyXG4gKiBAcGFyYW0gc3RyIFRvIGJlIGRlY29kZWRcclxuICogQHJldHVybiBEZWNvZGVkIHJlc3VsdCwgaWYgcG9zc2libGVcclxuICovXHJcbmNvbnN0IGJhc2U2NERlY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIGJhc2U2NC5kZWNvZGVTdHJpbmcoc3RyLCB0cnVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignYmFzZTY0RGVjb2RlIGZhaWxlZDogJywgZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERvIGEgZGVlcC1jb3B5IG9mIGJhc2ljIEphdmFTY3JpcHQgT2JqZWN0cyBvciBBcnJheXMuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWVwQ29weSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIGRlZXBFeHRlbmQodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbn1cclxuLyoqXHJcbiAqIENvcHkgcHJvcGVydGllcyBmcm9tIHNvdXJjZSB0byB0YXJnZXQgKHJlY3Vyc2l2ZWx5IGFsbG93cyBleHRlbnNpb25cclxuICogb2YgT2JqZWN0cyBhbmQgQXJyYXlzKS4gIFNjYWxhciB2YWx1ZXMgaW4gdGhlIHRhcmdldCBhcmUgb3Zlci13cml0dGVuLlxyXG4gKiBJZiB0YXJnZXQgaXMgdW5kZWZpbmVkLCBhbiBvYmplY3Qgb2YgdGhlIGFwcHJvcHJpYXRlIHR5cGUgd2lsbCBiZSBjcmVhdGVkXHJcbiAqIChhbmQgcmV0dXJuZWQpLlxyXG4gKlxyXG4gKiBXZSByZWN1cnNpdmVseSBjb3B5IGFsbCBjaGlsZCBwcm9wZXJ0aWVzIG9mIHBsYWluIE9iamVjdHMgaW4gdGhlIHNvdXJjZS0gc29cclxuICogdGhhdCBuYW1lc3BhY2UtIGxpa2UgZGljdGlvbmFyaWVzIGFyZSBtZXJnZWQuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGUgdGFyZ2V0IGNhbiBiZSBhIGZ1bmN0aW9uLCBpbiB3aGljaCBjYXNlIHRoZSBwcm9wZXJ0aWVzIGluXHJcbiAqIHRoZSBzb3VyY2UgT2JqZWN0IGFyZSBjb3BpZWQgb250byBpdCBhcyBzdGF0aWMgcHJvcGVydGllcyBvZiB0aGUgRnVuY3Rpb24uXHJcbiAqXHJcbiAqIE5vdGU6IHdlIGRvbid0IG1lcmdlIF9fcHJvdG9fXyB0byBwcmV2ZW50IHByb3RvdHlwZSBwb2xsdXRpb25cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBFeHRlbmQodGFyZ2V0LCBzb3VyY2UpIHtcclxuICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIE9iamVjdCkpIHtcclxuICAgICAgICByZXR1cm4gc291cmNlO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChzb3VyY2UuY29uc3RydWN0b3IpIHtcclxuICAgICAgICBjYXNlIERhdGU6XHJcbiAgICAgICAgICAgIC8vIFRyZWF0IERhdGVzIGxpa2Ugc2NhbGFyczsgaWYgdGhlIHRhcmdldCBkYXRlIG9iamVjdCBoYWQgYW55IGNoaWxkXHJcbiAgICAgICAgICAgIC8vIHByb3BlcnRpZXMgLSB0aGV5IHdpbGwgYmUgbG9zdCFcclxuICAgICAgICAgICAgY29uc3QgZGF0ZVZhbHVlID0gc291cmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XHJcbiAgICAgICAgY2FzZSBPYmplY3Q6XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBBcnJheTpcclxuICAgICAgICAgICAgLy8gQWx3YXlzIGNvcHkgdGhlIGFycmF5IHNvdXJjZSBhbmQgb3ZlcndyaXRlIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICAgIHRhcmdldCA9IFtdO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBOb3QgYSBwbGFpbiBPYmplY3QgLSB0cmVhdCBpdCBhcyBhIHNjYWxhci5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3QgcHJvcCBpbiBzb3VyY2UpIHtcclxuICAgICAgICAvLyB1c2UgaXNWYWxpZEtleSB0byBndWFyZCBhZ2FpbnN0IHByb3RvdHlwZSBwb2xsdXRpb24uIFNlZSBodHRwczovL3NueWsuaW8vdnVsbi9TTllLLUpTLUxPREFTSC00NTAyMDJcclxuICAgICAgICBpZiAoIXNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSB8fCAhaXNWYWxpZEtleShwcm9wKSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGFyZ2V0W3Byb3BdID0gZGVlcEV4dGVuZCh0YXJnZXRbcHJvcF0sIHNvdXJjZVtwcm9wXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG59XHJcbmZ1bmN0aW9uIGlzVmFsaWRLZXkoa2V5KSB7XHJcbiAgICByZXR1cm4ga2V5ICE9PSAnX19wcm90b19fJztcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBuYXZpZ2F0b3IudXNlckFnZW50IHN0cmluZyBvciAnJyBpZiBpdCdzIG5vdCBkZWZpbmVkLlxyXG4gKiBAcmV0dXJuIHVzZXIgYWdlbnQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRVQSgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQ29yZG92YSAvIFBob25lR2FwIC8gSW9uaWMgZnJhbWV3b3JrcyBvbiBhIG1vYmlsZSBkZXZpY2UuXHJcbiAqXHJcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwXHJcbiAqIGluIHRoZSBSaXBwbGUgZW11bGF0b3IpIG5vciBDb3Jkb3ZhIGBvbkRldmljZVJlYWR5YCwgd2hpY2ggd291bGQgbm9ybWFsbHlcclxuICogd2FpdCBmb3IgYSBjYWxsYmFjay5cclxuICovXHJcbmZ1bmN0aW9uIGlzTW9iaWxlQ29yZG92YSgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICAvLyBAdHMtaWdub3JlIFNldHRpbmcgdXAgYW4gYnJvYWRseSBhcHBsaWNhYmxlIGluZGV4IHNpZ25hdHVyZSBmb3IgV2luZG93XHJcbiAgICAgICAgLy8ganVzdCB0byBkZWFsIHdpdGggdGhpcyBjYXNlIHdvdWxkIHByb2JhYmx5IGJlIGEgYmFkIGlkZWEuXHJcbiAgICAgICAgISEod2luZG93Wydjb3Jkb3ZhJ10gfHwgd2luZG93WydwaG9uZWdhcCddIHx8IHdpbmRvd1snUGhvbmVHYXAnXSkgJiZcclxuICAgICAgICAvaW9zfGlwaG9uZXxpcG9kfGlwYWR8YW5kcm9pZHxibGFja2JlcnJ5fGllbW9iaWxlL2kudGVzdChnZXRVQSgpKSk7XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBOb2RlLmpzLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgTm9kZS5qcyBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbi8vIE5vZGUgZGV0ZWN0aW9uIGxvZ2ljIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9pbGlha2FuL2RldGVjdC1ub2RlL1xyXG5mdW5jdGlvbiBpc05vZGUoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQnJvd3NlciBFbnZpcm9ubWVudFxyXG4gKi9cclxuZnVuY3Rpb24gaXNCcm93c2VyKCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzZWxmID09PSAnb2JqZWN0JyAmJiBzZWxmLnNlbGYgPT09IHNlbGY7XHJcbn1cclxuZnVuY3Rpb24gaXNCcm93c2VyRXh0ZW5zaW9uKCkge1xyXG4gICAgY29uc3QgcnVudGltZSA9IHR5cGVvZiBjaHJvbWUgPT09ICdvYmplY3QnXHJcbiAgICAgICAgPyBjaHJvbWUucnVudGltZVxyXG4gICAgICAgIDogdHlwZW9mIGJyb3dzZXIgPT09ICdvYmplY3QnXHJcbiAgICAgICAgICAgID8gYnJvd3Nlci5ydW50aW1lXHJcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBydW50aW1lID09PSAnb2JqZWN0JyAmJiBydW50aW1lLmlkICE9PSB1bmRlZmluZWQ7XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBSZWFjdCBOYXRpdmUuXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBSZWFjdE5hdGl2ZSBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzUmVhY3ROYXRpdmUoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvclsncHJvZHVjdCddID09PSAnUmVhY3ROYXRpdmUnKTtcclxufVxyXG4vKiogRGV0ZWN0cyBFbGVjdHJvbiBhcHBzLiAqL1xyXG5mdW5jdGlvbiBpc0VsZWN0cm9uKCkge1xyXG4gICAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignRWxlY3Ryb24vJykgPj0gMDtcclxufVxyXG4vKiogRGV0ZWN0cyBJbnRlcm5ldCBFeHBsb3Jlci4gKi9cclxuZnVuY3Rpb24gaXNJRSgpIHtcclxuICAgIGNvbnN0IHVhID0gZ2V0VUEoKTtcclxuICAgIHJldHVybiB1YS5pbmRleE9mKCdNU0lFICcpID49IDAgfHwgdWEuaW5kZXhPZignVHJpZGVudC8nKSA+PSAwO1xyXG59XHJcbi8qKiBEZXRlY3RzIFVuaXZlcnNhbCBXaW5kb3dzIFBsYXRmb3JtIGFwcHMuICovXHJcbmZ1bmN0aW9uIGlzVVdQKCkge1xyXG4gICAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignTVNBcHBIb3N0LycpID49IDA7XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCB3aGV0aGVyIHRoZSBjdXJyZW50IFNESyBidWlsZCBpcyB0aGUgTm9kZSB2ZXJzaW9uLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgaXQncyB0aGUgTm9kZSBTREsgYnVpbGQuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc05vZGVTZGsoKSB7XHJcbiAgICByZXR1cm4gQ09OU1RBTlRTLk5PREVfQ0xJRU5UID09PSB0cnVlIHx8IENPTlNUQU5UUy5OT0RFX0FETUlOID09PSB0cnVlO1xyXG59XHJcbi8qKiBSZXR1cm5zIHRydWUgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gU2FmYXJpLiAqL1xyXG5mdW5jdGlvbiBpc1NhZmFyaSgpIHtcclxuICAgIHJldHVybiAoIWlzTm9kZSgpICYmXHJcbiAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnU2FmYXJpJykgJiZcclxuICAgICAgICAhbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnQ2hyb21lJykpO1xyXG59XHJcbi8qKlxyXG4gKiBUaGlzIG1ldGhvZCBjaGVja3MgaWYgaW5kZXhlZERCIGlzIHN1cHBvcnRlZCBieSBjdXJyZW50IGJyb3dzZXIvc2VydmljZSB3b3JrZXIgY29udGV4dFxyXG4gKiBAcmV0dXJuIHRydWUgaWYgaW5kZXhlZERCIGlzIHN1cHBvcnRlZCBieSBjdXJyZW50IGJyb3dzZXIvc2VydmljZSB3b3JrZXIgY29udGV4dFxyXG4gKi9cclxuZnVuY3Rpb24gaXNJbmRleGVkREJBdmFpbGFibGUoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIGluZGV4ZWREQiA9PT0gJ29iamVjdCc7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIHZhbGlkYXRlcyBicm93c2VyL3N3IGNvbnRleHQgZm9yIGluZGV4ZWREQiBieSBvcGVuaW5nIGEgZHVtbXkgaW5kZXhlZERCIGRhdGFiYXNlIGFuZCByZWplY3RcclxuICogaWYgZXJyb3JzIG9jY3VyIGR1cmluZyB0aGUgZGF0YWJhc2Ugb3BlbiBvcGVyYXRpb24uXHJcbiAqXHJcbiAqIEB0aHJvd3MgZXhjZXB0aW9uIGlmIGN1cnJlbnQgYnJvd3Nlci9zdyBjb250ZXh0IGNhbid0IHJ1biBpZGIub3BlbiAoZXg6IFNhZmFyaSBpZnJhbWUsIEZpcmVmb3hcclxuICogcHJpdmF0ZSBicm93c2luZylcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUoKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGxldCBwcmVFeGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IERCX0NIRUNLX05BTUUgPSAndmFsaWRhdGUtYnJvd3Nlci1jb250ZXh0LWZvci1pbmRleGVkZGItYW5hbHl0aWNzLW1vZHVsZSc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBzZWxmLmluZGV4ZWREQi5vcGVuKERCX0NIRUNLX05BTUUpO1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QucmVzdWx0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgZGF0YWJhc2Ugb25seSB3aGVuIGl0IGRvZXNuJ3QgcHJlLWV4aXN0XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZUV4aXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfQ0hFQ0tfTkFNRSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHByZUV4aXN0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgIHJlamVjdCgoKF9hID0gcmVxdWVzdC5lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1lc3NhZ2UpIHx8ICcnKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyB3aGV0aGVyIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICogQHJldHVybiB0cnVlIGlmIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICovXHJcbmZ1bmN0aW9uIGFyZUNvb2tpZXNFbmFibGVkKCkge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFuYXZpZ2F0b3IuY29va2llRW5hYmxlZCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbi8qKlxyXG4gKiBQb2x5ZmlsbCBmb3IgYGdsb2JhbFRoaXNgIG9iamVjdC5cclxuICogQHJldHVybnMgdGhlIGBnbG9iYWxUaGlzYCBvYmplY3QgZm9yIHRoZSBnaXZlbiBlbnZpcm9ubWVudC5cclxuICovXHJcbmZ1bmN0aW9uIGdldEdsb2JhbCgpIHtcclxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiB3aW5kb3c7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm4gZ2xvYmFsO1xyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gbG9jYXRlIGdsb2JhbCBvYmplY3QuJyk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgZ2V0RGVmYXVsdHNGcm9tR2xvYmFsID0gKCkgPT4gZ2V0R2xvYmFsKCkuX19GSVJFQkFTRV9ERUZBVUxUU19fO1xyXG4vKipcclxuICogQXR0ZW1wdCB0byByZWFkIGRlZmF1bHRzIGZyb20gYSBKU09OIHN0cmluZyBwcm92aWRlZCB0b1xyXG4gKiBwcm9jZXNzLmVudi5fX0ZJUkVCQVNFX0RFRkFVTFRTX18gb3IgYSBKU09OIGZpbGUgd2hvc2UgcGF0aCBpcyBpblxyXG4gKiBwcm9jZXNzLmVudi5fX0ZJUkVCQVNFX0RFRkFVTFRTX1BBVEhfX1xyXG4gKi9cclxuY29uc3QgZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUgPSAoKSA9PiB7XHJcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBwcm9jZXNzLmVudiA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBkZWZhdWx0c0pzb25TdHJpbmcgPSBwcm9jZXNzLmVudi5fX0ZJUkVCQVNFX0RFRkFVTFRTX187XHJcbiAgICBpZiAoZGVmYXVsdHNKc29uU3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVmYXVsdHNKc29uU3RyaW5nKTtcclxuICAgIH1cclxufTtcclxuY29uc3QgZ2V0RGVmYXVsdHNGcm9tQ29va2llID0gKCkgPT4ge1xyXG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgbWF0Y2g7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIG1hdGNoID0gZG9jdW1lbnQuY29va2llLm1hdGNoKC9fX0ZJUkVCQVNFX0RFRkFVTFRTX189KFteO10rKS8pO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAvLyBTb21lIGVudmlyb25tZW50cyBzdWNoIGFzIEFuZ3VsYXIgVW5pdmVyc2FsIFNTUiBoYXZlIGFcclxuICAgICAgICAvLyBgZG9jdW1lbnRgIG9iamVjdCBidXQgZXJyb3Igb24gYWNjZXNzaW5nIGBkb2N1bWVudC5jb29raWVgLlxyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGRlY29kZWQgPSBtYXRjaCAmJiBiYXNlNjREZWNvZGUobWF0Y2hbMV0pO1xyXG4gICAgcmV0dXJuIGRlY29kZWQgJiYgSlNPTi5wYXJzZShkZWNvZGVkKTtcclxufTtcclxuLyoqXHJcbiAqIEdldCB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdC4gSXQgY2hlY2tzIGluIG9yZGVyOlxyXG4gKiAoMSkgaWYgc3VjaCBhbiBvYmplY3QgZXhpc3RzIGFzIGEgcHJvcGVydHkgb2YgYGdsb2JhbFRoaXNgXHJcbiAqICgyKSBpZiBzdWNoIGFuIG9iamVjdCB3YXMgcHJvdmlkZWQgb24gYSBzaGVsbCBlbnZpcm9ubWVudCB2YXJpYWJsZVxyXG4gKiAoMykgaWYgc3VjaCBhbiBvYmplY3QgZXhpc3RzIGluIGEgY29va2llXHJcbiAqL1xyXG5jb25zdCBnZXREZWZhdWx0cyA9ICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIChnZXREZWZhdWx0c0Zyb21HbG9iYWwoKSB8fFxyXG4gICAgICAgICAgICBnZXREZWZhdWx0c0Zyb21FbnZWYXJpYWJsZSgpIHx8XHJcbiAgICAgICAgICAgIGdldERlZmF1bHRzRnJvbUNvb2tpZSgpKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2F0Y2gtYWxsIGZvciBiZWluZyB1bmFibGUgdG8gZ2V0IF9fRklSRUJBU0VfREVGQVVMVFNfXyBkdWVcclxuICAgICAgICAgKiB0byBhbnkgZW52aXJvbm1lbnQgY2FzZSB3ZSBoYXZlIG5vdCBhY2NvdW50ZWQgZm9yLiBMb2cgdG9cclxuICAgICAgICAgKiBpbmZvIGluc3RlYWQgb2Ygc3dhbGxvd2luZyBzbyB3ZSBjYW4gZmluZCB0aGVzZSB1bmtub3duIGNhc2VzXHJcbiAgICAgICAgICogYW5kIGFkZCBwYXRocyBmb3IgdGhlbSBpZiBuZWVkZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc29sZS5pbmZvKGBVbmFibGUgdG8gZ2V0IF9fRklSRUJBU0VfREVGQVVMVFNfXyBkdWUgdG86ICR7ZX1gKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGVtdWxhdG9yIGhvc3Qgc3RvcmVkIGluIHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0XHJcbiAqIGZvciB0aGUgZ2l2ZW4gcHJvZHVjdC5cclxuICogQHJldHVybnMgYSBVUkwgaG9zdCBmb3JtYXR0ZWQgbGlrZSBgMTI3LjAuMC4xOjk5OTlgIG9yIGBbOjoxXTo0MDAwYCBpZiBhdmFpbGFibGVcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCA9IChwcm9kdWN0TmFtZSkgPT4geyB2YXIgX2EsIF9iOyByZXR1cm4gKF9iID0gKF9hID0gZ2V0RGVmYXVsdHMoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVtdWxhdG9ySG9zdHMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYltwcm9kdWN0TmFtZV07IH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGVtdWxhdG9yIGhvc3RuYW1lIGFuZCBwb3J0IHN0b3JlZCBpbiB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdFxyXG4gKiBmb3IgdGhlIGdpdmVuIHByb2R1Y3QuXHJcbiAqIEByZXR1cm5zIGEgcGFpciBvZiBob3N0bmFtZSBhbmQgcG9ydCBsaWtlIGBbXCI6OjFcIiwgNDAwMF1gIGlmIGF2YWlsYWJsZVxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQgPSAocHJvZHVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IGhvc3QgPSBnZXREZWZhdWx0RW11bGF0b3JIb3N0KHByb2R1Y3ROYW1lKTtcclxuICAgIGlmICghaG9zdCkge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBzZXBhcmF0b3JJbmRleCA9IGhvc3QubGFzdEluZGV4T2YoJzonKTsgLy8gRmluZGluZyB0aGUgbGFzdCBzaW5jZSBJUHY2IGFkZHIgYWxzbyBoYXMgY29sb25zLlxyXG4gICAgaWYgKHNlcGFyYXRvckluZGV4IDw9IDAgfHwgc2VwYXJhdG9ySW5kZXggKyAxID09PSBob3N0Lmxlbmd0aCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBob3N0ICR7aG9zdH0gd2l0aCBubyBzZXBhcmF0ZSBob3N0bmFtZSBhbmQgcG9ydCFgKTtcclxuICAgIH1cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHNcclxuICAgIGNvbnN0IHBvcnQgPSBwYXJzZUludChob3N0LnN1YnN0cmluZyhzZXBhcmF0b3JJbmRleCArIDEpLCAxMCk7XHJcbiAgICBpZiAoaG9zdFswXSA9PT0gJ1snKSB7XHJcbiAgICAgICAgLy8gQnJhY2tldC1xdW90ZWQgYFtpcHY2YWRkcl06cG9ydGAgPT4gcmV0dXJuIFwiaXB2NmFkZHJcIiAod2l0aG91dCBicmFja2V0cykuXHJcbiAgICAgICAgcmV0dXJuIFtob3N0LnN1YnN0cmluZygxLCBzZXBhcmF0b3JJbmRleCAtIDEpLCBwb3J0XTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBbaG9zdC5zdWJzdHJpbmcoMCwgc2VwYXJhdG9ySW5kZXgpLCBwb3J0XTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgRmlyZWJhc2UgYXBwIGNvbmZpZyBzdG9yZWQgaW4gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGdldERlZmF1bHRBcHBDb25maWcgPSAoKSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IGdldERlZmF1bHRzKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb25maWc7IH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIGV4cGVyaW1lbnRhbCBzZXR0aW5nIG9uIHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0IChwcm9wZXJ0aWVzXHJcbiAqIHByZWZpeGVkIGJ5IFwiX1wiKVxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBnZXRFeHBlcmltZW50YWxTZXR0aW5nID0gKG5hbWUpID0+IHsgdmFyIF9hOyByZXR1cm4gKF9hID0gZ2V0RGVmYXVsdHMoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hW2BfJHtuYW1lfWBdOyB9O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBEZWZlcnJlZCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnJlamVjdCA9ICgpID0+IHsgfTtcclxuICAgICAgICB0aGlzLnJlc29sdmUgPSAoKSA9PiB7IH07XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3VyIEFQSSBpbnRlcm5hbHMgYXJlIG5vdCBwcm9taXNlaWZpZWQgYW5kIGNhbm5vdCBiZWNhdXNlIG91ciBjYWxsYmFjayBBUElzIGhhdmUgc3VidGxlIGV4cGVjdGF0aW9ucyBhcm91bmRcclxuICAgICAqIGludm9raW5nIHByb21pc2VzIGlubGluZSwgd2hpY2ggUHJvbWlzZXMgYXJlIGZvcmJpZGRlbiB0byBkby4gVGhpcyBtZXRob2QgYWNjZXB0cyBhbiBvcHRpb25hbCBub2RlLXN0eWxlIGNhbGxiYWNrXHJcbiAgICAgKiBhbmQgcmV0dXJucyBhIG5vZGUtc3R5bGUgY2FsbGJhY2sgd2hpY2ggd2lsbCByZXNvbHZlIG9yIHJlamVjdCB0aGUgRGVmZXJyZWQncyBwcm9taXNlLlxyXG4gICAgICovXHJcbiAgICB3cmFwQ2FsbGJhY2soY2FsbGJhY2spIHtcclxuICAgICAgICByZXR1cm4gKGVycm9yLCB2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgLy8gQXR0YWNoaW5nIG5vb3AgaGFuZGxlciBqdXN0IGluIGNhc2UgZGV2ZWxvcGVyIHdhc24ndCBleHBlY3RpbmdcclxuICAgICAgICAgICAgICAgIC8vIHByb21pc2VzXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb21pc2UuY2F0Y2goKCkgPT4geyB9KTtcclxuICAgICAgICAgICAgICAgIC8vIFNvbWUgb2Ygb3VyIGNhbGxiYWNrcyBkb24ndCBleHBlY3QgYSB2YWx1ZSBhbmQgb3VyIG93biB0ZXN0c1xyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0IHRoYXQgdGhlIHBhcmFtZXRlciBsZW5ndGggaXMgMVxyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZU1vY2tVc2VyVG9rZW4odG9rZW4sIHByb2plY3RJZCkge1xyXG4gICAgaWYgKHRva2VuLnVpZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIFwidWlkXCIgZmllbGQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBieSBtb2NrVXNlclRva2VuLiBQbGVhc2UgdXNlIFwic3ViXCIgaW5zdGVhZCBmb3IgRmlyZWJhc2UgQXV0aCBVc2VyIElELicpO1xyXG4gICAgfVxyXG4gICAgLy8gVW5zZWN1cmVkIEpXVHMgdXNlIFwibm9uZVwiIGFzIHRoZSBhbGdvcml0aG0uXHJcbiAgICBjb25zdCBoZWFkZXIgPSB7XHJcbiAgICAgICAgYWxnOiAnbm9uZScsXHJcbiAgICAgICAgdHlwZTogJ0pXVCdcclxuICAgIH07XHJcbiAgICBjb25zdCBwcm9qZWN0ID0gcHJvamVjdElkIHx8ICdkZW1vLXByb2plY3QnO1xyXG4gICAgY29uc3QgaWF0ID0gdG9rZW4uaWF0IHx8IDA7XHJcbiAgICBjb25zdCBzdWIgPSB0b2tlbi5zdWIgfHwgdG9rZW4udXNlcl9pZDtcclxuICAgIGlmICghc3ViKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibW9ja1VzZXJUb2tlbiBtdXN0IGNvbnRhaW4gJ3N1Yicgb3IgJ3VzZXJfaWQnIGZpZWxkIVwiKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHBheWxvYWQgPSBPYmplY3QuYXNzaWduKHsgXHJcbiAgICAgICAgLy8gU2V0IGFsbCByZXF1aXJlZCBmaWVsZHMgdG8gZGVjZW50IGRlZmF1bHRzXHJcbiAgICAgICAgaXNzOiBgaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tLyR7cHJvamVjdH1gLCBhdWQ6IHByb2plY3QsIGlhdCwgZXhwOiBpYXQgKyAzNjAwLCBhdXRoX3RpbWU6IGlhdCwgc3ViLCB1c2VyX2lkOiBzdWIsIGZpcmViYXNlOiB7XHJcbiAgICAgICAgICAgIHNpZ25faW5fcHJvdmlkZXI6ICdjdXN0b20nLFxyXG4gICAgICAgICAgICBpZGVudGl0aWVzOiB7fVxyXG4gICAgICAgIH0gfSwgdG9rZW4pO1xyXG4gICAgLy8gVW5zZWN1cmVkIEpXVHMgdXNlIHRoZSBlbXB0eSBzdHJpbmcgYXMgYSBzaWduYXR1cmUuXHJcbiAgICBjb25zdCBzaWduYXR1cmUgPSAnJztcclxuICAgIHJldHVybiBbXHJcbiAgICAgICAgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkoaGVhZGVyKSksXHJcbiAgICAgICAgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpLFxyXG4gICAgICAgIHNpZ25hdHVyZVxyXG4gICAgXS5qb2luKCcuJyk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgU3RhbmRhcmRpemVkIEZpcmViYXNlIEVycm9yLlxyXG4gKlxyXG4gKiBVc2FnZTpcclxuICpcclxuICogICAvLyBUeXBlc2NyaXB0IHN0cmluZyBsaXRlcmFscyBmb3IgdHlwZS1zYWZlIGNvZGVzXHJcbiAqICAgdHlwZSBFcnIgPVxyXG4gKiAgICAgJ3Vua25vd24nIHxcclxuICogICAgICdvYmplY3Qtbm90LWZvdW5kJ1xyXG4gKiAgICAgO1xyXG4gKlxyXG4gKiAgIC8vIENsb3N1cmUgZW51bSBmb3IgdHlwZS1zYWZlIGVycm9yIGNvZGVzXHJcbiAqICAgLy8gYXQtZW51bSB7c3RyaW5nfVxyXG4gKiAgIHZhciBFcnIgPSB7XHJcbiAqICAgICBVTktOT1dOOiAndW5rbm93bicsXHJcbiAqICAgICBPQkpFQ1RfTk9UX0ZPVU5EOiAnb2JqZWN0LW5vdC1mb3VuZCcsXHJcbiAqICAgfVxyXG4gKlxyXG4gKiAgIGxldCBlcnJvcnM6IE1hcDxFcnIsIHN0cmluZz4gPSB7XHJcbiAqICAgICAnZ2VuZXJpYy1lcnJvcic6IFwiVW5rbm93biBlcnJvclwiLFxyXG4gKiAgICAgJ2ZpbGUtbm90LWZvdW5kJzogXCJDb3VsZCBub3QgZmluZCBmaWxlOiB7JGZpbGV9XCIsXHJcbiAqICAgfTtcclxuICpcclxuICogICAvLyBUeXBlLXNhZmUgZnVuY3Rpb24gLSBtdXN0IHBhc3MgYSB2YWxpZCBlcnJvciBjb2RlIGFzIHBhcmFtLlxyXG4gKiAgIGxldCBlcnJvciA9IG5ldyBFcnJvckZhY3Rvcnk8RXJyPignc2VydmljZScsICdTZXJ2aWNlJywgZXJyb3JzKTtcclxuICpcclxuICogICAuLi5cclxuICogICB0aHJvdyBlcnJvci5jcmVhdGUoRXJyLkdFTkVSSUMpO1xyXG4gKiAgIC4uLlxyXG4gKiAgIHRocm93IGVycm9yLmNyZWF0ZShFcnIuRklMRV9OT1RfRk9VTkQsIHsnZmlsZSc6IGZpbGVOYW1lfSk7XHJcbiAqICAgLi4uXHJcbiAqICAgLy8gU2VydmljZTogQ291bGQgbm90IGZpbGUgZmlsZTogZm9vLnR4dCAoc2VydmljZS9maWxlLW5vdC1mb3VuZCkuXHJcbiAqXHJcbiAqICAgY2F0Y2ggKGUpIHtcclxuICogICAgIGFzc2VydChlLm1lc3NhZ2UgPT09IFwiQ291bGQgbm90IGZpbmQgZmlsZTogZm9vLnR4dC5cIik7XHJcbiAqICAgICBpZiAoKGUgYXMgRmlyZWJhc2VFcnJvcik/LmNvZGUgPT09ICdzZXJ2aWNlL2ZpbGUtbm90LWZvdW5kJykge1xyXG4gKiAgICAgICBjb25zb2xlLmxvZyhcIkNvdWxkIG5vdCByZWFkIGZpbGU6IFwiICsgZVsnZmlsZSddKTtcclxuICogICAgIH1cclxuICogICB9XHJcbiAqL1xyXG5jb25zdCBFUlJPUl9OQU1FID0gJ0ZpcmViYXNlRXJyb3InO1xyXG4vLyBCYXNlZCBvbiBjb2RlIGZyb206XHJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yI0N1c3RvbV9FcnJvcl9UeXBlc1xyXG5jbGFzcyBGaXJlYmFzZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAvKiogVGhlIGVycm9yIGNvZGUgZm9yIHRoaXMgZXJyb3IuICovXHJcbiAgICBjb2RlLCBtZXNzYWdlLCBcclxuICAgIC8qKiBDdXN0b20gZGF0YSBmb3IgdGhpcyBlcnJvci4gKi9cclxuICAgIGN1c3RvbURhdGEpIHtcclxuICAgICAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IGN1c3RvbURhdGE7XHJcbiAgICAgICAgLyoqIFRoZSBjdXN0b20gbmFtZSBmb3IgYWxsIEZpcmViYXNlRXJyb3JzLiAqL1xyXG4gICAgICAgIHRoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgLy8gRml4IEZvciBFUzVcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQtd2lraS9ibG9iL21hc3Rlci9CcmVha2luZy1DaGFuZ2VzLm1kI2V4dGVuZGluZy1idWlsdC1pbnMtbGlrZS1lcnJvci1hcnJheS1hbmQtbWFwLW1heS1uby1sb25nZXItd29ya1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBGaXJlYmFzZUVycm9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24uXHJcbiAgICAgICAgLy8gT25seSBhdmFpbGFibGUgb24gVjguXHJcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XHJcbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY2xhc3MgRXJyb3JGYWN0b3J5IHtcclxuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgIH1cclxuICAgIGNyZWF0ZShjb2RlLCAuLi5kYXRhKSB7XHJcbiAgICAgICAgY29uc3QgY3VzdG9tRGF0YSA9IGRhdGFbMF0gfHwge307XHJcbiAgICAgICAgY29uc3QgZnVsbENvZGUgPSBgJHt0aGlzLnNlcnZpY2V9LyR7Y29kZX1gO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHRlbXBsYXRlID8gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlLCBjdXN0b21EYXRhKSA6ICdFcnJvcic7XHJcbiAgICAgICAgLy8gU2VydmljZSBOYW1lOiBFcnJvciBtZXNzYWdlIChzZXJ2aWNlL2NvZGUpLlxyXG4gICAgICAgIGNvbnN0IGZ1bGxNZXNzYWdlID0gYCR7dGhpcy5zZXJ2aWNlTmFtZX06ICR7bWVzc2FnZX0gKCR7ZnVsbENvZGV9KS5gO1xyXG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEZpcmViYXNlRXJyb3IoZnVsbENvZGUsIGZ1bGxNZXNzYWdlLCBjdXN0b21EYXRhKTtcclxuICAgICAgICByZXR1cm4gZXJyb3I7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlLCBkYXRhKSB7XHJcbiAgICByZXR1cm4gdGVtcGxhdGUucmVwbGFjZShQQVRURVJOLCAoXywga2V5KSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2tleV07XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgPyBTdHJpbmcodmFsdWUpIDogYDwke2tleX0/PmA7XHJcbiAgICB9KTtcclxufVxyXG5jb25zdCBQQVRURVJOID0gL1xce1xcJChbXn1dKyl9L2c7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSBzdHJpbmcgY29udGFpbmluZyBKU09OLlxyXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cclxuICovXHJcbmZ1bmN0aW9uIGpzb25FdmFsKHN0cikge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIEpTT04gY29udGVudHMgb2YgdGhlIG9iamVjdC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxuY29uc3QgZGVjb2RlID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBsZXQgaGVhZGVyID0ge30sIGNsYWltcyA9IHt9LCBkYXRhID0ge30sIHNpZ25hdHVyZSA9ICcnO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgaGVhZGVyID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzBdKSB8fCAnJyk7XHJcbiAgICAgICAgY2xhaW1zID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzFdKSB8fCAnJyk7XHJcbiAgICAgICAgc2lnbmF0dXJlID0gcGFydHNbMl07XHJcbiAgICAgICAgZGF0YSA9IGNsYWltc1snZCddIHx8IHt9O1xyXG4gICAgICAgIGRlbGV0ZSBjbGFpbXNbJ2QnXTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7IH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaGVhZGVyLFxyXG4gICAgICAgIGNsYWltcyxcclxuICAgICAgICBkYXRhLFxyXG4gICAgICAgIHNpZ25hdHVyZVxyXG4gICAgfTtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgdGltZS1iYXNlZCBjbGFpbXMuIFdpbGwgcmV0dXJuIHRydWUgaWYgdGhlXHJcbiAqIHRva2VuIGlzIHdpdGhpbiB0aGUgdGltZSB3aW5kb3cgYXV0aG9yaXplZCBieSB0aGUgJ25iZicgKG5vdC1iZWZvcmUpIGFuZCAnaWF0JyAoaXNzdWVkLWF0KSBjbGFpbXMuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICovXHJcbmNvbnN0IGlzVmFsaWRUaW1lc3RhbXAgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIGNvbnN0IGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xyXG4gICAgbGV0IHZhbGlkU2luY2UgPSAwLCB2YWxpZFVudGlsID0gMDtcclxuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ25iZicpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ25iZiddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ2lhdCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdleHAnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFVudGlsID0gY2xhaW1zWydleHAnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRva2VuIHdpbGwgZXhwaXJlIGFmdGVyIDI0aCBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSB2YWxpZFNpbmNlICsgODY0MDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICghIW5vdyAmJlxyXG4gICAgICAgICEhdmFsaWRTaW5jZSAmJlxyXG4gICAgICAgICEhdmFsaWRVbnRpbCAmJlxyXG4gICAgICAgIG5vdyA+PSB2YWxpZFNpbmNlICYmXHJcbiAgICAgICAgbm93IDw9IHZhbGlkVW50aWwpO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCByZXR1cm5zIGl0cyBpc3N1ZWQgYXQgdGltZSBpZiB2YWxpZCwgbnVsbCBvdGhlcndpc2UuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gbnVsbCBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICovXHJcbmNvbnN0IGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgY29uc3QgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XHJcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSkge1xyXG4gICAgICAgIHJldHVybiBjbGFpbXNbJ2lhdCddO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIGZvcm1hdC4gRXhwZWN0cyBhIHZhbGlkIGlzc3VlZC1hdCB0aW1lLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkRm9ybWF0ID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XHJcbiAgICByZXR1cm4gISFjbGFpbXMgJiYgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKTtcclxufTtcclxuLyoqXHJcbiAqIEF0dGVtcHRzIHRvIHBlZXIgaW50byBhbiBhdXRoIHRva2VuIGFuZCBkZXRlcm1pbmUgaWYgaXQncyBhbiBhZG1pbiBhdXRoIHRva2VuIGJ5IGxvb2tpbmcgYXQgdGhlIGNsYWltcyBwb3J0aW9uLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc0FkbWluID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBjb25zdCBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIHJldHVybiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXNbJ2FkbWluJ10gPT09IHRydWU7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGNvbnRhaW5zKG9iaiwga2V5KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcclxufVxyXG5mdW5jdGlvbiBzYWZlR2V0KG9iaiwga2V5KSB7XHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBtYXAob2JqLCBmbiwgY29udGV4dE9iaikge1xyXG4gICAgY29uc3QgcmVzID0ge307XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICByZXNba2V5XSA9IGZuLmNhbGwoY29udGV4dE9iaiwgb2JqW2tleV0sIGtleSwgb2JqKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qKlxyXG4gKiBEZWVwIGVxdWFsIHR3byBvYmplY3RzLiBTdXBwb3J0IEFycmF5cyBhbmQgT2JqZWN0cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBFcXVhbChhLCBiKSB7XHJcbiAgICBpZiAoYSA9PT0gYikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIGNvbnN0IGJLZXlzID0gT2JqZWN0LmtleXMoYik7XHJcbiAgICBmb3IgKGNvbnN0IGsgb2YgYUtleXMpIHtcclxuICAgICAgICBpZiAoIWJLZXlzLmluY2x1ZGVzKGspKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYVByb3AgPSBhW2tdO1xyXG4gICAgICAgIGNvbnN0IGJQcm9wID0gYltrXTtcclxuICAgICAgICBpZiAoaXNPYmplY3QoYVByb3ApICYmIGlzT2JqZWN0KGJQcm9wKSkge1xyXG4gICAgICAgICAgICBpZiAoIWRlZXBFcXVhbChhUHJvcCwgYlByb3ApKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYVByb3AgIT09IGJQcm9wKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKGNvbnN0IGsgb2YgYktleXMpIHtcclxuICAgICAgICBpZiAoIWFLZXlzLmluY2x1ZGVzKGspKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBpc09iamVjdCh0aGluZykge1xyXG4gICAgcmV0dXJuIHRoaW5nICE9PSBudWxsICYmIHR5cGVvZiB0aGluZyA9PT0gJ29iamVjdCc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJlamVjdHMgaWYgdGhlIGdpdmVuIHByb21pc2UgZG9lc24ndCByZXNvbHZlIGluIHRpbWVJbk1TIG1pbGxpc2Vjb25kcy5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBwcm9taXNlV2l0aFRpbWVvdXQocHJvbWlzZSwgdGltZUluTVMgPSAyMDAwKSB7XHJcbiAgICBjb25zdCBkZWZlcnJlZFByb21pc2UgPSBuZXcgRGVmZXJyZWQoKTtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gZGVmZXJyZWRQcm9taXNlLnJlamVjdCgndGltZW91dCEnKSwgdGltZUluTVMpO1xyXG4gICAgcHJvbWlzZS50aGVuKGRlZmVycmVkUHJvbWlzZS5yZXNvbHZlLCBkZWZlcnJlZFByb21pc2UucmVqZWN0KTtcclxuICAgIHJldHVybiBkZWZlcnJlZFByb21pc2UucHJvbWlzZTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBhIHF1ZXJ5c3RyaW5nLWZvcm1hdHRlZCBzdHJpbmcgKGUuZy4gJmFyZz12YWwmYXJnMj12YWwyKSBmcm9tIGFcclxuICogcGFyYW1zIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICogTm90ZTogWW91IG11c3QgcHJlcGVuZCBpdCB3aXRoID8gd2hlbiBhZGRpbmcgaXQgdG8gYSBVUkwuXHJcbiAqL1xyXG5mdW5jdGlvbiBxdWVyeXN0cmluZyhxdWVyeXN0cmluZ1BhcmFtcykge1xyXG4gICAgY29uc3QgcGFyYW1zID0gW107XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhxdWVyeXN0cmluZ1BhcmFtcykpIHtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgdmFsdWUuZm9yRWFjaChhcnJheVZhbCA9PiB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChhcnJheVZhbCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBhcmFtcy5sZW5ndGggPyAnJicgKyBwYXJhbXMuam9pbignJicpIDogJyc7XHJcbn1cclxuLyoqXHJcbiAqIERlY29kZXMgYSBxdWVyeXN0cmluZyAoZS5nLiA/YXJnPXZhbCZhcmcyPXZhbDIpIGludG8gYSBwYXJhbXMgb2JqZWN0XHJcbiAqIChlLmcuIHthcmc6ICd2YWwnLCBhcmcyOiAndmFsMid9KVxyXG4gKi9cclxuZnVuY3Rpb24gcXVlcnlzdHJpbmdEZWNvZGUocXVlcnlzdHJpbmcpIHtcclxuICAgIGNvbnN0IG9iaiA9IHt9O1xyXG4gICAgY29uc3QgdG9rZW5zID0gcXVlcnlzdHJpbmcucmVwbGFjZSgvXlxcPy8sICcnKS5zcGxpdCgnJicpO1xyXG4gICAgdG9rZW5zLmZvckVhY2godG9rZW4gPT4ge1xyXG4gICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSB0b2tlbi5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgICBvYmpbZGVjb2RlVVJJQ29tcG9uZW50KGtleSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBvYmo7XHJcbn1cclxuLyoqXHJcbiAqIEV4dHJhY3QgdGhlIHF1ZXJ5IHN0cmluZyBwYXJ0IG9mIGEgVVJMLCBpbmNsdWRpbmcgdGhlIGxlYWRpbmcgcXVlc3Rpb24gbWFyayAoaWYgcHJlc2VudCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0UXVlcnlzdHJpbmcodXJsKSB7XHJcbiAgICBjb25zdCBxdWVyeVN0YXJ0ID0gdXJsLmluZGV4T2YoJz8nKTtcclxuICAgIGlmICghcXVlcnlTdGFydCkge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuICAgIGNvbnN0IGZyYWdtZW50U3RhcnQgPSB1cmwuaW5kZXhPZignIycsIHF1ZXJ5U3RhcnQpO1xyXG4gICAgcmV0dXJuIHVybC5zdWJzdHJpbmcocXVlcnlTdGFydCwgZnJhZ21lbnRTdGFydCA+IDAgPyBmcmFnbWVudFN0YXJ0IDogdW5kZWZpbmVkKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2guXHJcbiAqIFZhcmlhYmxlIG5hbWVzIGZvbGxvdyB0aGUgbm90YXRpb24gaW4gRklQUyBQVUIgMTgwLTM6XHJcbiAqIGh0dHA6Ly9jc3JjLm5pc3QuZ292L3B1YmxpY2F0aW9ucy9maXBzL2ZpcHMxODAtMy9maXBzMTgwLTNfZmluYWwucGRmLlxyXG4gKlxyXG4gKiBVc2FnZTpcclxuICogICB2YXIgc2hhMSA9IG5ldyBzaGExKCk7XHJcbiAqICAgc2hhMS51cGRhdGUoYnl0ZXMpO1xyXG4gKiAgIHZhciBoYXNoID0gc2hhMS5kaWdlc3QoKTtcclxuICpcclxuICogUGVyZm9ybWFuY2U6XHJcbiAqICAgQ2hyb21lIDIzOiAgIH40MDAgTWJpdC9zXHJcbiAqICAgRmlyZWZveCAxNjogIH4yNTAgTWJpdC9zXHJcbiAqXHJcbiAqL1xyXG4vKipcclxuICogU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoIGNvbnN0cnVjdG9yLlxyXG4gKlxyXG4gKiBUaGUgcHJvcGVydGllcyBkZWNsYXJlZCBoZXJlIGFyZSBkaXNjdXNzZWQgaW4gdGhlIGFib3ZlIGFsZ29yaXRobSBkb2N1bWVudC5cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBmaW5hbFxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG5jbGFzcyBTaGExIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEhvbGRzIHRoZSBwcmV2aW91cyB2YWx1ZXMgb2YgYWNjdW11bGF0ZWQgdmFyaWFibGVzIGEtZSBpbiB0aGUgY29tcHJlc3NfXHJcbiAgICAgICAgICogZnVuY3Rpb24uXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNoYWluXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgYnVmZmVyIGhvbGRpbmcgdGhlIHBhcnRpYWxseSBjb21wdXRlZCBoYXNoIHJlc3VsdC5cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuYnVmXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIGFycmF5IG9mIDgwIGJ5dGVzLCBlYWNoIGEgcGFydCBvZiB0aGUgbWVzc2FnZSB0byBiZSBoYXNoZWQuICBSZWZlcnJlZCB0b1xyXG4gICAgICAgICAqIGFzIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGluIHRoZSBkb2NzLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5XXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnRhaW5zIGRhdGEgbmVlZGVkIHRvIHBhZCBtZXNzYWdlcyBsZXNzIHRoYW4gNjQgYnl0ZXMuXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBhZF8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuaW5idWZfID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudG90YWxfID0gMDtcclxuICAgICAgICB0aGlzLmJsb2NrU2l6ZSA9IDUxMiAvIDg7XHJcbiAgICAgICAgdGhpcy5wYWRfWzBdID0gMTI4O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGhpcy5ibG9ja1NpemU7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZF9baV0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICB9XHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9IDB4Njc0NTIzMDE7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAweGVmY2RhYjg5O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gMHg5OGJhZGNmZTtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9IDB4MTAzMjU0NzY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAweGMzZDJlMWYwO1xyXG4gICAgICAgIHRoaXMuaW5idWZfID0gMDtcclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIGNvbXByZXNzIGhlbHBlciBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXHJcbiAgICAgKiBAcGFyYW0gb2Zmc2V0IE9mZnNldCBvZiB0aGUgYmxvY2sgaW4gdGhlIGJ1ZmZlci5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbXByZXNzXyhidWYsIG9mZnNldCkge1xyXG4gICAgICAgIGlmICghb2Zmc2V0KSB7XHJcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IFcgPSB0aGlzLldfO1xyXG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBhIGJ1ZyB0aGF0IHR1cm5zIHRoZSBwb3N0LWluY3JlbWVudCArKyBvcGVyYXRvciBpbnRvIHByZS1pbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGR1cmluZyBKSVQgY29tcGlsYXRpb24uICBXZSBoYXZlIGNvZGUgdGhhdCBkZXBlbmRzIGhlYXZpbHkgb24gU0hBLTEgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xyXG4gICAgICAgICAgICAgICAgLy8gb2YgcG9zdC1pbmNyZW1lbnQgKysgaW4gd2hpY2ggdGhlIHJlc3VsdCB2YWx1ZSBpcyB1c2VkLiAgV2UgY2FuIHJldmVydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2Ugb25jZSB0aGUgU2FmYXJpIGJ1Z1xyXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBjbGllbnRzIGhhdmUgYmVlbiB1cGRhdGVkLlxyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCkgPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDEpIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAyKSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDMpO1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXRdIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXQgKyAyXSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvZmZzZXQgKyAzXTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgdCA9IFdbaSAtIDNdIF4gV1tpIC0gOF0gXiBXW2kgLSAxNF0gXiBXW2kgLSAxNl07XHJcbiAgICAgICAgICAgIFdbaV0gPSAoKHQgPDwgMSkgfCAodCA+Pj4gMzEpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBhID0gdGhpcy5jaGFpbl9bMF07XHJcbiAgICAgICAgbGV0IGIgPSB0aGlzLmNoYWluX1sxXTtcclxuICAgICAgICBsZXQgYyA9IHRoaXMuY2hhaW5fWzJdO1xyXG4gICAgICAgIGxldCBkID0gdGhpcy5jaGFpbl9bM107XHJcbiAgICAgICAgbGV0IGUgPSB0aGlzLmNoYWluX1s0XTtcclxuICAgICAgICBsZXQgZiwgaztcclxuICAgICAgICAvLyBUT0RPKHVzZXIpOiBUcnkgdG8gdW5yb2xsIHRoaXMgbG9vcCB0byBzcGVlZCB1cCB0aGUgY29tcHV0YXRpb24uXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpIDwgNDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgMjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gZCBeIChiICYgKGMgXiBkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NWE4Mjc5OTk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDZlZDllYmExO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSAoYiAmIGMpIHwgKGQgJiAoYiB8IGMpKTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg4ZjFiYmNkYztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4Y2E2MmMxZDY7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdCA9ICgoKGEgPDwgNSkgfCAoYSA+Pj4gMjcpKSArIGYgKyBlICsgayArIFdbaV0pICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgZSA9IGQ7XHJcbiAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICBjID0gKChiIDw8IDMwKSB8IChiID4+PiAyKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBiID0gYTtcclxuICAgICAgICAgICAgYSA9IHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gKHRoaXMuY2hhaW5fWzFdICsgYikgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gKHRoaXMuY2hhaW5fWzJdICsgYykgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gKHRoaXMuY2hhaW5fWzRdICsgZSkgJiAweGZmZmZmZmZmO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlKGJ5dGVzLCBsZW5ndGgpIHtcclxuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xyXG4gICAgICAgIGlmIChieXRlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbGVuZ3RoTWludXNCbG9jayA9IGxlbmd0aCAtIHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAvLyBVc2luZyBsb2NhbCBpbnN0ZWFkIG9mIG1lbWJlciB2YXJpYWJsZXMgZ2l2ZXMgfjUlIHNwZWVkdXAgb24gRmlyZWZveCAxNi5cclxuICAgICAgICBjb25zdCBidWYgPSB0aGlzLmJ1Zl87XHJcbiAgICAgICAgbGV0IGluYnVmID0gdGhpcy5pbmJ1Zl87XHJcbiAgICAgICAgLy8gVGhlIG91dGVyIHdoaWxlIGxvb3Agc2hvdWxkIGV4ZWN1dGUgYXQgbW9zdCB0d2ljZS5cclxuICAgICAgICB3aGlsZSAobiA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAvLyBXaGVuIHdlIGhhdmUgbm8gZGF0YSBpbiB0aGUgYmxvY2sgdG8gdG9wIHVwLCB3ZSBjYW4gZGlyZWN0bHkgcHJvY2VzcyB0aGVcclxuICAgICAgICAgICAgLy8gaW5wdXQgYnVmZmVyIChhc3N1bWluZyBpdCBjb250YWlucyBzdWZmaWNpZW50IGRhdGEpLiBUaGlzIGdpdmVzIH4yNSVcclxuICAgICAgICAgICAgLy8gc3BlZWR1cCBvbiBDaHJvbWUgMjMgYW5kIH4xNSUgc3BlZWR1cCBvbiBGaXJlZm94IDE2LCBidXQgcmVxdWlyZXMgdGhhdFxyXG4gICAgICAgICAgICAvLyB0aGUgZGF0YSBpcyBwcm92aWRlZCBpbiBsYXJnZSBjaHVua3MgKG9yIGluIG11bHRpcGxlcyBvZiA2NCBieXRlcykuXHJcbiAgICAgICAgICAgIGlmIChpbmJ1ZiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPD0gbGVuZ3RoTWludXNCbG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ5dGVzLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBuICs9IHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlcy5jaGFyQ29kZUF0KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzW25dO1xyXG4gICAgICAgICAgICAgICAgICAgICsraW5idWY7XHJcbiAgICAgICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmJ1ZiA9PT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluYnVmXyA9IGluYnVmO1xyXG4gICAgICAgIHRoaXMudG90YWxfICs9IGxlbmd0aDtcclxuICAgIH1cclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIGRpZ2VzdCgpIHtcclxuICAgICAgICBjb25zdCBkaWdlc3QgPSBbXTtcclxuICAgICAgICBsZXQgdG90YWxCaXRzID0gdGhpcy50b3RhbF8gKiA4O1xyXG4gICAgICAgIC8vIEFkZCBwYWQgMHg4MCAweDAwKi5cclxuICAgICAgICBpZiAodGhpcy5pbmJ1Zl8gPCA1Nikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIDU2IC0gdGhpcy5pbmJ1Zl8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCB0aGlzLmJsb2NrU2l6ZSAtICh0aGlzLmluYnVmXyAtIDU2KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFkZCAjIGJpdHMuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMuYmxvY2tTaXplIC0gMTsgaSA+PSA1NjsgaS0tKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnVmX1tpXSA9IHRvdGFsQml0cyAmIDI1NTtcclxuICAgICAgICAgICAgdG90YWxCaXRzIC89IDI1NjsgLy8gRG9uJ3QgdXNlIGJpdC1zaGlmdGluZyBoZXJlIVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbXByZXNzXyh0aGlzLmJ1Zl8pO1xyXG4gICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMjQ7IGogPj0gMDsgaiAtPSA4KSB7XHJcbiAgICAgICAgICAgICAgICBkaWdlc3Rbbl0gPSAodGhpcy5jaGFpbl9baV0gPj4gaikgJiAyNTU7XHJcbiAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRpZ2VzdDtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogSGVscGVyIHRvIG1ha2UgYSBTdWJzY3JpYmUgZnVuY3Rpb24gKGp1c3QgbGlrZSBQcm9taXNlIGhlbHBzIG1ha2UgYVxyXG4gKiBUaGVuYWJsZSkuXHJcbiAqXHJcbiAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxyXG4gKiAgICAgYXMgYSBwcm94eS5cclxuICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlU3Vic2NyaWJlKGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XHJcbiAgICBjb25zdCBwcm94eSA9IG5ldyBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKTtcclxuICAgIHJldHVybiBwcm94eS5zdWJzY3JpYmUuYmluZChwcm94eSk7XHJcbn1cclxuLyoqXHJcbiAqIEltcGxlbWVudCBmYW4tb3V0IGZvciBhbnkgbnVtYmVyIG9mIE9ic2VydmVycyBhdHRhY2hlZCB2aWEgYSBzdWJzY3JpYmVcclxuICogZnVuY3Rpb24uXHJcbiAqL1xyXG5jbGFzcyBPYnNlcnZlclByb3h5IHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAgICAgKiAgICAgYXMgYSBwcm94eS5cclxuICAgICAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcclxuICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVzID0gW107XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckNvdW50ID0gMDtcclxuICAgICAgICAvLyBNaWNyby10YXNrIHNjaGVkdWxpbmcgYnkgY2FsbGluZyB0YXNrLnRoZW4oKS5cclxuICAgICAgICB0aGlzLnRhc2sgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub25Ob09ic2VydmVycyA9IG9uTm9PYnNlcnZlcnM7XHJcbiAgICAgICAgLy8gQ2FsbCB0aGUgZXhlY3V0b3IgYXN5bmNocm9ub3VzbHkgc28gc3Vic2NyaWJlcnMgdGhhdCBhcmUgY2FsbGVkXHJcbiAgICAgICAgLy8gc3luY2hyb25vdXNseSBhZnRlciB0aGUgY3JlYXRpb24gb2YgdGhlIHN1YnNjcmliZSBmdW5jdGlvblxyXG4gICAgICAgIC8vIGNhbiBzdGlsbCByZWNlaXZlIHRoZSB2ZXJ5IGZpcnN0IHZhbHVlIGdlbmVyYXRlZCBpbiB0aGUgZXhlY3V0b3IuXHJcbiAgICAgICAgdGhpcy50YXNrXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgZXhlY3V0b3IodGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yKGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgbmV4dCh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVycm9yKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoKG9ic2VydmVyKSA9PiB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKGVycm9yKTtcclxuICAgIH1cclxuICAgIGNvbXBsZXRlKCkge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3Vic2NyaWJlIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWRkIGFuIE9ic2VydmVyIHRvIHRoZSBmYW4tb3V0IGxpc3QuXHJcbiAgICAgKlxyXG4gICAgICogLSBXZSByZXF1aXJlIHRoYXQgbm8gZXZlbnQgaXMgc2VudCB0byBhIHN1YnNjcmliZXIgc3ljaHJvbm91c2x5IHRvIHRoZWlyXHJcbiAgICAgKiAgIGNhbGwgdG8gc3Vic2NyaWJlKCkuXHJcbiAgICAgKi9cclxuICAgIHN1YnNjcmliZShuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7XHJcbiAgICAgICAgbGV0IG9ic2VydmVyO1xyXG4gICAgICAgIGlmIChuZXh0T3JPYnNlcnZlciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGVycm9yID09PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICAgY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgT2JzZXJ2ZXIuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFzc2VtYmxlIGFuIE9ic2VydmVyIG9iamVjdCB3aGVuIHBhc3NlZCBhcyBjYWxsYmFjayBmdW5jdGlvbnMuXHJcbiAgICAgICAgaWYgKGltcGxlbWVudHNBbnlNZXRob2RzKG5leHRPck9ic2VydmVyLCBbXHJcbiAgICAgICAgICAgICduZXh0JyxcclxuICAgICAgICAgICAgJ2Vycm9yJyxcclxuICAgICAgICAgICAgJ2NvbXBsZXRlJ1xyXG4gICAgICAgIF0pKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IHtcclxuICAgICAgICAgICAgICAgIG5leHQ6IG5leHRPck9ic2VydmVyLFxyXG4gICAgICAgICAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvciA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgdW5zdWIgPSB0aGlzLnVuc3Vic2NyaWJlT25lLmJpbmQodGhpcywgdGhpcy5vYnNlcnZlcnMubGVuZ3RoKTtcclxuICAgICAgICAvLyBBdHRlbXB0IHRvIHN1YnNjcmliZSB0byBhIHRlcm1pbmF0ZWQgT2JzZXJ2YWJsZSAtIHdlXHJcbiAgICAgICAgLy8ganVzdCByZXNwb25kIHRvIHRoZSBPYnNlcnZlciB3aXRoIHRoZSBmaW5hbCBlcnJvciBvciBjb21wbGV0ZVxyXG4gICAgICAgIC8vIGV2ZW50LlxyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgICAgIHRoaXMudGFzay50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZmluYWxFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcih0aGlzLmZpbmFsRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gICAgICAgIHJldHVybiB1bnN1YjtcclxuICAgIH1cclxuICAgIC8vIFVuc3Vic2NyaWJlIGlzIHN5bmNocm9ub3VzIC0gd2UgZ3VhcmFudGVlIHRoYXQgbm8gZXZlbnRzIGFyZSBzZW50IHRvXHJcbiAgICAvLyBhbnkgdW5zdWJzY3JpYmVkIE9ic2VydmVyLlxyXG4gICAgdW5zdWJzY3JpYmVPbmUoaSkge1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVycyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMub2JzZXJ2ZXJzW2ldID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWxldGUgdGhpcy5vYnNlcnZlcnNbaV07XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckNvdW50IC09IDE7XHJcbiAgICAgICAgaWYgKHRoaXMub2JzZXJ2ZXJDb3VudCA9PT0gMCAmJiB0aGlzLm9uTm9PYnNlcnZlcnMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnModGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yRWFjaE9ic2VydmVyKGZuKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XHJcbiAgICAgICAgICAgIC8vIEFscmVhZHkgY2xvc2VkIGJ5IHByZXZpb3VzIGV2ZW50Li4uLmp1c3QgZWF0IHRoZSBhZGRpdGlvbmFsIHZhbHVlcy5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTaW5jZSBzZW5kT25lIGNhbGxzIGFzeW5jaHJvbm91c2x5IC0gdGhlcmUgaXMgbm8gY2hhbmNlIHRoYXRcclxuICAgICAgICAvLyB0aGlzLm9ic2VydmVycyB3aWxsIGJlY29tZSB1bmRlZmluZWQuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9ic2VydmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRPbmUoaSwgZm4pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIENhbGwgdGhlIE9ic2VydmVyIHZpYSBvbmUgb2YgaXQncyBjYWxsYmFjayBmdW5jdGlvbi4gV2UgYXJlIGNhcmVmdWwgdG9cclxuICAgIC8vIGNvbmZpcm0gdGhhdCB0aGUgb2JzZXJ2ZSBoYXMgbm90IGJlZW4gdW5zdWJzY3JpYmVkIHNpbmNlIHRoaXMgYXN5bmNocm9ub3VzXHJcbiAgICAvLyBmdW5jdGlvbiBoYWQgYmVlbiBxdWV1ZWQuXHJcbiAgICBzZW5kT25lKGksIGZuKSB7XHJcbiAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY2FsbGJhY2sgYXN5bmNocm9ub3VzbHlcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLm9ic2VydmVyc1tpXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZuKHRoaXMub2JzZXJ2ZXJzW2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGV4Y2VwdGlvbnMgcmFpc2VkIGluIE9ic2VydmVycyBvciBtaXNzaW5nIG1ldGhvZHMgb2YgYW5cclxuICAgICAgICAgICAgICAgICAgICAvLyBPYnNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICAvLyBMb2cgZXJyb3IgdG8gY29uc29sZS4gYi8zMTQwNDgwNlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZS5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY2xvc2UoZXJyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSB0cnVlO1xyXG4gICAgICAgIGlmIChlcnIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpbmFsRXJyb3IgPSBlcnI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFByb3h5IGlzIG5vIGxvbmdlciBuZWVkZWQgLSBnYXJiYWdlIGNvbGxlY3QgcmVmZXJlbmNlc1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLyoqIFR1cm4gc3luY2hyb25vdXMgZnVuY3Rpb24gaW50byBvbmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5LiAqL1xyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xyXG5mdW5jdGlvbiBhc3luYyhmbiwgb25FcnJvcikge1xyXG4gICAgcmV0dXJuICguLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHRydWUpXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgZm4oLi4uYXJncyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBvYmplY3QgcGFzc2VkIGluIGltcGxlbWVudHMgYW55IG9mIHRoZSBuYW1lZCBtZXRob2RzLlxyXG4gKi9cclxuZnVuY3Rpb24gaW1wbGVtZW50c0FueU1ldGhvZHMob2JqLCBtZXRob2RzKSB7XHJcbiAgICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBtZXRob2Qgb2YgbWV0aG9kcykge1xyXG4gICAgICAgIGlmIChtZXRob2QgaW4gb2JqICYmIHR5cGVvZiBvYmpbbWV0aG9kXSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuZnVuY3Rpb24gbm9vcCgpIHtcclxuICAgIC8vIGRvIG5vdGhpbmdcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQ2hlY2sgdG8gbWFrZSBzdXJlIHRoZSBhcHByb3ByaWF0ZSBudW1iZXIgb2YgYXJndW1lbnRzIGFyZSBwcm92aWRlZCBmb3IgYSBwdWJsaWMgZnVuY3Rpb24uXHJcbiAqIFRocm93cyBhbiBlcnJvciBpZiBpdCBmYWlscy5cclxuICpcclxuICogQHBhcmFtIGZuTmFtZSBUaGUgZnVuY3Rpb24gbmFtZVxyXG4gKiBAcGFyYW0gbWluQ291bnQgVGhlIG1pbmltdW0gbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcclxuICogQHBhcmFtIG1heENvdW50IFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVudCB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcclxuICogQHBhcmFtIGFyZ0NvdW50IFRoZSBhY3R1YWwgbnVtYmVyIG9mIGFyZ3VtZW50cyBwcm92aWRlZC5cclxuICovXHJcbmNvbnN0IHZhbGlkYXRlQXJnQ291bnQgPSBmdW5jdGlvbiAoZm5OYW1lLCBtaW5Db3VudCwgbWF4Q291bnQsIGFyZ0NvdW50KSB7XHJcbiAgICBsZXQgYXJnRXJyb3I7XHJcbiAgICBpZiAoYXJnQ291bnQgPCBtaW5Db3VudCkge1xyXG4gICAgICAgIGFyZ0Vycm9yID0gJ2F0IGxlYXN0ICcgKyBtaW5Db3VudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGFyZ0NvdW50ID4gbWF4Q291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoYXJnRXJyb3IpIHtcclxuICAgICAgICBjb25zdCBlcnJvciA9IGZuTmFtZSArXHJcbiAgICAgICAgICAgICcgZmFpbGVkOiBXYXMgY2FsbGVkIHdpdGggJyArXHJcbiAgICAgICAgICAgIGFyZ0NvdW50ICtcclxuICAgICAgICAgICAgKGFyZ0NvdW50ID09PSAxID8gJyBhcmd1bWVudC4nIDogJyBhcmd1bWVudHMuJykgK1xyXG4gICAgICAgICAgICAnIEV4cGVjdHMgJyArXHJcbiAgICAgICAgICAgIGFyZ0Vycm9yICtcclxuICAgICAgICAgICAgJy4nO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgYSBzdHJpbmcgdG8gcHJlZml4IGFuIGVycm9yIG1lc3NhZ2UgYWJvdXQgZmFpbGVkIGFyZ3VtZW50IHZhbGlkYXRpb25cclxuICpcclxuICogQHBhcmFtIGZuTmFtZSBUaGUgZnVuY3Rpb24gbmFtZVxyXG4gKiBAcGFyYW0gYXJnTmFtZSBUaGUgbmFtZSBvZiB0aGUgYXJndW1lbnRcclxuICogQHJldHVybiBUaGUgcHJlZml4IHRvIGFkZCB0byB0aGUgZXJyb3IgdGhyb3duIGZvciB2YWxpZGF0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmdOYW1lKSB7XHJcbiAgICByZXR1cm4gYCR7Zm5OYW1lfSBmYWlsZWQ6ICR7YXJnTmFtZX0gYXJndW1lbnQgYDtcclxufVxyXG4vKipcclxuICogQHBhcmFtIGZuTmFtZVxyXG4gKiBAcGFyYW0gYXJndW1lbnROdW1iZXJcclxuICogQHBhcmFtIG5hbWVzcGFjZVxyXG4gKiBAcGFyYW0gb3B0aW9uYWxcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZXNwYWNlKGZuTmFtZSwgbmFtZXNwYWNlLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFuYW1lc3BhY2UpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAvL1RPRE86IEkgc2hvdWxkIGRvIG1vcmUgdmFsaWRhdGlvbiBoZXJlLiBXZSBvbmx5IGFsbG93IGNlcnRhaW4gY2hhcnMgaW4gbmFtZXNwYWNlcy5cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCAnbmFtZXNwYWNlJykgKyAnbXVzdCBiZSBhIHZhbGlkIGZpcmViYXNlIG5hbWVzcGFjZS4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNhbGxiYWNrKGZuTmFtZSwgYXJndW1lbnROYW1lLCBcclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcclxuY2FsbGJhY2ssIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TmFtZSkgKyAnbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLicpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlQ29udGV4dE9iamVjdChmbk5hbWUsIGFyZ3VtZW50TmFtZSwgY29udGV4dCwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhY29udGV4dCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgY29udGV4dCAhPT0gJ29iamVjdCcgfHwgY29udGV4dCA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TmFtZSkgKyAnbXVzdCBiZSBhIHZhbGlkIGNvbnRleHQgb2JqZWN0LicpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIENvZGUgb3JpZ2luYWxseSBjYW1lIGZyb20gZ29vZy5jcnlwdC5zdHJpbmdUb1V0ZjhCeXRlQXJyYXksIGJ1dCBmb3Igc29tZSByZWFzb24gdGhleVxyXG4vLyBhdXRvbWF0aWNhbGx5IHJlcGxhY2VkICdcXHJcXG4nIHdpdGggJ1xcbicsIGFuZCB0aGV5IGRpZG4ndCBoYW5kbGUgc3Vycm9nYXRlIHBhaXJzLFxyXG4vLyBzbyBpdCdzIGJlZW4gbW9kaWZpZWQuXHJcbi8vIE5vdGUgdGhhdCBub3QgYWxsIFVuaWNvZGUgY2hhcmFjdGVycyBhcHBlYXIgYXMgc2luZ2xlIGNoYXJhY3RlcnMgaW4gSmF2YVNjcmlwdCBzdHJpbmdzLlxyXG4vLyBmcm9tQ2hhckNvZGUgcmV0dXJucyB0aGUgVVRGLTE2IGVuY29kaW5nIG9mIGEgY2hhcmFjdGVyIC0gc28gc29tZSBVbmljb2RlIGNoYXJhY3RlcnNcclxuLy8gdXNlIDIgY2hhcmFjdGVycyBpbiBKYXZhc2NyaXB0LiAgQWxsIDQtYnl0ZSBVVEYtOCBjaGFyYWN0ZXJzIGJlZ2luIHdpdGggYSBmaXJzdFxyXG4vLyBjaGFyYWN0ZXIgaW4gdGhlIHJhbmdlIDB4RDgwMCAtIDB4REJGRiAodGhlIGZpcnN0IGNoYXJhY3RlciBvZiBhIHNvLWNhbGxlZCBzdXJyb2dhdGVcclxuLy8gcGFpcikuXHJcbi8vIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuMS4zXHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4ge0FycmF5fVxyXG4gKi9cclxuY29uc3Qgc3RyaW5nVG9CeXRlQXJyYXkgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGxldCBwID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICAvLyBJcyB0aGlzIHRoZSBsZWFkIHN1cnJvZ2F0ZSBpbiBhIHN1cnJvZ2F0ZSBwYWlyP1xyXG4gICAgICAgIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICBjb25zdCBoaWdoID0gYyAtIDB4ZDgwMDsgLy8gdGhlIGhpZ2ggMTAgYml0cy5cclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICBhc3NlcnQoaSA8IHN0ci5sZW5ndGgsICdTdXJyb2dhdGUgcGFpciBtaXNzaW5nIHRyYWlsIHN1cnJvZ2F0ZS4nKTtcclxuICAgICAgICAgICAgY29uc3QgbG93ID0gc3RyLmNoYXJDb2RlQXQoaSkgLSAweGRjMDA7IC8vIHRoZSBsb3cgMTAgYml0cy5cclxuICAgICAgICAgICAgYyA9IDB4MTAwMDAgKyAoaGlnaCA8PCAxMCkgKyBsb3c7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDY1NTM2KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgbGVuZ3RoIHdpdGhvdXQgYWN0dWFsbHkgY29udmVydGluZzsgdXNlZnVsIGZvciBkb2luZyBjaGVhcGVyIHZhbGlkYXRpb24uXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuY29uc3Qgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgbGV0IHAgPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgcCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBwICs9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XHJcbiAgICAgICAgICAgIC8vIExlYWQgc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIuICBUaGUgcGFpciB0b2dldGhlciB3aWxsIHRha2UgNCBieXRlcyB0byByZXByZXNlbnQuXHJcbiAgICAgICAgICAgIHAgKz0gNDtcclxuICAgICAgICAgICAgaSsrOyAvLyBza2lwIHRyYWlsIHN1cnJvZ2F0ZS5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHAgKz0gMztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcDtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENvcGllZCBmcm9tIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMTE3NTIzXHJcbiAqIEdlbmVyYXRlcyBhIG5ldyB1dWlkLlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCB1dWlkdjQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBjID0+IHtcclxuICAgICAgICBjb25zdCByID0gKE1hdGgucmFuZG9tKCkgKiAxNikgfCAwLCB2ID0gYyA9PT0gJ3gnID8gciA6IChyICYgMHgzKSB8IDB4ODtcclxuICAgICAgICByZXR1cm4gdi50b1N0cmluZygxNik7XHJcbiAgICB9KTtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBhbW91bnQgb2YgbWlsbGlzZWNvbmRzIHRvIGV4cG9uZW50aWFsbHkgaW5jcmVhc2UuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0lOVEVSVkFMX01JTExJUyA9IDEwMDA7XHJcbi8qKlxyXG4gKiBUaGUgZmFjdG9yIHRvIGJhY2tvZmYgYnkuXHJcbiAqIFNob3VsZCBiZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMS5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfQkFDS09GRl9GQUNUT1IgPSAyO1xyXG4vKipcclxuICogVGhlIG1heGltdW0gbWlsbGlzZWNvbmRzIHRvIGluY3JlYXNlIHRvLlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBNQVhfVkFMVUVfTUlMTElTID0gNCAqIDYwICogNjAgKiAxMDAwOyAvLyBGb3VyIGhvdXJzLCBsaWtlIGlPUyBhbmQgQW5kcm9pZC5cclxuLyoqXHJcbiAqIFRoZSBwZXJjZW50YWdlIG9mIGJhY2tvZmYgdGltZSB0byByYW5kb21pemUgYnkuXHJcbiAqIFNlZVxyXG4gKiBodHRwOi8vZ28vc2FmZS1jbGllbnQtYmVoYXZpb3Ijc3RlcC0xLWRldGVybWluZS10aGUtYXBwcm9wcmlhdGUtcmV0cnktaW50ZXJ2YWwtdG8taGFuZGxlLXNwaWtlLXRyYWZmaWNcclxuICogZm9yIGNvbnRleHQuXHJcbiAqXHJcbiAqIDxwPlZpc2libGUgZm9yIHRlc3RpbmdcclxuICovXHJcbmNvbnN0IFJBTkRPTV9GQUNUT1IgPSAwLjU7XHJcbi8qKlxyXG4gKiBCYXNlZCBvbiB0aGUgYmFja29mZiBtZXRob2QgZnJvbVxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtbGlicmFyeS9ibG9iL21hc3Rlci9jbG9zdXJlL2dvb2cvbWF0aC9leHBvbmVudGlhbGJhY2tvZmYuanMuXHJcbiAqIEV4dHJhY3RlZCBoZXJlIHNvIHdlIGRvbid0IG5lZWQgdG8gcGFzcyBtZXRhZGF0YSBhbmQgYSBzdGF0ZWZ1bCBFeHBvbmVudGlhbEJhY2tvZmYgb2JqZWN0IGFyb3VuZC5cclxuICovXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZUJhY2tvZmZNaWxsaXMoYmFja29mZkNvdW50LCBpbnRlcnZhbE1pbGxpcyA9IERFRkFVTFRfSU5URVJWQUxfTUlMTElTLCBiYWNrb2ZmRmFjdG9yID0gREVGQVVMVF9CQUNLT0ZGX0ZBQ1RPUikge1xyXG4gICAgLy8gQ2FsY3VsYXRlcyBhbiBleHBvbmVudGlhbGx5IGluY3JlYXNpbmcgdmFsdWUuXHJcbiAgICAvLyBEZXZpYXRpb246IGNhbGN1bGF0ZXMgdmFsdWUgZnJvbSBjb3VudCBhbmQgYSBjb25zdGFudCBpbnRlcnZhbCwgc28gd2Ugb25seSBuZWVkIHRvIHNhdmUgdmFsdWVcclxuICAgIC8vIGFuZCBjb3VudCB0byByZXN0b3JlIHN0YXRlLlxyXG4gICAgY29uc3QgY3VyckJhc2VWYWx1ZSA9IGludGVydmFsTWlsbGlzICogTWF0aC5wb3coYmFja29mZkZhY3RvciwgYmFja29mZkNvdW50KTtcclxuICAgIC8vIEEgcmFuZG9tIFwiZnV6elwiIHRvIGF2b2lkIHdhdmVzIG9mIHJldHJpZXMuXHJcbiAgICAvLyBEZXZpYXRpb246IHJhbmRvbUZhY3RvciBpcyByZXF1aXJlZC5cclxuICAgIGNvbnN0IHJhbmRvbVdhaXQgPSBNYXRoLnJvdW5kKFxyXG4gICAgLy8gQSBmcmFjdGlvbiBvZiB0aGUgYmFja29mZiB2YWx1ZSB0byBhZGQvc3VidHJhY3QuXHJcbiAgICAvLyBEZXZpYXRpb246IGNoYW5nZXMgbXVsdGlwbGljYXRpb24gb3JkZXIgdG8gaW1wcm92ZSByZWFkYWJpbGl0eS5cclxuICAgIFJBTkRPTV9GQUNUT1IgKlxyXG4gICAgICAgIGN1cnJCYXNlVmFsdWUgKlxyXG4gICAgICAgIC8vIEEgcmFuZG9tIGZsb2F0IChyb3VuZGVkIHRvIGludCBieSBNYXRoLnJvdW5kIGFib3ZlKSBpbiB0aGUgcmFuZ2UgWy0xLCAxXS4gRGV0ZXJtaW5lc1xyXG4gICAgICAgIC8vIGlmIHdlIGFkZCBvciBzdWJ0cmFjdC5cclxuICAgICAgICAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKlxyXG4gICAgICAgIDIpO1xyXG4gICAgLy8gTGltaXRzIGJhY2tvZmYgdG8gbWF4IHRvIGF2b2lkIGVmZmVjdGl2ZWx5IHBlcm1hbmVudCBiYWNrb2ZmLlxyXG4gICAgcmV0dXJuIE1hdGgubWluKE1BWF9WQUxVRV9NSUxMSVMsIGN1cnJCYXNlVmFsdWUgKyByYW5kb21XYWl0KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZSBFbmdsaXNoIG9yZGluYWwgbGV0dGVycyBhZnRlciBhIG51bWJlclxyXG4gKi9cclxuZnVuY3Rpb24gb3JkaW5hbChpKSB7XHJcbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZShpKSkge1xyXG4gICAgICAgIHJldHVybiBgJHtpfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaSArIGluZGljYXRvcihpKTtcclxufVxyXG5mdW5jdGlvbiBpbmRpY2F0b3IoaSkge1xyXG4gICAgaSA9IE1hdGguYWJzKGkpO1xyXG4gICAgY29uc3QgY2VudCA9IGkgJSAxMDA7XHJcbiAgICBpZiAoY2VudCA+PSAxMCAmJiBjZW50IDw9IDIwKSB7XHJcbiAgICAgICAgcmV0dXJuICd0aCc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBkZWMgPSBpICUgMTA7XHJcbiAgICBpZiAoZGVjID09PSAxKSB7XHJcbiAgICAgICAgcmV0dXJuICdzdCc7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVjID09PSAyKSB7XHJcbiAgICAgICAgcmV0dXJuICduZCc7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVjID09PSAzKSB7XHJcbiAgICAgICAgcmV0dXJuICdyZCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJ3RoJztcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRNb2R1bGFySW5zdGFuY2Uoc2VydmljZSkge1xyXG4gICAgaWYgKHNlcnZpY2UgJiYgc2VydmljZS5fZGVsZWdhdGUpIHtcclxuICAgICAgICByZXR1cm4gc2VydmljZS5fZGVsZWdhdGU7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuICAgIH1cclxufVxuXG5leHBvcnQgeyBDT05TVEFOVFMsIERlZmVycmVkLCBFcnJvckZhY3RvcnksIEZpcmViYXNlRXJyb3IsIE1BWF9WQUxVRV9NSUxMSVMsIFJBTkRPTV9GQUNUT1IsIFNoYTEsIGFyZUNvb2tpZXNFbmFibGVkLCBhc3NlcnQsIGFzc2VydGlvbkVycm9yLCBhc3luYywgYmFzZTY0LCBiYXNlNjREZWNvZGUsIGJhc2U2NEVuY29kZSwgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcsIGNhbGN1bGF0ZUJhY2tvZmZNaWxsaXMsIGNvbnRhaW5zLCBjcmVhdGVNb2NrVXNlclRva2VuLCBjcmVhdGVTdWJzY3JpYmUsIGRlY29kZSwgZGVlcENvcHksIGRlZXBFcXVhbCwgZGVlcEV4dGVuZCwgZXJyb3JQcmVmaXgsIGV4dHJhY3RRdWVyeXN0cmluZywgZ2V0RGVmYXVsdEFwcENvbmZpZywgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCwgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0LCBnZXRFeHBlcmltZW50YWxTZXR0aW5nLCBnZXRHbG9iYWwsIGdldE1vZHVsYXJJbnN0YW5jZSwgZ2V0VUEsIGlzQWRtaW4sIGlzQnJvd3NlciwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc0VsZWN0cm9uLCBpc0VtcHR5LCBpc0lFLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNNb2JpbGVDb3Jkb3ZhLCBpc05vZGUsIGlzTm9kZVNkaywgaXNSZWFjdE5hdGl2ZSwgaXNTYWZhcmksIGlzVVdQLCBpc1ZhbGlkRm9ybWF0LCBpc1ZhbGlkVGltZXN0YW1wLCBpc3N1ZWRBdFRpbWUsIGpzb25FdmFsLCBtYXAsIG9yZGluYWwsIHByb21pc2VXaXRoVGltZW91dCwgcXVlcnlzdHJpbmcsIHF1ZXJ5c3RyaW5nRGVjb2RlLCBzYWZlR2V0LCBzdHJpbmdMZW5ndGgsIHN0cmluZ1RvQnl0ZUFycmF5LCBzdHJpbmdpZnksIHV1aWR2NCwgdmFsaWRhdGVBcmdDb3VudCwgdmFsaWRhdGVDYWxsYmFjaywgdmFsaWRhdGVDb250ZXh0T2JqZWN0LCB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlLCB2YWxpZGF0ZU5hbWVzcGFjZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IERlZmVycmVkIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcclxuICogQ29tcG9uZW50IGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiBgYXV0aGAsIGBhdXRoLWludGVybmFsYFxyXG4gKi9cclxuY2xhc3MgQ29tcG9uZW50IHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBwdWJsaWMgc2VydmljZSBuYW1lLCBlLmcuIGFwcCwgYXV0aCwgZmlyZXN0b3JlLCBkYXRhYmFzZVxyXG4gICAgICogQHBhcmFtIGluc3RhbmNlRmFjdG9yeSBTZXJ2aWNlIGZhY3RvcnkgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIHRoZSBwdWJsaWMgaW50ZXJmYWNlXHJcbiAgICAgKiBAcGFyYW0gdHlwZSB3aGV0aGVyIHRoZSBzZXJ2aWNlIHByb3ZpZGVkIGJ5IHRoZSBjb21wb25lbnQgaXMgcHVibGljIG9yIHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgaW5zdGFuY2VGYWN0b3J5LCB0eXBlKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlRmFjdG9yeSA9IGluc3RhbmNlRmFjdG9yeTtcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBmYWxzZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBQcm9wZXJ0aWVzIHRvIGJlIGFkZGVkIHRvIHRoZSBzZXJ2aWNlIG5hbWVzcGFjZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0ge307XHJcbiAgICAgICAgdGhpcy5pbnN0YW50aWF0aW9uTW9kZSA9IFwiTEFaWVwiIC8qIExBWlkgKi87XHJcbiAgICAgICAgdGhpcy5vbkluc3RhbmNlQ3JlYXRlZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBzZXRJbnN0YW50aWF0aW9uTW9kZShtb2RlKSB7XHJcbiAgICAgICAgdGhpcy5pbnN0YW50aWF0aW9uTW9kZSA9IG1vZGU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBzZXRNdWx0aXBsZUluc3RhbmNlcyhtdWx0aXBsZUluc3RhbmNlcykge1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBtdWx0aXBsZUluc3RhbmNlcztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIHNldFNlcnZpY2VQcm9wcyhwcm9wcykge1xyXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0gcHJvcHM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBzZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjayhjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMub25JbnN0YW5jZUNyZWF0ZWQgPSBjYWxsYmFjaztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBpbnN0YW5jZSBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gJ2F1dGgnLCAnYXV0aC1pbnRlcm5hbCdcclxuICogTmFtZVNlcnZpY2VNYXBwaW5nW1RdIGlzIGFuIGFsaWFzIGZvciB0aGUgdHlwZSBvZiB0aGUgaW5zdGFuY2VcclxuICovXHJcbmNsYXNzIFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMub25Jbml0Q2FsbGJhY2tzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gaWRlbnRpZmllciBBIHByb3ZpZGVyIGNhbiBwcm92aWRlIG11bGl0cGxlIGluc3RhbmNlcyBvZiBhIHNlcnZpY2VcclxuICAgICAqIGlmIHRoaXMuY29tcG9uZW50Lm11bHRpcGxlSW5zdGFuY2VzIGlzIHRydWUuXHJcbiAgICAgKi9cclxuICAgIGdldChpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5oYXMobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBkZWZlcnJlZCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIHNlcnZpY2UgaWYgaXQgY2FuIGJlIGF1dG8taW5pdGlhbGl6ZWRcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZWRJZGVudGlmaWVyXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyBnZXQoKSwgaXQgc2hvdWxkIG5vdCBjYXVzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IuIFdlIGp1c3QgcmV0dXJuIHRoZSB1bnJlc29sdmVkIHByb21pc2UgaW4gdGhpcyBjYXNlLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmdldChub3JtYWxpemVkSWRlbnRpZmllcikucHJvbWlzZTtcclxuICAgIH1cclxuICAgIGdldEltbWVkaWF0ZShvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIC8vIGlmIG11bHRpcGxlSW5zdGFuY2VzIGlzIG5vdCBzdXBwb3J0ZWQsIHVzZSB0aGUgZGVmYXVsdCBuYW1lXHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaWRlbnRpZmllcik7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uYWwgPSAoX2EgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMub3B0aW9uYWwpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSW4gY2FzZSBhIGNvbXBvbmVudCBpcyBub3QgaW5pdGlhbGl6ZWQgYW5kIHNob3VsZC9jYW4gbm90IGJlIGF1dG8taW5pdGlhbGl6ZWQgYXQgdGhlIG1vbWVudCwgcmV0dXJuIG51bGwgaWYgdGhlIG9wdGlvbmFsIGZsYWcgaXMgc2V0LCBvciB0aHJvd1xyXG4gICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoYFNlcnZpY2UgJHt0aGlzLm5hbWV9IGlzIG5vdCBhdmFpbGFibGVgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldENvbXBvbmVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQ7XHJcbiAgICB9XHJcbiAgICBzZXRDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudC5uYW1lICE9PSB0aGlzLm5hbWUpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYE1pc21hdGNoaW5nIENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBmb3IgUHJvdmlkZXIgJHt0aGlzLm5hbWV9LmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCBmb3IgJHt0aGlzLm5hbWV9IGhhcyBhbHJlYWR5IGJlZW4gcHJvdmlkZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVhcmx5IHdpdGhvdXQgYXR0ZW1wdGluZyB0byBpbml0aWFsaXplIHRoZSBjb21wb25lbnQgaWYgdGhlIGNvbXBvbmVudCByZXF1aXJlcyBleHBsaWNpdCBpbml0aWFsaXphdGlvbiAoY2FsbGluZyBgUHJvdmlkZXIuaW5pdGlhbGl6ZSgpYClcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2aWNlIGlzIGVhZ2VyLCBpbml0aWFsaXplIHRoZSBkZWZhdWx0IGluc3RhbmNlXHJcbiAgICAgICAgaWYgKGlzQ29tcG9uZW50RWFnZXIoY29tcG9uZW50KSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHsgaW5zdGFuY2VJZGVudGlmaWVyOiBERUZBVUxUX0VOVFJZX05BTUUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgZm9yIGFuIGVhZ2VyIENvbXBvbmVudCB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyB0aGUgZWFnZXJcclxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemF0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlIGEgZmF0YWwgZXJyb3IuXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBJbnZlc3RpZ2F0ZSBpZiB3ZSBuZWVkIHRvIG1ha2UgaXQgY29uZmlndXJhYmxlLCBiZWNhdXNlIHNvbWUgY29tcG9uZW50IG1heSB3YW50IHRvIGNhdXNlXHJcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yIGluIHRoaXMgY2FzZT9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDcmVhdGUgc2VydmljZSBpbnN0YW5jZXMgZm9yIHRoZSBwZW5kaW5nIHByb21pc2VzIGFuZCByZXNvbHZlIHRoZW1cclxuICAgICAgICAvLyBOT1RFOiBpZiB0aGlzLm11bHRpcGxlSW5zdGFuY2VzIGlzIGZhbHNlLCBvbmx5IHRoZSBkZWZhdWx0IGluc3RhbmNlIHdpbGwgYmUgY3JlYXRlZFxyXG4gICAgICAgIC8vIGFuZCBhbGwgcHJvbWlzZXMgd2l0aCByZXNvbHZlIHdpdGggaXQgcmVnYXJkbGVzcyBvZiB0aGUgaWRlbnRpZmllci5cclxuICAgICAgICBmb3IgKGNvbnN0IFtpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlRGVmZXJyZWRdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIGBnZXRPckluaXRpYWxpemVTZXJ2aWNlKClgIHNob3VsZCBhbHdheXMgcmV0dXJuIGEgdmFsaWQgaW5zdGFuY2Ugc2luY2UgYSBjb21wb25lbnQgaXMgZ3VhcmFudGVlZC4gdXNlICEgdG8gbWFrZSB0eXBlc2NyaXB0IGhhcHB5LlxyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VEZWZlcnJlZC5yZXNvbHZlKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSB0aHJvd3MgYW4gZXhjZXB0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlXHJcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yLiBXZSBqdXN0IGxlYXZlIHRoZSBwcm9taXNlIHVucmVzb2x2ZWQuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjbGVhckluc3RhbmNlKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc09wdGlvbnMuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgIH1cclxuICAgIC8vIGFwcC5kZWxldGUoKSB3aWxsIGNhbGwgdGhpcyBtZXRob2Qgb24gZXZlcnkgcHJvdmlkZXIgdG8gZGVsZXRlIHRoZSBzZXJ2aWNlc1xyXG4gICAgLy8gVE9ETzogc2hvdWxkIHdlIG1hcmsgdGhlIHByb3ZpZGVyIGFzIGRlbGV0ZWQ/XHJcbiAgICBhc3luYyBkZWxldGUoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VydmljZXMgPSBBcnJheS5mcm9tKHRoaXMuaW5zdGFuY2VzLnZhbHVlcygpKTtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgICAgIC4uLnNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ0lOVEVSTkFMJyBpbiBzZXJ2aWNlKSAvLyBsZWdhY3kgc2VydmljZXNcclxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgICAgICAgICAubWFwKHNlcnZpY2UgPT4gc2VydmljZS5JTlRFUk5BTC5kZWxldGUoKSksXHJcbiAgICAgICAgICAgIC4uLnNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ19kZWxldGUnIGluIHNlcnZpY2UpIC8vIG1vZHVsYXJpemVkIHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgICAgICAgLm1hcChzZXJ2aWNlID0+IHNlcnZpY2UuX2RlbGV0ZSgpKVxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgaXNDb21wb25lbnRTZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50ICE9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpc0luaXRpYWxpemVkKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXMuaGFzKGlkZW50aWZpZXIpO1xyXG4gICAgfVxyXG4gICAgZ2V0T3B0aW9ucyhpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5nZXQoaWRlbnRpZmllcikgfHwge307XHJcbiAgICB9XHJcbiAgICBpbml0aWFsaXplKG9wdHMgPSB7fSkge1xyXG4gICAgICAgIGNvbnN0IHsgb3B0aW9ucyA9IHt9IH0gPSBvcHRzO1xyXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIob3B0cy5pbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKGAke3RoaXMubmFtZX0oJHtub3JtYWxpemVkSWRlbnRpZmllcn0pIGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCAke3RoaXMubmFtZX0gaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgeWV0YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllcixcclxuICAgICAgICAgICAgb3B0aW9uc1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIHJlc29sdmUgYW55IHBlbmRpbmcgcHJvbWlzZSB3YWl0aW5nIGZvciB0aGUgc2VydmljZSBpbnN0YW5jZVxyXG4gICAgICAgIGZvciAoY29uc3QgW2luc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2VEZWZlcnJlZF0gb2YgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIGlmIChub3JtYWxpemVkSWRlbnRpZmllciA9PT0gbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllcikge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VEZWZlcnJlZC5yZXNvbHZlKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkICBhZnRlciB0aGUgcHJvdmlkZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWQgYnkgY2FsbGluZyBwcm92aWRlci5pbml0aWFsaXplKCkuXHJcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgaW52b2tlZCBTWU5DSFJPTk9VU0xZLCBzbyBpdCBzaG91bGQgbm90IGV4ZWN1dGUgYW55IGxvbmdydW5uaW5nIHRhc2tzIGluIG9yZGVyIHRvIG5vdCBibG9jayB0aGUgcHJvZ3JhbS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWRlbnRpZmllciBBbiBvcHRpb25hbCBpbnN0YW5jZSBpZGVudGlmaWVyXHJcbiAgICAgKiBAcmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgdGhlIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIG9uSW5pdChjYWxsYmFjaywgaWRlbnRpZmllcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ2FsbGJhY2tzID0gKF9hID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbmV3IFNldCgpO1xyXG4gICAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5vbkluaXRDYWxsYmFja3Muc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBleGlzdGluZ0NhbGxiYWNrcyk7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdJbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2VzLmdldChub3JtYWxpemVkSWRlbnRpZmllcik7XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2soZXhpc3RpbmdJbnN0YW5jZSwgbm9ybWFsaXplZElkZW50aWZpZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBleGlzdGluZ0NhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2spO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEludm9rZSBvbkluaXQgY2FsbGJhY2tzIHN5bmNocm9ub3VzbHlcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZSB0aGUgc2VydmljZSBpbnN0YW5jZWBcclxuICAgICAqL1xyXG4gICAgaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghY2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChjb25zdCBjYWxsYmFjayBvZiBjYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGluc3RhbmNlLCBpZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5pdCBjYWxsYmFja1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0T3JJbml0aWFsaXplU2VydmljZSh7IGluc3RhbmNlSWRlbnRpZmllciwgb3B0aW9ucyA9IHt9IH0pIHtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIWluc3RhbmNlICYmIHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcy5jb21wb25lbnQuaW5zdGFuY2VGYWN0b3J5KHRoaXMuY29udGFpbmVyLCB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZUlkZW50aWZpZXJGb3JGYWN0b3J5KGluc3RhbmNlSWRlbnRpZmllciksXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEludm9rZSBvbkluaXQgbGlzdGVuZXJzLlxyXG4gICAgICAgICAgICAgKiBOb3RlIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkIGlzIGRpZmZlcmVudCwgd2hpY2ggaXMgdXNlZCBieSB0aGUgY29tcG9uZW50IGNyZWF0b3IsXHJcbiAgICAgICAgICAgICAqIHdoaWxlIG9uSW5pdCBsaXN0ZW5lcnMgYXJlIHJlZ2lzdGVyZWQgYnkgY29uc3VtZXJzIG9mIHRoZSBwcm92aWRlci5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogT3JkZXIgaXMgaW1wb3J0YW50XHJcbiAgICAgICAgICAgICAqIG9uSW5zdGFuY2VDcmVhdGVkKCkgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7IHdoaWNoXHJcbiAgICAgICAgICAgICAqIG1ha2VzIGBpc0luaXRpYWxpemVkKClgIHJldHVybiB0cnVlLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKHRoaXMuY29udGFpbmVyLCBpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgfHwgbnVsbDtcclxuICAgIH1cclxuICAgIG5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5tdWx0aXBsZUluc3RhbmNlcyA/IGlkZW50aWZpZXIgOiBERUZBVUxUX0VOVFJZX05BTUU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gaWRlbnRpZmllcjsgLy8gYXNzdW1lIG11bHRpcGxlIGluc3RhbmNlcyBhcmUgc3VwcG9ydGVkIGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIHByb3ZpZGVkLlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNob3VsZEF1dG9Jbml0aWFsaXplKCkge1xyXG4gICAgICAgIHJldHVybiAoISF0aGlzLmNvbXBvbmVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSAhPT0gXCJFWFBMSUNJVFwiIC8qIEVYUExJQ0lUICovKTtcclxuICAgIH1cclxufVxyXG4vLyB1bmRlZmluZWQgc2hvdWxkIGJlIHBhc3NlZCB0byB0aGUgc2VydmljZSBmYWN0b3J5IGZvciB0aGUgZGVmYXVsdCBpbnN0YW5jZVxyXG5mdW5jdGlvbiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpZGVudGlmaWVyKSB7XHJcbiAgICByZXR1cm4gaWRlbnRpZmllciA9PT0gREVGQVVMVF9FTlRSWV9OQU1FID8gdW5kZWZpbmVkIDogaWRlbnRpZmllcjtcclxufVxyXG5mdW5jdGlvbiBpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkge1xyXG4gICAgcmV0dXJuIGNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSA9PT0gXCJFQUdFUlwiIC8qIEVBR0VSICovO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDb21wb25lbnRDb250YWluZXIgdGhhdCBwcm92aWRlcyBQcm92aWRlcnMgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuIGBhdXRoYCwgYGF1dGgtaW50ZXJuYWxgXHJcbiAqL1xyXG5jbGFzcyBDb21wb25lbnRDb250YWluZXIge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50IENvbXBvbmVudCBiZWluZyBhZGRlZFxyXG4gICAgICogQHBhcmFtIG92ZXJ3cml0ZSBXaGVuIGEgY29tcG9uZW50IHdpdGggdGhlIHNhbWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQsXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgdHJ1ZTogb3ZlcndyaXRlIHRoZSBleGlzdGluZyBjb21wb25lbnQgd2l0aCB0aGUgbmV3IGNvbXBvbmVudCBhbmQgY3JlYXRlIGEgbmV3XHJcbiAgICAgKiBwcm92aWRlciB3aXRoIHRoZSBuZXcgY29tcG9uZW50LiBJdCBjYW4gYmUgdXNlZnVsIGluIHRlc3RzIHdoZXJlIHlvdSB3YW50IHRvIHVzZSBkaWZmZXJlbnQgbW9ja3NcclxuICAgICAqIGZvciBkaWZmZXJlbnQgdGVzdHMuXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgZmFsc2U6IHRocm93IGFuIGV4Y2VwdGlvblxyXG4gICAgICovXHJcbiAgICBhZGRDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICBpZiAocHJvdmlkZXIuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQgd2l0aCAke3RoaXMubmFtZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcHJvdmlkZXIuc2V0Q29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICBhZGRPck92ZXJ3cml0ZUNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgICAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIoY29tcG9uZW50Lm5hbWUpO1xyXG4gICAgICAgIGlmIChwcm92aWRlci5pc0NvbXBvbmVudFNldCgpKSB7XHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSB0aGUgZXhpc3RpbmcgcHJvdmlkZXIgZnJvbSB0aGUgY29udGFpbmVyLCBzbyB3ZSBjYW4gcmVnaXN0ZXIgdGhlIG5ldyBjb21wb25lbnRcclxuICAgICAgICAgICAgdGhpcy5wcm92aWRlcnMuZGVsZXRlKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZ2V0UHJvdmlkZXIgcHJvdmlkZXMgYSB0eXBlIHNhZmUgaW50ZXJmYWNlIHdoZXJlIGl0IGNhbiBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgZmllbGQgbmFtZVxyXG4gICAgICogcHJlc2VudCBpbiBOYW1lU2VydmljZU1hcHBpbmcgaW50ZXJmYWNlLlxyXG4gICAgICpcclxuICAgICAqIEZpcmViYXNlIFNES3MgcHJvdmlkaW5nIHNlcnZpY2VzIHNob3VsZCBleHRlbmQgTmFtZVNlcnZpY2VNYXBwaW5nIGludGVyZmFjZSB0byByZWdpc3RlclxyXG4gICAgICogdGhlbXNlbHZlcy5cclxuICAgICAqL1xyXG4gICAgZ2V0UHJvdmlkZXIobmFtZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3ZpZGVycy5oYXMobmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXJzLmdldChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY3JlYXRlIGEgUHJvdmlkZXIgZm9yIGEgc2VydmljZSB0aGF0IGhhc24ndCByZWdpc3RlcmVkIHdpdGggRmlyZWJhc2VcclxuICAgICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBQcm92aWRlcihuYW1lLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnByb3ZpZGVycy5zZXQobmFtZSwgcHJvdmlkZXIpO1xyXG4gICAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH1cclxuICAgIGdldFByb3ZpZGVycygpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSk7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRDb250YWluZXIsIFByb3ZpZGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgY29udGFpbmVyIGZvciBhbGwgb2YgdGhlIExvZ2dlciBpbnN0YW5jZXNcclxuICovXHJcbmNvbnN0IGluc3RhbmNlcyA9IFtdO1xyXG4vKipcclxuICogVGhlIEpTIFNESyBzdXBwb3J0cyA1IGxvZyBsZXZlbHMgYW5kIGFsc28gYWxsb3dzIGEgdXNlciB0aGUgYWJpbGl0eSB0b1xyXG4gKiBzaWxlbmNlIHRoZSBsb2dzIGFsdG9nZXRoZXIuXHJcbiAqXHJcbiAqIFRoZSBvcmRlciBpcyBhIGZvbGxvd3M6XHJcbiAqIERFQlVHIDwgVkVSQk9TRSA8IElORk8gPCBXQVJOIDwgRVJST1JcclxuICpcclxuICogQWxsIG9mIHRoZSBsb2cgdHlwZXMgYWJvdmUgdGhlIGN1cnJlbnQgbG9nIGxldmVsIHdpbGwgYmUgY2FwdHVyZWQgKGkuZS4gaWZcclxuICogeW91IHNldCB0aGUgbG9nIGxldmVsIHRvIGBJTkZPYCwgZXJyb3JzIHdpbGwgc3RpbGwgYmUgbG9nZ2VkLCBidXQgYERFQlVHYCBhbmRcclxuICogYFZFUkJPU0VgIGxvZ3Mgd2lsbCBub3QpXHJcbiAqL1xyXG52YXIgTG9nTGV2ZWw7XHJcbihmdW5jdGlvbiAoTG9nTGV2ZWwpIHtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiREVCVUdcIl0gPSAwXSA9IFwiREVCVUdcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiVkVSQk9TRVwiXSA9IDFdID0gXCJWRVJCT1NFXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIklORk9cIl0gPSAyXSA9IFwiSU5GT1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJXQVJOXCJdID0gM10gPSBcIldBUk5cIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiRVJST1JcIl0gPSA0XSA9IFwiRVJST1JcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiU0lMRU5UXCJdID0gNV0gPSBcIlNJTEVOVFwiO1xyXG59KShMb2dMZXZlbCB8fCAoTG9nTGV2ZWwgPSB7fSkpO1xyXG5jb25zdCBsZXZlbFN0cmluZ1RvRW51bSA9IHtcclxuICAgICdkZWJ1Zyc6IExvZ0xldmVsLkRFQlVHLFxyXG4gICAgJ3ZlcmJvc2UnOiBMb2dMZXZlbC5WRVJCT1NFLFxyXG4gICAgJ2luZm8nOiBMb2dMZXZlbC5JTkZPLFxyXG4gICAgJ3dhcm4nOiBMb2dMZXZlbC5XQVJOLFxyXG4gICAgJ2Vycm9yJzogTG9nTGV2ZWwuRVJST1IsXHJcbiAgICAnc2lsZW50JzogTG9nTGV2ZWwuU0lMRU5UXHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcclxuICovXHJcbmNvbnN0IGRlZmF1bHRMb2dMZXZlbCA9IExvZ0xldmVsLklORk87XHJcbi8qKlxyXG4gKiBCeSBkZWZhdWx0LCBgY29uc29sZS5kZWJ1Z2AgaXMgbm90IGRpc3BsYXllZCBpbiB0aGUgZGV2ZWxvcGVyIGNvbnNvbGUgKGluXHJcbiAqIGNocm9tZSkuIFRvIGF2b2lkIGZvcmNpbmcgdXNlcnMgdG8gaGF2ZSB0byBvcHQtaW4gdG8gdGhlc2UgbG9ncyB0d2ljZVxyXG4gKiAoaS5lLiBvbmNlIGZvciBmaXJlYmFzZSwgYW5kIG9uY2UgaW4gdGhlIGNvbnNvbGUpLCB3ZSBhcmUgc2VuZGluZyBgREVCVUdgXHJcbiAqIGxvZ3MgdG8gdGhlIGBjb25zb2xlLmxvZ2AgZnVuY3Rpb24uXHJcbiAqL1xyXG5jb25zdCBDb25zb2xlTWV0aG9kID0ge1xyXG4gICAgW0xvZ0xldmVsLkRFQlVHXTogJ2xvZycsXHJcbiAgICBbTG9nTGV2ZWwuVkVSQk9TRV06ICdsb2cnLFxyXG4gICAgW0xvZ0xldmVsLklORk9dOiAnaW5mbycsXHJcbiAgICBbTG9nTGV2ZWwuV0FSTl06ICd3YXJuJyxcclxuICAgIFtMb2dMZXZlbC5FUlJPUl06ICdlcnJvcidcclxufTtcclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGxvZyBoYW5kbGVyIHdpbGwgZm9yd2FyZCBERUJVRywgVkVSQk9TRSwgSU5GTywgV0FSTiwgYW5kIEVSUk9SXHJcbiAqIG1lc3NhZ2VzIG9uIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmcgY29uc29sZSBjb3VudGVycGFydHMgKGlmIHRoZSBsb2cgbWV0aG9kXHJcbiAqIGlzIHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCBsb2cgbGV2ZWwpXHJcbiAqL1xyXG5jb25zdCBkZWZhdWx0TG9nSGFuZGxlciA9IChpbnN0YW5jZSwgbG9nVHlwZSwgLi4uYXJncykgPT4ge1xyXG4gICAgaWYgKGxvZ1R5cGUgPCBpbnN0YW5jZS5sb2dMZXZlbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgIGNvbnN0IG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZV07XHJcbiAgICBpZiAobWV0aG9kKSB7XHJcbiAgICAgICAgY29uc29sZVttZXRob2RdKGBbJHtub3d9XSAgJHtpbnN0YW5jZS5uYW1lfTpgLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZW1wdGVkIHRvIGxvZyBhIG1lc3NhZ2Ugd2l0aCBhbiBpbnZhbGlkIGxvZ1R5cGUgKHZhbHVlOiAke2xvZ1R5cGV9KWApO1xyXG4gICAgfVxyXG59O1xyXG5jbGFzcyBMb2dnZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlcyB5b3UgYW4gaW5zdGFuY2Ugb2YgYSBMb2dnZXIgdG8gY2FwdHVyZSBtZXNzYWdlcyBhY2NvcmRpbmcgdG9cclxuICAgICAqIEZpcmViYXNlJ3MgbG9nZ2luZyBzY2hlbWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgdGhhdCB0aGUgbG9ncyB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbG9nIGxldmVsIG9mIHRoZSBnaXZlbiBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSBkZWZhdWx0TG9nTGV2ZWw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG1haW4gKGludGVybmFsKSBsb2cgaGFuZGxlciBmb3IgdGhlIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKiBDYW4gYmUgc2V0IHRvIGEgbmV3IGZ1bmN0aW9uIGluIGludGVybmFsIHBhY2thZ2UgY29kZSBidXQgbm90IGJ5IHVzZXIuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IGRlZmF1bHRMb2dIYW5kbGVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBvcHRpb25hbCwgYWRkaXRpb25hbCwgdXNlci1kZWZpbmVkIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYXB0dXJlIHRoZSBjdXJyZW50IGluc3RhbmNlIGZvciBsYXRlciB1c2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnN0YW5jZXMucHVzaCh0aGlzKTtcclxuICAgIH1cclxuICAgIGdldCBsb2dMZXZlbCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XHJcbiAgICB9XHJcbiAgICBzZXQgbG9nTGV2ZWwodmFsKSB7XHJcbiAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBJbnZhbGlkIHZhbHVlIFwiJHt2YWx9XCIgYXNzaWduZWQgdG8gXFxgbG9nTGV2ZWxcXGBgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XHJcbiAgICB9XHJcbiAgICAvLyBXb3JrYXJvdW5kIGZvciBzZXR0ZXIvZ2V0dGVyIGhhdmluZyB0byBiZSB0aGUgc2FtZSB0eXBlLlxyXG4gICAgc2V0TG9nTGV2ZWwodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/IGxldmVsU3RyaW5nVG9FbnVtW3ZhbF0gOiB2YWw7XHJcbiAgICB9XHJcbiAgICBnZXQgbG9nSGFuZGxlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbG9nSGFuZGxlcjtcclxuICAgIH1cclxuICAgIHNldCBsb2dIYW5kbGVyKHZhbCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1ZhbHVlIGFzc2lnbmVkIHRvIGBsb2dIYW5kbGVyYCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCB1c2VyTG9nSGFuZGxlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckxvZ0hhbmRsZXI7XHJcbiAgICB9XHJcbiAgICBzZXQgdXNlckxvZ0hhbmRsZXIodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSB2YWw7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmdW5jdGlvbnMgYmVsb3cgYXJlIGFsbCBiYXNlZCBvbiB0aGUgYGNvbnNvbGVgIGludGVyZmFjZVxyXG4gICAgICovXHJcbiAgICBkZWJ1ZyguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuREVCVUcsIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuREVCVUcsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgbG9nKC4uLmFyZ3MpIHtcclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJlxyXG4gICAgICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5WRVJCT1NFLCAuLi5hcmdzKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLlZFUkJPU0UsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgaW5mbyguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuSU5GTywgLi4uYXJncyk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5JTkZPLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIHdhcm4oLi4uYXJncykge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLldBUk4sIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuV0FSTiwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgICBlcnJvciguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuRVJST1IsIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuRVJST1IsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxldmVsKSB7XHJcbiAgICBpbnN0YW5jZXMuZm9yRWFjaChpbnN0ID0+IHtcclxuICAgICAgICBpbnN0LnNldExvZ0xldmVsKGxldmVsKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xyXG4gICAgICAgIGxldCBjdXN0b21Mb2dMZXZlbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5sZXZlbCkge1xyXG4gICAgICAgICAgICBjdXN0b21Mb2dMZXZlbCA9IGxldmVsU3RyaW5nVG9FbnVtW29wdGlvbnMubGV2ZWxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobG9nQ2FsbGJhY2sgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXNlckxvZ0hhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXNlckxvZ0hhbmRsZXIgPSAoaW5zdGFuY2UsIGxldmVsLCAuLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYXJnc1xyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoYXJnID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInIHx8IHR5cGVvZiBhcmcgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoaWdub3JlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoYXJnID0+IGFyZylcclxuICAgICAgICAgICAgICAgICAgICAuam9pbignICcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxldmVsID49IChjdXN0b21Mb2dMZXZlbCAhPT0gbnVsbCAmJiBjdXN0b21Mb2dMZXZlbCAhPT0gdm9pZCAwID8gY3VzdG9tTG9nTGV2ZWwgOiBpbnN0YW5jZS5sb2dMZXZlbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2dDYWxsYmFjayh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBMb2dMZXZlbFtsZXZlbF0udG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogaW5zdGFuY2UubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5leHBvcnQgeyBMb2dMZXZlbCwgTG9nZ2VyLCBzZXRMb2dMZXZlbCwgc2V0VXNlckxvZ0hhbmRsZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJjb25zdCBpbnN0YW5jZU9mQW55ID0gKG9iamVjdCwgY29uc3RydWN0b3JzKSA9PiBjb25zdHJ1Y3RvcnMuc29tZSgoYykgPT4gb2JqZWN0IGluc3RhbmNlb2YgYyk7XG5cbmxldCBpZGJQcm94eWFibGVUeXBlcztcbmxldCBjdXJzb3JBZHZhbmNlTWV0aG9kcztcbi8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLlxuZnVuY3Rpb24gZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSB7XG4gICAgcmV0dXJuIChpZGJQcm94eWFibGVUeXBlcyB8fFxuICAgICAgICAoaWRiUHJveHlhYmxlVHlwZXMgPSBbXG4gICAgICAgICAgICBJREJEYXRhYmFzZSxcbiAgICAgICAgICAgIElEQk9iamVjdFN0b3JlLFxuICAgICAgICAgICAgSURCSW5kZXgsXG4gICAgICAgICAgICBJREJDdXJzb3IsXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbixcbiAgICAgICAgXSkpO1xufVxuLy8gVGhpcyBpcyBhIGZ1bmN0aW9uIHRvIHByZXZlbnQgaXQgdGhyb3dpbmcgdXAgaW4gbm9kZSBlbnZpcm9ubWVudHMuXG5mdW5jdGlvbiBnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpIHtcbiAgICByZXR1cm4gKGN1cnNvckFkdmFuY2VNZXRob2RzIHx8XG4gICAgICAgIChjdXJzb3JBZHZhbmNlTWV0aG9kcyA9IFtcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuYWR2YW5jZSxcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuY29udGludWUsXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmNvbnRpbnVlUHJpbWFyeUtleSxcbiAgICAgICAgXSkpO1xufVxuY29uc3QgY3Vyc29yUmVxdWVzdE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCB0cmFuc2FjdGlvbkRvbmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHRyYW5zZm9ybUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHJldmVyc2VUcmFuc2Zvcm1DYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB1bmxpc3RlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIHN1Y2Nlc3MpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUod3JhcChyZXF1ZXN0LnJlc3VsdCkpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICAgICAgICB1bmxpc3RlbigpO1xuICAgICAgICB9O1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICB9KTtcbiAgICBwcm9taXNlXG4gICAgICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyBTaW5jZSBjdXJzb3JpbmcgcmV1c2VzIHRoZSBJREJSZXF1ZXN0ICgqc2lnaCopLCB3ZSBjYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsXG4gICAgICAgIC8vIChzZWUgd3JhcEZ1bmN0aW9uKS5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCQ3Vyc29yKSB7XG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0TWFwLnNldCh2YWx1ZSwgcmVxdWVzdCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2F0Y2hpbmcgdG8gYXZvaWQgXCJVbmNhdWdodCBQcm9taXNlIGV4Y2VwdGlvbnNcIlxuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgIC8vIFRoaXMgbWFwcGluZyBleGlzdHMgaW4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGJ1dCBkb2Vzbid0IGRvZXNuJ3QgZXhpc3QgaW4gdHJhbnNmb3JtQ2FjaGUuIFRoaXNcbiAgICAvLyBpcyBiZWNhdXNlIHdlIGNyZWF0ZSBtYW55IHByb21pc2VzIGZyb20gYSBzaW5nbGUgSURCUmVxdWVzdC5cbiAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KHByb21pc2UsIHJlcXVlc3QpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uKHR4KSB7XG4gICAgLy8gRWFybHkgYmFpbCBpZiB3ZSd2ZSBhbHJlYWR5IGNyZWF0ZWQgYSBkb25lIHByb21pc2UgZm9yIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgaWYgKHRyYW5zYWN0aW9uRG9uZU1hcC5oYXModHgpKVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgZG9uZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5saXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGNvbXBsZXRlKTtcbiAgICAgICAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QodHguZXJyb3IgfHwgbmV3IERPTUV4Y2VwdGlvbignQWJvcnRFcnJvcicsICdBYm9ydEVycm9yJykpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7XG4gICAgICAgIHR4LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICB0eC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGVycm9yKTtcbiAgICB9KTtcbiAgICAvLyBDYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsLlxuICAgIHRyYW5zYWN0aW9uRG9uZU1hcC5zZXQodHgsIGRvbmUpO1xufVxubGV0IGlkYlByb3h5VHJhcHMgPSB7XG4gICAgZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciB0cmFuc2FjdGlvbi5kb25lLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdkb25lJylcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25Eb25lTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICAgICAgLy8gUG9seWZpbGwgZm9yIG9iamVjdFN0b3JlTmFtZXMgYmVjYXVzZSBvZiBFZGdlLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdvYmplY3RTdG9yZU5hbWVzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQub2JqZWN0U3RvcmVOYW1lcyB8fCB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuZ2V0KHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBNYWtlIHR4LnN0b3JlIHJldHVybiB0aGUgb25seSBzdG9yZSBpbiB0aGUgdHJhbnNhY3Rpb24sIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgbWFueS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnc3RvcmUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVyLm9iamVjdFN0b3JlTmFtZXNbMV1cbiAgICAgICAgICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgOiByZWNlaXZlci5vYmplY3RTdG9yZShyZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBFbHNlIHRyYW5zZm9ybSB3aGF0ZXZlciB3ZSBnZXQgYmFjay5cbiAgICAgICAgcmV0dXJuIHdyYXAodGFyZ2V0W3Byb3BdKTtcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGhhcyh0YXJnZXQsIHByb3ApIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uICYmXG4gICAgICAgICAgICAocHJvcCA9PT0gJ2RvbmUnIHx8IHByb3AgPT09ICdzdG9yZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcCBpbiB0YXJnZXQ7XG4gICAgfSxcbn07XG5mdW5jdGlvbiByZXBsYWNlVHJhcHMoY2FsbGJhY2spIHtcbiAgICBpZGJQcm94eVRyYXBzID0gY2FsbGJhY2soaWRiUHJveHlUcmFwcyk7XG59XG5mdW5jdGlvbiB3cmFwRnVuY3Rpb24oZnVuYykge1xuICAgIC8vIER1ZSB0byBleHBlY3RlZCBvYmplY3QgZXF1YWxpdHkgKHdoaWNoIGlzIGVuZm9yY2VkIGJ5IHRoZSBjYWNoaW5nIGluIGB3cmFwYCksIHdlXG4gICAgLy8gb25seSBjcmVhdGUgb25lIG5ldyBmdW5jIHBlciBmdW5jLlxuICAgIC8vIEVkZ2UgZG9lc24ndCBzdXBwb3J0IG9iamVjdFN0b3JlTmFtZXMgKGJvb28pLCBzbyB3ZSBwb2x5ZmlsbCBpdCBoZXJlLlxuICAgIGlmIChmdW5jID09PSBJREJEYXRhYmFzZS5wcm90b3R5cGUudHJhbnNhY3Rpb24gJiZcbiAgICAgICAgISgnb2JqZWN0U3RvcmVOYW1lcycgaW4gSURCVHJhbnNhY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0b3JlTmFtZXMsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZnVuYy5jYWxsKHVud3JhcCh0aGlzKSwgc3RvcmVOYW1lcywgLi4uYXJncyk7XG4gICAgICAgICAgICB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuc2V0KHR4LCBzdG9yZU5hbWVzLnNvcnQgPyBzdG9yZU5hbWVzLnNvcnQoKSA6IFtzdG9yZU5hbWVzXSk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcCh0eCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIEN1cnNvciBtZXRob2RzIGFyZSBzcGVjaWFsLCBhcyB0aGUgYmVoYXZpb3VyIGlzIGEgbGl0dGxlIG1vcmUgZGlmZmVyZW50IHRvIHN0YW5kYXJkIElEQi4gSW5cbiAgICAvLyBJREIsIHlvdSBhZHZhbmNlIHRoZSBjdXJzb3IgYW5kIHdhaXQgZm9yIGEgbmV3ICdzdWNjZXNzJyBvbiB0aGUgSURCUmVxdWVzdCB0aGF0IGdhdmUgeW91IHRoZVxuICAgIC8vIGN1cnNvci4gSXQncyBraW5kYSBsaWtlIGEgcHJvbWlzZSB0aGF0IGNhbiByZXNvbHZlIHdpdGggbWFueSB2YWx1ZXMuIFRoYXQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgLy8gd2l0aCByZWFsIHByb21pc2VzLCBzbyBlYWNoIGFkdmFuY2UgbWV0aG9kcyByZXR1cm5zIGEgbmV3IHByb21pc2UgZm9yIHRoZSBjdXJzb3Igb2JqZWN0LCBvclxuICAgIC8vIHVuZGVmaW5lZCBpZiB0aGUgZW5kIG9mIHRoZSBjdXJzb3IgaGFzIGJlZW4gcmVhY2hlZC5cbiAgICBpZiAoZ2V0Q3Vyc29yQWR2YW5jZU1ldGhvZHMoKS5pbmNsdWRlcyhmdW5jKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIC8vIENhbGxpbmcgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggdGhlIHByb3h5IGFzICd0aGlzJyBjYXVzZXMgSUxMRUdBTCBJTlZPQ0FUSU9OLCBzbyB3ZSB1c2VcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgICAgICBmdW5jLmFwcGx5KHVud3JhcCh0aGlzKSwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcChjdXJzb3JSZXF1ZXN0TWFwLmdldCh0aGlzKSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlXG4gICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgIHJldHVybiB3cmFwKGZ1bmMuYXBwbHkodW53cmFwKHRoaXMpLCBhcmdzKSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKVxuICAgICAgICByZXR1cm4gd3JhcEZ1bmN0aW9uKHZhbHVlKTtcbiAgICAvLyBUaGlzIGRvZXNuJ3QgcmV0dXJuLCBpdCBqdXN0IGNyZWF0ZXMgYSAnZG9uZScgcHJvbWlzZSBmb3IgdGhlIHRyYW5zYWN0aW9uLFxuICAgIC8vIHdoaWNoIGlzIGxhdGVyIHJldHVybmVkIGZvciB0cmFuc2FjdGlvbi5kb25lIChzZWUgaWRiT2JqZWN0SGFuZGxlcikuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCVHJhbnNhY3Rpb24pXG4gICAgICAgIGNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbih2YWx1ZSk7XG4gICAgaWYgKGluc3RhbmNlT2ZBbnkodmFsdWUsIGdldElkYlByb3h5YWJsZVR5cGVzKCkpKVxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHZhbHVlLCBpZGJQcm94eVRyYXBzKTtcbiAgICAvLyBSZXR1cm4gdGhlIHNhbWUgdmFsdWUgYmFjayBpZiB3ZSdyZSBub3QgZ29pbmcgdG8gdHJhbnNmb3JtIGl0LlxuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHdyYXAodmFsdWUpIHtcbiAgICAvLyBXZSBzb21ldGltZXMgZ2VuZXJhdGUgbXVsdGlwbGUgcHJvbWlzZXMgZnJvbSBhIHNpbmdsZSBJREJSZXF1ZXN0IChlZyB3aGVuIGN1cnNvcmluZyksIGJlY2F1c2VcbiAgICAvLyBJREIgaXMgd2VpcmQgYW5kIGEgc2luZ2xlIElEQlJlcXVlc3QgY2FuIHlpZWxkIG1hbnkgcmVzcG9uc2VzLCBzbyB0aGVzZSBjYW4ndCBiZSBjYWNoZWQuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCUmVxdWVzdClcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QodmFsdWUpO1xuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgdHJhbnNmb3JtZWQgdGhpcyB2YWx1ZSBiZWZvcmUsIHJldXNlIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZS5cbiAgICAvLyBUaGlzIGlzIGZhc3RlciwgYnV0IGl0IGFsc28gcHJvdmlkZXMgb2JqZWN0IGVxdWFsaXR5LlxuICAgIGlmICh0cmFuc2Zvcm1DYWNoZS5oYXModmFsdWUpKVxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpO1xuICAgIC8vIE5vdCBhbGwgdHlwZXMgYXJlIHRyYW5zZm9ybWVkLlxuICAgIC8vIFRoZXNlIG1heSBiZSBwcmltaXRpdmUgdHlwZXMsIHNvIHRoZXkgY2FuJ3QgYmUgV2Vha01hcCBrZXlzLlxuICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgdHJhbnNmb3JtQ2FjaGUuc2V0KHZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIHJldmVyc2VUcmFuc2Zvcm1DYWNoZS5zZXQobmV3VmFsdWUsIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1ZhbHVlO1xufVxuY29uc3QgdW53cmFwID0gKHZhbHVlKSA9PiByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcblxuZXhwb3J0IHsgcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGFzIGEsIGluc3RhbmNlT2ZBbnkgYXMgaSwgcmVwbGFjZVRyYXBzIGFzIHIsIHVud3JhcCBhcyB1LCB3cmFwIGFzIHcgfTtcbiIsImltcG9ydCB7IHcgYXMgd3JhcCwgciBhcyByZXBsYWNlVHJhcHMgfSBmcm9tICcuL3dyYXAtaWRiLXZhbHVlLmpzJztcbmV4cG9ydCB7IHUgYXMgdW53cmFwLCB3IGFzIHdyYXAgfSBmcm9tICcuL3dyYXAtaWRiLXZhbHVlLmpzJztcblxuLyoqXG4gKiBPcGVuIGEgZGF0YWJhc2UuXG4gKlxuICogQHBhcmFtIG5hbWUgTmFtZSBvZiB0aGUgZGF0YWJhc2UuXG4gKiBAcGFyYW0gdmVyc2lvbiBTY2hlbWEgdmVyc2lvbi5cbiAqIEBwYXJhbSBjYWxsYmFja3MgQWRkaXRpb25hbCBjYWxsYmFja3MuXG4gKi9cbmZ1bmN0aW9uIG9wZW5EQihuYW1lLCB2ZXJzaW9uLCB7IGJsb2NrZWQsIHVwZ3JhZGUsIGJsb2NraW5nLCB0ZXJtaW5hdGVkIH0gPSB7fSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihuYW1lLCB2ZXJzaW9uKTtcbiAgICBjb25zdCBvcGVuUHJvbWlzZSA9IHdyYXAocmVxdWVzdCk7XG4gICAgaWYgKHVwZ3JhZGUpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB1cGdyYWRlKHdyYXAocmVxdWVzdC5yZXN1bHQpLCBldmVudC5vbGRWZXJzaW9uLCBldmVudC5uZXdWZXJzaW9uLCB3cmFwKHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChibG9ja2VkKVxuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Jsb2NrZWQnLCAoKSA9PiBibG9ja2VkKCkpO1xuICAgIG9wZW5Qcm9taXNlXG4gICAgICAgIC50aGVuKChkYikgPT4ge1xuICAgICAgICBpZiAodGVybWluYXRlZClcbiAgICAgICAgICAgIGRiLmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgKCkgPT4gdGVybWluYXRlZCgpKTtcbiAgICAgICAgaWYgKGJsb2NraW5nKVxuICAgICAgICAgICAgZGIuYWRkRXZlbnRMaXN0ZW5lcigndmVyc2lvbmNoYW5nZScsICgpID0+IGJsb2NraW5nKCkpO1xuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgIHJldHVybiBvcGVuUHJvbWlzZTtcbn1cbi8qKlxuICogRGVsZXRlIGEgZGF0YWJhc2UuXG4gKlxuICogQHBhcmFtIG5hbWUgTmFtZSBvZiB0aGUgZGF0YWJhc2UuXG4gKi9cbmZ1bmN0aW9uIGRlbGV0ZURCKG5hbWUsIHsgYmxvY2tlZCB9ID0ge30pIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKG5hbWUpO1xuICAgIGlmIChibG9ja2VkKVxuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Jsb2NrZWQnLCAoKSA9PiBibG9ja2VkKCkpO1xuICAgIHJldHVybiB3cmFwKHJlcXVlc3QpLnRoZW4oKCkgPT4gdW5kZWZpbmVkKTtcbn1cblxuY29uc3QgcmVhZE1ldGhvZHMgPSBbJ2dldCcsICdnZXRLZXknLCAnZ2V0QWxsJywgJ2dldEFsbEtleXMnLCAnY291bnQnXTtcbmNvbnN0IHdyaXRlTWV0aG9kcyA9IFsncHV0JywgJ2FkZCcsICdkZWxldGUnLCAnY2xlYXInXTtcbmNvbnN0IGNhY2hlZE1ldGhvZHMgPSBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB7XG4gICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgSURCRGF0YWJhc2UgJiZcbiAgICAgICAgIShwcm9wIGluIHRhcmdldCkgJiZcbiAgICAgICAgdHlwZW9mIHByb3AgPT09ICdzdHJpbmcnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjYWNoZWRNZXRob2RzLmdldChwcm9wKSlcbiAgICAgICAgcmV0dXJuIGNhY2hlZE1ldGhvZHMuZ2V0KHByb3ApO1xuICAgIGNvbnN0IHRhcmdldEZ1bmNOYW1lID0gcHJvcC5yZXBsYWNlKC9Gcm9tSW5kZXgkLywgJycpO1xuICAgIGNvbnN0IHVzZUluZGV4ID0gcHJvcCAhPT0gdGFyZ2V0RnVuY05hbWU7XG4gICAgY29uc3QgaXNXcml0ZSA9IHdyaXRlTWV0aG9kcy5pbmNsdWRlcyh0YXJnZXRGdW5jTmFtZSk7XG4gICAgaWYgKFxuICAgIC8vIEJhaWwgaWYgdGhlIHRhcmdldCBkb2Vzbid0IGV4aXN0IG9uIHRoZSB0YXJnZXQuIEVnLCBnZXRBbGwgaXNuJ3QgaW4gRWRnZS5cbiAgICAhKHRhcmdldEZ1bmNOYW1lIGluICh1c2VJbmRleCA/IElEQkluZGV4IDogSURCT2JqZWN0U3RvcmUpLnByb3RvdHlwZSkgfHxcbiAgICAgICAgIShpc1dyaXRlIHx8IHJlYWRNZXRob2RzLmluY2x1ZGVzKHRhcmdldEZ1bmNOYW1lKSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZXRob2QgPSBhc3luYyBmdW5jdGlvbiAoc3RvcmVOYW1lLCAuLi5hcmdzKSB7XG4gICAgICAgIC8vIGlzV3JpdGUgPyAncmVhZHdyaXRlJyA6IHVuZGVmaW5lZCBnemlwcHMgYmV0dGVyLCBidXQgZmFpbHMgaW4gRWRnZSA6KFxuICAgICAgICBjb25zdCB0eCA9IHRoaXMudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBpc1dyaXRlID8gJ3JlYWR3cml0ZScgOiAncmVhZG9ubHknKTtcbiAgICAgICAgbGV0IHRhcmdldCA9IHR4LnN0b3JlO1xuICAgICAgICBpZiAodXNlSW5kZXgpXG4gICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQuaW5kZXgoYXJncy5zaGlmdCgpKTtcbiAgICAgICAgLy8gTXVzdCByZWplY3QgaWYgb3AgcmVqZWN0cy5cbiAgICAgICAgLy8gSWYgaXQncyBhIHdyaXRlIG9wZXJhdGlvbiwgbXVzdCByZWplY3QgaWYgdHguZG9uZSByZWplY3RzLlxuICAgICAgICAvLyBNdXN0IHJlamVjdCB3aXRoIG9wIHJlamVjdGlvbiBmaXJzdC5cbiAgICAgICAgLy8gTXVzdCByZXNvbHZlIHdpdGggb3AgdmFsdWUuXG4gICAgICAgIC8vIE11c3QgaGFuZGxlIGJvdGggcHJvbWlzZXMgKG5vIHVuaGFuZGxlZCByZWplY3Rpb25zKVxuICAgICAgICByZXR1cm4gKGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIHRhcmdldFt0YXJnZXRGdW5jTmFtZV0oLi4uYXJncyksXG4gICAgICAgICAgICBpc1dyaXRlICYmIHR4LmRvbmUsXG4gICAgICAgIF0pKVswXTtcbiAgICB9O1xuICAgIGNhY2hlZE1ldGhvZHMuc2V0KHByb3AsIG1ldGhvZCk7XG4gICAgcmV0dXJuIG1ldGhvZDtcbn1cbnJlcGxhY2VUcmFwcygob2xkVHJhcHMpID0+ICh7XG4gICAgLi4ub2xkVHJhcHMsXG4gICAgZ2V0OiAodGFyZ2V0LCBwcm9wLCByZWNlaXZlcikgPT4gZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkgfHwgb2xkVHJhcHMuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpLFxuICAgIGhhczogKHRhcmdldCwgcHJvcCkgPT4gISFnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB8fCBvbGRUcmFwcy5oYXModGFyZ2V0LCBwcm9wKSxcbn0pKTtcblxuZXhwb3J0IHsgZGVsZXRlREIsIG9wZW5EQiB9O1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRDb250YWluZXIgfSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IExvZ2dlciwgc2V0VXNlckxvZ0hhbmRsZXIsIHNldExvZ0xldmVsIGFzIHNldExvZ0xldmVsJDEgfSBmcm9tICdAZmlyZWJhc2UvbG9nZ2VyJztcbmltcG9ydCB7IEVycm9yRmFjdG9yeSwgZ2V0RGVmYXVsdEFwcENvbmZpZywgZGVlcEVxdWFsLCBGaXJlYmFzZUVycm9yLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgaXNJbmRleGVkREJBdmFpbGFibGUsIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5leHBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgb3BlbkRCIH0gZnJvbSAnaWRiJztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgIH1cclxuICAgIC8vIEluIGluaXRpYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd2lsbCBiZSBjYWxsZWQgYnkgaW5zdGFsbGF0aW9ucyBvblxyXG4gICAgLy8gYXV0aCB0b2tlbiByZWZyZXNoLCBhbmQgaW5zdGFsbGF0aW9ucyB3aWxsIHNlbmQgdGhpcyBzdHJpbmcuXHJcbiAgICBnZXRQbGF0Zm9ybUluZm9TdHJpbmcoKSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXJzID0gdGhpcy5jb250YWluZXIuZ2V0UHJvdmlkZXJzKCk7XHJcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIHByb3ZpZGVycyBhbmQgZ2V0IGxpYnJhcnkvdmVyc2lvbiBwYWlycyBmcm9tIGFueSB0aGF0IGFyZVxyXG4gICAgICAgIC8vIHZlcnNpb24gY29tcG9uZW50cy5cclxuICAgICAgICByZXR1cm4gcHJvdmlkZXJzXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyKHByb3ZpZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VydmljZSA9IHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3NlcnZpY2UubGlicmFyeX0vJHtzZXJ2aWNlLnZlcnNpb259YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihsb2dTdHJpbmcgPT4gbG9nU3RyaW5nKVxyXG4gICAgICAgICAgICAuam9pbignICcpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKlxyXG4gKiBAcGFyYW0gcHJvdmlkZXIgY2hlY2sgaWYgdGhpcyBwcm92aWRlciBwcm92aWRlcyBhIFZlcnNpb25TZXJ2aWNlXHJcbiAqXHJcbiAqIE5PVEU6IFVzaW5nIFByb3ZpZGVyPCdhcHAtdmVyc2lvbic+IGlzIGEgaGFjayB0byBpbmRpY2F0ZSB0aGF0IHRoZSBwcm92aWRlclxyXG4gKiBwcm92aWRlcyBWZXJzaW9uU2VydmljZS4gVGhlIHByb3ZpZGVyIGlzIG5vdCBuZWNlc3NhcmlseSBhICdhcHAtdmVyc2lvbidcclxuICogcHJvdmlkZXIuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIocHJvdmlkZXIpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudCA9IHByb3ZpZGVyLmdldENvbXBvbmVudCgpO1xyXG4gICAgcmV0dXJuIChjb21wb25lbnQgPT09IG51bGwgfHwgY29tcG9uZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb21wb25lbnQudHlwZSkgPT09IFwiVkVSU0lPTlwiIC8qIFZFUlNJT04gKi87XHJcbn1cblxuY29uc3QgbmFtZSRvID0gXCJAZmlyZWJhc2UvYXBwXCI7XG5jb25zdCB2ZXJzaW9uJDEgPSBcIjAuOC40XCI7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IGxvZ2dlciA9IG5ldyBMb2dnZXIoJ0BmaXJlYmFzZS9hcHAnKTtcblxuY29uc3QgbmFtZSRuID0gXCJAZmlyZWJhc2UvYXBwLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJG0gPSBcIkBmaXJlYmFzZS9hbmFseXRpY3MtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbCA9IFwiQGZpcmViYXNlL2FuYWx5dGljc1wiO1xuXG5jb25zdCBuYW1lJGsgPSBcIkBmaXJlYmFzZS9hcHAtY2hlY2stY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkaiA9IFwiQGZpcmViYXNlL2FwcC1jaGVja1wiO1xuXG5jb25zdCBuYW1lJGkgPSBcIkBmaXJlYmFzZS9hdXRoXCI7XG5cbmNvbnN0IG5hbWUkaCA9IFwiQGZpcmViYXNlL2F1dGgtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkZyA9IFwiQGZpcmViYXNlL2RhdGFiYXNlXCI7XG5cbmNvbnN0IG5hbWUkZiA9IFwiQGZpcmViYXNlL2RhdGFiYXNlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGUgPSBcIkBmaXJlYmFzZS9mdW5jdGlvbnNcIjtcblxuY29uc3QgbmFtZSRkID0gXCJAZmlyZWJhc2UvZnVuY3Rpb25zLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGMgPSBcIkBmaXJlYmFzZS9pbnN0YWxsYXRpb25zXCI7XG5cbmNvbnN0IG5hbWUkYiA9IFwiQGZpcmViYXNlL2luc3RhbGxhdGlvbnMtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkYSA9IFwiQGZpcmViYXNlL21lc3NhZ2luZ1wiO1xuXG5jb25zdCBuYW1lJDkgPSBcIkBmaXJlYmFzZS9tZXNzYWdpbmctY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkOCA9IFwiQGZpcmViYXNlL3BlcmZvcm1hbmNlXCI7XG5cbmNvbnN0IG5hbWUkNyA9IFwiQGZpcmViYXNlL3BlcmZvcm1hbmNlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDYgPSBcIkBmaXJlYmFzZS9yZW1vdGUtY29uZmlnXCI7XG5cbmNvbnN0IG5hbWUkNSA9IFwiQGZpcmViYXNlL3JlbW90ZS1jb25maWctY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkNCA9IFwiQGZpcmViYXNlL3N0b3JhZ2VcIjtcblxuY29uc3QgbmFtZSQzID0gXCJAZmlyZWJhc2Uvc3RvcmFnZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQyID0gXCJAZmlyZWJhc2UvZmlyZXN0b3JlXCI7XG5cbmNvbnN0IG5hbWUkMSA9IFwiQGZpcmViYXNlL2ZpcmVzdG9yZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSA9IFwiZmlyZWJhc2VcIjtcbmNvbnN0IHZlcnNpb24gPSBcIjkuMTQuMFwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgYXBwIG5hbWVcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcclxuY29uc3QgUExBVEZPUk1fTE9HX1NUUklORyA9IHtcclxuICAgIFtuYW1lJG9dOiAnZmlyZS1jb3JlJyxcclxuICAgIFtuYW1lJG5dOiAnZmlyZS1jb3JlLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRsXTogJ2ZpcmUtYW5hbHl0aWNzJyxcclxuICAgIFtuYW1lJG1dOiAnZmlyZS1hbmFseXRpY3MtY29tcGF0JyxcclxuICAgIFtuYW1lJGpdOiAnZmlyZS1hcHAtY2hlY2snLFxyXG4gICAgW25hbWUka106ICdmaXJlLWFwcC1jaGVjay1jb21wYXQnLFxyXG4gICAgW25hbWUkaV06ICdmaXJlLWF1dGgnLFxyXG4gICAgW25hbWUkaF06ICdmaXJlLWF1dGgtY29tcGF0JyxcclxuICAgIFtuYW1lJGddOiAnZmlyZS1ydGRiJyxcclxuICAgIFtuYW1lJGZdOiAnZmlyZS1ydGRiLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRlXTogJ2ZpcmUtZm4nLFxyXG4gICAgW25hbWUkZF06ICdmaXJlLWZuLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRjXTogJ2ZpcmUtaWlkJyxcclxuICAgIFtuYW1lJGJdOiAnZmlyZS1paWQtY29tcGF0JyxcclxuICAgIFtuYW1lJGFdOiAnZmlyZS1mY20nLFxyXG4gICAgW25hbWUkOV06ICdmaXJlLWZjbS1jb21wYXQnLFxyXG4gICAgW25hbWUkOF06ICdmaXJlLXBlcmYnLFxyXG4gICAgW25hbWUkN106ICdmaXJlLXBlcmYtY29tcGF0JyxcclxuICAgIFtuYW1lJDZdOiAnZmlyZS1yYycsXHJcbiAgICBbbmFtZSQ1XTogJ2ZpcmUtcmMtY29tcGF0JyxcclxuICAgIFtuYW1lJDRdOiAnZmlyZS1nY3MnLFxyXG4gICAgW25hbWUkM106ICdmaXJlLWdjcy1jb21wYXQnLFxyXG4gICAgW25hbWUkMl06ICdmaXJlLWZzdCcsXHJcbiAgICBbbmFtZSQxXTogJ2ZpcmUtZnN0LWNvbXBhdCcsXHJcbiAgICAnZmlyZS1qcyc6ICdmaXJlLWpzJyxcclxuICAgIFtuYW1lXTogJ2ZpcmUtanMtYWxsJ1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBfYXBwcyA9IG5ldyBNYXAoKTtcclxuLyoqXHJcbiAqIFJlZ2lzdGVyZWQgY29tcG9uZW50cy5cclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG5jb25zdCBfY29tcG9uZW50cyA9IG5ldyBNYXAoKTtcclxuLyoqXHJcbiAqIEBwYXJhbSBjb21wb25lbnQgLSB0aGUgY29tcG9uZW50IGJlaW5nIGFkZGVkIHRvIHRoaXMgYXBwJ3MgY29udGFpbmVyXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gX2FkZENvbXBvbmVudChhcHAsIGNvbXBvbmVudCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhcHAuY29udGFpbmVyLmFkZENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoYENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBmYWlsZWQgdG8gcmVnaXN0ZXIgd2l0aCBGaXJlYmFzZUFwcCAke2FwcC5uYW1lfWAsIGUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9hZGRPck92ZXJ3cml0ZUNvbXBvbmVudChhcHAsIGNvbXBvbmVudCkge1xyXG4gICAgYXBwLmNvbnRhaW5lci5hZGRPck92ZXJ3cml0ZUNvbXBvbmVudChjb21wb25lbnQpO1xyXG59XHJcbi8qKlxyXG4gKlxyXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCB0byByZWdpc3RlclxyXG4gKiBAcmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGUgY29tcG9uZW50IGlzIHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5XHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gX3JlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudCkge1xyXG4gICAgY29uc3QgY29tcG9uZW50TmFtZSA9IGNvbXBvbmVudC5uYW1lO1xyXG4gICAgaWYgKF9jb21wb25lbnRzLmhhcyhjb21wb25lbnROYW1lKSkge1xyXG4gICAgICAgIGxvZ2dlci5kZWJ1ZyhgVGhlcmUgd2VyZSBtdWx0aXBsZSBhdHRlbXB0cyB0byByZWdpc3RlciBjb21wb25lbnQgJHtjb21wb25lbnROYW1lfS5gKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBfY29tcG9uZW50cy5zZXQoY29tcG9uZW50TmFtZSwgY29tcG9uZW50KTtcclxuICAgIC8vIGFkZCB0aGUgY29tcG9uZW50IHRvIGV4aXN0aW5nIGFwcCBpbnN0YW5jZXNcclxuICAgIGZvciAoY29uc3QgYXBwIG9mIF9hcHBzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgX2FkZENvbXBvbmVudChhcHAsIGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSBuYW1lIC0gc2VydmljZSBuYW1lXHJcbiAqXHJcbiAqIEByZXR1cm5zIHRoZSBwcm92aWRlciBmb3IgdGhlIHNlcnZpY2Ugd2l0aCB0aGUgbWF0Y2hpbmcgbmFtZVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9nZXRQcm92aWRlcihhcHAsIG5hbWUpIHtcclxuICAgIGNvbnN0IGhlYXJ0YmVhdENvbnRyb2xsZXIgPSBhcHAuY29udGFpbmVyXHJcbiAgICAgICAgLmdldFByb3ZpZGVyKCdoZWFydGJlYXQnKVxyXG4gICAgICAgIC5nZXRJbW1lZGlhdGUoeyBvcHRpb25hbDogdHJ1ZSB9KTtcclxuICAgIGlmIChoZWFydGJlYXRDb250cm9sbGVyKSB7XHJcbiAgICAgICAgdm9pZCBoZWFydGJlYXRDb250cm9sbGVyLnRyaWdnZXJIZWFydGJlYXQoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcHAuY29udGFpbmVyLmdldFByb3ZpZGVyKG5hbWUpO1xyXG59XHJcbi8qKlxyXG4gKlxyXG4gKiBAcGFyYW0gYXBwIC0gRmlyZWJhc2VBcHAgaW5zdGFuY2VcclxuICogQHBhcmFtIG5hbWUgLSBzZXJ2aWNlIG5hbWVcclxuICogQHBhcmFtIGluc3RhbmNlSWRlbnRpZmllciAtIHNlcnZpY2UgaW5zdGFuY2UgaWRlbnRpZmllciBpbiBjYXNlIHRoZSBzZXJ2aWNlIHN1cHBvcnRzIG11bHRpcGxlIGluc3RhbmNlc1xyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UoYXBwLCBuYW1lLCBpbnN0YW5jZUlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgIF9nZXRQcm92aWRlcihhcHAsIG5hbWUpLmNsZWFySW5zdGFuY2UoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxufVxyXG4vKipcclxuICogVGVzdCBvbmx5XHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gX2NsZWFyQ29tcG9uZW50cygpIHtcclxuICAgIF9jb21wb25lbnRzLmNsZWFyKCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgRVJST1JTID0ge1xyXG4gICAgW1wibm8tYXBwXCIgLyogTk9fQVBQICovXTogXCJObyBGaXJlYmFzZSBBcHAgJ3skYXBwTmFtZX0nIGhhcyBiZWVuIGNyZWF0ZWQgLSBcIiArXHJcbiAgICAgICAgJ2NhbGwgRmlyZWJhc2UgQXBwLmluaXRpYWxpemVBcHAoKScsXHJcbiAgICBbXCJiYWQtYXBwLW5hbWVcIiAvKiBCQURfQVBQX05BTUUgKi9dOiBcIklsbGVnYWwgQXBwIG5hbWU6ICd7JGFwcE5hbWV9XCIsXHJcbiAgICBbXCJkdXBsaWNhdGUtYXBwXCIgLyogRFVQTElDQVRFX0FQUCAqL106IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JGFwcE5hbWV9JyBhbHJlYWR5IGV4aXN0cyB3aXRoIGRpZmZlcmVudCBvcHRpb25zIG9yIGNvbmZpZ1wiLFxyXG4gICAgW1wiYXBwLWRlbGV0ZWRcIiAvKiBBUFBfREVMRVRFRCAqL106IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JGFwcE5hbWV9JyBhbHJlYWR5IGRlbGV0ZWRcIixcclxuICAgIFtcIm5vLW9wdGlvbnNcIiAvKiBOT19PUFRJT05TICovXTogJ05lZWQgdG8gcHJvdmlkZSBvcHRpb25zLCB3aGVuIG5vdCBiZWluZyBkZXBsb3llZCB0byBob3N0aW5nIHZpYSBzb3VyY2UuJyxcclxuICAgIFtcImludmFsaWQtYXBwLWFyZ3VtZW50XCIgLyogSU5WQUxJRF9BUFBfQVJHVU1FTlQgKi9dOiAnZmlyZWJhc2UueyRhcHBOYW1lfSgpIHRha2VzIGVpdGhlciBubyBhcmd1bWVudCBvciBhICcgK1xyXG4gICAgICAgICdGaXJlYmFzZSBBcHAgaW5zdGFuY2UuJyxcclxuICAgIFtcImludmFsaWQtbG9nLWFyZ3VtZW50XCIgLyogSU5WQUxJRF9MT0dfQVJHVU1FTlQgKi9dOiAnRmlyc3QgYXJndW1lbnQgdG8gYG9uTG9nYCBtdXN0IGJlIG51bGwgb3IgYSBmdW5jdGlvbi4nLFxyXG4gICAgW1wiaWRiLW9wZW5cIiAvKiBJREJfT1BFTiAqL106ICdFcnJvciB0aHJvd24gd2hlbiBvcGVuaW5nIEluZGV4ZWREQi4gT3JpZ2luYWwgZXJyb3I6IHskb3JpZ2luYWxFcnJvck1lc3NhZ2V9LicsXHJcbiAgICBbXCJpZGItZ2V0XCIgLyogSURCX0dFVCAqL106ICdFcnJvciB0aHJvd24gd2hlbiByZWFkaW5nIGZyb20gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcclxuICAgIFtcImlkYi1zZXRcIiAvKiBJREJfV1JJVEUgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gd3JpdGluZyB0byBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxyXG4gICAgW1wiaWRiLWRlbGV0ZVwiIC8qIElEQl9ERUxFVEUgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gZGVsZXRpbmcgZnJvbSBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nXHJcbn07XHJcbmNvbnN0IEVSUk9SX0ZBQ1RPUlkgPSBuZXcgRXJyb3JGYWN0b3J5KCdhcHAnLCAnRmlyZWJhc2UnLCBFUlJPUlMpO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBGaXJlYmFzZUFwcEltcGwge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucywgY29uZmlnLCBjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLl9pc0RlbGV0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5fY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgY29uZmlnKTtcclxuICAgICAgICB0aGlzLl9uYW1lID0gY29uZmlnLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID1cclxuICAgICAgICAgICAgY29uZmlnLmF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ29tcG9uZW50KG5ldyBDb21wb25lbnQoJ2FwcCcsICgpID0+IHRoaXMsIFwiUFVCTElDXCIgLyogUFVCTElDICovKSk7XHJcbiAgICB9XHJcbiAgICBnZXQgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xyXG4gICAgfVxyXG4gICAgc2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCh2YWwpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID0gdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IG5hbWUoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xyXG4gICAgfVxyXG4gICAgZ2V0IG9wdGlvbnMoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xyXG4gICAgfVxyXG4gICAgZ2V0IGNvbmZpZygpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcclxuICAgIH1cclxuICAgIGdldCBjb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRhaW5lcjtcclxuICAgIH1cclxuICAgIGdldCBpc0RlbGV0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRGVsZXRlZDtcclxuICAgIH1cclxuICAgIHNldCBpc0RlbGV0ZWQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gdmFsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgdGhyb3cgYW4gRXJyb3IgaWYgdGhlIEFwcCBoYXMgYWxyZWFkeSBiZWVuIGRlbGV0ZWQgLVxyXG4gICAgICogdXNlIGJlZm9yZSBwZXJmb3JtaW5nIEFQSSBhY3Rpb25zIG9uIHRoZSBBcHAuXHJcbiAgICAgKi9cclxuICAgIGNoZWNrRGVzdHJveWVkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRGVsZXRlZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi8sIHsgYXBwTmFtZTogdGhpcy5fbmFtZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBjdXJyZW50IFNESyB2ZXJzaW9uLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBTREtfVkVSU0lPTiA9IHZlcnNpb247XHJcbmZ1bmN0aW9uIGluaXRpYWxpemVBcHAoX29wdGlvbnMsIHJhd0NvbmZpZyA9IHt9KSB7XHJcbiAgICBsZXQgb3B0aW9ucyA9IF9vcHRpb25zO1xyXG4gICAgaWYgKHR5cGVvZiByYXdDb25maWcgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgY29uc3QgbmFtZSA9IHJhd0NvbmZpZztcclxuICAgICAgICByYXdDb25maWcgPSB7IG5hbWUgfTtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oeyBuYW1lOiBERUZBVUxUX0VOVFJZX05BTUUsIGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDogZmFsc2UgfSwgcmF3Q29uZmlnKTtcclxuICAgIGNvbnN0IG5hbWUgPSBjb25maWcubmFtZTtcclxuICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycgfHwgIW5hbWUpIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImJhZC1hcHAtbmFtZVwiIC8qIEJBRF9BUFBfTkFNRSAqLywge1xyXG4gICAgICAgICAgICBhcHBOYW1lOiBTdHJpbmcobmFtZSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG9wdGlvbnMgfHwgKG9wdGlvbnMgPSBnZXREZWZhdWx0QXBwQ29uZmlnKCkpO1xyXG4gICAgaWYgKCFvcHRpb25zKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJuby1vcHRpb25zXCIgLyogTk9fT1BUSU9OUyAqLyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBleGlzdGluZ0FwcCA9IF9hcHBzLmdldChuYW1lKTtcclxuICAgIGlmIChleGlzdGluZ0FwcCkge1xyXG4gICAgICAgIC8vIHJldHVybiB0aGUgZXhpc3RpbmcgYXBwIGlmIG9wdGlvbnMgYW5kIGNvbmZpZyBkZWVwIGVxdWFsIHRoZSBvbmVzIGluIHRoZSBleGlzdGluZyBhcHAuXHJcbiAgICAgICAgaWYgKGRlZXBFcXVhbChvcHRpb25zLCBleGlzdGluZ0FwcC5vcHRpb25zKSAmJlxyXG4gICAgICAgICAgICBkZWVwRXF1YWwoY29uZmlnLCBleGlzdGluZ0FwcC5jb25maWcpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0FwcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiZHVwbGljYXRlLWFwcFwiIC8qIERVUExJQ0FURV9BUFAgKi8sIHsgYXBwTmFtZTogbmFtZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBuZXcgQ29tcG9uZW50Q29udGFpbmVyKG5hbWUpO1xyXG4gICAgZm9yIChjb25zdCBjb21wb25lbnQgb2YgX2NvbXBvbmVudHMudmFsdWVzKCkpIHtcclxuICAgICAgICBjb250YWluZXIuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBuZXdBcHAgPSBuZXcgRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKTtcclxuICAgIF9hcHBzLnNldChuYW1lLCBuZXdBcHApO1xyXG4gICAgcmV0dXJuIG5ld0FwcDtcclxufVxyXG4vKipcclxuICogUmV0cmlldmVzIGEge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9IGluc3RhbmNlLlxyXG4gKlxyXG4gKiBXaGVuIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50cywgdGhlIGRlZmF1bHQgYXBwIGlzIHJldHVybmVkLiBXaGVuIGFuIGFwcCBuYW1lXHJcbiAqIGlzIHByb3ZpZGVkLCB0aGUgYXBwIGNvcnJlc3BvbmRpbmcgdG8gdGhhdCBuYW1lIGlzIHJldHVybmVkLlxyXG4gKlxyXG4gKiBBbiBleGNlcHRpb24gaXMgdGhyb3duIGlmIHRoZSBhcHAgYmVpbmcgcmV0cmlldmVkIGhhcyBub3QgeWV0IGJlZW5cclxuICogaW5pdGlhbGl6ZWQuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gUmV0dXJuIHRoZSBkZWZhdWx0IGFwcFxyXG4gKiBjb25zdCBhcHAgPSBnZXRBcHAoKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gUmV0dXJuIGEgbmFtZWQgYXBwXHJcbiAqIGNvbnN0IG90aGVyQXBwID0gZ2V0QXBwKFwib3RoZXJBcHBcIik7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gbmFtZSAtIE9wdGlvbmFsIG5hbWUgb2YgdGhlIGFwcCB0byByZXR1cm4uIElmIG5vIG5hbWUgaXNcclxuICogICBwcm92aWRlZCwgdGhlIGRlZmF1bHQgaXMgYFwiW0RFRkFVTFRdXCJgLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBUaGUgYXBwIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb3ZpZGVkIGFwcCBuYW1lLlxyXG4gKiAgIElmIG5vIGFwcCBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgZGVmYXVsdCBhcHAgaXMgcmV0dXJuZWQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldEFwcChuYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBjb25zdCBhcHAgPSBfYXBwcy5nZXQobmFtZSk7XHJcbiAgICBpZiAoIWFwcCAmJiBuYW1lID09PSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gaW5pdGlhbGl6ZUFwcCgpO1xyXG4gICAgfVxyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcIm5vLWFwcFwiIC8qIE5PX0FQUCAqLywgeyBhcHBOYW1lOiBuYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFwcDtcclxufVxyXG4vKipcclxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXBwcygpIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKF9hcHBzLnZhbHVlcygpKTtcclxufVxyXG4vKipcclxuICogUmVuZGVycyB0aGlzIGFwcCB1bnVzYWJsZSBhbmQgZnJlZXMgdGhlIHJlc291cmNlcyBvZiBhbGwgYXNzb2NpYXRlZFxyXG4gKiBzZXJ2aWNlcy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBkZWxldGVBcHAoYXBwKVxyXG4gKiAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coXCJBcHAgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbiAqICAgfSlcclxuICogICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICogICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVsZXRpbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAqICAgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwKSB7XHJcbiAgICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XHJcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgX2FwcHMuZGVsZXRlKG5hbWUpO1xyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGFwcC5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4gcHJvdmlkZXIuZGVsZXRlKCkpKTtcclxuICAgICAgICBhcHAuaXNEZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXHJcbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXHJcbiAqIEBwYXJhbSB2ZXJzaW9uIC0gQ3VycmVudCB2ZXJzaW9uIG9mIHRoYXQgbGlicmFyeS5cclxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJWZXJzaW9uKGxpYnJhcnlLZXlPck5hbWUsIHZlcnNpb24sIHZhcmlhbnQpIHtcclxuICAgIHZhciBfYTtcclxuICAgIC8vIFRPRE86IFdlIGNhbiB1c2UgdGhpcyBjaGVjayB0byB3aGl0ZWxpc3Qgc3RyaW5ncyB3aGVuL2lmIHdlIHNldCB1cFxyXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXHJcbiAgICBsZXQgbGlicmFyeSA9IChfYSA9IFBMQVRGT1JNX0xPR19TVFJJTkdbbGlicmFyeUtleU9yTmFtZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxpYnJhcnlLZXlPck5hbWU7XHJcbiAgICBpZiAodmFyaWFudCkge1xyXG4gICAgICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpYnJhcnlNaXNtYXRjaCA9IGxpYnJhcnkubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgd2FybmluZyA9IFtcclxuICAgICAgICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgbGlicmFyeSBuYW1lIFwiJHtsaWJyYXJ5fVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCAmJiB2ZXJzaW9uTWlzbWF0Y2gpIHtcclxuICAgICAgICAgICAgd2FybmluZy5wdXNoKCdhbmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZlcnNpb25NaXNtYXRjaCkge1xyXG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goYHZlcnNpb24gbmFtZSBcIiR7dmVyc2lvbn1cIiBjb250YWlucyBpbGxlZ2FsIGNoYXJhY3RlcnMgKHdoaXRlc3BhY2Ugb3IgXCIvXCIpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChgJHtsaWJyYXJ5fS12ZXJzaW9uYCwgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSwgXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLykpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cclxuICogQHBhcmFtIGxvZ0NhbGxiYWNrIC0gQW4gb3B0aW9uYWwgY3VzdG9tIGxvZyBoYW5kbGVyIHRoYXQgZXhlY3V0ZXMgdXNlciBjb2RlIHdoZW5ldmVyXHJcbiAqIHRoZSBGaXJlYmFzZSBTREsgbWFrZXMgYSBsb2dnaW5nIGNhbGwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIG9uTG9nKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBpZiAobG9nQ2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGxvZ0NhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovKTtcclxuICAgIH1cclxuICAgIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKTtcclxufVxyXG4vKipcclxuICogU2V0cyBsb2cgbGV2ZWwgZm9yIGFsbCBGaXJlYmFzZSBTREtzLlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgYXJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgaW5mb2AsIGVycm9ycyBhcmUgbG9nZ2VkLCBidXQgYGRlYnVnYCBhbmRcclxuICogYHZlcmJvc2VgIGxvZ3MgYXJlIG5vdCkuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxvZ0xldmVsKSB7XHJcbiAgICBzZXRMb2dMZXZlbCQxKGxvZ0xldmVsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBEQl9OQU1FID0gJ2ZpcmViYXNlLWhlYXJ0YmVhdC1kYXRhYmFzZSc7XHJcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xyXG5jb25zdCBTVE9SRV9OQU1FID0gJ2ZpcmViYXNlLWhlYXJ0YmVhdC1zdG9yZSc7XHJcbmxldCBkYlByb21pc2UgPSBudWxsO1xyXG5mdW5jdGlvbiBnZXREYlByb21pc2UoKSB7XHJcbiAgICBpZiAoIWRiUHJvbWlzZSkge1xyXG4gICAgICAgIGRiUHJvbWlzZSA9IG9wZW5EQihEQl9OQU1FLCBEQl9WRVJTSU9OLCB7XHJcbiAgICAgICAgICAgIHVwZ3JhZGU6IChkYiwgb2xkVmVyc2lvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgdXNlICdicmVhaycgaW4gdGhpcyBzd2l0Y2ggc3RhdGVtZW50LCB0aGUgZmFsbC10aHJvdWdoXHJcbiAgICAgICAgICAgICAgICAvLyBiZWhhdmlvciBpcyB3aGF0IHdlIHdhbnQsIGJlY2F1c2UgaWYgdGhlcmUgYXJlIG11bHRpcGxlIHZlcnNpb25zIGJldHdlZW5cclxuICAgICAgICAgICAgICAgIC8vIHRoZSBvbGQgdmVyc2lvbiBhbmQgdGhlIGN1cnJlbnQgdmVyc2lvbiwgd2Ugd2FudCBBTEwgdGhlIG1pZ3JhdGlvbnNcclxuICAgICAgICAgICAgICAgIC8vIHRoYXQgY29ycmVzcG9uZCB0byB0aG9zZSB2ZXJzaW9ucyB0byBydW4sIG5vdCBvbmx5IHRoZSBsYXN0IG9uZS5cclxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZWZhdWx0LWNhc2VcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAob2xkVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoU1RPUkVfTkFNRSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpZGItb3BlblwiIC8qIElEQl9PUEVOICovLCB7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yTWVzc2FnZTogZS5tZXNzYWdlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRiUHJvbWlzZTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiByZWFkSGVhcnRiZWF0c0Zyb21JbmRleGVkREIoYXBwKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJQcm9taXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIGRiXHJcbiAgICAgICAgICAgIC50cmFuc2FjdGlvbihTVE9SRV9OQU1FKVxyXG4gICAgICAgICAgICAub2JqZWN0U3RvcmUoU1RPUkVfTkFNRSlcclxuICAgICAgICAgICAgLmdldChjb21wdXRlS2V5KGFwcCkpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZpcmViYXNlRXJyb3IpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oZS5tZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkYkdldEVycm9yID0gRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpZGItZ2V0XCIgLyogSURCX0dFVCAqLywge1xyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFcnJvck1lc3NhZ2U6IChfYSA9IGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tZXNzYWdlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBsb2dnZXIud2FybihpZGJHZXRFcnJvci5tZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gd3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIoYXBwLCBoZWFydGJlYXRPYmplY3QpIHtcclxuICAgIHZhciBfYTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcclxuICAgICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFNUT1JFX05BTUUpO1xyXG4gICAgICAgIGF3YWl0IG9iamVjdFN0b3JlLnB1dChoZWFydGJlYXRPYmplY3QsIGNvbXB1dGVLZXkoYXBwKSk7XHJcbiAgICAgICAgcmV0dXJuIHR4LmRvbmU7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmlyZWJhc2VFcnJvcikge1xyXG4gICAgICAgICAgICBsb2dnZXIud2FybihlLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaWRiR2V0RXJyb3IgPSBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImlkYi1zZXRcIiAvKiBJREJfV1JJVEUgKi8sIHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiAoX2EgPSBlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubWVzc2FnZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbG9nZ2VyLndhcm4oaWRiR2V0RXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGNvbXB1dGVLZXkoYXBwKSB7XHJcbiAgICByZXR1cm4gYCR7YXBwLm5hbWV9ISR7YXBwLm9wdGlvbnMuYXBwSWR9YDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBNQVhfSEVBREVSX0JZVEVTID0gMTAyNDtcclxuLy8gMzAgZGF5c1xyXG5jb25zdCBTVE9SRURfSEVBUlRCRUFUX1JFVEVOVElPTl9NQVhfTUlMTElTID0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xyXG5jbGFzcyBIZWFydGJlYXRTZXJ2aWNlSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBJbi1tZW1vcnkgY2FjaGUgZm9yIGhlYXJ0YmVhdHMsIHVzZWQgYnkgZ2V0SGVhcnRiZWF0c0hlYWRlcigpIHRvIGdlbmVyYXRlXHJcbiAgICAgICAgICogdGhlIGhlYWRlciBzdHJpbmcuXHJcbiAgICAgICAgICogU3RvcmVzIG9uZSByZWNvcmQgcGVyIGRhdGUuIFRoaXMgd2lsbCBiZSBjb25zb2xpZGF0ZWQgaW50byB0aGUgc3RhbmRhcmRcclxuICAgICAgICAgKiBmb3JtYXQgb2Ygb25lIHJlY29yZCBwZXIgdXNlciBhZ2VudCBzdHJpbmcgYmVmb3JlIGJlaW5nIHNlbnQgYXMgYSBoZWFkZXIuXHJcbiAgICAgICAgICogUG9wdWxhdGVkIGZyb20gaW5kZXhlZERCIHdoZW4gdGhlIGNvbnRyb2xsZXIgaXMgaW5zdGFudGlhdGVkIGFuZCBzaG91bGRcclxuICAgICAgICAgKiBiZSBrZXB0IGluIHN5bmMgd2l0aCBpbmRleGVkREIuXHJcbiAgICAgICAgICogTGVhdmUgcHVibGljIGZvciBlYXNpZXIgdGVzdGluZy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGFwcCA9IHRoaXMuY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcclxuICAgICAgICB0aGlzLl9zdG9yYWdlID0gbmV3IEhlYXJ0YmVhdFN0b3JhZ2VJbXBsKGFwcCk7XHJcbiAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlUHJvbWlzZSA9IHRoaXMuX3N0b3JhZ2UucmVhZCgpLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlID0gcmVzdWx0O1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgdG8gcmVwb3J0IGEgaGVhcnRiZWF0LiBUaGUgZnVuY3Rpb24gd2lsbCBnZW5lcmF0ZVxyXG4gICAgICogYSBIZWFydGJlYXRzQnlVc2VyQWdlbnQgb2JqZWN0LCB1cGRhdGUgaGVhcnRiZWF0c0NhY2hlLCBhbmQgcGVyc2lzdCBpdFxyXG4gICAgICogdG8gSW5kZXhlZERCLlxyXG4gICAgICogTm90ZSB0aGF0IHdlIG9ubHkgc3RvcmUgb25lIGhlYXJ0YmVhdCBwZXIgZGF5LiBTbyBpZiBhIGhlYXJ0YmVhdCBmb3IgdG9kYXkgaXNcclxuICAgICAqIGFscmVhZHkgbG9nZ2VkLCBzdWJzZXF1ZW50IGNhbGxzIHRvIHRoaXMgZnVuY3Rpb24gaW4gdGhlIHNhbWUgZGF5IHdpbGwgYmUgaWdub3JlZC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgdHJpZ2dlckhlYXJ0YmVhdCgpIHtcclxuICAgICAgICBjb25zdCBwbGF0Zm9ybUxvZ2dlciA9IHRoaXMuY29udGFpbmVyXHJcbiAgICAgICAgICAgIC5nZXRQcm92aWRlcigncGxhdGZvcm0tbG9nZ2VyJylcclxuICAgICAgICAgICAgLmdldEltbWVkaWF0ZSgpO1xyXG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIFwiRmlyZWJhc2UgdXNlciBhZ2VudFwiIHN0cmluZyBmcm9tIHRoZSBwbGF0Zm9ybSBsb2dnZXJcclxuICAgICAgICAvLyBzZXJ2aWNlLCBub3QgdGhlIGJyb3dzZXIgdXNlciBhZ2VudC5cclxuICAgICAgICBjb25zdCBhZ2VudCA9IHBsYXRmb3JtTG9nZ2VyLmdldFBsYXRmb3JtSW5mb1N0cmluZygpO1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBnZXRVVENEYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSBhd2FpdCB0aGlzLl9oZWFydGJlYXRzQ2FjaGVQcm9taXNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBEbyBub3Qgc3RvcmUgYSBoZWFydGJlYXQgaWYgb25lIGlzIGFscmVhZHkgc3RvcmVkIGZvciB0aGlzIGRheVxyXG4gICAgICAgIC8vIG9yIGlmIGEgaGVhZGVyIGhhcyBhbHJlYWR5IGJlZW4gc2VudCB0b2RheS5cclxuICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlLmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA9PT0gZGF0ZSB8fFxyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cy5zb21lKHNpbmdsZURhdGVIZWFydGJlYXQgPT4gc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlID09PSBkYXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGVyZSBpcyBubyBlbnRyeSBmb3IgdGhpcyBkYXRlLiBDcmVhdGUgb25lLlxyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cy5wdXNoKHsgZGF0ZSwgYWdlbnQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFJlbW92ZSBlbnRyaWVzIG9sZGVyIHRoYW4gMzAgZGF5cy5cclxuICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cyA9IHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLmZpbHRlcihzaW5nbGVEYXRlSGVhcnRiZWF0ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaGJUaW1lc3RhbXAgPSBuZXcgRGF0ZShzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUpLnZhbHVlT2YoKTtcclxuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5vdyAtIGhiVGltZXN0YW1wIDw9IFNUT1JFRF9IRUFSVEJFQVRfUkVURU5USU9OX01BWF9NSUxMSVM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcgd2hpY2ggY2FuIGJlIGF0dGFjaGVkIHRvIHRoZSBoZWFydGJlYXQtc3BlY2lmaWMgaGVhZGVyIGRpcmVjdGx5LlxyXG4gICAgICogSXQgYWxzbyBjbGVhcnMgYWxsIGhlYXJ0YmVhdHMgZnJvbSBtZW1vcnkgYXMgd2VsbCBhcyBpbiBJbmRleGVkREIuXHJcbiAgICAgKlxyXG4gICAgICogTk9URTogQ29uc3VtaW5nIHByb2R1Y3QgU0RLcyBzaG91bGQgbm90IHNlbmQgdGhlIGhlYWRlciBpZiB0aGlzIG1ldGhvZFxyXG4gICAgICogcmV0dXJucyBhbiBlbXB0eSBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGdldEhlYXJ0YmVhdHNIZWFkZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9oZWFydGJlYXRzQ2FjaGVQcm9taXNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBpdCdzIHN0aWxsIG51bGwgb3IgdGhlIGFycmF5IGlzIGVtcHR5LCB0aGVyZSBpcyBubyBkYXRhIHRvIHNlbmQuXHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9PT0gbnVsbCB8fFxyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkYXRlID0gZ2V0VVRDRGF0ZVN0cmluZygpO1xyXG4gICAgICAgIC8vIEV4dHJhY3QgYXMgbWFueSBoZWFydGJlYXRzIGZyb20gdGhlIGNhY2hlIGFzIHdpbGwgZml0IHVuZGVyIHRoZSBzaXplIGxpbWl0LlxyXG4gICAgICAgIGNvbnN0IHsgaGVhcnRiZWF0c1RvU2VuZCwgdW5zZW50RW50cmllcyB9ID0gZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIodGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMpO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlclN0cmluZyA9IGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKEpTT04uc3RyaW5naWZ5KHsgdmVyc2lvbjogMiwgaGVhcnRiZWF0czogaGVhcnRiZWF0c1RvU2VuZCB9KSk7XHJcbiAgICAgICAgLy8gU3RvcmUgbGFzdCBzZW50IGRhdGUgdG8gcHJldmVudCBhbm90aGVyIGJlaW5nIGxvZ2dlZC9zZW50IGZvciB0aGUgc2FtZSBkYXkuXHJcbiAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA9IGRhdGU7XHJcbiAgICAgICAgaWYgKHVuc2VudEVudHJpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyBTdG9yZSBhbnkgdW5zZW50IGVudHJpZXMgaWYgdGhleSBleGlzdC5cclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSB1bnNlbnRFbnRyaWVzO1xyXG4gICAgICAgICAgICAvLyBUaGlzIHNlZW1zIG1vcmUgbGlrZWx5IHRoYW4gZW1wdHlpbmcgdGhlIGFycmF5IChiZWxvdykgdG8gbGVhZCB0byBzb21lIG9kZCBzdGF0ZVxyXG4gICAgICAgICAgICAvLyBzaW5jZSB0aGUgY2FjaGUgaXNuJ3QgZW1wdHkgYW5kIHRoaXMgd2lsbCBiZSBjYWxsZWQgYWdhaW4gb24gdGhlIG5leHQgcmVxdWVzdCxcclxuICAgICAgICAgICAgLy8gYW5kIGlzIHByb2JhYmx5IHNhZmVzdCBpZiB3ZSBhd2FpdCBpdC5cclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fc3RvcmFnZS5vdmVyd3JpdGUodGhpcy5faGVhcnRiZWF0c0NhY2hlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzID0gW107XHJcbiAgICAgICAgICAgIC8vIERvIG5vdCB3YWl0IGZvciB0aGlzLCB0byByZWR1Y2UgbGF0ZW5jeS5cclxuICAgICAgICAgICAgdm9pZCB0aGlzLl9zdG9yYWdlLm92ZXJ3cml0ZSh0aGlzLl9oZWFydGJlYXRzQ2FjaGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGVhZGVyU3RyaW5nO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldFVUQ0RhdGVTdHJpbmcoKSB7XHJcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgICAvLyBSZXR1cm5zIGRhdGUgZm9ybWF0ICdZWVlZLU1NLUREJ1xyXG4gICAgcmV0dXJuIHRvZGF5LnRvSVNPU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDEwKTtcclxufVxyXG5mdW5jdGlvbiBleHRyYWN0SGVhcnRiZWF0c0ZvckhlYWRlcihoZWFydGJlYXRzQ2FjaGUsIG1heFNpemUgPSBNQVhfSEVBREVSX0JZVEVTKSB7XHJcbiAgICAvLyBIZWFydGJlYXRzIGdyb3VwZWQgYnkgdXNlciBhZ2VudCBpbiB0aGUgc3RhbmRhcmQgZm9ybWF0IHRvIGJlIHNlbnQgaW5cclxuICAgIC8vIHRoZSBoZWFkZXIuXHJcbiAgICBjb25zdCBoZWFydGJlYXRzVG9TZW5kID0gW107XHJcbiAgICAvLyBTaW5nbGUgZGF0ZSBmb3JtYXQgaGVhcnRiZWF0cyB0aGF0IGFyZSBub3Qgc2VudC5cclxuICAgIGxldCB1bnNlbnRFbnRyaWVzID0gaGVhcnRiZWF0c0NhY2hlLnNsaWNlKCk7XHJcbiAgICBmb3IgKGNvbnN0IHNpbmdsZURhdGVIZWFydGJlYXQgb2YgaGVhcnRiZWF0c0NhY2hlKSB7XHJcbiAgICAgICAgLy8gTG9vayBmb3IgYW4gZXhpc3RpbmcgZW50cnkgd2l0aCB0aGUgc2FtZSB1c2VyIGFnZW50LlxyXG4gICAgICAgIGNvbnN0IGhlYXJ0YmVhdEVudHJ5ID0gaGVhcnRiZWF0c1RvU2VuZC5maW5kKGhiID0+IGhiLmFnZW50ID09PSBzaW5nbGVEYXRlSGVhcnRiZWF0LmFnZW50KTtcclxuICAgICAgICBpZiAoIWhlYXJ0YmVhdEVudHJ5KSB7XHJcbiAgICAgICAgICAgIC8vIElmIG5vIGVudHJ5IGZvciB0aGlzIHVzZXIgYWdlbnQgZXhpc3RzLCBjcmVhdGUgb25lLlxyXG4gICAgICAgICAgICBoZWFydGJlYXRzVG9TZW5kLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgYWdlbnQ6IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnQsXHJcbiAgICAgICAgICAgICAgICBkYXRlczogW3NpbmdsZURhdGVIZWFydGJlYXQuZGF0ZV1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChjb3VudEJ5dGVzKGhlYXJ0YmVhdHNUb1NlbmQpID4gbWF4U2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGhlYWRlciB3b3VsZCBleGNlZWQgbWF4IHNpemUsIHJlbW92ZSB0aGUgYWRkZWQgaGVhcnRiZWF0XHJcbiAgICAgICAgICAgICAgICAvLyBlbnRyeSBhbmQgc3RvcCBhZGRpbmcgdG8gdGhlIGhlYWRlci5cclxuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaGVhcnRiZWF0RW50cnkuZGF0ZXMucHVzaChzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUpO1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgaGVhZGVyIHdvdWxkIGV4Y2VlZCBtYXggc2l6ZSwgcmVtb3ZlIHRoZSBhZGRlZCBkYXRlXHJcbiAgICAgICAgICAgIC8vIGFuZCBzdG9wIGFkZGluZyB0byB0aGUgaGVhZGVyLlxyXG4gICAgICAgICAgICBpZiAoY291bnRCeXRlcyhoZWFydGJlYXRzVG9TZW5kKSA+IG1heFNpemUpIHtcclxuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdEVudHJ5LmRhdGVzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUG9wIHVuc2VudCBlbnRyeSBmcm9tIHF1ZXVlLiAoU2tpcHBlZCBpZiBhZGRpbmcgdGhlIGVudHJ5IGV4Y2VlZGVkXHJcbiAgICAgICAgLy8gcXVvdGEgYW5kIHRoZSBsb29wIGJyZWFrcyBlYXJseS4pXHJcbiAgICAgICAgdW5zZW50RW50cmllcyA9IHVuc2VudEVudHJpZXMuc2xpY2UoMSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQsXHJcbiAgICAgICAgdW5zZW50RW50cmllc1xyXG4gICAgfTtcclxufVxyXG5jbGFzcyBIZWFydGJlYXRTdG9yYWdlSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlID0gdGhpcy5ydW5JbmRleGVkREJFbnZpcm9ubWVudENoZWNrKCk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBydW5JbmRleGVkREJFbnZpcm9ubWVudENoZWNrKCkge1xyXG4gICAgICAgIGlmICghaXNJbmRleGVkREJBdmFpbGFibGUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB0cnVlKVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKCgpID0+IGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlYWQgYWxsIGhlYXJ0YmVhdHMuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHJlYWQoKSB7XHJcbiAgICAgICAgY29uc3QgY2FuVXNlSW5kZXhlZERCID0gYXdhaXQgdGhpcy5fY2FuVXNlSW5kZXhlZERCUHJvbWlzZTtcclxuICAgICAgICBpZiAoIWNhblVzZUluZGV4ZWREQikge1xyXG4gICAgICAgICAgICByZXR1cm4geyBoZWFydGJlYXRzOiBbXSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaWRiSGVhcnRiZWF0T2JqZWN0ID0gYXdhaXQgcmVhZEhlYXJ0YmVhdHNGcm9tSW5kZXhlZERCKHRoaXMuYXBwKTtcclxuICAgICAgICAgICAgcmV0dXJuIGlkYkhlYXJ0YmVhdE9iamVjdCB8fCB7IGhlYXJ0YmVhdHM6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gb3ZlcndyaXRlIHRoZSBzdG9yYWdlIHdpdGggdGhlIHByb3ZpZGVkIGhlYXJ0YmVhdHNcclxuICAgIGFzeW5jIG92ZXJ3cml0ZShoZWFydGJlYXRzT2JqZWN0KSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIGNvbnN0IGNhblVzZUluZGV4ZWREQiA9IGF3YWl0IHRoaXMuX2NhblVzZUluZGV4ZWREQlByb21pc2U7XHJcbiAgICAgICAgaWYgKCFjYW5Vc2VJbmRleGVkREIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0ID0gYXdhaXQgdGhpcy5yZWFkKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQih0aGlzLmFwcCwge1xyXG4gICAgICAgICAgICAgICAgbGFzdFNlbnRIZWFydGJlYXREYXRlOiAoX2EgPSBoZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSxcclxuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdHM6IGhlYXJ0YmVhdHNPYmplY3QuaGVhcnRiZWF0c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBhZGQgaGVhcnRiZWF0c1xyXG4gICAgYXN5bmMgYWRkKGhlYXJ0YmVhdHNPYmplY3QpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3QgY2FuVXNlSW5kZXhlZERCID0gYXdhaXQgdGhpcy5fY2FuVXNlSW5kZXhlZERCUHJvbWlzZTtcclxuICAgICAgICBpZiAoIWNhblVzZUluZGV4ZWREQikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QgPSBhd2FpdCB0aGlzLnJlYWQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHdyaXRlSGVhcnRiZWF0c1RvSW5kZXhlZERCKHRoaXMuYXBwLCB7XHJcbiAgICAgICAgICAgICAgICBsYXN0U2VudEhlYXJ0YmVhdERhdGU6IChfYSA9IGhlYXJ0YmVhdHNPYmplY3QubGFzdFNlbnRIZWFydGJlYXREYXRlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QubGFzdFNlbnRIZWFydGJlYXREYXRlLFxyXG4gICAgICAgICAgICAgICAgaGVhcnRiZWF0czogW1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLmV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5oZWFydGJlYXRzLFxyXG4gICAgICAgICAgICAgICAgICAgIC4uLmhlYXJ0YmVhdHNPYmplY3QuaGVhcnRiZWF0c1xyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBieXRlcyBvZiBhIEhlYXJ0YmVhdHNCeVVzZXJBZ2VudCBhcnJheSBhZnRlciBiZWluZyB3cmFwcGVkXHJcbiAqIGluIGEgcGxhdGZvcm0gbG9nZ2luZyBoZWFkZXIgSlNPTiBvYmplY3QsIHN0cmluZ2lmaWVkLCBhbmQgY29udmVydGVkXHJcbiAqIHRvIGJhc2UgNjQuXHJcbiAqL1xyXG5mdW5jdGlvbiBjb3VudEJ5dGVzKGhlYXJ0YmVhdHNDYWNoZSkge1xyXG4gICAgLy8gYmFzZTY0IGhhcyBhIHJlc3RyaWN0ZWQgc2V0IG9mIGNoYXJhY3RlcnMsIGFsbCBvZiB3aGljaCBzaG91bGQgYmUgMSBieXRlLlxyXG4gICAgcmV0dXJuIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKFxyXG4gICAgLy8gaGVhcnRiZWF0c0NhY2hlIHdyYXBwZXIgcHJvcGVydGllc1xyXG4gICAgSlNPTi5zdHJpbmdpZnkoeyB2ZXJzaW9uOiAyLCBoZWFydGJlYXRzOiBoZWFydGJlYXRzQ2FjaGUgfSkpLmxlbmd0aDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlckNvcmVDb21wb25lbnRzKHZhcmlhbnQpIHtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdwbGF0Zm9ybS1sb2dnZXInLCBjb250YWluZXIgPT4gbmV3IFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogUFJJVkFURSAqLykpO1xyXG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoJ2hlYXJ0YmVhdCcsIGNvbnRhaW5lciA9PiBuZXcgSGVhcnRiZWF0U2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogUFJJVkFURSAqLykpO1xyXG4gICAgLy8gUmVnaXN0ZXIgYGFwcGAgcGFja2FnZS5cclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJG8sIHZlcnNpb24kMSwgdmFyaWFudCk7XHJcbiAgICAvLyBCVUlMRF9UQVJHRVQgd2lsbCBiZSByZXBsYWNlZCBieSB2YWx1ZXMgbGlrZSBlc201LCBlc20yMDE3LCBjanM1LCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxyXG4gICAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUkbywgdmVyc2lvbiQxLCAnZXNtMjAxNycpO1xyXG4gICAgLy8gUmVnaXN0ZXIgcGxhdGZvcm0gU0RLIGlkZW50aWZpZXIgKG5vIHZlcnNpb24pLlxyXG4gICAgcmVnaXN0ZXJWZXJzaW9uKCdmaXJlLWpzJywgJycpO1xyXG59XG5cbi8qKlxyXG4gKiBGaXJlYmFzZSBBcHBcclxuICpcclxuICogQHJlbWFya3MgVGhpcyBwYWNrYWdlIGNvb3JkaW5hdGVzIHRoZSBjb21tdW5pY2F0aW9uIGJldHdlZW4gdGhlIGRpZmZlcmVudCBGaXJlYmFzZSBjb21wb25lbnRzXHJcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxyXG4gKi9cclxucmVnaXN0ZXJDb3JlQ29tcG9uZW50cygnJyk7XG5cbmV4cG9ydCB7IFNES19WRVJTSU9OLCBERUZBVUxUX0VOVFJZX05BTUUgYXMgX0RFRkFVTFRfRU5UUllfTkFNRSwgX2FkZENvbXBvbmVudCwgX2FkZE9yT3ZlcndyaXRlQ29tcG9uZW50LCBfYXBwcywgX2NsZWFyQ29tcG9uZW50cywgX2NvbXBvbmVudHMsIF9nZXRQcm92aWRlciwgX3JlZ2lzdGVyQ29tcG9uZW50LCBfcmVtb3ZlU2VydmljZUluc3RhbmNlLCBkZWxldGVBcHAsIGdldEFwcCwgZ2V0QXBwcywgaW5pdGlhbGl6ZUFwcCwgb25Mb2csIHJlZ2lzdGVyVmVyc2lvbiwgc2V0TG9nTGV2ZWwgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyByZWdpc3RlclZlcnNpb24gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmV4cG9ydCAqIGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG52YXIgbmFtZSA9IFwiZmlyZWJhc2VcIjtcbnZhciB2ZXJzaW9uID0gXCI5LjE0LjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxucmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdhcHAnKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiIsInZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG52YXIgZXNtID0ge307XG5cbi8qXG5cbiBDb3B5cmlnaHQgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLlxuIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4qL1xuXG52YXIgayxnb29nPWdvb2d8fHt9LGw9Y29tbW9uanNHbG9iYWx8fHNlbGY7ZnVuY3Rpb24gYWEoKXt9ZnVuY3Rpb24gYmEoYSl7dmFyIGI9dHlwZW9mIGE7Yj1cIm9iamVjdFwiIT1iP2I6YT9BcnJheS5pc0FycmF5KGEpP1wiYXJyYXlcIjpiOlwibnVsbFwiO3JldHVybiBcImFycmF5XCI9PWJ8fFwib2JqZWN0XCI9PWImJlwibnVtYmVyXCI9PXR5cGVvZiBhLmxlbmd0aH1mdW5jdGlvbiBwKGEpe3ZhciBiPXR5cGVvZiBhO3JldHVybiBcIm9iamVjdFwiPT1iJiZudWxsIT1hfHxcImZ1bmN0aW9uXCI9PWJ9ZnVuY3Rpb24gY2EoYSl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLGRhKSYmYVtkYV18fChhW2RhXT0rK2VhKX12YXIgZGE9XCJjbG9zdXJlX3VpZF9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKSxlYT0wO2Z1bmN0aW9uIGZhKGEsYixjKXtyZXR1cm4gYS5jYWxsLmFwcGx5KGEuYmluZCxhcmd1bWVudHMpfVxuZnVuY3Rpb24gaGEoYSxiLGMpe2lmKCFhKXRocm93IEVycm9yKCk7aWYoMjxhcmd1bWVudHMubGVuZ3RoKXt2YXIgZD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtBcnJheS5wcm90b3R5cGUudW5zaGlmdC5hcHBseShlLGQpO3JldHVybiBhLmFwcGx5KGIsZSl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gcShhLGIsYyl7RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQmJi0xIT1GdW5jdGlvbi5wcm90b3R5cGUuYmluZC50b1N0cmluZygpLmluZGV4T2YoXCJuYXRpdmUgY29kZVwiKT9xPWZhOnE9aGE7cmV0dXJuIHEuYXBwbHkobnVsbCxhcmd1bWVudHMpfVxuZnVuY3Rpb24gaWEoYSxiKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9Yy5zbGljZSgpO2QucHVzaC5hcHBseShkLGFyZ3VtZW50cyk7cmV0dXJuIGEuYXBwbHkodGhpcyxkKX19ZnVuY3Rpb24gdChhLGIpe2Z1bmN0aW9uIGMoKXt9Yy5wcm90b3R5cGU9Yi5wcm90b3R5cGU7YS5YPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO2EucHJvdG90eXBlLmNvbnN0cnVjdG9yPWE7YS5XYj1mdW5jdGlvbihkLGUsZil7Zm9yKHZhciBoPUFycmF5KGFyZ3VtZW50cy5sZW5ndGgtMiksbj0yO248YXJndW1lbnRzLmxlbmd0aDtuKyspaFtuLTJdPWFyZ3VtZW50c1tuXTtyZXR1cm4gYi5wcm90b3R5cGVbZV0uYXBwbHkoZCxoKX07fWZ1bmN0aW9uIHYoKXt0aGlzLnM9dGhpcy5zO3RoaXMubz10aGlzLm87fXZhciBqYT0wO3YucHJvdG90eXBlLnM9ITE7di5wcm90b3R5cGUubmE9ZnVuY3Rpb24oKXtpZighdGhpcy5zJiYodGhpcy5zPSEwLHRoaXMuTSgpLDAhPWphKSl7Y2EodGhpcyk7fX07di5wcm90b3R5cGUuTT1mdW5jdGlvbigpe2lmKHRoaXMubylmb3IoO3RoaXMuby5sZW5ndGg7KXRoaXMuby5zaGlmdCgpKCk7fTtjb25zdCBsYT1BcnJheS5wcm90b3R5cGUuaW5kZXhPZj9mdW5jdGlvbihhLGIpe3JldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsYix2b2lkIDApfTpmdW5jdGlvbihhLGIpe2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gXCJzdHJpbmdcIiE9PXR5cGVvZiBifHwxIT1iLmxlbmd0aD8tMTphLmluZGV4T2YoYiwwKTtmb3IobGV0IGM9MDtjPGEubGVuZ3RoO2MrKylpZihjIGluIGEmJmFbY109PT1iKXJldHVybiBjO3JldHVybiAtMX07ZnVuY3Rpb24gbWEoYSl7Y29uc3QgYj1hLmxlbmd0aDtpZigwPGIpe2NvbnN0IGM9QXJyYXkoYik7Zm9yKGxldCBkPTA7ZDxiO2QrKyljW2RdPWFbZF07cmV0dXJuIGN9cmV0dXJuIFtdfVxuZnVuY3Rpb24gbmEoYSxiKXtmb3IobGV0IGM9MTtjPGFyZ3VtZW50cy5sZW5ndGg7YysrKXtjb25zdCBkPWFyZ3VtZW50c1tjXTtpZihiYShkKSl7Y29uc3QgZT1hLmxlbmd0aHx8MCxmPWQubGVuZ3RofHwwO2EubGVuZ3RoPWUrZjtmb3IobGV0IGg9MDtoPGY7aCsrKWFbZStoXT1kW2hdO31lbHNlIGEucHVzaChkKTt9fWZ1bmN0aW9uIHcoYSxiKXt0aGlzLnR5cGU9YTt0aGlzLmc9dGhpcy50YXJnZXQ9Yjt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITE7fXcucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITA7fTt2YXIgb2E9ZnVuY3Rpb24oKXtpZighbC5hZGRFdmVudExpc3RlbmVyfHwhT2JqZWN0LmRlZmluZVByb3BlcnR5KXJldHVybiAhMTt2YXIgYT0hMSxiPU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSxcInBhc3NpdmVcIix7Z2V0OmZ1bmN0aW9uKCl7YT0hMDt9fSk7dHJ5e2wuYWRkRXZlbnRMaXN0ZW5lcihcInRlc3RcIixhYSxiKSxsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYWEsYik7fWNhdGNoKGMpe31yZXR1cm4gYX0oKTtmdW5jdGlvbiBwYShhKXtyZXR1cm4gL15bXFxzXFx4YTBdKiQvLnRlc3QoYSl9dmFyIHFhPVN0cmluZy5wcm90b3R5cGUudHJpbT9mdW5jdGlvbihhKXtyZXR1cm4gYS50cmltKCl9OmZ1bmN0aW9uKGEpe3JldHVybiAvXltcXHNcXHhhMF0qKFtcXHNcXFNdKj8pW1xcc1xceGEwXSokLy5leGVjKGEpWzFdfTtmdW5jdGlvbiByYShhLGIpe3JldHVybiBhPGI/LTE6YT5iPzE6MH1mdW5jdGlvbiBzYSgpe3ZhciBhPWwubmF2aWdhdG9yO3JldHVybiBhJiYoYT1hLnVzZXJBZ2VudCk/YTpcIlwifWZ1bmN0aW9uIHgoYSl7cmV0dXJuIC0xIT1zYSgpLmluZGV4T2YoYSl9ZnVuY3Rpb24gdGEoYSl7dGFbXCIgXCJdKGEpO3JldHVybiBhfXRhW1wiIFwiXT1hYTtmdW5jdGlvbiB1YShhKXt2YXIgYj12YTtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsOSk/Yls5XTpiWzldPWEoOSl9dmFyIHdhPXgoXCJPcGVyYVwiKSx5PXgoXCJUcmlkZW50XCIpfHx4KFwiTVNJRVwiKSx4YT14KFwiRWRnZVwiKSx5YT14YXx8eSx6YT14KFwiR2Vja29cIikmJiEoLTEhPXNhKCkudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwid2Via2l0XCIpJiYheChcIkVkZ2VcIikpJiYhKHgoXCJUcmlkZW50XCIpfHx4KFwiTVNJRVwiKSkmJiF4KFwiRWRnZVwiKSxBYT0tMSE9c2EoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJ3ZWJraXRcIikmJiF4KFwiRWRnZVwiKTtmdW5jdGlvbiBCYSgpe3ZhciBhPWwuZG9jdW1lbnQ7cmV0dXJuIGE/YS5kb2N1bWVudE1vZGU6dm9pZCAwfXZhciBFYTtcbmE6e3ZhciBGYT1cIlwiLEdhPWZ1bmN0aW9uKCl7dmFyIGE9c2EoKTtpZih6YSlyZXR1cm4gL3J2OihbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpO2lmKHhhKXJldHVybiAvRWRnZVxcLyhbXFxkXFwuXSspLy5leGVjKGEpO2lmKHkpcmV0dXJuIC9cXGIoPzpNU0lFfHJ2KVs6IF0oW15cXCk7XSspKFxcKXw7KS8uZXhlYyhhKTtpZihBYSlyZXR1cm4gL1dlYktpdFxcLyhcXFMrKS8uZXhlYyhhKTtpZih3YSlyZXR1cm4gLyg/OlZlcnNpb24pWyBcXC9dPyhcXFMrKS8uZXhlYyhhKX0oKTtHYSYmKEZhPUdhP0dhWzFdOlwiXCIpO2lmKHkpe3ZhciBIYT1CYSgpO2lmKG51bGwhPUhhJiZIYT5wYXJzZUZsb2F0KEZhKSl7RWE9U3RyaW5nKEhhKTticmVhayBhfX1FYT1GYTt9dmFyIHZhPXt9O1xuZnVuY3Rpb24gSWEoKXtyZXR1cm4gdWEoZnVuY3Rpb24oKXtsZXQgYT0wO2NvbnN0IGI9cWEoU3RyaW5nKEVhKSkuc3BsaXQoXCIuXCIpLGM9cWEoXCI5XCIpLnNwbGl0KFwiLlwiKSxkPU1hdGgubWF4KGIubGVuZ3RoLGMubGVuZ3RoKTtmb3IobGV0IGg9MDswPT1hJiZoPGQ7aCsrKXt2YXIgZT1iW2hdfHxcIlwiLGY9Y1toXXx8XCJcIjtkb3tlPS8oXFxkKikoXFxEKikoLiopLy5leGVjKGUpfHxbXCJcIixcIlwiLFwiXCIsXCJcIl07Zj0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhmKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO2lmKDA9PWVbMF0ubGVuZ3RoJiYwPT1mWzBdLmxlbmd0aClicmVhazthPXJhKDA9PWVbMV0ubGVuZ3RoPzA6cGFyc2VJbnQoZVsxXSwxMCksMD09ZlsxXS5sZW5ndGg/MDpwYXJzZUludChmWzFdLDEwKSl8fHJhKDA9PWVbMl0ubGVuZ3RoLDA9PWZbMl0ubGVuZ3RoKXx8cmEoZVsyXSxmWzJdKTtlPWVbM107Zj1mWzNdO313aGlsZSgwPT1hKX1yZXR1cm4gMDw9YX0pfXZhciBKYTtcbmlmKGwuZG9jdW1lbnQmJnkpe3ZhciBLYT1CYSgpO0phPUthP0thOnBhcnNlSW50KEVhLDEwKXx8dm9pZCAwO31lbHNlIEphPXZvaWQgMDt2YXIgTGE9SmE7ZnVuY3Rpb24geihhLGIpe3cuY2FsbCh0aGlzLGE/YS50eXBlOlwiXCIpO3RoaXMucmVsYXRlZFRhcmdldD10aGlzLmc9dGhpcy50YXJnZXQ9bnVsbDt0aGlzLmJ1dHRvbj10aGlzLnNjcmVlblk9dGhpcy5zY3JlZW5YPXRoaXMuY2xpZW50WT10aGlzLmNsaWVudFg9MDt0aGlzLmtleT1cIlwiO3RoaXMubWV0YUtleT10aGlzLnNoaWZ0S2V5PXRoaXMuYWx0S2V5PXRoaXMuY3RybEtleT0hMTt0aGlzLnN0YXRlPW51bGw7dGhpcy5wb2ludGVySWQ9MDt0aGlzLnBvaW50ZXJUeXBlPVwiXCI7dGhpcy5pPW51bGw7aWYoYSl7dmFyIGM9dGhpcy50eXBlPWEudHlwZSxkPWEuY2hhbmdlZFRvdWNoZXMmJmEuY2hhbmdlZFRvdWNoZXMubGVuZ3RoP2EuY2hhbmdlZFRvdWNoZXNbMF06bnVsbDt0aGlzLnRhcmdldD1hLnRhcmdldHx8YS5zcmNFbGVtZW50O3RoaXMuZz1iO2lmKGI9YS5yZWxhdGVkVGFyZ2V0KXtpZih6YSl7YTp7dHJ5e3RhKGIubm9kZU5hbWUpO3ZhciBlPSEwO2JyZWFrIGF9Y2F0Y2goZil7fWU9XG4hMTt9ZXx8KGI9bnVsbCk7fX1lbHNlIFwibW91c2VvdmVyXCI9PWM/Yj1hLmZyb21FbGVtZW50OlwibW91c2VvdXRcIj09YyYmKGI9YS50b0VsZW1lbnQpO3RoaXMucmVsYXRlZFRhcmdldD1iO2Q/KHRoaXMuY2xpZW50WD12b2lkIDAhPT1kLmNsaWVudFg/ZC5jbGllbnRYOmQucGFnZVgsdGhpcy5jbGllbnRZPXZvaWQgMCE9PWQuY2xpZW50WT9kLmNsaWVudFk6ZC5wYWdlWSx0aGlzLnNjcmVlblg9ZC5zY3JlZW5YfHwwLHRoaXMuc2NyZWVuWT1kLnNjcmVlbll8fDApOih0aGlzLmNsaWVudFg9dm9pZCAwIT09YS5jbGllbnRYP2EuY2xpZW50WDphLnBhZ2VYLHRoaXMuY2xpZW50WT12b2lkIDAhPT1hLmNsaWVudFk/YS5jbGllbnRZOmEucGFnZVksdGhpcy5zY3JlZW5YPWEuc2NyZWVuWHx8MCx0aGlzLnNjcmVlblk9YS5zY3JlZW5ZfHwwKTt0aGlzLmJ1dHRvbj1hLmJ1dHRvbjt0aGlzLmtleT1hLmtleXx8XCJcIjt0aGlzLmN0cmxLZXk9YS5jdHJsS2V5O3RoaXMuYWx0S2V5PWEuYWx0S2V5O3RoaXMuc2hpZnRLZXk9XG5hLnNoaWZ0S2V5O3RoaXMubWV0YUtleT1hLm1ldGFLZXk7dGhpcy5wb2ludGVySWQ9YS5wb2ludGVySWR8fDA7dGhpcy5wb2ludGVyVHlwZT1cInN0cmluZ1wiPT09dHlwZW9mIGEucG9pbnRlclR5cGU/YS5wb2ludGVyVHlwZTpNYVthLnBvaW50ZXJUeXBlXXx8XCJcIjt0aGlzLnN0YXRlPWEuc3RhdGU7dGhpcy5pPWE7YS5kZWZhdWx0UHJldmVudGVkJiZ6LlguaC5jYWxsKHRoaXMpO319dCh6LHcpO3ZhciBNYT17MjpcInRvdWNoXCIsMzpcInBlblwiLDQ6XCJtb3VzZVwifTt6LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7ei5YLmguY2FsbCh0aGlzKTt2YXIgYT10aGlzLmk7YS5wcmV2ZW50RGVmYXVsdD9hLnByZXZlbnREZWZhdWx0KCk6YS5yZXR1cm5WYWx1ZT0hMTt9O3ZhciBBPVwiY2xvc3VyZV9saXN0ZW5hYmxlX1wiKygxRTYqTWF0aC5yYW5kb20oKXwwKTt2YXIgTmE9MDtmdW5jdGlvbiBPYShhLGIsYyxkLGUpe3RoaXMubGlzdGVuZXI9YTt0aGlzLnByb3h5PW51bGw7dGhpcy5zcmM9Yjt0aGlzLnR5cGU9Yzt0aGlzLmNhcHR1cmU9ISFkO3RoaXMuaGE9ZTt0aGlzLmtleT0rK05hO3RoaXMuYmE9dGhpcy5lYT0hMTt9ZnVuY3Rpb24gUGEoYSl7YS5iYT0hMDthLmxpc3RlbmVyPW51bGw7YS5wcm94eT1udWxsO2Euc3JjPW51bGw7YS5oYT1udWxsO31mdW5jdGlvbiBRYShhLGIsYyl7Zm9yKGNvbnN0IGQgaW4gYSliLmNhbGwoYyxhW2RdLGQsYSk7fWZ1bmN0aW9uIFJhKGEpe2NvbnN0IGI9e307Zm9yKGNvbnN0IGMgaW4gYSliW2NdPWFbY107cmV0dXJuIGJ9Y29uc3QgU2E9XCJjb25zdHJ1Y3RvciBoYXNPd25Qcm9wZXJ0eSBpc1Byb3RvdHlwZU9mIHByb3BlcnR5SXNFbnVtZXJhYmxlIHRvTG9jYWxlU3RyaW5nIHRvU3RyaW5nIHZhbHVlT2ZcIi5zcGxpdChcIiBcIik7ZnVuY3Rpb24gVGEoYSxiKXtsZXQgYyxkO2ZvcihsZXQgZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspe2Q9YXJndW1lbnRzW2VdO2ZvcihjIGluIGQpYVtjXT1kW2NdO2ZvcihsZXQgZj0wO2Y8U2EubGVuZ3RoO2YrKyljPVNhW2ZdLE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLGMpJiYoYVtjXT1kW2NdKTt9fWZ1bmN0aW9uIFVhKGEpe3RoaXMuc3JjPWE7dGhpcy5nPXt9O3RoaXMuaD0wO31VYS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9YS50b1N0cmluZygpO2E9dGhpcy5nW2ZdO2F8fChhPXRoaXMuZ1tmXT1bXSx0aGlzLmgrKyk7dmFyIGg9VmEoYSxiLGQsZSk7LTE8aD8oYj1hW2hdLGN8fChiLmVhPSExKSk6KGI9bmV3IE9hKGIsdGhpcy5zcmMsZiwhIWQsZSksYi5lYT1jLGEucHVzaChiKSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIFdhKGEsYil7dmFyIGM9Yi50eXBlO2lmKGMgaW4gYS5nKXt2YXIgZD1hLmdbY10sZT1sYShkLGIpLGY7KGY9MDw9ZSkmJkFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChkLGUsMSk7ZiYmKFBhKGIpLDA9PWEuZ1tjXS5sZW5ndGgmJihkZWxldGUgYS5nW2NdLGEuaC0tKSk7fX1cbmZ1bmN0aW9uIFZhKGEsYixjLGQpe2Zvcih2YXIgZT0wO2U8YS5sZW5ndGg7KytlKXt2YXIgZj1hW2VdO2lmKCFmLmJhJiZmLmxpc3RlbmVyPT1iJiZmLmNhcHR1cmU9PSEhYyYmZi5oYT09ZClyZXR1cm4gZX1yZXR1cm4gLTF9dmFyIFhhPVwiY2xvc3VyZV9sbV9cIisoMUU2Kk1hdGgucmFuZG9tKCl8MCksWWE9e307ZnVuY3Rpb24gJGEoYSxiLGMsZCxlKXtpZihkJiZkLm9uY2UpcmV0dXJuIGFiKGEsYixjLGQsZSk7aWYoQXJyYXkuaXNBcnJheShiKSl7Zm9yKHZhciBmPTA7ZjxiLmxlbmd0aDtmKyspJGEoYSxiW2ZdLGMsZCxlKTtyZXR1cm4gbnVsbH1jPWJiKGMpO3JldHVybiBhJiZhW0FdP2EuTihiLGMscChkKT8hIWQuY2FwdHVyZTohIWQsZSk6Y2IoYSxiLGMsITEsZCxlKX1cbmZ1bmN0aW9uIGNiKGEsYixjLGQsZSxmKXtpZighYil0aHJvdyBFcnJvcihcIkludmFsaWQgZXZlbnQgdHlwZVwiKTt2YXIgaD1wKGUpPyEhZS5jYXB0dXJlOiEhZSxuPWRiKGEpO258fChhW1hhXT1uPW5ldyBVYShhKSk7Yz1uLmFkZChiLGMsZCxoLGYpO2lmKGMucHJveHkpcmV0dXJuIGM7ZD1lYigpO2MucHJveHk9ZDtkLnNyYz1hO2QubGlzdGVuZXI9YztpZihhLmFkZEV2ZW50TGlzdGVuZXIpb2F8fChlPWgpLHZvaWQgMD09PWUmJihlPSExKSxhLmFkZEV2ZW50TGlzdGVuZXIoYi50b1N0cmluZygpLGQsZSk7ZWxzZSBpZihhLmF0dGFjaEV2ZW50KWEuYXR0YWNoRXZlbnQoZmIoYi50b1N0cmluZygpKSxkKTtlbHNlIGlmKGEuYWRkTGlzdGVuZXImJmEucmVtb3ZlTGlzdGVuZXIpYS5hZGRMaXN0ZW5lcihkKTtlbHNlIHRocm93IEVycm9yKFwiYWRkRXZlbnRMaXN0ZW5lciBhbmQgYXR0YWNoRXZlbnQgYXJlIHVuYXZhaWxhYmxlLlwiKTtyZXR1cm4gY31cbmZ1bmN0aW9uIGViKCl7ZnVuY3Rpb24gYShjKXtyZXR1cm4gYi5jYWxsKGEuc3JjLGEubGlzdGVuZXIsYyl9Y29uc3QgYj1nYjtyZXR1cm4gYX1mdW5jdGlvbiBhYihhLGIsYyxkLGUpe2lmKEFycmF5LmlzQXJyYXkoYikpe2Zvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKWFiKGEsYltmXSxjLGQsZSk7cmV0dXJuIG51bGx9Yz1iYihjKTtyZXR1cm4gYSYmYVtBXT9hLk8oYixjLHAoZCk/ISFkLmNhcHR1cmU6ISFkLGUpOmNiKGEsYixjLCEwLGQsZSl9XG5mdW5jdGlvbiBoYihhLGIsYyxkLGUpe2lmKEFycmF5LmlzQXJyYXkoYikpZm9yKHZhciBmPTA7ZjxiLmxlbmd0aDtmKyspaGIoYSxiW2ZdLGMsZCxlKTtlbHNlIChkPXAoZCk/ISFkLmNhcHR1cmU6ISFkLGM9YmIoYyksYSYmYVtBXSk/KGE9YS5pLGI9U3RyaW5nKGIpLnRvU3RyaW5nKCksYiBpbiBhLmcmJihmPWEuZ1tiXSxjPVZhKGYsYyxkLGUpLC0xPGMmJihQYShmW2NdKSxBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoZixjLDEpLDA9PWYubGVuZ3RoJiYoZGVsZXRlIGEuZ1tiXSxhLmgtLSkpKSk6YSYmKGE9ZGIoYSkpJiYoYj1hLmdbYi50b1N0cmluZygpXSxhPS0xLGImJihhPVZhKGIsYyxkLGUpKSwoYz0tMTxhP2JbYV06bnVsbCkmJmliKGMpKTt9XG5mdW5jdGlvbiBpYihhKXtpZihcIm51bWJlclwiIT09dHlwZW9mIGEmJmEmJiFhLmJhKXt2YXIgYj1hLnNyYztpZihiJiZiW0FdKVdhKGIuaSxhKTtlbHNlIHt2YXIgYz1hLnR5cGUsZD1hLnByb3h5O2IucmVtb3ZlRXZlbnRMaXN0ZW5lcj9iLnJlbW92ZUV2ZW50TGlzdGVuZXIoYyxkLGEuY2FwdHVyZSk6Yi5kZXRhY2hFdmVudD9iLmRldGFjaEV2ZW50KGZiKGMpLGQpOmIuYWRkTGlzdGVuZXImJmIucmVtb3ZlTGlzdGVuZXImJmIucmVtb3ZlTGlzdGVuZXIoZCk7KGM9ZGIoYikpPyhXYShjLGEpLDA9PWMuaCYmKGMuc3JjPW51bGwsYltYYV09bnVsbCkpOlBhKGEpO319fWZ1bmN0aW9uIGZiKGEpe3JldHVybiBhIGluIFlhP1lhW2FdOllhW2FdPVwib25cIithfWZ1bmN0aW9uIGdiKGEsYil7aWYoYS5iYSlhPSEwO2Vsc2Uge2I9bmV3IHooYix0aGlzKTt2YXIgYz1hLmxpc3RlbmVyLGQ9YS5oYXx8YS5zcmM7YS5lYSYmaWIoYSk7YT1jLmNhbGwoZCxiKTt9cmV0dXJuIGF9XG5mdW5jdGlvbiBkYihhKXthPWFbWGFdO3JldHVybiBhIGluc3RhbmNlb2YgVWE/YTpudWxsfXZhciBqYj1cIl9fY2xvc3VyZV9ldmVudHNfZm5fXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCk7ZnVuY3Rpb24gYmIoYSl7aWYoXCJmdW5jdGlvblwiPT09dHlwZW9mIGEpcmV0dXJuIGE7YVtqYl18fChhW2piXT1mdW5jdGlvbihiKXtyZXR1cm4gYS5oYW5kbGVFdmVudChiKX0pO3JldHVybiBhW2piXX1mdW5jdGlvbiBCKCl7di5jYWxsKHRoaXMpO3RoaXMuaT1uZXcgVWEodGhpcyk7dGhpcy5QPXRoaXM7dGhpcy5JPW51bGw7fXQoQix2KTtCLnByb3RvdHlwZVtBXT0hMDtCLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe2hiKHRoaXMsYSxiLGMsZCk7fTtcbmZ1bmN0aW9uIEMoYSxiKXt2YXIgYyxkPWEuSTtpZihkKWZvcihjPVtdO2Q7ZD1kLkkpYy5wdXNoKGQpO2E9YS5QO2Q9Yi50eXBlfHxiO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYiliPW5ldyB3KGIsYSk7ZWxzZSBpZihiIGluc3RhbmNlb2YgdyliLnRhcmdldD1iLnRhcmdldHx8YTtlbHNlIHt2YXIgZT1iO2I9bmV3IHcoZCxhKTtUYShiLGUpO31lPSEwO2lmKGMpZm9yKHZhciBmPWMubGVuZ3RoLTE7MDw9ZjtmLS0pe3ZhciBoPWIuZz1jW2ZdO2U9a2IoaCxkLCEwLGIpJiZlO31oPWIuZz1hO2U9a2IoaCxkLCEwLGIpJiZlO2U9a2IoaCxkLCExLGIpJiZlO2lmKGMpZm9yKGY9MDtmPGMubGVuZ3RoO2YrKyloPWIuZz1jW2ZdLGU9a2IoaCxkLCExLGIpJiZlO31cbkIucHJvdG90eXBlLk09ZnVuY3Rpb24oKXtCLlguTS5jYWxsKHRoaXMpO2lmKHRoaXMuaSl7dmFyIGE9dGhpcy5pLGM7Zm9yKGMgaW4gYS5nKXtmb3IodmFyIGQ9YS5nW2NdLGU9MDtlPGQubGVuZ3RoO2UrKylQYShkW2VdKTtkZWxldGUgYS5nW2NdO2EuaC0tO319dGhpcy5JPW51bGw7fTtCLnByb3RvdHlwZS5OPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmkuYWRkKFN0cmluZyhhKSxiLCExLGMsZCl9O0IucHJvdG90eXBlLk89ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuaS5hZGQoU3RyaW5nKGEpLGIsITAsYyxkKX07XG5mdW5jdGlvbiBrYihhLGIsYyxkKXtiPWEuaS5nW1N0cmluZyhiKV07aWYoIWIpcmV0dXJuICEwO2I9Yi5jb25jYXQoKTtmb3IodmFyIGU9ITAsZj0wO2Y8Yi5sZW5ndGg7KytmKXt2YXIgaD1iW2ZdO2lmKGgmJiFoLmJhJiZoLmNhcHR1cmU9PWMpe3ZhciBuPWgubGlzdGVuZXIsdT1oLmhhfHxoLnNyYztoLmVhJiZXYShhLmksaCk7ZT0hMSE9PW4uY2FsbCh1LGQpJiZlO319cmV0dXJuIGUmJiFkLmRlZmF1bHRQcmV2ZW50ZWR9dmFyIGxiPWwuSlNPTi5zdHJpbmdpZnk7ZnVuY3Rpb24gbWIoKXt2YXIgYT1uYjtsZXQgYj1udWxsO2EuZyYmKGI9YS5nLGEuZz1hLmcubmV4dCxhLmd8fChhLmg9bnVsbCksYi5uZXh0PW51bGwpO3JldHVybiBifWNsYXNzIG9ie2NvbnN0cnVjdG9yKCl7dGhpcy5oPXRoaXMuZz1udWxsO31hZGQoYSxiKXtjb25zdCBjPXBiLmdldCgpO2Muc2V0KGEsYik7dGhpcy5oP3RoaXMuaC5uZXh0PWM6dGhpcy5nPWM7dGhpcy5oPWM7fX12YXIgcGI9bmV3IGNsYXNze2NvbnN0cnVjdG9yKGEsYil7dGhpcy5pPWE7dGhpcy5qPWI7dGhpcy5oPTA7dGhpcy5nPW51bGw7fWdldCgpe2xldCBhOzA8dGhpcy5oPyh0aGlzLmgtLSxhPXRoaXMuZyx0aGlzLmc9YS5uZXh0LGEubmV4dD1udWxsKTphPXRoaXMuaSgpO3JldHVybiBhfX0oKCk9Pm5ldyBxYixhPT5hLnJlc2V0KCkpO1xuY2xhc3MgcWJ7Y29uc3RydWN0b3IoKXt0aGlzLm5leHQ9dGhpcy5nPXRoaXMuaD1udWxsO31zZXQoYSxiKXt0aGlzLmg9YTt0aGlzLmc9Yjt0aGlzLm5leHQ9bnVsbDt9cmVzZXQoKXt0aGlzLm5leHQ9dGhpcy5nPXRoaXMuaD1udWxsO319ZnVuY3Rpb24gcmIoYSl7bC5zZXRUaW1lb3V0KCgpPT57dGhyb3cgYTt9LDApO31mdW5jdGlvbiBzYihhLGIpe3VifHx2YigpO3difHwodWIoKSx3Yj0hMCk7bmIuYWRkKGEsYik7fXZhciB1YjtmdW5jdGlvbiB2Yigpe3ZhciBhPWwuUHJvbWlzZS5yZXNvbHZlKHZvaWQgMCk7dWI9ZnVuY3Rpb24oKXthLnRoZW4oeGIpO307fXZhciB3Yj0hMSxuYj1uZXcgb2I7ZnVuY3Rpb24geGIoKXtmb3IodmFyIGE7YT1tYigpOyl7dHJ5e2EuaC5jYWxsKGEuZyk7fWNhdGNoKGMpe3JiKGMpO312YXIgYj1wYjtiLmooYSk7MTAwPmIuaCYmKGIuaCsrLGEubmV4dD1iLmcsYi5nPWEpO313Yj0hMTt9ZnVuY3Rpb24geWIoYSxiKXtCLmNhbGwodGhpcyk7dGhpcy5oPWF8fDE7dGhpcy5nPWJ8fGw7dGhpcy5qPXEodGhpcy5sYix0aGlzKTt0aGlzLmw9RGF0ZS5ub3coKTt9dCh5YixCKTtrPXliLnByb3RvdHlwZTtrLmNhPSExO2suUj1udWxsO2subGI9ZnVuY3Rpb24oKXtpZih0aGlzLmNhKXt2YXIgYT1EYXRlLm5vdygpLXRoaXMubDswPGEmJmE8LjgqdGhpcy5oP3RoaXMuUj10aGlzLmcuc2V0VGltZW91dCh0aGlzLmosdGhpcy5oLWEpOih0aGlzLlImJih0aGlzLmcuY2xlYXJUaW1lb3V0KHRoaXMuUiksdGhpcy5SPW51bGwpLEModGhpcyxcInRpY2tcIiksdGhpcy5jYSYmKHpiKHRoaXMpLHRoaXMuc3RhcnQoKSkpO319O2suc3RhcnQ9ZnVuY3Rpb24oKXt0aGlzLmNhPSEwO3RoaXMuUnx8KHRoaXMuUj10aGlzLmcuc2V0VGltZW91dCh0aGlzLmosdGhpcy5oKSx0aGlzLmw9RGF0ZS5ub3coKSk7fTtcbmZ1bmN0aW9uIHpiKGEpe2EuY2E9ITE7YS5SJiYoYS5nLmNsZWFyVGltZW91dChhLlIpLGEuUj1udWxsKTt9ay5NPWZ1bmN0aW9uKCl7eWIuWC5NLmNhbGwodGhpcyk7emIodGhpcyk7ZGVsZXRlIHRoaXMuZzt9O2Z1bmN0aW9uIEFiKGEsYixjKXtpZihcImZ1bmN0aW9uXCI9PT10eXBlb2YgYSljJiYoYT1xKGEsYykpO2Vsc2UgaWYoYSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5oYW5kbGVFdmVudClhPXEoYS5oYW5kbGVFdmVudCxhKTtlbHNlIHRocm93IEVycm9yKFwiSW52YWxpZCBsaXN0ZW5lciBhcmd1bWVudFwiKTtyZXR1cm4gMjE0NzQ4MzY0NzxOdW1iZXIoYik/LTE6bC5zZXRUaW1lb3V0KGEsYnx8MCl9ZnVuY3Rpb24gQmIoYSl7YS5nPUFiKCgpPT57YS5nPW51bGw7YS5pJiYoYS5pPSExLEJiKGEpKTt9LGEuaik7Y29uc3QgYj1hLmg7YS5oPW51bGw7YS5tLmFwcGx5KG51bGwsYik7fWNsYXNzIENiIGV4dGVuZHMgdntjb25zdHJ1Y3RvcihhLGIpe3N1cGVyKCk7dGhpcy5tPWE7dGhpcy5qPWI7dGhpcy5oPW51bGw7dGhpcy5pPSExO3RoaXMuZz1udWxsO31sKGEpe3RoaXMuaD1hcmd1bWVudHM7dGhpcy5nP3RoaXMuaT0hMDpCYih0aGlzKTt9TSgpe3N1cGVyLk0oKTt0aGlzLmcmJihsLmNsZWFyVGltZW91dCh0aGlzLmcpLHRoaXMuZz1udWxsLHRoaXMuaT0hMSx0aGlzLmg9bnVsbCk7fX1mdW5jdGlvbiBEKGEpe3YuY2FsbCh0aGlzKTt0aGlzLmg9YTt0aGlzLmc9e307fXQoRCx2KTt2YXIgRGI9W107ZnVuY3Rpb24gRWIoYSxiLGMsZCl7QXJyYXkuaXNBcnJheShjKXx8KGMmJihEYlswXT1jLnRvU3RyaW5nKCkpLGM9RGIpO2Zvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKXt2YXIgZj0kYShiLGNbZV0sZHx8YS5oYW5kbGVFdmVudCwhMSxhLmh8fGEpO2lmKCFmKWJyZWFrO2EuZ1tmLmtleV09Zjt9fWZ1bmN0aW9uIEZiKGEpe1FhKGEuZyxmdW5jdGlvbihiLGMpe3RoaXMuZy5oYXNPd25Qcm9wZXJ0eShjKSYmaWIoYik7fSxhKTthLmc9e307fUQucHJvdG90eXBlLk09ZnVuY3Rpb24oKXtELlguTS5jYWxsKHRoaXMpO0ZiKHRoaXMpO307RC5wcm90b3R5cGUuaGFuZGxlRXZlbnQ9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcIkV2ZW50SGFuZGxlci5oYW5kbGVFdmVudCBub3QgaW1wbGVtZW50ZWRcIik7fTtmdW5jdGlvbiBHYigpe3RoaXMuZz0hMDt9R2IucHJvdG90eXBlLkFhPWZ1bmN0aW9uKCl7dGhpcy5nPSExO307ZnVuY3Rpb24gSGIoYSxiLGMsZCxlLGYpe2EuaW5mbyhmdW5jdGlvbigpe2lmKGEuZylpZihmKXt2YXIgaD1cIlwiO2Zvcih2YXIgbj1mLnNwbGl0KFwiJlwiKSx1PTA7dTxuLmxlbmd0aDt1Kyspe3ZhciBtPW5bdV0uc3BsaXQoXCI9XCIpO2lmKDE8bS5sZW5ndGgpe3ZhciByPW1bMF07bT1tWzFdO3ZhciBGPXIuc3BsaXQoXCJfXCIpO2g9Mjw9Ri5sZW5ndGgmJlwidHlwZVwiPT1GWzFdP2grKHIrXCI9XCIrbStcIiZcIik6aCsocitcIj1yZWRhY3RlZCZcIik7fX19ZWxzZSBoPW51bGw7ZWxzZSBoPWY7cmV0dXJuIFwiWE1MSFRUUCBSRVEgKFwiK2QrXCIpIFthdHRlbXB0IFwiK2UrXCJdOiBcIitiK1wiXFxuXCIrYytcIlxcblwiK2h9KTt9XG5mdW5jdGlvbiBJYihhLGIsYyxkLGUsZixoKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJYTUxIVFRQIFJFU1AgKFwiK2QrXCIpIFsgYXR0ZW1wdCBcIitlK1wiXTogXCIrYitcIlxcblwiK2MrXCJcXG5cIitmK1wiIFwiK2h9KTt9ZnVuY3Rpb24gRShhLGIsYyxkKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJYTUxIVFRQIFRFWFQgKFwiK2IrXCIpOiBcIitKYihhLGMpKyhkP1wiIFwiK2Q6XCJcIil9KTt9ZnVuY3Rpb24gS2IoYSxiKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJUSU1FT1VUOiBcIitifSk7fUdiLnByb3RvdHlwZS5pbmZvPWZ1bmN0aW9uKCl7fTtcbmZ1bmN0aW9uIEpiKGEsYil7aWYoIWEuZylyZXR1cm4gYjtpZighYilyZXR1cm4gbnVsbDt0cnl7dmFyIGM9SlNPTi5wYXJzZShiKTtpZihjKWZvcihhPTA7YTxjLmxlbmd0aDthKyspaWYoQXJyYXkuaXNBcnJheShjW2FdKSl7dmFyIGQ9Y1thXTtpZighKDI+ZC5sZW5ndGgpKXt2YXIgZT1kWzFdO2lmKEFycmF5LmlzQXJyYXkoZSkmJiEoMT5lLmxlbmd0aCkpe3ZhciBmPWVbMF07aWYoXCJub29wXCIhPWYmJlwic3RvcFwiIT1mJiZcImNsb3NlXCIhPWYpZm9yKHZhciBoPTE7aDxlLmxlbmd0aDtoKyspZVtoXT1cIlwiO319fXJldHVybiBsYihjKX1jYXRjaChuKXtyZXR1cm4gYn19dmFyIEc9e30sTGI9bnVsbDtmdW5jdGlvbiBNYigpe3JldHVybiBMYj1MYnx8bmV3IEJ9Ry5QYT1cInNlcnZlcnJlYWNoYWJpbGl0eVwiO2Z1bmN0aW9uIE5iKGEpe3cuY2FsbCh0aGlzLEcuUGEsYSk7fXQoTmIsdyk7ZnVuY3Rpb24gSChhKXtjb25zdCBiPU1iKCk7QyhiLG5ldyBOYihiKSk7fUcuU1RBVF9FVkVOVD1cInN0YXRldmVudFwiO2Z1bmN0aW9uIE9iKGEsYil7dy5jYWxsKHRoaXMsRy5TVEFUX0VWRU5ULGEpO3RoaXMuc3RhdD1iO310KE9iLHcpO2Z1bmN0aW9uIEkoYSl7Y29uc3QgYj1NYigpO0MoYixuZXcgT2IoYixhKSk7fUcuUWE9XCJ0aW1pbmdldmVudFwiO2Z1bmN0aW9uIFBiKGEsYil7dy5jYWxsKHRoaXMsRy5RYSxhKTt0aGlzLnNpemU9Yjt9dChQYix3KTtcbmZ1bmN0aW9uIEooYSxiKXtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgYSl0aHJvdyBFcnJvcihcIkZuIG11c3Qgbm90IGJlIG51bGwgYW5kIG11c3QgYmUgYSBmdW5jdGlvblwiKTtyZXR1cm4gbC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YSgpO30sYil9dmFyIFFiPXtOT19FUlJPUjowLG1iOjEsemI6Mix5YjozLHRiOjQseGI6NSxBYjo2LE1hOjcsVElNRU9VVDo4LERiOjl9O3ZhciBSYj17cmI6XCJjb21wbGV0ZVwiLE5iOlwic3VjY2Vzc1wiLE5hOlwiZXJyb3JcIixNYTpcImFib3J0XCIsRmI6XCJyZWFkeVwiLEdiOlwicmVhZHlzdGF0ZWNoYW5nZVwiLFRJTUVPVVQ6XCJ0aW1lb3V0XCIsQmI6XCJpbmNyZW1lbnRhbGRhdGFcIixFYjpcInByb2dyZXNzXCIsdWI6XCJkb3dubG9hZHByb2dyZXNzXCIsVmI6XCJ1cGxvYWRwcm9ncmVzc1wifTtmdW5jdGlvbiBTYigpe31TYi5wcm90b3R5cGUuaD1udWxsO2Z1bmN0aW9uIFRiKGEpe3JldHVybiBhLmh8fChhLmg9YS5pKCkpfWZ1bmN0aW9uIFViKCl7fXZhciBLPXtPUEVOOlwiYVwiLHFiOlwiYlwiLE5hOlwiY1wiLENiOlwiZFwifTtmdW5jdGlvbiBWYigpe3cuY2FsbCh0aGlzLFwiZFwiKTt9dChWYix3KTtmdW5jdGlvbiBXYigpe3cuY2FsbCh0aGlzLFwiY1wiKTt9dChXYix3KTt2YXIgWGI7ZnVuY3Rpb24gWWIoKXt9dChZYixTYik7WWIucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fTtZYi5wcm90b3R5cGUuaT1mdW5jdGlvbigpe3JldHVybiB7fX07WGI9bmV3IFliO2Z1bmN0aW9uIEwoYSxiLGMsZCl7dGhpcy5sPWE7dGhpcy5qPWI7dGhpcy5tPWM7dGhpcy5VPWR8fDE7dGhpcy5TPW5ldyBEKHRoaXMpO3RoaXMuTz1aYjthPXlhPzEyNTp2b2lkIDA7dGhpcy5UPW5ldyB5YihhKTt0aGlzLkg9bnVsbDt0aGlzLmk9ITE7dGhpcy5zPXRoaXMuQT10aGlzLnY9dGhpcy5LPXRoaXMuRj10aGlzLlY9dGhpcy5CPW51bGw7dGhpcy5EPVtdO3RoaXMuZz1udWxsO3RoaXMuQz0wO3RoaXMubz10aGlzLnU9bnVsbDt0aGlzLlk9LTE7dGhpcy5JPSExO3RoaXMuTj0wO3RoaXMuTD1udWxsO3RoaXMuJD10aGlzLko9dGhpcy5aPXRoaXMuUD0hMTt0aGlzLmg9bmV3ICRiO31mdW5jdGlvbiAkYigpe3RoaXMuaT1udWxsO3RoaXMuZz1cIlwiO3RoaXMuaD0hMTt9dmFyIFpiPTQ1RTMsYWM9e30sYmM9e307az1MLnByb3RvdHlwZTtrLnNldFRpbWVvdXQ9ZnVuY3Rpb24oYSl7dGhpcy5PPWE7fTtcbmZ1bmN0aW9uIGNjKGEsYixjKXthLks9MTthLnY9ZGMoTShiKSk7YS5zPWM7YS5QPSEwO2VjKGEsbnVsbCk7fWZ1bmN0aW9uIGVjKGEsYil7YS5GPURhdGUubm93KCk7TihhKTthLkE9TShhLnYpO3ZhciBjPWEuQSxkPWEuVTtBcnJheS5pc0FycmF5KGQpfHwoZD1bU3RyaW5nKGQpXSk7ZmMoYy5pLFwidFwiLGQpO2EuQz0wO2M9YS5sLkg7YS5oPW5ldyAkYjthLmc9Z2MoYS5sLGM/YjpudWxsLCFhLnMpOzA8YS5OJiYoYS5MPW5ldyBDYihxKGEuTGEsYSxhLmcpLGEuTikpO0ViKGEuUyxhLmcsXCJyZWFkeXN0YXRlY2hhbmdlXCIsYS5pYik7Yj1hLkg/UmEoYS5IKTp7fTthLnM/KGEudXx8KGEudT1cIlBPU1RcIiksYltcIkNvbnRlbnQtVHlwZVwiXT1cImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLGEuZy5kYShhLkEsYS51LGEucyxiKSk6KGEudT1cIkdFVFwiLGEuZy5kYShhLkEsYS51LG51bGwsYikpO0goKTtIYihhLmosYS51LGEuQSxhLm0sYS5VLGEucyk7fVxuay5pYj1mdW5jdGlvbihhKXthPWEudGFyZ2V0O2NvbnN0IGI9dGhpcy5MO2ImJjM9PU8oYSk/Yi5sKCk6dGhpcy5MYShhKTt9O1xuay5MYT1mdW5jdGlvbihhKXt0cnl7aWYoYT09dGhpcy5nKWE6e2NvbnN0IHI9Tyh0aGlzLmcpO3ZhciBiPXRoaXMuZy5FYSgpO2NvbnN0IEY9dGhpcy5nLmFhKCk7aWYoISgzPnIpJiYoMyE9cnx8eWF8fHRoaXMuZyYmKHRoaXMuaC5ofHx0aGlzLmcuZmEoKXx8aGModGhpcy5nKSkpKXt0aGlzLkl8fDQhPXJ8fDc9PWJ8fCg4PT1ifHwwPj1GP0goMyk6SCgyKSk7aWModGhpcyk7dmFyIGM9dGhpcy5nLmFhKCk7dGhpcy5ZPWM7YjppZihqYyh0aGlzKSl7dmFyIGQ9aGModGhpcy5nKTthPVwiXCI7dmFyIGU9ZC5sZW5ndGgsZj00PT1PKHRoaXMuZyk7aWYoIXRoaXMuaC5pKXtpZihcInVuZGVmaW5lZFwiPT09dHlwZW9mIFRleHREZWNvZGVyKXtQKHRoaXMpO1EodGhpcyk7dmFyIGg9XCJcIjticmVhayBifXRoaXMuaC5pPW5ldyBsLlRleHREZWNvZGVyO31mb3IoYj0wO2I8ZTtiKyspdGhpcy5oLmg9ITAsYSs9dGhpcy5oLmkuZGVjb2RlKGRbYl0se3N0cmVhbTpmJiZiPT1lLTF9KTtkLnNwbGljZSgwLFxuZSk7dGhpcy5oLmcrPWE7dGhpcy5DPTA7aD10aGlzLmguZzt9ZWxzZSBoPXRoaXMuZy5mYSgpO3RoaXMuaT0yMDA9PWM7SWIodGhpcy5qLHRoaXMudSx0aGlzLkEsdGhpcy5tLHRoaXMuVSxyLGMpO2lmKHRoaXMuaSl7aWYodGhpcy5aJiYhdGhpcy5KKXtiOntpZih0aGlzLmcpe3ZhciBuLHU9dGhpcy5nO2lmKChuPXUuZz91LmcuZ2V0UmVzcG9uc2VIZWFkZXIoXCJYLUhUVFAtSW5pdGlhbC1SZXNwb25zZVwiKTpudWxsKSYmIXBhKG4pKXt2YXIgbT1uO2JyZWFrIGJ9fW09bnVsbDt9aWYoYz1tKUUodGhpcy5qLHRoaXMubSxjLFwiSW5pdGlhbCBoYW5kc2hha2UgcmVzcG9uc2UgdmlhIFgtSFRUUC1Jbml0aWFsLVJlc3BvbnNlXCIpLHRoaXMuSj0hMCxrYyh0aGlzLGMpO2Vsc2Uge3RoaXMuaT0hMTt0aGlzLm89MztJKDEyKTtQKHRoaXMpO1EodGhpcyk7YnJlYWsgYX19dGhpcy5QPyhsYyh0aGlzLHIsaCkseWEmJnRoaXMuaSYmMz09ciYmKEViKHRoaXMuUyx0aGlzLlQsXCJ0aWNrXCIsdGhpcy5oYiksXG50aGlzLlQuc3RhcnQoKSkpOihFKHRoaXMuaix0aGlzLm0saCxudWxsKSxrYyh0aGlzLGgpKTs0PT1yJiZQKHRoaXMpO3RoaXMuaSYmIXRoaXMuSSYmKDQ9PXI/bWModGhpcy5sLHRoaXMpOih0aGlzLmk9ITEsTih0aGlzKSkpO31lbHNlIDQwMD09YyYmMDxoLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKT8odGhpcy5vPTMsSSgxMikpOih0aGlzLm89MCxJKDEzKSksUCh0aGlzKSxRKHRoaXMpO319fWNhdGNoKHIpe31maW5hbGx5e319O2Z1bmN0aW9uIGpjKGEpe3JldHVybiBhLmc/XCJHRVRcIj09YS51JiYyIT1hLksmJmEubC5EYTohMX1cbmZ1bmN0aW9uIGxjKGEsYixjKXtsZXQgZD0hMCxlO2Zvcig7IWEuSSYmYS5DPGMubGVuZ3RoOylpZihlPW5jKGEsYyksZT09YmMpezQ9PWImJihhLm89NCxJKDE0KSxkPSExKTtFKGEuaixhLm0sbnVsbCxcIltJbmNvbXBsZXRlIFJlc3BvbnNlXVwiKTticmVha31lbHNlIGlmKGU9PWFjKXthLm89NDtJKDE1KTtFKGEuaixhLm0sYyxcIltJbnZhbGlkIENodW5rXVwiKTtkPSExO2JyZWFrfWVsc2UgRShhLmosYS5tLGUsbnVsbCksa2MoYSxlKTtqYyhhKSYmZSE9YmMmJmUhPWFjJiYoYS5oLmc9XCJcIixhLkM9MCk7NCE9Ynx8MCE9Yy5sZW5ndGh8fGEuaC5ofHwoYS5vPTEsSSgxNiksZD0hMSk7YS5pPWEuaSYmZDtkPzA8Yy5sZW5ndGgmJiFhLiQmJihhLiQ9ITAsYj1hLmwsYi5nPT1hJiZiLiQmJiFiLksmJihiLmouaW5mbyhcIkdyZWF0LCBubyBidWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQuIEJ5dGVzIHJlY2VpdmVkOiBcIitjLmxlbmd0aCksb2MoYiksYi5LPSEwLEkoMTEpKSk6KEUoYS5qLGEubSxjLFxuXCJbSW52YWxpZCBDaHVua2VkIFJlc3BvbnNlXVwiKSxQKGEpLFEoYSkpO31rLmhiPWZ1bmN0aW9uKCl7aWYodGhpcy5nKXt2YXIgYT1PKHRoaXMuZyksYj10aGlzLmcuZmEoKTt0aGlzLkM8Yi5sZW5ndGgmJihpYyh0aGlzKSxsYyh0aGlzLGEsYiksdGhpcy5pJiY0IT1hJiZOKHRoaXMpKTt9fTtmdW5jdGlvbiBuYyhhLGIpe3ZhciBjPWEuQyxkPWIuaW5kZXhPZihcIlxcblwiLGMpO2lmKC0xPT1kKXJldHVybiBiYztjPU51bWJlcihiLnN1YnN0cmluZyhjLGQpKTtpZihpc05hTihjKSlyZXR1cm4gYWM7ZCs9MTtpZihkK2M+Yi5sZW5ndGgpcmV0dXJuIGJjO2I9Yi5zdWJzdHIoZCxjKTthLkM9ZCtjO3JldHVybiBifWsuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5JPSEwO1AodGhpcyk7fTtmdW5jdGlvbiBOKGEpe2EuVj1EYXRlLm5vdygpK2EuTztwYyhhLGEuTyk7fVxuZnVuY3Rpb24gcGMoYSxiKXtpZihudWxsIT1hLkIpdGhyb3cgRXJyb3IoXCJXYXRjaERvZyB0aW1lciBub3QgbnVsbFwiKTthLkI9SihxKGEuZ2IsYSksYik7fWZ1bmN0aW9uIGljKGEpe2EuQiYmKGwuY2xlYXJUaW1lb3V0KGEuQiksYS5CPW51bGwpO31rLmdiPWZ1bmN0aW9uKCl7dGhpcy5CPW51bGw7Y29uc3QgYT1EYXRlLm5vdygpOzA8PWEtdGhpcy5WPyhLYih0aGlzLmosdGhpcy5BKSwyIT10aGlzLksmJihIKCksSSgxNykpLFAodGhpcyksdGhpcy5vPTIsUSh0aGlzKSk6cGModGhpcyx0aGlzLlYtYSk7fTtmdW5jdGlvbiBRKGEpezA9PWEubC5HfHxhLkl8fG1jKGEubCxhKTt9ZnVuY3Rpb24gUChhKXtpYyhhKTt2YXIgYj1hLkw7YiYmXCJmdW5jdGlvblwiPT10eXBlb2YgYi5uYSYmYi5uYSgpO2EuTD1udWxsO3piKGEuVCk7RmIoYS5TKTthLmcmJihiPWEuZyxhLmc9bnVsbCxiLmFib3J0KCksYi5uYSgpKTt9XG5mdW5jdGlvbiBrYyhhLGIpe3RyeXt2YXIgYz1hLmw7aWYoMCE9Yy5HJiYoYy5nPT1hfHxxYyhjLmgsYSkpKWlmKCFhLkomJnFjKGMuaCxhKSYmMz09Yy5HKXt0cnl7dmFyIGQ9Yy5GYS5nLnBhcnNlKGIpO31jYXRjaChtKXtkPW51bGw7fWlmKEFycmF5LmlzQXJyYXkoZCkmJjM9PWQubGVuZ3RoKXt2YXIgZT1kO2lmKDA9PWVbMF0pYTp7aWYoIWMudSl7aWYoYy5nKWlmKGMuZy5GKzNFMzxhLkYpcmMoYyksc2MoYyk7ZWxzZSBicmVhayBhO3RjKGMpO0koMTgpO319ZWxzZSBjLkJhPWVbMV0sMDxjLkJhLWMuVCYmMzc1MDA+ZVsyXSYmYy5MJiYwPT1jLkEmJiFjLnYmJihjLnY9SihxKGMuY2IsYyksNkUzKSk7aWYoMT49dWMoYy5oKSYmYy5qYSl7dHJ5e2MuamEoKTt9Y2F0Y2gobSl7fWMuamE9dm9pZCAwO319ZWxzZSBSKGMsMTEpO31lbHNlIGlmKChhLkp8fGMuZz09YSkmJnJjKGMpLCFwYShiKSlmb3IoZT1jLkZhLmcucGFyc2UoYiksYj0wO2I8ZS5sZW5ndGg7YisrKXtsZXQgbT1lW2JdO2MuVD1cbm1bMF07bT1tWzFdO2lmKDI9PWMuRylpZihcImNcIj09bVswXSl7Yy5JPW1bMV07Yy5rYT1tWzJdO2NvbnN0IHI9bVszXTtudWxsIT1yJiYoYy5tYT1yLGMuai5pbmZvKFwiVkVSPVwiK2MubWEpKTtjb25zdCBGPW1bNF07bnVsbCE9RiYmKGMuQ2E9RixjLmouaW5mbyhcIlNWRVI9XCIrYy5DYSkpO2NvbnN0IENhPW1bNV07bnVsbCE9Q2EmJlwibnVtYmVyXCI9PT10eXBlb2YgQ2EmJjA8Q2EmJihkPTEuNSpDYSxjLko9ZCxjLmouaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIrZCkpO2Q9Yztjb25zdCBaPWEuZztpZihaKXtjb25zdCBEYT1aLmc/Wi5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKTpudWxsO2lmKERhKXt2YXIgZj1kLmg7Zi5nfHwtMT09RGEuaW5kZXhPZihcInNwZHlcIikmJi0xPT1EYS5pbmRleE9mKFwicXVpY1wiKSYmLTE9PURhLmluZGV4T2YoXCJoMlwiKXx8KGYuaj1mLmwsZi5nPW5ldyBTZXQsZi5oJiYodmMoZixmLmgpLGYuaD1udWxsKSk7fWlmKGQuRCl7Y29uc3QgdGI9XG5aLmc/Wi5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLVNlc3Npb24tSWRcIik6bnVsbDt0YiYmKGQuemE9dGIsUyhkLkYsZC5ELHRiKSk7fX1jLkc9MztjLmwmJmMubC54YSgpO2MuJCYmKGMuUD1EYXRlLm5vdygpLWEuRixjLmouaW5mbyhcIkhhbmRzaGFrZSBSVFQ6IFwiK2MuUCtcIm1zXCIpKTtkPWM7dmFyIGg9YTtkLnNhPXdjKGQsZC5IP2Qua2E6bnVsbCxkLlYpO2lmKGguSil7eGMoZC5oLGgpO3ZhciBuPWgsdT1kLko7dSYmbi5zZXRUaW1lb3V0KHUpO24uQiYmKGljKG4pLE4obikpO2QuZz1oO31lbHNlIHljKGQpOzA8Yy5pLmxlbmd0aCYmemMoYyk7fWVsc2UgXCJzdG9wXCIhPW1bMF0mJlwiY2xvc2VcIiE9bVswXXx8UihjLDcpO2Vsc2UgMz09Yy5HJiYoXCJzdG9wXCI9PW1bMF18fFwiY2xvc2VcIj09bVswXT9cInN0b3BcIj09bVswXT9SKGMsNyk6QWMoYyk6XCJub29wXCIhPW1bMF0mJmMubCYmYy5sLndhKG0pLGMuQT0wKTt9SCg0KTt9Y2F0Y2gobSl7fX1mdW5jdGlvbiBCYyhhKXtpZihhLlcmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuVylyZXR1cm4gYS5XKCk7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBNYXAmJmEgaW5zdGFuY2VvZiBNYXB8fFwidW5kZWZpbmVkXCIhPT10eXBlb2YgU2V0JiZhIGluc3RhbmNlb2YgU2V0KXJldHVybiBBcnJheS5mcm9tKGEudmFsdWVzKCkpO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYS5zcGxpdChcIlwiKTtpZihiYShhKSl7Zm9yKHZhciBiPVtdLGM9YS5sZW5ndGgsZD0wO2Q8YztkKyspYi5wdXNoKGFbZF0pO3JldHVybiBifWI9W107Yz0wO2ZvcihkIGluIGEpYltjKytdPWFbZF07cmV0dXJuIGJ9XG5mdW5jdGlvbiBDYyhhKXtpZihhLm9hJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLm9hKXJldHVybiBhLm9hKCk7aWYoIWEuV3x8XCJmdW5jdGlvblwiIT10eXBlb2YgYS5XKXtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIE1hcCYmYSBpbnN0YW5jZW9mIE1hcClyZXR1cm4gQXJyYXkuZnJvbShhLmtleXMoKSk7aWYoIShcInVuZGVmaW5lZFwiIT09dHlwZW9mIFNldCYmYSBpbnN0YW5jZW9mIFNldCkpe2lmKGJhKGEpfHxcInN0cmluZ1wiPT09dHlwZW9mIGEpe3ZhciBiPVtdO2E9YS5sZW5ndGg7Zm9yKHZhciBjPTA7YzxhO2MrKyliLnB1c2goYyk7cmV0dXJuIGJ9Yj1bXTtjPTA7Zm9yKGNvbnN0IGQgaW4gYSliW2MrK109ZDtyZXR1cm4gYn19fVxuZnVuY3Rpb24gRGMoYSxiKXtpZihhLmZvckVhY2gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuZm9yRWFjaClhLmZvckVhY2goYix2b2lkIDApO2Vsc2UgaWYoYmEoYSl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGEsYix2b2lkIDApO2Vsc2UgZm9yKHZhciBjPUNjKGEpLGQ9QmMoYSksZT1kLmxlbmd0aCxmPTA7ZjxlO2YrKyliLmNhbGwodm9pZCAwLGRbZl0sYyYmY1tmXSxhKTt9dmFyIEVjPVJlZ0V4cChcIl4oPzooW146Lz8jLl0rKTopPyg/Oi8vKD86KFteXFxcXFxcXFwvPyNdKilAKT8oW15cXFxcXFxcXC8/I10qPykoPzo6KFswLTldKykpPyg/PVtcXFxcXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcXFw/KFteI10qKSk/KD86IyhbXFxcXHNcXFxcU10qKSk/JFwiKTtmdW5jdGlvbiBGYyhhLGIpe2lmKGEpe2E9YS5zcGxpdChcIiZcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uaW5kZXhPZihcIj1cIiksZT1udWxsO2lmKDA8PWQpe3ZhciBmPWFbY10uc3Vic3RyaW5nKDAsZCk7ZT1hW2NdLnN1YnN0cmluZyhkKzEpO31lbHNlIGY9YVtjXTtiKGYsZT9kZWNvZGVVUklDb21wb25lbnQoZS5yZXBsYWNlKC9cXCsvZyxcIiBcIikpOlwiXCIpO319fWZ1bmN0aW9uIFQoYSxiKXt0aGlzLmc9dGhpcy5zPXRoaXMuaj1cIlwiO3RoaXMubT1udWxsO3RoaXMubz10aGlzLmw9XCJcIjt0aGlzLmg9ITE7aWYoYSBpbnN0YW5jZW9mIFQpe3RoaXMuaD12b2lkIDAhPT1iP2I6YS5oO0djKHRoaXMsYS5qKTt0aGlzLnM9YS5zO3RoaXMuZz1hLmc7SGModGhpcyxhLm0pO3RoaXMubD1hLmw7Yj1hLmk7dmFyIGM9bmV3IEljO2MuaT1iLmk7Yi5nJiYoYy5nPW5ldyBNYXAoYi5nKSxjLmg9Yi5oKTtKYyh0aGlzLGMpO3RoaXMubz1hLm87fWVsc2UgYSYmKGM9U3RyaW5nKGEpLm1hdGNoKEVjKSk/KHRoaXMuaD0hIWIsR2ModGhpcyxjWzFdfHxcIlwiLCEwKSx0aGlzLnM9S2MoY1syXXx8XCJcIiksdGhpcy5nPUtjKGNbM118fFwiXCIsITApLEhjKHRoaXMsY1s0XSksdGhpcy5sPUtjKGNbNV18fFwiXCIsITApLEpjKHRoaXMsY1s2XXx8XCJcIiwhMCksdGhpcy5vPUtjKGNbN118fFwiXCIpKToodGhpcy5oPSEhYix0aGlzLmk9bmV3IEljKG51bGwsdGhpcy5oKSk7fVxuVC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYT1bXSxiPXRoaXMuajtiJiZhLnB1c2goTGMoYixNYywhMCksXCI6XCIpO3ZhciBjPXRoaXMuZztpZihjfHxcImZpbGVcIj09YilhLnB1c2goXCIvL1wiKSwoYj10aGlzLnMpJiZhLnB1c2goTGMoYixNYywhMCksXCJAXCIpLGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csXCIlJDFcIikpLGM9dGhpcy5tLG51bGwhPWMmJmEucHVzaChcIjpcIixTdHJpbmcoYykpO2lmKGM9dGhpcy5sKXRoaXMuZyYmXCIvXCIhPWMuY2hhckF0KDApJiZhLnB1c2goXCIvXCIpLGEucHVzaChMYyhjLFwiL1wiPT1jLmNoYXJBdCgwKT9OYzpPYywhMCkpOyhjPXRoaXMuaS50b1N0cmluZygpKSYmYS5wdXNoKFwiP1wiLGMpOyhjPXRoaXMubykmJmEucHVzaChcIiNcIixMYyhjLFBjKSk7cmV0dXJuIGEuam9pbihcIlwiKX07ZnVuY3Rpb24gTShhKXtyZXR1cm4gbmV3IFQoYSl9XG5mdW5jdGlvbiBHYyhhLGIsYyl7YS5qPWM/S2MoYiwhMCk6YjthLmomJihhLmo9YS5qLnJlcGxhY2UoLzokLyxcIlwiKSk7fWZ1bmN0aW9uIEhjKGEsYil7aWYoYil7Yj1OdW1iZXIoYik7aWYoaXNOYU4oYil8fDA+Yil0aHJvdyBFcnJvcihcIkJhZCBwb3J0IG51bWJlciBcIitiKTthLm09Yjt9ZWxzZSBhLm09bnVsbDt9ZnVuY3Rpb24gSmMoYSxiLGMpe2IgaW5zdGFuY2VvZiBJYz8oYS5pPWIsUWMoYS5pLGEuaCkpOihjfHwoYj1MYyhiLFJjKSksYS5pPW5ldyBJYyhiLGEuaCkpO31mdW5jdGlvbiBTKGEsYixjKXthLmkuc2V0KGIsYyk7fWZ1bmN0aW9uIGRjKGEpe1MoYSxcInp4XCIsTWF0aC5mbG9vcigyMTQ3NDgzNjQ4Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDM2KStNYXRoLmFicyhNYXRoLmZsb29yKDIxNDc0ODM2NDgqTWF0aC5yYW5kb20oKSleRGF0ZS5ub3coKSkudG9TdHJpbmcoMzYpKTtyZXR1cm4gYX1cbmZ1bmN0aW9uIEtjKGEsYil7cmV0dXJuIGE/Yj9kZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZyxcIiUyNTI1XCIpKTpkZWNvZGVVUklDb21wb25lbnQoYSk6XCJcIn1mdW5jdGlvbiBMYyhhLGIsYyl7cmV0dXJuIFwic3RyaW5nXCI9PT10eXBlb2YgYT8oYT1lbmNvZGVVUkkoYSkucmVwbGFjZShiLFNjKSxjJiYoYT1hLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZyxcIiUkMVwiKSksYSk6bnVsbH1mdW5jdGlvbiBTYyhhKXthPWEuY2hhckNvZGVBdCgwKTtyZXR1cm4gXCIlXCIrKGE+PjQmMTUpLnRvU3RyaW5nKDE2KSsoYSYxNSkudG9TdHJpbmcoMTYpfXZhciBNYz0vWyNcXC9cXD9AXS9nLE9jPS9bI1xcPzpdL2csTmM9L1sjXFw/XS9nLFJjPS9bI1xcP0BdL2csUGM9LyMvZztmdW5jdGlvbiBJYyhhLGIpe3RoaXMuaD10aGlzLmc9bnVsbDt0aGlzLmk9YXx8bnVsbDt0aGlzLmo9ISFiO31cbmZ1bmN0aW9uIFUoYSl7YS5nfHwoYS5nPW5ldyBNYXAsYS5oPTAsYS5pJiZGYyhhLmksZnVuY3Rpb24oYixjKXthLmFkZChkZWNvZGVVUklDb21wb25lbnQoYi5yZXBsYWNlKC9cXCsvZyxcIiBcIikpLGMpO30pKTt9az1JYy5wcm90b3R5cGU7ay5hZGQ9ZnVuY3Rpb24oYSxiKXtVKHRoaXMpO3RoaXMuaT1udWxsO2E9Vih0aGlzLGEpO3ZhciBjPXRoaXMuZy5nZXQoYSk7Y3x8dGhpcy5nLnNldChhLGM9W10pO2MucHVzaChiKTt0aGlzLmgrPTE7cmV0dXJuIHRoaXN9O2Z1bmN0aW9uIFRjKGEsYil7VShhKTtiPVYoYSxiKTthLmcuaGFzKGIpJiYoYS5pPW51bGwsYS5oLT1hLmcuZ2V0KGIpLmxlbmd0aCxhLmcuZGVsZXRlKGIpKTt9ZnVuY3Rpb24gVWMoYSxiKXtVKGEpO2I9VihhLGIpO3JldHVybiBhLmcuaGFzKGIpfVxuay5mb3JFYWNoPWZ1bmN0aW9uKGEsYil7VSh0aGlzKTt0aGlzLmcuZm9yRWFjaChmdW5jdGlvbihjLGQpe2MuZm9yRWFjaChmdW5jdGlvbihlKXthLmNhbGwoYixlLGQsdGhpcyk7fSx0aGlzKTt9LHRoaXMpO307ay5vYT1mdW5jdGlvbigpe1UodGhpcyk7Y29uc3QgYT1BcnJheS5mcm9tKHRoaXMuZy52YWx1ZXMoKSksYj1BcnJheS5mcm9tKHRoaXMuZy5rZXlzKCkpLGM9W107Zm9yKGxldCBkPTA7ZDxiLmxlbmd0aDtkKyspe2NvbnN0IGU9YVtkXTtmb3IobGV0IGY9MDtmPGUubGVuZ3RoO2YrKyljLnB1c2goYltkXSk7fXJldHVybiBjfTtrLlc9ZnVuY3Rpb24oYSl7VSh0aGlzKTtsZXQgYj1bXTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpVWModGhpcyxhKSYmKGI9Yi5jb25jYXQodGhpcy5nLmdldChWKHRoaXMsYSkpKSk7ZWxzZSB7YT1BcnJheS5mcm9tKHRoaXMuZy52YWx1ZXMoKSk7Zm9yKGxldCBjPTA7YzxhLmxlbmd0aDtjKyspYj1iLmNvbmNhdChhW2NdKTt9cmV0dXJuIGJ9O1xuay5zZXQ9ZnVuY3Rpb24oYSxiKXtVKHRoaXMpO3RoaXMuaT1udWxsO2E9Vih0aGlzLGEpO1VjKHRoaXMsYSkmJih0aGlzLmgtPXRoaXMuZy5nZXQoYSkubGVuZ3RoKTt0aGlzLmcuc2V0KGEsW2JdKTt0aGlzLmgrPTE7cmV0dXJuIHRoaXN9O2suZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuIGI7YT10aGlzLlcoYSk7cmV0dXJuIDA8YS5sZW5ndGg/U3RyaW5nKGFbMF0pOmJ9O2Z1bmN0aW9uIGZjKGEsYixjKXtUYyhhLGIpOzA8Yy5sZW5ndGgmJihhLmk9bnVsbCxhLmcuc2V0KFYoYSxiKSxtYShjKSksYS5oKz1jLmxlbmd0aCk7fVxuay50b1N0cmluZz1mdW5jdGlvbigpe2lmKHRoaXMuaSlyZXR1cm4gdGhpcy5pO2lmKCF0aGlzLmcpcmV0dXJuIFwiXCI7Y29uc3QgYT1bXSxiPUFycmF5LmZyb20odGhpcy5nLmtleXMoKSk7Zm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspe3ZhciBkPWJbY107Y29uc3QgZj1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKSxoPXRoaXMuVyhkKTtmb3IoZD0wO2Q8aC5sZW5ndGg7ZCsrKXt2YXIgZT1mO1wiXCIhPT1oW2RdJiYoZSs9XCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhoW2RdKSkpO2EucHVzaChlKTt9fXJldHVybiB0aGlzLmk9YS5qb2luKFwiJlwiKX07ZnVuY3Rpb24gVihhLGIpe2I9U3RyaW5nKGIpO2EuaiYmKGI9Yi50b0xvd2VyQ2FzZSgpKTtyZXR1cm4gYn1cbmZ1bmN0aW9uIFFjKGEsYil7YiYmIWEuaiYmKFUoYSksYS5pPW51bGwsYS5nLmZvckVhY2goZnVuY3Rpb24oYyxkKXt2YXIgZT1kLnRvTG93ZXJDYXNlKCk7ZCE9ZSYmKFRjKHRoaXMsZCksZmModGhpcyxlLGMpKTt9LGEpKTthLmo9Yjt9dmFyIFZjPWNsYXNze2NvbnN0cnVjdG9yKGEsYil7dGhpcy5oPWE7dGhpcy5nPWI7fX07ZnVuY3Rpb24gV2MoYSl7dGhpcy5sPWF8fFhjO2wuUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nPyhhPWwucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIiksYT0wPGEubGVuZ3RoJiYoXCJocVwiPT1hWzBdLm5leHRIb3BQcm90b2NvbHx8XCJoMlwiPT1hWzBdLm5leHRIb3BQcm90b2NvbCkpOmE9ISEobC5nJiZsLmcuR2EmJmwuZy5HYSgpJiZsLmcuR2EoKS4kYik7dGhpcy5qPWE/dGhpcy5sOjE7dGhpcy5nPW51bGw7MTx0aGlzLmomJih0aGlzLmc9bmV3IFNldCk7dGhpcy5oPW51bGw7dGhpcy5pPVtdO312YXIgWGM9MTA7ZnVuY3Rpb24gWWMoYSl7cmV0dXJuIGEuaD8hMDphLmc/YS5nLnNpemU+PWEuajohMX1mdW5jdGlvbiB1YyhhKXtyZXR1cm4gYS5oPzE6YS5nP2EuZy5zaXplOjB9ZnVuY3Rpb24gcWMoYSxiKXtyZXR1cm4gYS5oP2EuaD09YjphLmc/YS5nLmhhcyhiKTohMX1mdW5jdGlvbiB2YyhhLGIpe2EuZz9hLmcuYWRkKGIpOmEuaD1iO31cbmZ1bmN0aW9uIHhjKGEsYil7YS5oJiZhLmg9PWI/YS5oPW51bGw6YS5nJiZhLmcuaGFzKGIpJiZhLmcuZGVsZXRlKGIpO31XYy5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5pPVpjKHRoaXMpO2lmKHRoaXMuaCl0aGlzLmguY2FuY2VsKCksdGhpcy5oPW51bGw7ZWxzZSBpZih0aGlzLmcmJjAhPT10aGlzLmcuc2l6ZSl7Zm9yKGNvbnN0IGEgb2YgdGhpcy5nLnZhbHVlcygpKWEuY2FuY2VsKCk7dGhpcy5nLmNsZWFyKCk7fX07ZnVuY3Rpb24gWmMoYSl7aWYobnVsbCE9YS5oKXJldHVybiBhLmkuY29uY2F0KGEuaC5EKTtpZihudWxsIT1hLmcmJjAhPT1hLmcuc2l6ZSl7bGV0IGI9YS5pO2Zvcihjb25zdCBjIG9mIGEuZy52YWx1ZXMoKSliPWIuY29uY2F0KGMuRCk7cmV0dXJuIGJ9cmV0dXJuIG1hKGEuaSl9ZnVuY3Rpb24gJGMoKXt9JGMucHJvdG90eXBlLnN0cmluZ2lmeT1mdW5jdGlvbihhKXtyZXR1cm4gbC5KU09OLnN0cmluZ2lmeShhLHZvaWQgMCl9OyRjLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbihhKXtyZXR1cm4gbC5KU09OLnBhcnNlKGEsdm9pZCAwKX07ZnVuY3Rpb24gYWQoKXt0aGlzLmc9bmV3ICRjO31mdW5jdGlvbiBiZChhLGIsYyl7Y29uc3QgZD1jfHxcIlwiO3RyeXtEYyhhLGZ1bmN0aW9uKGUsZil7bGV0IGg9ZTtwKGUpJiYoaD1sYihlKSk7Yi5wdXNoKGQrZitcIj1cIitlbmNvZGVVUklDb21wb25lbnQoaCkpO30pO31jYXRjaChlKXt0aHJvdyBiLnB1c2goZCtcInR5cGU9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFwiX2JhZG1hcFwiKSksZTt9fWZ1bmN0aW9uIGNkKGEsYil7Y29uc3QgYz1uZXcgR2I7aWYobC5JbWFnZSl7Y29uc3QgZD1uZXcgSW1hZ2U7ZC5vbmxvYWQ9aWEoZGQsYyxkLFwiVGVzdExvYWRJbWFnZTogbG9hZGVkXCIsITAsYik7ZC5vbmVycm9yPWlhKGRkLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGVycm9yXCIsITEsYik7ZC5vbmFib3J0PWlhKGRkLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGFib3J0XCIsITEsYik7ZC5vbnRpbWVvdXQ9aWEoZGQsYyxkLFwiVGVzdExvYWRJbWFnZTogdGltZW91dFwiLCExLGIpO2wuc2V0VGltZW91dChmdW5jdGlvbigpe2lmKGQub250aW1lb3V0KWQub250aW1lb3V0KCk7fSwxRTQpO2Quc3JjPWE7fWVsc2UgYighMSk7fWZ1bmN0aW9uIGRkKGEsYixjLGQsZSl7dHJ5e2Iub25sb2FkPW51bGwsYi5vbmVycm9yPW51bGwsYi5vbmFib3J0PW51bGwsYi5vbnRpbWVvdXQ9bnVsbCxlKGQpO31jYXRjaChmKXt9fWZ1bmN0aW9uIGVkKGEpe3RoaXMubD1hLmFjfHxudWxsO3RoaXMuaj1hLmpifHwhMTt9dChlZCxTYik7ZWQucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGZkKHRoaXMubCx0aGlzLmopfTtlZC5wcm90b3R5cGUuaT1mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYX19KHt9KTtmdW5jdGlvbiBmZChhLGIpe0IuY2FsbCh0aGlzKTt0aGlzLkQ9YTt0aGlzLnU9Yjt0aGlzLm09dm9pZCAwO3RoaXMucmVhZHlTdGF0ZT1nZDt0aGlzLnN0YXR1cz0wO3RoaXMucmVzcG9uc2VUeXBlPXRoaXMucmVzcG9uc2VUZXh0PXRoaXMucmVzcG9uc2U9dGhpcy5zdGF0dXNUZXh0PVwiXCI7dGhpcy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt0aGlzLnY9bmV3IEhlYWRlcnM7dGhpcy5oPW51bGw7dGhpcy5DPVwiR0VUXCI7dGhpcy5CPVwiXCI7dGhpcy5nPSExO3RoaXMuQT10aGlzLmo9dGhpcy5sPW51bGw7fXQoZmQsQik7dmFyIGdkPTA7az1mZC5wcm90b3R5cGU7XG5rLm9wZW49ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnJlYWR5U3RhdGUhPWdkKXRocm93IHRoaXMuYWJvcnQoKSxFcnJvcihcIkVycm9yIHJlb3BlbmluZyBhIGNvbm5lY3Rpb25cIik7dGhpcy5DPWE7dGhpcy5CPWI7dGhpcy5yZWFkeVN0YXRlPTE7aGQodGhpcyk7fTtrLnNlbmQ9ZnVuY3Rpb24oYSl7aWYoMSE9dGhpcy5yZWFkeVN0YXRlKXRocm93IHRoaXMuYWJvcnQoKSxFcnJvcihcIm5lZWQgdG8gY2FsbCBvcGVuKCkgZmlyc3QuIFwiKTt0aGlzLmc9ITA7Y29uc3QgYj17aGVhZGVyczp0aGlzLnYsbWV0aG9kOnRoaXMuQyxjcmVkZW50aWFsczp0aGlzLm0sY2FjaGU6dm9pZCAwfTthJiYoYi5ib2R5PWEpOyh0aGlzLkR8fGwpLmZldGNoKG5ldyBSZXF1ZXN0KHRoaXMuQixiKSkudGhlbih0aGlzLldhLmJpbmQodGhpcyksdGhpcy5nYS5iaW5kKHRoaXMpKTt9O1xuay5hYm9ydD1mdW5jdGlvbigpe3RoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQ9XCJcIjt0aGlzLnY9bmV3IEhlYWRlcnM7dGhpcy5zdGF0dXM9MDt0aGlzLmomJnRoaXMuai5jYW5jZWwoXCJSZXF1ZXN0IHdhcyBhYm9ydGVkLlwiKS5jYXRjaCgoKT0+e30pOzE8PXRoaXMucmVhZHlTdGF0ZSYmdGhpcy5nJiY0IT10aGlzLnJlYWR5U3RhdGUmJih0aGlzLmc9ITEsaWQodGhpcykpO3RoaXMucmVhZHlTdGF0ZT1nZDt9O1xuay5XYT1mdW5jdGlvbihhKXtpZih0aGlzLmcmJih0aGlzLmw9YSx0aGlzLmh8fCh0aGlzLnN0YXR1cz10aGlzLmwuc3RhdHVzLHRoaXMuc3RhdHVzVGV4dD10aGlzLmwuc3RhdHVzVGV4dCx0aGlzLmg9YS5oZWFkZXJzLHRoaXMucmVhZHlTdGF0ZT0yLGhkKHRoaXMpKSx0aGlzLmcmJih0aGlzLnJlYWR5U3RhdGU9MyxoZCh0aGlzKSx0aGlzLmcpKSlpZihcImFycmF5YnVmZmVyXCI9PT10aGlzLnJlc3BvbnNlVHlwZSlhLmFycmF5QnVmZmVyKCkudGhlbih0aGlzLlVhLmJpbmQodGhpcyksdGhpcy5nYS5iaW5kKHRoaXMpKTtlbHNlIGlmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSYmXCJib2R5XCJpbiBhKXt0aGlzLmo9YS5ib2R5LmdldFJlYWRlcigpO2lmKHRoaXMudSl7aWYodGhpcy5yZXNwb25zZVR5cGUpdGhyb3cgRXJyb3IoJ3Jlc3BvbnNlVHlwZSBtdXN0IGJlIGVtcHR5IGZvciBcInN0cmVhbUJpbmFyeUNodW5rc1wiIG1vZGUgcmVzcG9uc2VzLicpO3RoaXMucmVzcG9uc2U9XG5bXTt9ZWxzZSB0aGlzLnJlc3BvbnNlPXRoaXMucmVzcG9uc2VUZXh0PVwiXCIsdGhpcy5BPW5ldyBUZXh0RGVjb2RlcjtqZCh0aGlzKTt9ZWxzZSBhLnRleHQoKS50aGVuKHRoaXMuVmEuYmluZCh0aGlzKSx0aGlzLmdhLmJpbmQodGhpcykpO307ZnVuY3Rpb24gamQoYSl7YS5qLnJlYWQoKS50aGVuKGEuVGEuYmluZChhKSkuY2F0Y2goYS5nYS5iaW5kKGEpKTt9ay5UYT1mdW5jdGlvbihhKXtpZih0aGlzLmcpe2lmKHRoaXMudSYmYS52YWx1ZSl0aGlzLnJlc3BvbnNlLnB1c2goYS52YWx1ZSk7ZWxzZSBpZighdGhpcy51KXt2YXIgYj1hLnZhbHVlP2EudmFsdWU6bmV3IFVpbnQ4QXJyYXkoMCk7aWYoYj10aGlzLkEuZGVjb2RlKGIse3N0cmVhbTohYS5kb25lfSkpdGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dCs9Yjt9YS5kb25lP2lkKHRoaXMpOmhkKHRoaXMpOzM9PXRoaXMucmVhZHlTdGF0ZSYmamQodGhpcyk7fX07XG5rLlZhPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQ9YSxpZCh0aGlzKSk7fTtrLlVhPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9YSxpZCh0aGlzKSk7fTtrLmdhPWZ1bmN0aW9uKCl7dGhpcy5nJiZpZCh0aGlzKTt9O2Z1bmN0aW9uIGlkKGEpe2EucmVhZHlTdGF0ZT00O2EubD1udWxsO2Euaj1udWxsO2EuQT1udWxsO2hkKGEpO31rLnNldFJlcXVlc3RIZWFkZXI9ZnVuY3Rpb24oYSxiKXt0aGlzLnYuYXBwZW5kKGEsYik7fTtrLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmg/dGhpcy5oLmdldChhLnRvTG93ZXJDYXNlKCkpfHxcIlwiOlwiXCJ9O1xuay5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXtpZighdGhpcy5oKXJldHVybiBcIlwiO2NvbnN0IGE9W10sYj10aGlzLmguZW50cmllcygpO2Zvcih2YXIgYz1iLm5leHQoKTshYy5kb25lOyljPWMudmFsdWUsYS5wdXNoKGNbMF0rXCI6IFwiK2NbMV0pLGM9Yi5uZXh0KCk7cmV0dXJuIGEuam9pbihcIlxcclxcblwiKX07ZnVuY3Rpb24gaGQoYSl7YS5vbnJlYWR5c3RhdGVjaGFuZ2UmJmEub25yZWFkeXN0YXRlY2hhbmdlLmNhbGwoYSk7fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShmZC5wcm90b3R5cGUsXCJ3aXRoQ3JlZGVudGlhbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIFwiaW5jbHVkZVwiPT09dGhpcy5tfSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5tPWE/XCJpbmNsdWRlXCI6XCJzYW1lLW9yaWdpblwiO319KTt2YXIga2Q9bC5KU09OLnBhcnNlO2Z1bmN0aW9uIFcoYSl7Qi5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgTWFwO3RoaXMudT1hfHxudWxsO3RoaXMuaD0hMTt0aGlzLkM9dGhpcy5nPW51bGw7dGhpcy5IPVwiXCI7dGhpcy5tPTA7dGhpcy5qPVwiXCI7dGhpcy5sPXRoaXMuRj10aGlzLnY9dGhpcy5EPSExO3RoaXMuQj0wO3RoaXMuQT1udWxsO3RoaXMuSj1sZDt0aGlzLks9dGhpcy5MPSExO310KFcsQik7dmFyIGxkPVwiXCIsbWQ9L15odHRwcz8kL2ksbmQ9W1wiUE9TVFwiLFwiUFVUXCJdO2s9Vy5wcm90b3R5cGU7ay5LYT1mdW5jdGlvbihhKXt0aGlzLkw9YTt9O1xuay5kYT1mdW5jdGlvbihhLGIsYyxkKXtpZih0aGlzLmcpdGhyb3cgRXJyb3IoXCJbZ29vZy5uZXQuWGhySW9dIE9iamVjdCBpcyBhY3RpdmUgd2l0aCBhbm90aGVyIHJlcXVlc3Q9XCIrdGhpcy5IK1wiOyBuZXdVcmk9XCIrYSk7Yj1iP2IudG9VcHBlckNhc2UoKTpcIkdFVFwiO3RoaXMuSD1hO3RoaXMuaj1cIlwiO3RoaXMubT0wO3RoaXMuRD0hMTt0aGlzLmg9ITA7dGhpcy5nPXRoaXMudT90aGlzLnUuZygpOlhiLmcoKTt0aGlzLkM9dGhpcy51P1RiKHRoaXMudSk6VGIoWGIpO3RoaXMuZy5vbnJlYWR5c3RhdGVjaGFuZ2U9cSh0aGlzLkhhLHRoaXMpO3RyeXt0aGlzLkY9ITAsdGhpcy5nLm9wZW4oYixTdHJpbmcoYSksITApLHRoaXMuRj0hMTt9Y2F0Y2goZil7b2QodGhpcyxmKTtyZXR1cm59YT1jfHxcIlwiO2M9bmV3IE1hcCh0aGlzLmhlYWRlcnMpO2lmKGQpaWYoT2JqZWN0LmdldFByb3RvdHlwZU9mKGQpPT09T2JqZWN0LnByb3RvdHlwZSlmb3IodmFyIGUgaW4gZCljLnNldChlLGRbZV0pO2Vsc2UgaWYoXCJmdW5jdGlvblwiPT09XG50eXBlb2YgZC5rZXlzJiZcImZ1bmN0aW9uXCI9PT10eXBlb2YgZC5nZXQpZm9yKGNvbnN0IGYgb2YgZC5rZXlzKCkpYy5zZXQoZixkLmdldChmKSk7ZWxzZSB0aHJvdyBFcnJvcihcIlVua25vd24gaW5wdXQgdHlwZSBmb3Igb3B0X2hlYWRlcnM6IFwiK1N0cmluZyhkKSk7ZD1BcnJheS5mcm9tKGMua2V5cygpKS5maW5kKGY9PlwiY29udGVudC10eXBlXCI9PWYudG9Mb3dlckNhc2UoKSk7ZT1sLkZvcm1EYXRhJiZhIGluc3RhbmNlb2YgbC5Gb3JtRGF0YTshKDA8PWxhKG5kLGIpKXx8ZHx8ZXx8Yy5zZXQoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO2Zvcihjb25zdCBbZixoXW9mIGMpdGhpcy5nLnNldFJlcXVlc3RIZWFkZXIoZixoKTt0aGlzLkomJih0aGlzLmcucmVzcG9uc2VUeXBlPXRoaXMuSik7XCJ3aXRoQ3JlZGVudGlhbHNcImluIHRoaXMuZyYmdGhpcy5nLndpdGhDcmVkZW50aWFscyE9PXRoaXMuTCYmKHRoaXMuZy53aXRoQ3JlZGVudGlhbHM9XG50aGlzLkwpO3RyeXtwZCh0aGlzKSwwPHRoaXMuQiYmKCh0aGlzLks9cWQodGhpcy5nKSk/KHRoaXMuZy50aW1lb3V0PXRoaXMuQix0aGlzLmcub250aW1lb3V0PXEodGhpcy5xYSx0aGlzKSk6dGhpcy5BPUFiKHRoaXMucWEsdGhpcy5CLHRoaXMpKSx0aGlzLnY9ITAsdGhpcy5nLnNlbmQoYSksdGhpcy52PSExO31jYXRjaChmKXtvZCh0aGlzLGYpO319O2Z1bmN0aW9uIHFkKGEpe3JldHVybiB5JiZJYSgpJiZcIm51bWJlclwiPT09dHlwZW9mIGEudGltZW91dCYmdm9pZCAwIT09YS5vbnRpbWVvdXR9ay5xYT1mdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiZ0aGlzLmcmJih0aGlzLmo9XCJUaW1lZCBvdXQgYWZ0ZXIgXCIrdGhpcy5CK1wibXMsIGFib3J0aW5nXCIsdGhpcy5tPTgsQyh0aGlzLFwidGltZW91dFwiKSx0aGlzLmFib3J0KDgpKTt9O1xuZnVuY3Rpb24gb2QoYSxiKXthLmg9ITE7YS5nJiYoYS5sPSEwLGEuZy5hYm9ydCgpLGEubD0hMSk7YS5qPWI7YS5tPTU7cmQoYSk7c2QoYSk7fWZ1bmN0aW9uIHJkKGEpe2EuRHx8KGEuRD0hMCxDKGEsXCJjb21wbGV0ZVwiKSxDKGEsXCJlcnJvclwiKSk7fWsuYWJvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5nJiZ0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSx0aGlzLm09YXx8NyxDKHRoaXMsXCJjb21wbGV0ZVwiKSxDKHRoaXMsXCJhYm9ydFwiKSxzZCh0aGlzKSk7fTtrLk09ZnVuY3Rpb24oKXt0aGlzLmcmJih0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSksc2QodGhpcywhMCkpO1cuWC5NLmNhbGwodGhpcyk7fTtrLkhhPWZ1bmN0aW9uKCl7dGhpcy5zfHwodGhpcy5GfHx0aGlzLnZ8fHRoaXMubD90ZCh0aGlzKTp0aGlzLmZiKCkpO307ay5mYj1mdW5jdGlvbigpe3RkKHRoaXMpO307XG5mdW5jdGlvbiB0ZChhKXtpZihhLmgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiYoIWEuQ1sxXXx8NCE9TyhhKXx8MiE9YS5hYSgpKSlpZihhLnYmJjQ9PU8oYSkpQWIoYS5IYSwwLGEpO2Vsc2UgaWYoQyhhLFwicmVhZHlzdGF0ZWNoYW5nZVwiKSw0PT1PKGEpKXthLmg9ITE7dHJ5e2NvbnN0IG49YS5hYSgpO2E6c3dpdGNoKG4pe2Nhc2UgMjAwOmNhc2UgMjAxOmNhc2UgMjAyOmNhc2UgMjA0OmNhc2UgMjA2OmNhc2UgMzA0OmNhc2UgMTIyMzp2YXIgYj0hMDticmVhayBhO2RlZmF1bHQ6Yj0hMTt9dmFyIGM7aWYoIShjPWIpKXt2YXIgZDtpZihkPTA9PT1uKXt2YXIgZT1TdHJpbmcoYS5IKS5tYXRjaChFYylbMV18fG51bGw7aWYoIWUmJmwuc2VsZiYmbC5zZWxmLmxvY2F0aW9uKXt2YXIgZj1sLnNlbGYubG9jYXRpb24ucHJvdG9jb2w7ZT1mLnN1YnN0cigwLGYubGVuZ3RoLTEpO31kPSFtZC50ZXN0KGU/ZS50b0xvd2VyQ2FzZSgpOlwiXCIpO31jPWQ7fWlmKGMpQyhhLFwiY29tcGxldGVcIiksQyhhLFxuXCJzdWNjZXNzXCIpO2Vsc2Uge2EubT02O3RyeXt2YXIgaD0yPE8oYSk/YS5nLnN0YXR1c1RleHQ6XCJcIjt9Y2F0Y2godSl7aD1cIlwiO31hLmo9aCtcIiBbXCIrYS5hYSgpK1wiXVwiO3JkKGEpO319ZmluYWxseXtzZChhKTt9fX1mdW5jdGlvbiBzZChhLGIpe2lmKGEuZyl7cGQoYSk7Y29uc3QgYz1hLmcsZD1hLkNbMF0/YWE6bnVsbDthLmc9bnVsbDthLkM9bnVsbDtifHxDKGEsXCJyZWFkeVwiKTt0cnl7Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZDt9Y2F0Y2goZSl7fX19ZnVuY3Rpb24gcGQoYSl7YS5nJiZhLksmJihhLmcub250aW1lb3V0PW51bGwpO2EuQSYmKGwuY2xlYXJUaW1lb3V0KGEuQSksYS5BPW51bGwpO31mdW5jdGlvbiBPKGEpe3JldHVybiBhLmc/YS5nLnJlYWR5U3RhdGU6MH1rLmFhPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiAyPE8odGhpcyk/dGhpcy5nLnN0YXR1czotMX1jYXRjaChhKXtyZXR1cm4gLTF9fTtcbmsuZmE9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHRoaXMuZz90aGlzLmcucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIFwiXCJ9fTtrLlNhPWZ1bmN0aW9uKGEpe2lmKHRoaXMuZyl7dmFyIGI9dGhpcy5nLnJlc3BvbnNlVGV4dDthJiYwPT1iLmluZGV4T2YoYSkmJihiPWIuc3Vic3RyaW5nKGEubGVuZ3RoKSk7cmV0dXJuIGtkKGIpfX07ZnVuY3Rpb24gaGMoYSl7dHJ5e2lmKCFhLmcpcmV0dXJuIG51bGw7aWYoXCJyZXNwb25zZVwiaW4gYS5nKXJldHVybiBhLmcucmVzcG9uc2U7c3dpdGNoKGEuSil7Y2FzZSBsZDpjYXNlIFwidGV4dFwiOnJldHVybiBhLmcucmVzcG9uc2VUZXh0O2Nhc2UgXCJhcnJheWJ1ZmZlclwiOmlmKFwibW96UmVzcG9uc2VBcnJheUJ1ZmZlclwiaW4gYS5nKXJldHVybiBhLmcubW96UmVzcG9uc2VBcnJheUJ1ZmZlcn1yZXR1cm4gbnVsbH1jYXRjaChiKXtyZXR1cm4gbnVsbH19ay5FYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm19O1xuay5PYT1mdW5jdGlvbigpe3JldHVybiBcInN0cmluZ1wiPT09dHlwZW9mIHRoaXMuaj90aGlzLmo6U3RyaW5nKHRoaXMuail9O2Z1bmN0aW9uIHVkKGEpe2xldCBiPVwiXCI7UWEoYSxmdW5jdGlvbihjLGQpe2IrPWQ7Yis9XCI6XCI7Yis9YztiKz1cIlxcclxcblwiO30pO3JldHVybiBifWZ1bmN0aW9uIHZkKGEsYixjKXthOntmb3IoZCBpbiBjKXt2YXIgZD0hMTticmVhayBhfWQ9ITA7fWR8fChjPXVkKGMpLFwic3RyaW5nXCI9PT10eXBlb2YgYT8obnVsbCE9YyYmZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSkpOlMoYSxiLGMpKTt9ZnVuY3Rpb24gd2QoYSxiLGMpe3JldHVybiBjJiZjLmludGVybmFsQ2hhbm5lbFBhcmFtcz9jLmludGVybmFsQ2hhbm5lbFBhcmFtc1thXXx8YjpifVxuZnVuY3Rpb24geGQoYSl7dGhpcy5DYT0wO3RoaXMuaT1bXTt0aGlzLmo9bmV3IEdiO3RoaXMua2E9dGhpcy5zYT10aGlzLkY9dGhpcy5WPXRoaXMuZz10aGlzLnphPXRoaXMuRD10aGlzLmlhPXRoaXMubz10aGlzLlM9dGhpcy5zPW51bGw7dGhpcy5hYj10aGlzLlU9MDt0aGlzLlphPXdkKFwiZmFpbEZhc3RcIiwhMSxhKTt0aGlzLkw9dGhpcy52PXRoaXMudT10aGlzLm09dGhpcy5sPW51bGw7dGhpcy5ZPSEwO3RoaXMucGE9dGhpcy5CYT10aGlzLlQ9LTE7dGhpcy5aPXRoaXMuQT10aGlzLkM9MDt0aGlzLlhhPXdkKFwiYmFzZVJldHJ5RGVsYXlNc1wiLDVFMyxhKTt0aGlzLmJiPXdkKFwicmV0cnlEZWxheVNlZWRNc1wiLDFFNCxhKTt0aGlzLiRhPXdkKFwiZm9yd2FyZENoYW5uZWxNYXhSZXRyaWVzXCIsMixhKTt0aGlzLnRhPXdkKFwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zXCIsMkU0LGEpO3RoaXMucmE9YSYmYS54bWxIdHRwRmFjdG9yeXx8dm9pZCAwO3RoaXMuRGE9YSYmYS5aYnx8ITE7XG50aGlzLko9dm9pZCAwO3RoaXMuSD1hJiZhLnN1cHBvcnRzQ3Jvc3NEb21haW5YaHJ8fCExO3RoaXMuST1cIlwiO3RoaXMuaD1uZXcgV2MoYSYmYS5jb25jdXJyZW50UmVxdWVzdExpbWl0KTt0aGlzLkZhPW5ldyBhZDt0aGlzLk89YSYmYS5mYXN0SGFuZHNoYWtlfHwhMTt0aGlzLk49YSYmYS5lbmNvZGVJbml0TWVzc2FnZUhlYWRlcnN8fCExO3RoaXMuTyYmdGhpcy5OJiYodGhpcy5OPSExKTt0aGlzLllhPWEmJmEuWGJ8fCExO2EmJmEuQWEmJnRoaXMuai5BYSgpO2EmJmEuZm9yY2VMb25nUG9sbGluZyYmKHRoaXMuWT0hMSk7dGhpcy4kPSF0aGlzLk8mJnRoaXMuWSYmYSYmYS5kZXRlY3RCdWZmZXJpbmdQcm94eXx8ITE7dGhpcy5qYT12b2lkIDA7dGhpcy5QPTA7dGhpcy5LPSExO3RoaXMubGE9dGhpcy5CPW51bGw7fWs9eGQucHJvdG90eXBlO2subWE9ODtrLkc9MTtcbmZ1bmN0aW9uIEFjKGEpe3lkKGEpO2lmKDM9PWEuRyl7dmFyIGI9YS5VKyssYz1NKGEuRik7UyhjLFwiU0lEXCIsYS5JKTtTKGMsXCJSSURcIixiKTtTKGMsXCJUWVBFXCIsXCJ0ZXJtaW5hdGVcIik7emQoYSxjKTtiPW5ldyBMKGEsYS5qLGIsdm9pZCAwKTtiLks9MjtiLnY9ZGMoTShjKSk7Yz0hMTtsLm5hdmlnYXRvciYmbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbiYmKGM9bC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihiLnYudG9TdHJpbmcoKSxcIlwiKSk7IWMmJmwuSW1hZ2UmJigobmV3IEltYWdlKS5zcmM9Yi52LGM9ITApO2N8fChiLmc9Z2MoYi5sLG51bGwpLGIuZy5kYShiLnYpKTtiLkY9RGF0ZS5ub3coKTtOKGIpO31BZChhKTt9ZnVuY3Rpb24gc2MoYSl7YS5nJiYob2MoYSksYS5nLmNhbmNlbCgpLGEuZz1udWxsKTt9XG5mdW5jdGlvbiB5ZChhKXtzYyhhKTthLnUmJihsLmNsZWFyVGltZW91dChhLnUpLGEudT1udWxsKTtyYyhhKTthLmguY2FuY2VsKCk7YS5tJiYoXCJudW1iZXJcIj09PXR5cGVvZiBhLm0mJmwuY2xlYXJUaW1lb3V0KGEubSksYS5tPW51bGwpO31mdW5jdGlvbiB6YyhhKXtZYyhhLmgpfHxhLm18fChhLm09ITAsc2IoYS5KYSxhKSxhLkM9MCk7fWZ1bmN0aW9uIEJkKGEsYil7aWYodWMoYS5oKT49YS5oLmotKGEubT8xOjApKXJldHVybiAhMTtpZihhLm0pcmV0dXJuIGEuaT1iLkQuY29uY2F0KGEuaSksITA7aWYoMT09YS5HfHwyPT1hLkd8fGEuQz49KGEuWmE/MDphLiRhKSlyZXR1cm4gITE7YS5tPUoocShhLkphLGEsYiksQ2QoYSxhLkMpKTthLkMrKztyZXR1cm4gITB9XG5rLkphPWZ1bmN0aW9uKGEpe2lmKHRoaXMubSlpZih0aGlzLm09bnVsbCwxPT10aGlzLkcpe2lmKCFhKXt0aGlzLlU9TWF0aC5mbG9vcigxRTUqTWF0aC5yYW5kb20oKSk7YT10aGlzLlUrKztjb25zdCBlPW5ldyBMKHRoaXMsdGhpcy5qLGEsdm9pZCAwKTtsZXQgZj10aGlzLnM7dGhpcy5TJiYoZj8oZj1SYShmKSxUYShmLHRoaXMuUykpOmY9dGhpcy5TKTtudWxsIT09dGhpcy5vfHx0aGlzLk58fChlLkg9ZixmPW51bGwpO2lmKHRoaXMuTylhOnt2YXIgYj0wO2Zvcih2YXIgYz0wO2M8dGhpcy5pLmxlbmd0aDtjKyspe2I6e3ZhciBkPXRoaXMuaVtjXTtpZihcIl9fZGF0YV9fXCJpbiBkLmcmJihkPWQuZy5fX2RhdGFfXyxcInN0cmluZ1wiPT09dHlwZW9mIGQpKXtkPWQubGVuZ3RoO2JyZWFrIGJ9ZD12b2lkIDA7fWlmKHZvaWQgMD09PWQpYnJlYWs7Yis9ZDtpZig0MDk2PGIpe2I9YzticmVhayBhfWlmKDQwOTY9PT1ifHxjPT09dGhpcy5pLmxlbmd0aC0xKXtiPWMrMTticmVhayBhfX1iPTFFMzt9ZWxzZSBiPVxuMUUzO2I9RGQodGhpcyxlLGIpO2M9TSh0aGlzLkYpO1MoYyxcIlJJRFwiLGEpO1MoYyxcIkNWRVJcIiwyMik7dGhpcy5EJiZTKGMsXCJYLUhUVFAtU2Vzc2lvbi1JZFwiLHRoaXMuRCk7emQodGhpcyxjKTtmJiYodGhpcy5OP2I9XCJoZWFkZXJzPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodWQoZikpKStcIiZcIitiOnRoaXMubyYmdmQoYyx0aGlzLm8sZikpO3ZjKHRoaXMuaCxlKTt0aGlzLllhJiZTKGMsXCJUWVBFXCIsXCJpbml0XCIpO3RoaXMuTz8oUyhjLFwiJHJlcVwiLGIpLFMoYyxcIlNJRFwiLFwibnVsbFwiKSxlLlo9ITAsY2MoZSxjLG51bGwpKTpjYyhlLGMsYik7dGhpcy5HPTI7fX1lbHNlIDM9PXRoaXMuRyYmKGE/RWQodGhpcyxhKTowPT10aGlzLmkubGVuZ3RofHxZYyh0aGlzLmgpfHxFZCh0aGlzKSk7fTtcbmZ1bmN0aW9uIEVkKGEsYil7dmFyIGM7Yj9jPWIubTpjPWEuVSsrO2NvbnN0IGQ9TShhLkYpO1MoZCxcIlNJRFwiLGEuSSk7UyhkLFwiUklEXCIsYyk7UyhkLFwiQUlEXCIsYS5UKTt6ZChhLGQpO2EubyYmYS5zJiZ2ZChkLGEubyxhLnMpO2M9bmV3IEwoYSxhLmosYyxhLkMrMSk7bnVsbD09PWEubyYmKGMuSD1hLnMpO2ImJihhLmk9Yi5ELmNvbmNhdChhLmkpKTtiPURkKGEsYywxRTMpO2Muc2V0VGltZW91dChNYXRoLnJvdW5kKC41KmEudGEpK01hdGgucm91bmQoLjUqYS50YSpNYXRoLnJhbmRvbSgpKSk7dmMoYS5oLGMpO2NjKGMsZCxiKTt9ZnVuY3Rpb24gemQoYSxiKXthLmlhJiZRYShhLmlhLGZ1bmN0aW9uKGMsZCl7UyhiLGQsYyk7fSk7YS5sJiZEYyh7fSxmdW5jdGlvbihjLGQpe1MoYixkLGMpO30pO31cbmZ1bmN0aW9uIERkKGEsYixjKXtjPU1hdGgubWluKGEuaS5sZW5ndGgsYyk7dmFyIGQ9YS5sP3EoYS5sLlJhLGEubCxhKTpudWxsO2E6e3ZhciBlPWEuaTtsZXQgZj0tMTtmb3IoOzspe2NvbnN0IGg9W1wiY291bnQ9XCIrY107LTE9PWY/MDxjPyhmPWVbMF0uaCxoLnB1c2goXCJvZnM9XCIrZikpOmY9MDpoLnB1c2goXCJvZnM9XCIrZik7bGV0IG49ITA7Zm9yKGxldCB1PTA7dTxjO3UrKyl7bGV0IG09ZVt1XS5oO2NvbnN0IHI9ZVt1XS5nO20tPWY7aWYoMD5tKWY9TWF0aC5tYXgoMCxlW3VdLmgtMTAwKSxuPSExO2Vsc2UgdHJ5e2JkKHIsaCxcInJlcVwiK20rXCJfXCIpO31jYXRjaChGKXtkJiZkKHIpO319aWYobil7ZD1oLmpvaW4oXCImXCIpO2JyZWFrIGF9fX1hPWEuaS5zcGxpY2UoMCxjKTtiLkQ9YTtyZXR1cm4gZH1mdW5jdGlvbiB5YyhhKXthLmd8fGEudXx8KGEuWj0xLHNiKGEuSWEsYSksYS5BPTApO31cbmZ1bmN0aW9uIHRjKGEpe2lmKGEuZ3x8YS51fHwzPD1hLkEpcmV0dXJuICExO2EuWisrO2EudT1KKHEoYS5JYSxhKSxDZChhLGEuQSkpO2EuQSsrO3JldHVybiAhMH1rLklhPWZ1bmN0aW9uKCl7dGhpcy51PW51bGw7RmQodGhpcyk7aWYodGhpcy4kJiYhKHRoaXMuS3x8bnVsbD09dGhpcy5nfHwwPj10aGlzLlApKXt2YXIgYT0yKnRoaXMuUDt0aGlzLmouaW5mbyhcIkJQIGRldGVjdGlvbiB0aW1lciBlbmFibGVkOiBcIithKTt0aGlzLkI9SihxKHRoaXMuZWIsdGhpcyksYSk7fX07ay5lYj1mdW5jdGlvbigpe3RoaXMuQiYmKHRoaXMuQj1udWxsLHRoaXMuai5pbmZvKFwiQlAgZGV0ZWN0aW9uIHRpbWVvdXQgcmVhY2hlZC5cIiksdGhpcy5qLmluZm8oXCJCdWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQgYW5kIHN3aXRjaCB0byBsb25nLXBvbGxpbmchXCIpLHRoaXMuTD0hMSx0aGlzLks9ITAsSSgxMCksc2ModGhpcyksRmQodGhpcykpO307XG5mdW5jdGlvbiBvYyhhKXtudWxsIT1hLkImJihsLmNsZWFyVGltZW91dChhLkIpLGEuQj1udWxsKTt9ZnVuY3Rpb24gRmQoYSl7YS5nPW5ldyBMKGEsYS5qLFwicnBjXCIsYS5aKTtudWxsPT09YS5vJiYoYS5nLkg9YS5zKTthLmcuTj0wO3ZhciBiPU0oYS5zYSk7UyhiLFwiUklEXCIsXCJycGNcIik7UyhiLFwiU0lEXCIsYS5JKTtTKGIsXCJDSVwiLGEuTD9cIjBcIjpcIjFcIik7UyhiLFwiQUlEXCIsYS5UKTtTKGIsXCJUWVBFXCIsXCJ4bWxodHRwXCIpO3pkKGEsYik7YS5vJiZhLnMmJnZkKGIsYS5vLGEucyk7YS5KJiZhLmcuc2V0VGltZW91dChhLkopO3ZhciBjPWEuZzthPWEua2E7Yy5LPTE7Yy52PWRjKE0oYikpO2Mucz1udWxsO2MuUD0hMDtlYyhjLGEpO31rLmNiPWZ1bmN0aW9uKCl7bnVsbCE9dGhpcy52JiYodGhpcy52PW51bGwsc2ModGhpcyksdGModGhpcyksSSgxOSkpO307ZnVuY3Rpb24gcmMoYSl7bnVsbCE9YS52JiYobC5jbGVhclRpbWVvdXQoYS52KSxhLnY9bnVsbCk7fVxuZnVuY3Rpb24gbWMoYSxiKXt2YXIgYz1udWxsO2lmKGEuZz09Yil7cmMoYSk7b2MoYSk7YS5nPW51bGw7dmFyIGQ9Mjt9ZWxzZSBpZihxYyhhLmgsYikpYz1iLkQseGMoYS5oLGIpLGQ9MTtlbHNlIHJldHVybjtpZigwIT1hLkcpaWYoYS5wYT1iLlksYi5pKWlmKDE9PWQpe2M9Yi5zP2Iucy5sZW5ndGg6MDtiPURhdGUubm93KCktYi5GO3ZhciBlPWEuQztkPU1iKCk7QyhkLG5ldyBQYihkLGMpKTt6YyhhKTt9ZWxzZSB5YyhhKTtlbHNlIGlmKGU9Yi5vLDM9PWV8fDA9PWUmJjA8YS5wYXx8ISgxPT1kJiZCZChhLGIpfHwyPT1kJiZ0YyhhKSkpc3dpdGNoKGMmJjA8Yy5sZW5ndGgmJihiPWEuaCxiLmk9Yi5pLmNvbmNhdChjKSksZSl7Y2FzZSAxOlIoYSw1KTticmVhaztjYXNlIDQ6UihhLDEwKTticmVhaztjYXNlIDM6UihhLDYpO2JyZWFrO2RlZmF1bHQ6UihhLDIpO319XG5mdW5jdGlvbiBDZChhLGIpe2xldCBjPWEuWGErTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmEuYmIpO2EubHx8KGMqPTIpO3JldHVybiBjKmJ9ZnVuY3Rpb24gUihhLGIpe2Euai5pbmZvKFwiRXJyb3IgY29kZSBcIitiKTtpZigyPT1iKXt2YXIgYz1udWxsO2EubCYmKGM9bnVsbCk7dmFyIGQ9cShhLmtiLGEpO2N8fChjPW5ldyBUKFwiLy93d3cuZ29vZ2xlLmNvbS9pbWFnZXMvY2xlYXJkb3QuZ2lmXCIpLGwubG9jYXRpb24mJlwiaHR0cFwiPT1sLmxvY2F0aW9uLnByb3RvY29sfHxHYyhjLFwiaHR0cHNcIiksZGMoYykpO2NkKGMudG9TdHJpbmcoKSxkKTt9ZWxzZSBJKDIpO2EuRz0wO2EubCYmYS5sLnZhKGIpO0FkKGEpO3lkKGEpO31rLmtiPWZ1bmN0aW9uKGEpe2E/KHRoaXMuai5pbmZvKFwiU3VjY2Vzc2Z1bGx5IHBpbmdlZCBnb29nbGUuY29tXCIpLEkoMikpOih0aGlzLmouaW5mbyhcIkZhaWxlZCB0byBwaW5nIGdvb2dsZS5jb21cIiksSSgxKSk7fTtcbmZ1bmN0aW9uIEFkKGEpe2EuRz0wO2EubGE9W107aWYoYS5sKXtjb25zdCBiPVpjKGEuaCk7aWYoMCE9Yi5sZW5ndGh8fDAhPWEuaS5sZW5ndGgpbmEoYS5sYSxiKSxuYShhLmxhLGEuaSksYS5oLmkubGVuZ3RoPTAsbWEoYS5pKSxhLmkubGVuZ3RoPTA7YS5sLnVhKCk7fX1mdW5jdGlvbiB3YyhhLGIsYyl7dmFyIGQ9YyBpbnN0YW5jZW9mIFQ/TShjKTpuZXcgVChjLHZvaWQgMCk7aWYoXCJcIiE9ZC5nKWImJihkLmc9YitcIi5cIitkLmcpLEhjKGQsZC5tKTtlbHNlIHt2YXIgZT1sLmxvY2F0aW9uO2Q9ZS5wcm90b2NvbDtiPWI/YitcIi5cIitlLmhvc3RuYW1lOmUuaG9zdG5hbWU7ZT0rZS5wb3J0O3ZhciBmPW5ldyBUKG51bGwsdm9pZCAwKTtkJiZHYyhmLGQpO2ImJihmLmc9Yik7ZSYmSGMoZixlKTtjJiYoZi5sPWMpO2Q9Zjt9Yz1hLkQ7Yj1hLnphO2MmJmImJlMoZCxjLGIpO1MoZCxcIlZFUlwiLGEubWEpO3pkKGEsZCk7cmV0dXJuIGR9XG5mdW5jdGlvbiBnYyhhLGIsYyl7aWYoYiYmIWEuSCl0aHJvdyBFcnJvcihcIkNhbid0IGNyZWF0ZSBzZWNvbmRhcnkgZG9tYWluIGNhcGFibGUgWGhySW8gb2JqZWN0LlwiKTtiPWMmJmEuRGEmJiFhLnJhP25ldyBXKG5ldyBlZCh7amI6ITB9KSk6bmV3IFcoYS5yYSk7Yi5LYShhLkgpO3JldHVybiBifWZ1bmN0aW9uIEdkKCl7fWs9R2QucHJvdG90eXBlO2sueGE9ZnVuY3Rpb24oKXt9O2sud2E9ZnVuY3Rpb24oKXt9O2sudmE9ZnVuY3Rpb24oKXt9O2sudWE9ZnVuY3Rpb24oKXt9O2suUmE9ZnVuY3Rpb24oKXt9O2Z1bmN0aW9uIEhkKCl7aWYoeSYmISgxMDw9TnVtYmVyKExhKSkpdGhyb3cgRXJyb3IoXCJFbnZpcm9ubWVudGFsIGVycm9yOiBubyBhdmFpbGFibGUgdHJhbnNwb3J0LlwiKTt9SGQucHJvdG90eXBlLmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFgoYSxiKX07XG5mdW5jdGlvbiBYKGEsYil7Qi5jYWxsKHRoaXMpO3RoaXMuZz1uZXcgeGQoYik7dGhpcy5sPWE7dGhpcy5oPWImJmIubWVzc2FnZVVybFBhcmFtc3x8bnVsbDthPWImJmIubWVzc2FnZUhlYWRlcnN8fG51bGw7YiYmYi5jbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkJiYoYT9hW1wiWC1DbGllbnQtUHJvdG9jb2xcIl09XCJ3ZWJjaGFubmVsXCI6YT17XCJYLUNsaWVudC1Qcm90b2NvbFwiOlwid2ViY2hhbm5lbFwifSk7dGhpcy5nLnM9YTthPWImJmIuaW5pdE1lc3NhZ2VIZWFkZXJzfHxudWxsO2ImJmIubWVzc2FnZUNvbnRlbnRUeXBlJiYoYT9hW1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiXT1iLm1lc3NhZ2VDb250ZW50VHlwZTphPXtcIlgtV2ViQ2hhbm5lbC1Db250ZW50LVR5cGVcIjpiLm1lc3NhZ2VDb250ZW50VHlwZX0pO2ImJmIueWEmJihhP2FbXCJYLVdlYkNoYW5uZWwtQ2xpZW50LVByb2ZpbGVcIl09Yi55YTphPXtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiOmIueWF9KTt0aGlzLmcuUz1cbmE7KGE9YiYmYi5ZYikmJiFwYShhKSYmKHRoaXMuZy5vPWEpO3RoaXMuQT1iJiZiLnN1cHBvcnRzQ3Jvc3NEb21haW5YaHJ8fCExO3RoaXMudj1iJiZiLnNlbmRSYXdKc29ufHwhMTsoYj1iJiZiLmh0dHBTZXNzaW9uSWRQYXJhbSkmJiFwYShiKSYmKHRoaXMuZy5EPWIsYT10aGlzLmgsbnVsbCE9PWEmJmIgaW4gYSYmKGE9dGhpcy5oLGIgaW4gYSYmZGVsZXRlIGFbYl0pKTt0aGlzLmo9bmV3IFkodGhpcyk7fXQoWCxCKTtYLnByb3RvdHlwZS5tPWZ1bmN0aW9uKCl7dGhpcy5nLmw9dGhpcy5qO3RoaXMuQSYmKHRoaXMuZy5IPSEwKTt2YXIgYT10aGlzLmcsYj10aGlzLmwsYz10aGlzLmh8fHZvaWQgMDtJKDApO2EuVj1iO2EuaWE9Y3x8e307YS5MPWEuWTthLkY9d2MoYSxudWxsLGEuVik7emMoYSk7fTtYLnByb3RvdHlwZS5jbG9zZT1mdW5jdGlvbigpe0FjKHRoaXMuZyk7fTtcblgucHJvdG90eXBlLnU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSl7dmFyIGM9e307Yy5fX2RhdGFfXz1hO2E9Yzt9ZWxzZSB0aGlzLnYmJihjPXt9LGMuX19kYXRhX189bGIoYSksYT1jKTtiLmkucHVzaChuZXcgVmMoYi5hYisrLGEpKTszPT1iLkcmJnpjKGIpO307WC5wcm90b3R5cGUuTT1mdW5jdGlvbigpe3RoaXMuZy5sPW51bGw7ZGVsZXRlIHRoaXMuajtBYyh0aGlzLmcpO2RlbGV0ZSB0aGlzLmc7WC5YLk0uY2FsbCh0aGlzKTt9O2Z1bmN0aW9uIElkKGEpe1ZiLmNhbGwodGhpcyk7dmFyIGI9YS5fX3NtX187aWYoYil7YTp7Zm9yKGNvbnN0IGMgaW4gYil7YT1jO2JyZWFrIGF9YT12b2lkIDA7fWlmKHRoaXMuaT1hKWE9dGhpcy5pLGI9bnVsbCE9PWImJmEgaW4gYj9iW2FdOnZvaWQgMDt0aGlzLmRhdGE9Yjt9ZWxzZSB0aGlzLmRhdGE9YTt9dChJZCxWYik7ZnVuY3Rpb24gSmQoKXtXYi5jYWxsKHRoaXMpO3RoaXMuc3RhdHVzPTE7fXQoSmQsV2IpO1xuZnVuY3Rpb24gWShhKXt0aGlzLmc9YTt9dChZLEdkKTtZLnByb3RvdHlwZS54YT1mdW5jdGlvbigpe0ModGhpcy5nLFwiYVwiKTt9O1kucHJvdG90eXBlLndhPWZ1bmN0aW9uKGEpe0ModGhpcy5nLG5ldyBJZChhKSk7fTtZLnByb3RvdHlwZS52YT1mdW5jdGlvbihhKXtDKHRoaXMuZyxuZXcgSmQoKSk7fTtZLnByb3RvdHlwZS51YT1mdW5jdGlvbigpe0ModGhpcy5nLFwiYlwiKTt9Oy8qXG5cbiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG5cbiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cbiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5IZC5wcm90b3R5cGUuY3JlYXRlV2ViQ2hhbm5lbD1IZC5wcm90b3R5cGUuZztYLnByb3RvdHlwZS5zZW5kPVgucHJvdG90eXBlLnU7WC5wcm90b3R5cGUub3Blbj1YLnByb3RvdHlwZS5tO1gucHJvdG90eXBlLmNsb3NlPVgucHJvdG90eXBlLmNsb3NlO1FiLk5PX0VSUk9SPTA7UWIuVElNRU9VVD04O1FiLkhUVFBfRVJST1I9NjtSYi5DT01QTEVURT1cImNvbXBsZXRlXCI7VWIuRXZlbnRUeXBlPUs7Sy5PUEVOPVwiYVwiO0suQ0xPU0U9XCJiXCI7Sy5FUlJPUj1cImNcIjtLLk1FU1NBR0U9XCJkXCI7Qi5wcm90b3R5cGUubGlzdGVuPUIucHJvdG90eXBlLk47Vy5wcm90b3R5cGUubGlzdGVuT25jZT1XLnByb3RvdHlwZS5PO1cucHJvdG90eXBlLmdldExhc3RFcnJvcj1XLnByb3RvdHlwZS5PYTtXLnByb3RvdHlwZS5nZXRMYXN0RXJyb3JDb2RlPVcucHJvdG90eXBlLkVhO1cucHJvdG90eXBlLmdldFN0YXR1cz1XLnByb3RvdHlwZS5hYTtXLnByb3RvdHlwZS5nZXRSZXNwb25zZUpzb249Vy5wcm90b3R5cGUuU2E7XG5XLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQ9Vy5wcm90b3R5cGUuZmE7Vy5wcm90b3R5cGUuc2VuZD1XLnByb3RvdHlwZS5kYTtXLnByb3RvdHlwZS5zZXRXaXRoQ3JlZGVudGlhbHM9Vy5wcm90b3R5cGUuS2E7dmFyIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQgPSBlc20uY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydD1mdW5jdGlvbigpe3JldHVybiBuZXcgSGR9O3ZhciBnZXRTdGF0RXZlbnRUYXJnZXQgPSBlc20uZ2V0U3RhdEV2ZW50VGFyZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIE1iKCl9O3ZhciBFcnJvckNvZGUgPSBlc20uRXJyb3JDb2RlPVFiO3ZhciBFdmVudFR5cGUgPSBlc20uRXZlbnRUeXBlPVJiO3ZhciBFdmVudCA9IGVzbS5FdmVudD1HO3ZhciBTdGF0ID0gZXNtLlN0YXQ9e3NiOjAsdmI6MSx3YjoyLFBiOjMsVWI6NCxSYjo1LFNiOjYsUWI6NyxPYjo4LFRiOjksUFJPWFk6MTAsTk9QUk9YWToxMSxNYjoxMixJYjoxMyxKYjoxNCxIYjoxNSxLYjoxNixMYjoxNyxvYjoxOCxuYjoxOSxwYjoyMH07XG52YXIgRmV0Y2hYbWxIdHRwRmFjdG9yeSA9IGVzbS5GZXRjaFhtbEh0dHBGYWN0b3J5PWVkO3ZhciBXZWJDaGFubmVsID0gZXNtLldlYkNoYW5uZWw9VWI7dmFyIFhocklvID0gZXNtLlhocklvPVc7XG5cbmV4cG9ydCB7IEVycm9yQ29kZSwgRXZlbnQsIEV2ZW50VHlwZSwgRmV0Y2hYbWxIdHRwRmFjdG9yeSwgU3RhdCwgV2ViQ2hhbm5lbCwgWGhySW8sIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQsIGVzbSBhcyBkZWZhdWx0LCBnZXRTdGF0RXZlbnRUYXJnZXQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyBfcmVnaXN0ZXJDb21wb25lbnQsIHJlZ2lzdGVyVmVyc2lvbiwgX2dldFByb3ZpZGVyLCBnZXRBcHAsIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UsIFNES19WRVJTSU9OIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IExvZ2dlciwgTG9nTGV2ZWwgfSBmcm9tICdAZmlyZWJhc2UvbG9nZ2VyJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGdldE1vZHVsYXJJbnN0YW5jZSwgZGVlcEVxdWFsLCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQsIGdldFVBLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNTYWZhcmkgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBYaHJJbywgRXZlbnRUeXBlLCBFcnJvckNvZGUsIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQsIGdldFN0YXRFdmVudFRhcmdldCwgRmV0Y2hYbWxIdHRwRmFjdG9yeSwgV2ViQ2hhbm5lbCwgRXZlbnQsIFN0YXQgfSBmcm9tICdAZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyJztcblxuY29uc3QgYiA9IFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTaW1wbGUgd3JhcHBlciBhcm91bmQgYSBudWxsYWJsZSBVSUQuIE1vc3RseSBleGlzdHMgdG8gbWFrZSBjb2RlIG1vcmVcbiAqIHJlYWRhYmxlLlxuICovXG5jbGFzcyBQIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudWlkID0gdDtcbiAgICB9XG4gICAgaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPSB0aGlzLnVpZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGtleSByZXByZXNlbnRpbmcgdGhpcyB1c2VyLCBzdWl0YWJsZSBmb3IgaW5jbHVzaW9uIGluIGFcbiAgICAgKiBkaWN0aW9uYXJ5LlxuICAgICAqLyAgICB0b0tleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNBdXRoZW50aWNhdGVkKCkgPyBcInVpZDpcIiArIHRoaXMudWlkIDogXCJhbm9ueW1vdXMtdXNlclwiO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQudWlkID09PSB0aGlzLnVpZDtcbiAgICB9XG59XG5cbi8qKiBBIHVzZXIgd2l0aCBhIG51bGwgVUlELiAqLyBQLlVOQVVUSEVOVElDQVRFRCA9IG5ldyBQKG51bGwpLCBcbi8vIFRPRE8obWlrZWxlaGVuKTogTG9vayBpbnRvIGdldHRpbmcgYSBwcm9wZXIgdWlkLWVxdWl2YWxlbnQgZm9yXG4vLyBub24tRmlyZWJhc2VBdXRoIHByb3ZpZGVycy5cblAuR09PR0xFX0NSRURFTlRJQUxTID0gbmV3IFAoXCJnb29nbGUtY3JlZGVudGlhbHMtdWlkXCIpLCBQLkZJUlNUX1BBUlRZID0gbmV3IFAoXCJmaXJzdC1wYXJ0eS11aWRcIiksIFxuUC5NT0NLX1VTRVIgPSBuZXcgUChcIm1vY2stdXNlclwiKTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmxldCB2ID0gXCI5LjE0LjBcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IFYgPSBuZXcgTG9nZ2VyKFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiKTtcblxuLy8gSGVscGVyIG1ldGhvZHMgYXJlIG5lZWRlZCBiZWNhdXNlIHZhcmlhYmxlcyBjYW4ndCBiZSBleHBvcnRlZCBhcyByZWFkL3dyaXRlXG5mdW5jdGlvbiBTKCkge1xuICAgIHJldHVybiBWLmxvZ0xldmVsO1xufVxuXG4vKipcbiAqIFNldHMgdGhlIHZlcmJvc2l0eSBvZiBDbG91ZCBGaXJlc3RvcmUgbG9ncyAoZGVidWcsIGVycm9yLCBvciBzaWxlbnQpLlxuICpcbiAqIEBwYXJhbSBsb2dMZXZlbCAtIFRoZSB2ZXJib3NpdHkgeW91IHNldCBmb3IgYWN0aXZpdHkgYW5kIGVycm9yIGxvZ2dpbmcuIENhblxuICogICBiZSBhbnkgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXM6XG4gKlxuICogICA8dWw+XG4gKiAgICAgPGxpPmBkZWJ1Z2AgZm9yIHRoZSBtb3N0IHZlcmJvc2UgbG9nZ2luZyBsZXZlbCwgcHJpbWFyaWx5IGZvclxuICogICAgIGRlYnVnZ2luZy48L2xpPlxuICogICAgIDxsaT5gZXJyb3JgIHRvIGxvZyBlcnJvcnMgb25seS48L2xpPlxuICogICAgIDxsaT48Y29kZT5gc2lsZW50YCB0byB0dXJuIG9mZiBsb2dnaW5nLjwvbGk+XG4gKiAgIDwvdWw+XG4gKi8gZnVuY3Rpb24gRCh0KSB7XG4gICAgVi5zZXRMb2dMZXZlbCh0KTtcbn1cblxuZnVuY3Rpb24gQyh0LCAuLi5lKSB7XG4gICAgaWYgKFYubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuREVCVUcpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKGspO1xuICAgICAgICBWLmRlYnVnKGBGaXJlc3RvcmUgKCR7dn0pOiAke3R9YCwgLi4ubik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB4KHQsIC4uLmUpIHtcbiAgICBpZiAoVi5sb2dMZXZlbCA8PSBMb2dMZXZlbC5FUlJPUikge1xuICAgICAgICBjb25zdCBuID0gZS5tYXAoayk7XG4gICAgICAgIFYuZXJyb3IoYEZpcmVzdG9yZSAoJHt2fSk6ICR7dH1gLCAuLi5uKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gTih0LCAuLi5lKSB7XG4gICAgaWYgKFYubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuV0FSTikge1xuICAgICAgICBjb25zdCBuID0gZS5tYXAoayk7XG4gICAgICAgIFYud2FybihgRmlyZXN0b3JlICgke3Z9KTogJHt0fWAsIC4uLm4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBhZGRpdGlvbmFsIGxvZyBwYXJhbWV0ZXIgdG8gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24uXG4gKi8gZnVuY3Rpb24gayh0KSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpIHJldHVybiB0O1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBlID0gdCwgSlNPTi5zdHJpbmdpZnkoZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBDb252ZXJ0aW5nIHRvIEpTT04gZmFpbGVkLCBqdXN0IGxvZyB0aGUgb2JqZWN0IGRpcmVjdGx5XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgIC8qKiBGb3JtYXRzIGFuIG9iamVjdCBhcyBhIEpTT04gc3RyaW5nLCBzdWl0YWJsZSBmb3IgbG9nZ2luZy4gKi9cbiAgICB2YXIgZTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVW5jb25kaXRpb25hbGx5IGZhaWxzLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLlxuICogTWVzc2FnZXMgYXJlIHN0cmlwcGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICpcbiAqIFJldHVybnMgYG5ldmVyYCBhbmQgY2FuIGJlIHVzZWQgaW4gZXhwcmVzc2lvbnM6XG4gKiBAZXhhbXBsZVxuICogbGV0IGZ1dHVyZVZhciA9IGZhaWwoJ25vdCBpbXBsZW1lbnRlZCB5ZXQnKTtcbiAqLyBmdW5jdGlvbiBPKHQgPSBcIlVuZXhwZWN0ZWQgc3RhdGVcIikge1xuICAgIC8vIExvZyB0aGUgZmFpbHVyZSBpbiBhZGRpdGlvbiB0byB0aHJvdyBhbiBleGNlcHRpb24sIGp1c3QgaW4gY2FzZSB0aGVcbiAgICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxuICAgIGNvbnN0IGUgPSBgRklSRVNUT1JFICgke3Z9KSBJTlRFUk5BTCBBU1NFUlRJT04gRkFJTEVEOiBgICsgdDtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCB1c2UgRmlyZXN0b3JlRXJyb3IgaGVyZSBiZWNhdXNlIHRoZXNlIGFyZSBpbnRlcm5hbCBmYWlsdXJlc1xuICAgIC8vIHRoYXQgY2Fubm90IGJlIGhhbmRsZWQgYnkgdGhlIHVzZXIuIChBbHNvIGl0IHdvdWxkIGNyZWF0ZSBhIGNpcmN1bGFyXG4gICAgLy8gZGVwZW5kZW5jeSBiZXR3ZWVuIHRoZSBlcnJvciBhbmQgYXNzZXJ0IG1vZHVsZXMgd2hpY2ggZG9lc24ndCB3b3JrLilcbiAgICB0aHJvdyB4KGUpLCBuZXcgRXJyb3IoZSk7XG59XG5cbi8qKlxuICogRmFpbHMgaWYgdGhlIGdpdmVuIGFzc2VydGlvbiBjb25kaXRpb24gaXMgZmFsc2UsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cbiAqXG4gKiBNZXNzYWdlcyBhcmUgc3RyaXBwZWQgaW4gcHJvZHVjdGlvbiBidWlsZHMuXG4gKi8gZnVuY3Rpb24gTSh0LCBlKSB7XG4gICAgdCB8fCBPKCk7XG59XG5cbi8qKlxuICogRmFpbHMgaWYgdGhlIGdpdmVuIGFzc2VydGlvbiBjb25kaXRpb24gaXMgZmFsc2UsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cbiAqXG4gKiBUaGUgY29kZSBvZiBjYWxsc2l0ZXMgaW52b2tpbmcgdGhpcyBmdW5jdGlvbiBhcmUgc3RyaXBwZWQgb3V0IGluIHByb2R1Y3Rpb25cbiAqIGJ1aWxkcy4gQW55IHNpZGUtZWZmZWN0cyBvZiBjb2RlIHdpdGhpbiB0aGUgZGVidWdBc3NlcnQoKSBpbnZvY2F0aW9uIHdpbGwgbm90XG4gKiBoYXBwZW4gaW4gdGhpcyBjYXNlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIEYodCwgZSkge1xuICAgIHQgfHwgTygpO1xufVxuXG4vKipcbiAqIENhc3RzIGBvYmpgIHRvIGBUYC4gSW4gbm9uLXByb2R1Y3Rpb24gYnVpbGRzLCB2ZXJpZmllcyB0aGF0IGBvYmpgIGlzIGFuXG4gKiBpbnN0YW5jZSBvZiBgVGAgYmVmb3JlIGNhc3RpbmcuXG4gKi8gZnVuY3Rpb24gJCh0LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5lKSB7XG4gICAgcmV0dXJuIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IEIgPSB7XG4gICAgLy8gQ2F1c2VzIGFyZSBjb3BpZWQgZnJvbTpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ3JwYy9ncnBjL2Jsb2IvYmNlZWM5NGVhNGZjNWYwMDg1ZDgxMjM1ZDhlMWMwNjc5OGRjMzQxYS9pbmNsdWRlL2dycGMlMkIlMkIvaW1wbC9jb2RlZ2VuL3N0YXR1c19jb2RlX2VudW0uaFxuICAgIC8qKiBOb3QgYW4gZXJyb3I7IHJldHVybmVkIG9uIHN1Y2Nlc3MuICovXG4gICAgT0s6IFwib2tcIixcbiAgICAvKiogVGhlIG9wZXJhdGlvbiB3YXMgY2FuY2VsbGVkICh0eXBpY2FsbHkgYnkgdGhlIGNhbGxlcikuICovXG4gICAgQ0FOQ0VMTEVEOiBcImNhbmNlbGxlZFwiLFxuICAgIC8qKiBVbmtub3duIGVycm9yIG9yIGFuIGVycm9yIGZyb20gYSBkaWZmZXJlbnQgZXJyb3IgZG9tYWluLiAqL1xuICAgIFVOS05PV046IFwidW5rbm93blwiLFxuICAgIC8qKlxuICAgICAqIENsaWVudCBzcGVjaWZpZWQgYW4gaW52YWxpZCBhcmd1bWVudC4gTm90ZSB0aGF0IHRoaXMgZGlmZmVycyBmcm9tXG4gICAgICogRkFJTEVEX1BSRUNPTkRJVElPTi4gSU5WQUxJRF9BUkdVTUVOVCBpbmRpY2F0ZXMgYXJndW1lbnRzIHRoYXQgYXJlXG4gICAgICogcHJvYmxlbWF0aWMgcmVnYXJkbGVzcyBvZiB0aGUgc3RhdGUgb2YgdGhlIHN5c3RlbSAoZS5nLiwgYSBtYWxmb3JtZWQgZmlsZVxuICAgICAqIG5hbWUpLlxuICAgICAqL1xuICAgIElOVkFMSURfQVJHVU1FTlQ6IFwiaW52YWxpZC1hcmd1bWVudFwiLFxuICAgIC8qKlxuICAgICAqIERlYWRsaW5lIGV4cGlyZWQgYmVmb3JlIG9wZXJhdGlvbiBjb3VsZCBjb21wbGV0ZS4gRm9yIG9wZXJhdGlvbnMgdGhhdFxuICAgICAqIGNoYW5nZSB0aGUgc3RhdGUgb2YgdGhlIHN5c3RlbSwgdGhpcyBlcnJvciBtYXkgYmUgcmV0dXJuZWQgZXZlbiBpZiB0aGVcbiAgICAgKiBvcGVyYXRpb24gaGFzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuIEZvciBleGFtcGxlLCBhIHN1Y2Nlc3NmdWwgcmVzcG9uc2VcbiAgICAgKiBmcm9tIGEgc2VydmVyIGNvdWxkIGhhdmUgYmVlbiBkZWxheWVkIGxvbmcgZW5vdWdoIGZvciB0aGUgZGVhZGxpbmUgdG9cbiAgICAgKiBleHBpcmUuXG4gICAgICovXG4gICAgREVBRExJTkVfRVhDRUVERUQ6IFwiZGVhZGxpbmUtZXhjZWVkZWRcIixcbiAgICAvKiogU29tZSByZXF1ZXN0ZWQgZW50aXR5IChlLmcuLCBmaWxlIG9yIGRpcmVjdG9yeSkgd2FzIG5vdCBmb3VuZC4gKi9cbiAgICBOT1RfRk9VTkQ6IFwibm90LWZvdW5kXCIsXG4gICAgLyoqXG4gICAgICogU29tZSBlbnRpdHkgdGhhdCB3ZSBhdHRlbXB0ZWQgdG8gY3JlYXRlIChlLmcuLCBmaWxlIG9yIGRpcmVjdG9yeSkgYWxyZWFkeVxuICAgICAqIGV4aXN0cy5cbiAgICAgKi9cbiAgICBBTFJFQURZX0VYSVNUUzogXCJhbHJlYWR5LWV4aXN0c1wiLFxuICAgIC8qKlxuICAgICAqIFRoZSBjYWxsZXIgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGV4ZWN1dGUgdGhlIHNwZWNpZmllZCBvcGVyYXRpb24uXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBmb3IgcmVqZWN0aW9ucyBjYXVzZWQgYnkgZXhoYXVzdGluZ1xuICAgICAqIHNvbWUgcmVzb3VyY2UgKHVzZSBSRVNPVVJDRV9FWEhBVVNURUQgaW5zdGVhZCBmb3IgdGhvc2UgZXJyb3JzKS5cbiAgICAgKiBQRVJNSVNTSU9OX0RFTklFRCBtdXN0IG5vdCBiZSB1c2VkIGlmIHRoZSBjYWxsZXIgY2FuIG5vdCBiZSBpZGVudGlmaWVkXG4gICAgICogKHVzZSBVTkFVVEhFTlRJQ0FURUQgaW5zdGVhZCBmb3IgdGhvc2UgZXJyb3JzKS5cbiAgICAgKi9cbiAgICBQRVJNSVNTSU9OX0RFTklFRDogXCJwZXJtaXNzaW9uLWRlbmllZFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSByZXF1ZXN0IGRvZXMgbm90IGhhdmUgdmFsaWQgYXV0aGVudGljYXRpb24gY3JlZGVudGlhbHMgZm9yIHRoZVxuICAgICAqIG9wZXJhdGlvbi5cbiAgICAgKi9cbiAgICBVTkFVVEhFTlRJQ0FURUQ6IFwidW5hdXRoZW50aWNhdGVkXCIsXG4gICAgLyoqXG4gICAgICogU29tZSByZXNvdXJjZSBoYXMgYmVlbiBleGhhdXN0ZWQsIHBlcmhhcHMgYSBwZXItdXNlciBxdW90YSwgb3IgcGVyaGFwcyB0aGVcbiAgICAgKiBlbnRpcmUgZmlsZSBzeXN0ZW0gaXMgb3V0IG9mIHNwYWNlLlxuICAgICAqL1xuICAgIFJFU09VUkNFX0VYSEFVU1RFRDogXCJyZXNvdXJjZS1leGhhdXN0ZWRcIixcbiAgICAvKipcbiAgICAgKiBPcGVyYXRpb24gd2FzIHJlamVjdGVkIGJlY2F1c2UgdGhlIHN5c3RlbSBpcyBub3QgaW4gYSBzdGF0ZSByZXF1aXJlZCBmb3JcbiAgICAgKiB0aGUgb3BlcmF0aW9uJ3MgZXhlY3V0aW9uLiBGb3IgZXhhbXBsZSwgZGlyZWN0b3J5IHRvIGJlIGRlbGV0ZWQgbWF5IGJlXG4gICAgICogbm9uLWVtcHR5LCBhbiBybWRpciBvcGVyYXRpb24gaXMgYXBwbGllZCB0byBhIG5vbi1kaXJlY3RvcnksIGV0Yy5cbiAgICAgKlxuICAgICAqIEEgbGl0bXVzIHRlc3QgdGhhdCBtYXkgaGVscCBhIHNlcnZpY2UgaW1wbGVtZW50b3IgaW4gZGVjaWRpbmdcbiAgICAgKiBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsIGFuZCBVTkFWQUlMQUJMRTpcbiAgICAgKiAgKGEpIFVzZSBVTkFWQUlMQUJMRSBpZiB0aGUgY2xpZW50IGNhbiByZXRyeSBqdXN0IHRoZSBmYWlsaW5nIGNhbGwuXG4gICAgICogIChiKSBVc2UgQUJPUlRFRCBpZiB0aGUgY2xpZW50IHNob3VsZCByZXRyeSBhdCBhIGhpZ2hlci1sZXZlbFxuICAgICAqICAgICAgKGUuZy4sIHJlc3RhcnRpbmcgYSByZWFkLW1vZGlmeS13cml0ZSBzZXF1ZW5jZSkuXG4gICAgICogIChjKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHNob3VsZCBub3QgcmV0cnkgdW50aWxcbiAgICAgKiAgICAgIHRoZSBzeXN0ZW0gc3RhdGUgaGFzIGJlZW4gZXhwbGljaXRseSBmaXhlZC4gRS5nLiwgaWYgYW4gXCJybWRpclwiXG4gICAgICogICAgICBmYWlscyBiZWNhdXNlIHRoZSBkaXJlY3RvcnkgaXMgbm9uLWVtcHR5LCBGQUlMRURfUFJFQ09ORElUSU9OXG4gICAgICogICAgICBzaG91bGQgYmUgcmV0dXJuZWQgc2luY2UgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVubGVzc1xuICAgICAqICAgICAgdGhleSBoYXZlIGZpcnN0IGZpeGVkIHVwIHRoZSBkaXJlY3RvcnkgYnkgZGVsZXRpbmcgZmlsZXMgZnJvbSBpdC5cbiAgICAgKiAgKGQpIFVzZSBGQUlMRURfUFJFQ09ORElUSU9OIGlmIHRoZSBjbGllbnQgcGVyZm9ybXMgY29uZGl0aW9uYWxcbiAgICAgKiAgICAgIFJFU1QgR2V0L1VwZGF0ZS9EZWxldGUgb24gYSByZXNvdXJjZSBhbmQgdGhlIHJlc291cmNlIG9uIHRoZVxuICAgICAqICAgICAgc2VydmVyIGRvZXMgbm90IG1hdGNoIHRoZSBjb25kaXRpb24uIEUuZy4sIGNvbmZsaWN0aW5nXG4gICAgICogICAgICByZWFkLW1vZGlmeS13cml0ZSBvbiB0aGUgc2FtZSByZXNvdXJjZS5cbiAgICAgKi9cbiAgICBGQUlMRURfUFJFQ09ORElUSU9OOiBcImZhaWxlZC1wcmVjb25kaXRpb25cIixcbiAgICAvKipcbiAgICAgKiBUaGUgb3BlcmF0aW9uIHdhcyBhYm9ydGVkLCB0eXBpY2FsbHkgZHVlIHRvIGEgY29uY3VycmVuY3kgaXNzdWUgbGlrZVxuICAgICAqIHNlcXVlbmNlciBjaGVjayBmYWlsdXJlcywgdHJhbnNhY3Rpb24gYWJvcnRzLCBldGMuXG4gICAgICpcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXG4gICAgICovXG4gICAgQUJPUlRFRDogXCJhYm9ydGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyBhdHRlbXB0ZWQgcGFzdCB0aGUgdmFsaWQgcmFuZ2UuIEUuZy4sIHNlZWtpbmcgb3IgcmVhZGluZ1xuICAgICAqIHBhc3QgZW5kIG9mIGZpbGUuXG4gICAgICpcbiAgICAgKiBVbmxpa2UgSU5WQUxJRF9BUkdVTUVOVCwgdGhpcyBlcnJvciBpbmRpY2F0ZXMgYSBwcm9ibGVtIHRoYXQgbWF5IGJlIGZpeGVkXG4gICAgICogaWYgdGhlIHN5c3RlbSBzdGF0ZSBjaGFuZ2VzLiBGb3IgZXhhbXBsZSwgYSAzMi1iaXQgZmlsZSBzeXN0ZW0gd2lsbFxuICAgICAqIGdlbmVyYXRlIElOVkFMSURfQVJHVU1FTlQgaWYgYXNrZWQgdG8gcmVhZCBhdCBhbiBvZmZzZXQgdGhhdCBpcyBub3QgaW4gdGhlXG4gICAgICogcmFuZ2UgWzAsMl4zMi0xXSwgYnV0IGl0IHdpbGwgZ2VuZXJhdGUgT1VUX09GX1JBTkdFIGlmIGFza2VkIHRvIHJlYWQgZnJvbVxuICAgICAqIGFuIG9mZnNldCBwYXN0IHRoZSBjdXJyZW50IGZpbGUgc2l6ZS5cbiAgICAgKlxuICAgICAqIFRoZXJlIGlzIGEgZmFpciBiaXQgb2Ygb3ZlcmxhcCBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXG4gICAgICogT1VUX09GX1JBTkdFLiBXZSByZWNvbW1lbmQgdXNpbmcgT1VUX09GX1JBTkdFICh0aGUgbW9yZSBzcGVjaWZpYyBlcnJvcilcbiAgICAgKiB3aGVuIGl0IGFwcGxpZXMgc28gdGhhdCBjYWxsZXJzIHdobyBhcmUgaXRlcmF0aW5nIHRocm91Z2ggYSBzcGFjZSBjYW5cbiAgICAgKiBlYXNpbHkgbG9vayBmb3IgYW4gT1VUX09GX1JBTkdFIGVycm9yIHRvIGRldGVjdCB3aGVuIHRoZXkgYXJlIGRvbmUuXG4gICAgICovXG4gICAgT1VUX09GX1JBTkdFOiBcIm91dC1vZi1yYW5nZVwiLFxuICAgIC8qKiBPcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkIG9yIG5vdCBzdXBwb3J0ZWQvZW5hYmxlZCBpbiB0aGlzIHNlcnZpY2UuICovXG4gICAgVU5JTVBMRU1FTlRFRDogXCJ1bmltcGxlbWVudGVkXCIsXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgZXJyb3JzLiBNZWFucyBzb21lIGludmFyaWFudHMgZXhwZWN0ZWQgYnkgdW5kZXJseWluZyBTeXN0ZW0gaGFzXG4gICAgICogYmVlbiBicm9rZW4uIElmIHlvdSBzZWUgb25lIG9mIHRoZXNlIGVycm9ycywgU29tZXRoaW5nIGlzIHZlcnkgYnJva2VuLlxuICAgICAqL1xuICAgIElOVEVSTkFMOiBcImludGVybmFsXCIsXG4gICAgLyoqXG4gICAgICogVGhlIHNlcnZpY2UgaXMgY3VycmVudGx5IHVuYXZhaWxhYmxlLiBUaGlzIGlzIGEgbW9zdCBsaWtlbHkgYSB0cmFuc2llbnRcbiAgICAgKiBjb25kaXRpb24gYW5kIG1heSBiZSBjb3JyZWN0ZWQgYnkgcmV0cnlpbmcgd2l0aCBhIGJhY2tvZmYuXG4gICAgICpcbiAgICAgKiBTZWUgbGl0bXVzIHRlc3QgYWJvdmUgZm9yIGRlY2lkaW5nIGJldHdlZW4gRkFJTEVEX1BSRUNPTkRJVElPTiwgQUJPUlRFRCxcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXG4gICAgICovXG4gICAgVU5BVkFJTEFCTEU6IFwidW5hdmFpbGFibGVcIixcbiAgICAvKiogVW5yZWNvdmVyYWJsZSBkYXRhIGxvc3Mgb3IgY29ycnVwdGlvbi4gKi9cbiAgICBEQVRBX0xPU1M6IFwiZGF0YS1sb3NzXCJcbn07XG5cbi8qKiBBbiBlcnJvciByZXR1cm5lZCBieSBhIEZpcmVzdG9yZSBvcGVyYXRpb24uICovIGNsYXNzIEwgZXh0ZW5kcyBGaXJlYmFzZUVycm9yIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBiYWNrZW5kIGVycm9yIGNvZGUgYXNzb2NpYXRlZCB3aXRoIHRoaXMgZXJyb3IuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogQSBjdXN0b20gZXJyb3IgZGVzY3JpcHRpb24uXG4gICAgICovXG4gICAgZSkge1xuICAgICAgICBzdXBlcih0LCBlKSwgdGhpcy5jb2RlID0gdCwgdGhpcy5tZXNzYWdlID0gZSwgXG4gICAgICAgIC8vIEhBQ0s6IFdlIHdyaXRlIGEgdG9TdHJpbmcgcHJvcGVydHkgZGlyZWN0bHkgYmVjYXVzZSBFcnJvciBpcyBub3QgYSByZWFsXG4gICAgICAgIC8vIGNsYXNzIGFuZCBzbyBpbmhlcml0YW5jZSBkb2VzIG5vdCB3b3JrIGNvcnJlY3RseS4gV2UgY291bGQgYWx0ZXJuYXRpdmVseVxuICAgICAgICAvLyBkbyB0aGUgc2FtZSBcImJhY2stZG9vciBpbmhlcml0YW5jZVwiIHRyaWNrIHRoYXQgRmlyZWJhc2VFcnJvciBkb2VzLlxuICAgICAgICB0aGlzLnRvU3RyaW5nID0gKCkgPT4gYCR7dGhpcy5uYW1lfTogW2NvZGU9JHt0aGlzLmNvZGV9XTogJHt0aGlzLm1lc3NhZ2V9YDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZSA9IHQsIHRoaXMucmVqZWN0ID0gZTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgcSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnVzZXIgPSBlLCB0aGlzLnR5cGUgPSBcIk9BdXRoXCIsIHRoaXMuaGVhZGVycyA9IG5ldyBNYXAsIHRoaXMuaGVhZGVycy5zZXQoXCJBdXRob3JpemF0aW9uXCIsIGBCZWFyZXIgJHt0fWApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIENyZWRlbnRpYWxzUHJvdmlkZXIgdGhhdCBhbHdheXMgeWllbGRzIGFuIGVtcHR5IHRva2VuLlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgSyB7XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1c2VyLlxuICAgICAgICB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IGUoUC5VTkFVVEhFTlRJQ0FURUQpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBBIENyZWRlbnRpYWxzUHJvdmlkZXIgdGhhdCBhbHdheXMgcmV0dXJucyBhIGNvbnN0YW50IHRva2VuLiBVc2VkIGZvclxuICogZW11bGF0b3IgdG9rZW4gbW9ja2luZy5cbiAqLyBjbGFzcyBHIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudG9rZW4gPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0b3JlcyB0aGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKClcbiAgICAgICAgICogVGhpcyBpc24ndCBhY3R1YWxseSBuZWNlc3Nhcnkgc2luY2UgdGhlIFVJRCBuZXZlciBjaGFuZ2VzLCBidXQgd2UgdXNlIHRoaXNcbiAgICAgICAgICogdG8gdmVyaWZ5IHRoZSBsaXN0ZW4gY29udHJhY3QgaXMgYWRoZXJlZCB0byBpbiB0ZXN0cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnRva2VuKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBlLCBcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKHRoaXMudG9rZW4udXNlcikpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgUSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnQgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyB0aGUgY3VycmVudCBVc2VyLiAqL1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gUC5VTkFVVEhFTlRJQ0FURUQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ291bnRlciB1c2VkIHRvIGRldGVjdCBpZiB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSBhIGdldFRva2VuIHJlcXVlc3Qgd2FzXG4gICAgICAgICAqIG91dHN0YW5kaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pID0gMCwgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hdXRoID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICBsZXQgbiA9IHRoaXMuaTtcbiAgICAgICAgLy8gQSBjaGFuZ2UgbGlzdGVuZXIgdGhhdCBwcmV2ZW50cyBkb3VibGUtZmlyaW5nIGZvciB0aGUgc2FtZSB0b2tlbiBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHQgPT4gdGhpcy5pICE9PSBuID8gKG4gPSB0aGlzLmksIGUodCkpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIC8vIEEgcHJvbWlzZSB0aGF0IGNhbiBiZSB3YWl0ZWQgb24gdG8gYmxvY2sgb24gdGhlIG5leHQgdG9rZW4gY2hhbmdlLlxuICAgICAgICAvLyBUaGlzIHByb21pc2UgaXMgcmUtY3JlYXRlZCBhZnRlciBlYWNoIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBsZXQgaSA9IG5ldyBVO1xuICAgICAgICB0aGlzLm8gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmkrKywgdGhpcy5jdXJyZW50VXNlciA9IHRoaXMudSgpLCBpLnJlc29sdmUoKSwgaSA9IG5ldyBVLCB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IHModGhpcy5jdXJyZW50VXNlcikpKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgciA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBpO1xuICAgICAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgZS5wcm9taXNlLCBhd2FpdCBzKHRoaXMuY3VycmVudFVzZXIpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9LCBvID0gdCA9PiB7XG4gICAgICAgICAgICBDKFwiRmlyZWJhc2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggZGV0ZWN0ZWRcIiksIHRoaXMuYXV0aCA9IHQsIHRoaXMuYXV0aC5hZGRBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pLCBcbiAgICAgICAgICAgIHIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50Lm9uSW5pdCgodCA9PiBvKHQpKSksIFxuICAgICAgICAvLyBPdXIgdXNlcnMgY2FuIGluaXRpYWxpemUgQXV0aCByaWdodCBhZnRlciBGaXJlc3RvcmUsIHNvIHdlIGdpdmUgaXRcbiAgICAgICAgLy8gYSBjaGFuY2UgdG8gcmVnaXN0ZXIgaXRzZWxmIHdpdGggdGhlIGNvbXBvbmVudCBmcmFtZXdvcmsgYmVmb3JlIHdlXG4gICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHRvIHN0YXJ0IHVwIGluIHVuYXV0aGVudGljYXRlZCBtb2RlLlxuICAgICAgICBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYXV0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnQuZ2V0SW1tZWRpYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6ICEwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdCA/IG8odCkgOiAoXG4gICAgICAgICAgICAgICAgLy8gSWYgYXV0aCBpcyBzdGlsbCBub3QgYXZhaWxhYmxlLCBwcm9jZWVkIHdpdGggYG51bGxgIHVzZXJcbiAgICAgICAgICAgICAgICBDKFwiRmlyZWJhc2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggbm90IHlldCBkZXRlY3RlZFwiKSwgaS5yZXNvbHZlKCksIGkgPSBuZXcgVSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCAwKSwgcigpO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgLy8gVGFrZSBub3RlIG9mIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSB0b2tlbkNvdW50ZXIgc28gdGhhdCB0aGlzIG1ldGhvZFxuICAgICAgICAvLyBjYW4gZmFpbCAod2l0aCBhbiBBQk9SVEVEIGVycm9yKSBpZiB0aGVyZSBpcyBhIHRva2VuIGNoYW5nZSB3aGlsZSB0aGVcbiAgICAgICAgLy8gcmVxdWVzdCBpcyBvdXRzdGFuZGluZy5cbiAgICAgICAgY29uc3QgdCA9IHRoaXMuaSwgZSA9IHRoaXMuZm9yY2VSZWZyZXNoO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hdXRoID8gdGhpcy5hdXRoLmdldFRva2VuKGUpLnRoZW4oKGUgPT4gXG4gICAgICAgIC8vIENhbmNlbCB0aGUgcmVxdWVzdCBzaW5jZSB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSB0aGUgcmVxdWVzdCB3YXNcbiAgICAgICAgLy8gb3V0c3RhbmRpbmcgc28gdGhlIHJlc3BvbnNlIGlzIHBvdGVudGlhbGx5IGZvciBhIHByZXZpb3VzIHVzZXIgKHdoaWNoXG4gICAgICAgIC8vIHVzZXIsIHdlIGNhbid0IGJlIHN1cmUpLlxuICAgICAgICB0aGlzLmkgIT09IHQgPyAoQyhcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJnZXRUb2tlbiBhYm9ydGVkIGR1ZSB0byB0b2tlbiBjaGFuZ2UuXCIpLCBcbiAgICAgICAgdGhpcy5nZXRUb2tlbigpKSA6IGUgPyAoTShcInN0cmluZ1wiID09IHR5cGVvZiBlLmFjY2Vzc1Rva2VuKSwgbmV3IHEoZS5hY2Nlc3NUb2tlbiwgdGhpcy5jdXJyZW50VXNlcikpIDogbnVsbCkpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7XG4gICAgICAgIHRoaXMuZm9yY2VSZWZyZXNoID0gITA7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLmF1dGggJiYgdGhpcy5hdXRoLnJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyKHRoaXMubyk7XG4gICAgfVxuICAgIC8vIEF1dGguZ2V0VWlkKCkgY2FuIHJldHVybiBudWxsIGV2ZW4gd2l0aCBhIHVzZXIgbG9nZ2VkIGluLiBJdCBpcyBiZWNhdXNlXG4gICAgLy8gZ2V0VWlkKCkgaXMgc3luY2hyb25vdXMsIGJ1dCB0aGUgYXV0aCBjb2RlIHBvcHVsYXRpbmcgVWlkIGlzIGFzeW5jaHJvbm91cy5cbiAgICAvLyBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBjYWxsZWQgaW4gdGhlIEF1dGhUb2tlbkxpc3RlbmVyIGNhbGxiYWNrXG4gICAgLy8gdG8gZ3VhcmFudGVlIHRvIGdldCB0aGUgYWN0dWFsIHVzZXIuXG4gICAgdSgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuYXV0aCAmJiB0aGlzLmF1dGguZ2V0VWlkKCk7XG4gICAgICAgIHJldHVybiBNKG51bGwgPT09IHQgfHwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCksIG5ldyBQKHQpO1xuICAgIH1cbn1cblxuLypcbiAqIEZpcnN0UGFydHlUb2tlbiBwcm92aWRlcyBhIGZyZXNoIHRva2VuIGVhY2ggdGltZSBpdHMgdmFsdWVcbiAqIGlzIHJlcXVlc3RlZCwgYmVjYXVzZSBpZiB0aGUgdG9rZW4gaXMgdG9vIG9sZCwgcmVxdWVzdHMgd2lsbCBiZSByZWplY3RlZC5cbiAqIFRlY2huaWNhbGx5IHRoaXMgbWF5IG5vIGxvbmdlciBiZSBuZWNlc3Nhcnkgc2luY2UgdGhlIFNESyBzaG91bGQgZ3JhY2VmdWxseVxuICogcmVjb3ZlciBmcm9tIHVuYXV0aGVudGljYXRlZCBlcnJvcnMgKHNlZSBiLzMzMTQ3ODE4IGZvciBjb250ZXh0KSwgYnV0IGl0J3NcbiAqIHNhZmVyIHRvIGtlZXAgdGhlIGltcGxlbWVudGF0aW9uIGFzLWlzLlxuICovIGNsYXNzIGoge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5oID0gdCwgdGhpcy5sID0gZSwgdGhpcy5tID0gbiwgdGhpcy5nID0gcywgdGhpcy50eXBlID0gXCJGaXJzdFBhcnR5XCIsIHRoaXMudXNlciA9IFAuRklSU1RfUEFSVFksIFxuICAgICAgICB0aGlzLnAgPSBuZXcgTWFwO1xuICAgIH1cbiAgICAvKiogR2V0cyBhbiBhdXRob3JpemF0aW9uIHRva2VuLCB1c2luZyBhIHByb3ZpZGVkIGZhY3RvcnkgZnVuY3Rpb24sIG9yIGZhbGxpbmcgYmFjayB0byBGaXJzdCBQYXJ0eSBHQVBJLiAqLyAgICBJKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nID8gdGhpcy5nKCkgOiAoXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIHJlYWxseSBpcyBhIEdhcGkgY2xpZW50LlxuICAgICAgICBNKCEoXCJvYmplY3RcIiAhPSB0eXBlb2YgdGhpcy5oIHx8IG51bGwgPT09IHRoaXMuaCB8fCAhdGhpcy5oLmF1dGggfHwgIXRoaXMuaC5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkpKSwgXG4gICAgICAgIHRoaXMuaC5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkoW10pKTtcbiAgICB9XG4gICAgZ2V0IGhlYWRlcnMoKSB7XG4gICAgICAgIHRoaXMucC5zZXQoXCJYLUdvb2ctQXV0aFVzZXJcIiwgdGhpcy5sKTtcbiAgICAgICAgLy8gVXNlIGFycmF5IG5vdGF0aW9uIHRvIHByZXZlbnQgbWluaWZpY2F0aW9uXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLkkoKTtcbiAgICAgICAgcmV0dXJuIHQgJiYgdGhpcy5wLnNldChcIkF1dGhvcml6YXRpb25cIiwgdCksIHRoaXMubSAmJiB0aGlzLnAuc2V0KFwiWC1Hb29nLUlhbS1BdXRob3JpemF0aW9uLVRva2VuXCIsIHRoaXMubSksIFxuICAgICAgICB0aGlzLnA7XG4gICAgfVxufVxuXG4vKlxuICogUHJvdmlkZXMgdXNlciBjcmVkZW50aWFscyByZXF1aXJlZCBmb3IgdGhlIEZpcmVzdG9yZSBKYXZhU2NyaXB0IFNES1xuICogdG8gYXV0aGVudGljYXRlIHRoZSB1c2VyLCB1c2luZyB0ZWNobmlxdWUgdGhhdCBpcyBvbmx5IGF2YWlsYWJsZVxuICogdG8gYXBwbGljYXRpb25zIGhvc3RlZCBieSBHb29nbGUuXG4gKi8gY2xhc3MgVyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLmggPSB0LCB0aGlzLmwgPSBlLCB0aGlzLm0gPSBuLCB0aGlzLmcgPSBzO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgaih0aGlzLmgsIHRoaXMubCwgdGhpcy5tLCB0aGlzLmcpKTtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1aWQuXG4gICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gZShQLkZJUlNUX1BBUlRZKSkpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbn1cblxuY2xhc3MgeiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdCwgdGhpcy50eXBlID0gXCJBcHBDaGVja1wiLCB0aGlzLmhlYWRlcnMgPSBuZXcgTWFwLCB0ICYmIHQubGVuZ3RoID4gMCAmJiB0aGlzLmhlYWRlcnMuc2V0KFwieC1maXJlYmFzZS1hcHBjaGVja1wiLCB0aGlzLnZhbHVlKTtcbiAgICB9XG59XG5cbmNsYXNzIEgge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5UID0gdCwgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hcHBDaGVjayA9IG51bGwsIHRoaXMuQSA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHQgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPSB0LmVycm9yICYmIEMoXCJGaXJlYmFzZUFwcENoZWNrVG9rZW5Qcm92aWRlclwiLCBgRXJyb3IgZ2V0dGluZyBBcHAgQ2hlY2sgdG9rZW47IHVzaW5nIHBsYWNlaG9sZGVyIHRva2VuIGluc3RlYWQuIEVycm9yOiAke3QuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRva2VuICE9PSB0aGlzLkE7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5BID0gdC50b2tlbiwgQyhcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIGBSZWNlaXZlZCAke24gPyBcIm5ld1wiIDogXCJleGlzdGluZ1wifSB0b2tlbi5gKSwgXG4gICAgICAgICAgICBuID8gZSh0LnRva2VuKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm8gPSBlID0+IHtcbiAgICAgICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gbihlKSkpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzID0gdCA9PiB7XG4gICAgICAgICAgICBDKFwiRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXJcIiwgXCJBcHBDaGVjayBkZXRlY3RlZFwiKSwgdGhpcy5hcHBDaGVjayA9IHQsIHRoaXMuYXBwQ2hlY2suYWRkVG9rZW5MaXN0ZW5lcih0aGlzLm8pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLlQub25Jbml0KCh0ID0+IHModCkpKSwgXG4gICAgICAgIC8vIE91ciB1c2VycyBjYW4gaW5pdGlhbGl6ZSBBcHBDaGVjayBhZnRlciBGaXJlc3RvcmUsIHNvIHdlIGdpdmUgaXRcbiAgICAgICAgLy8gYSBjaGFuY2UgdG8gcmVnaXN0ZXIgaXRzZWxmIHdpdGggdGhlIGNvbXBvbmVudCBmcmFtZXdvcmsuXG4gICAgICAgIHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5hcHBDaGVjaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLlQuZ2V0SW1tZWRpYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWw6ICEwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdCA/IHModCkgOiBcbiAgICAgICAgICAgICAgICAvLyBJZiBBcHBDaGVjayBpcyBzdGlsbCBub3QgYXZhaWxhYmxlLCBwcm9jZWVkIHdpdGhvdXQgaXQuXG4gICAgICAgICAgICAgICAgQyhcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIFwiQXBwQ2hlY2sgbm90IHlldCBkZXRlY3RlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIDApO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZm9yY2VSZWZyZXNoO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hcHBDaGVjayA/IHRoaXMuYXBwQ2hlY2suZ2V0VG9rZW4odCkudGhlbigodCA9PiB0ID8gKE0oXCJzdHJpbmdcIiA9PSB0eXBlb2YgdC50b2tlbiksIFxuICAgICAgICB0aGlzLkEgPSB0LnRva2VuLCBuZXcgeih0LnRva2VuKSkgOiBudWxsKSkgOiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHtcbiAgICAgICAgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMDtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuYXBwQ2hlY2sgJiYgdGhpcy5hcHBDaGVjay5yZW1vdmVUb2tlbkxpc3RlbmVyKHRoaXMubyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFuIEFwcENoZWNrIHRva2VuIHByb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIEoge1xuICAgIGdldFRva2VuKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyB6KFwiXCIpKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydCh0LCBlKSB7fVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBCdWlsZHMgYSBDcmVkZW50aWFsc1Byb3ZpZGVyIGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZlxuICogdGhlIGNyZWRlbnRpYWxzIHBhc3NlZCBpbi5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogR2VuZXJhdGVzIGBuQnl0ZXNgIG9mIHJhbmRvbSBieXRlcy5cbiAqXG4gKiBJZiBgbkJ5dGVzIDwgMGAgLCBhbiBlcnJvciB3aWxsIGJlIHRocm93bi5cbiAqL1xuZnVuY3Rpb24gWSh0KSB7XG4gICAgLy8gUG9seWZpbGxzIGZvciBJRSBhbmQgV2ViV29ya2VyIGJ5IHVzaW5nIGBzZWxmYCBhbmQgYG1zQ3J5cHRvYCB3aGVuIGBjcnlwdG9gIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgY29uc3QgZSA9IFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygc2VsZiAmJiAoc2VsZi5jcnlwdG8gfHwgc2VsZi5tc0NyeXB0byksIG4gPSBuZXcgVWludDhBcnJheSh0KTtcbiAgICBpZiAoZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUuZ2V0UmFuZG9tVmFsdWVzKSBlLmdldFJhbmRvbVZhbHVlcyhuKTsgZWxzZSBcbiAgICAvLyBGYWxscyBiYWNrIHRvIE1hdGgucmFuZG9tXG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0OyBlKyspIG5bZV0gPSBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpO1xuICAgIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBYIHtcbiAgICBzdGF0aWMgUigpIHtcbiAgICAgICAgLy8gQWxwaGFudW1lcmljIGNoYXJhY3RlcnNcbiAgICAgICAgY29uc3QgdCA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIiwgZSA9IE1hdGguZmxvb3IoMjU2IC8gdC5sZW5ndGgpICogdC5sZW5ndGg7XG4gICAgICAgIC8vIFRoZSBsYXJnZXN0IGJ5dGUgdmFsdWUgdGhhdCBpcyBhIG11bHRpcGxlIG9mIGBjaGFyLmxlbmd0aGAuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBcIlwiO1xuICAgICAgICBmb3IgKDtuLmxlbmd0aCA8IDIwOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBZKDQwKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcy5sZW5ndGg7ICsraSkgXG4gICAgICAgICAgICAvLyBPbmx5IGFjY2VwdCB2YWx1ZXMgdGhhdCBhcmUgWzAsIG1heE11bHRpcGxlKSwgdGhpcyBlbnN1cmVzIHRoZXkgY2FuXG4gICAgICAgICAgICAvLyBiZSBldmVubHkgbWFwcGVkIHRvIGluZGljZXMgb2YgYGNoYXJzYCB2aWEgYSBtb2R1bG8gb3BlcmF0aW9uLlxuICAgICAgICAgICAgbi5sZW5ndGggPCAyMCAmJiBzW2ldIDwgZSAmJiAobiArPSB0LmNoYXJBdChzW2ldICUgdC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFoodCwgZSkge1xuICAgIHJldHVybiB0IDwgZSA/IC0xIDogdCA+IGUgPyAxIDogMDtcbn1cblxuLyoqIEhlbHBlciB0byBjb21wYXJlIGFycmF5cyB1c2luZyBpc0VxdWFsKCkuICovIGZ1bmN0aW9uIHR0KHQsIGUsIG4pIHtcbiAgICByZXR1cm4gdC5sZW5ndGggPT09IGUubGVuZ3RoICYmIHQuZXZlcnkoKCh0LCBzKSA9PiBuKHQsIGVbc10pKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW1tZWRpYXRlIGxleGljb2dyYXBoaWNhbGx5LWZvbGxvd2luZyBzdHJpbmcuIFRoaXMgaXMgdXNlZnVsIHRvXG4gKiBjb25zdHJ1Y3QgYW4gaW5jbHVzaXZlIHJhbmdlIGZvciBpbmRleGVkZGIgaXRlcmF0b3JzLlxuICovIGZ1bmN0aW9uIGV0KHQpIHtcbiAgICAvLyBSZXR1cm4gdGhlIGlucHV0IHN0cmluZywgd2l0aCBhbiBhZGRpdGlvbmFsIE5VTCBieXRlIGFwcGVuZGVkLlxuICAgIHJldHVybiB0ICsgXCJcXDBcIjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRoZSBlYXJsaWVzdCBkYXRlIHN1cHBvcnRlZCBieSBGaXJlc3RvcmUgdGltZXN0YW1wcyAoMDAwMS0wMS0wMVQwMDowMDowMFopLlxuLyoqXG4gKiBBIGBUaW1lc3RhbXBgIHJlcHJlc2VudHMgYSBwb2ludCBpbiB0aW1lIGluZGVwZW5kZW50IG9mIGFueSB0aW1lIHpvbmUgb3JcbiAqIGNhbGVuZGFyLCByZXByZXNlbnRlZCBhcyBzZWNvbmRzIGFuZCBmcmFjdGlvbnMgb2Ygc2Vjb25kcyBhdCBuYW5vc2Vjb25kXG4gKiByZXNvbHV0aW9uIGluIFVUQyBFcG9jaCB0aW1lLlxuICpcbiAqIEl0IGlzIGVuY29kZWQgdXNpbmcgdGhlIFByb2xlcHRpYyBHcmVnb3JpYW4gQ2FsZW5kYXIgd2hpY2ggZXh0ZW5kcyB0aGVcbiAqIEdyZWdvcmlhbiBjYWxlbmRhciBiYWNrd2FyZHMgdG8geWVhciBvbmUuIEl0IGlzIGVuY29kZWQgYXNzdW1pbmcgYWxsIG1pbnV0ZXNcbiAqIGFyZSA2MCBzZWNvbmRzIGxvbmcsIGkuZS4gbGVhcCBzZWNvbmRzIGFyZSBcInNtZWFyZWRcIiBzbyB0aGF0IG5vIGxlYXAgc2Vjb25kXG4gKiB0YWJsZSBpcyBuZWVkZWQgZm9yIGludGVycHJldGF0aW9uLiBSYW5nZSBpcyBmcm9tIDAwMDEtMDEtMDFUMDA6MDA6MDBaIHRvXG4gKiA5OTk5LTEyLTMxVDIzOjU5OjU5Ljk5OTk5OTk5OVouXG4gKlxuICogRm9yIGV4YW1wbGVzIGFuZCBmdXJ0aGVyIHNwZWNpZmljYXRpb25zLCByZWZlciB0byB0aGVcbiAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL3Byb3RvYnVmL2Jsb2IvbWFzdGVyL3NyYy9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvIHwgVGltZXN0YW1wIGRlZmluaXRpb259LlxuICovXG5jbGFzcyBudCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2Vjb25kcyAtIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyBvZiBVVEMgdGltZSBzaW5jZSBVbml4IGVwb2NoXG4gICAgICogICAgIDE5NzAtMDEtMDFUMDA6MDA6MDBaLiBNdXN0IGJlIGZyb20gMDAwMS0wMS0wMVQwMDowMDowMFogdG9cbiAgICAgKiAgICAgOTk5OS0xMi0zMVQyMzo1OTo1OVogaW5jbHVzaXZlLlxuICAgICAqIEBwYXJhbSBuYW5vc2Vjb25kcyAtIFRoZSBub24tbmVnYXRpdmUgZnJhY3Rpb25zIG9mIGEgc2Vjb25kIGF0IG5hbm9zZWNvbmRcbiAgICAgKiAgICAgcmVzb2x1dGlvbi4gTmVnYXRpdmUgc2Vjb25kIHZhbHVlcyB3aXRoIGZyYWN0aW9ucyBtdXN0IHN0aWxsIGhhdmVcbiAgICAgKiAgICAgbm9uLW5lZ2F0aXZlIG5hbm9zZWNvbmRzIHZhbHVlcyB0aGF0IGNvdW50IGZvcndhcmQgaW4gdGltZS4gTXVzdCBiZVxuICAgICAqICAgICBmcm9tIDAgdG8gOTk5LDk5OSw5OTkgaW5jbHVzaXZlLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyBvZiBVVEMgdGltZSBzaW5jZSBVbml4IGVwb2NoIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZCByZXNvbHV0aW9uLipcbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIGlmICh0aGlzLnNlY29uZHMgPSB0LCB0aGlzLm5hbm9zZWNvbmRzID0gZSwgZSA8IDApIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJUaW1lc3RhbXAgbmFub3NlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIGUpO1xuICAgICAgICBpZiAoZSA+PSAxZTkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJUaW1lc3RhbXAgbmFub3NlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIGUpO1xuICAgICAgICBpZiAodCA8IC02MjEzNTU5NjgwMCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyB0KTtcbiAgICAgICAgLy8gVGhpcyB3aWxsIGJyZWFrIGluIHRoZSB5ZWFyIDEwLDAwMC5cbiAgICAgICAgICAgICAgICBpZiAodCA+PSAyNTM0MDIzMDA4MDApIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJUaW1lc3RhbXAgc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIHdpdGggdGhlIGN1cnJlbnQgZGF0ZSwgd2l0aCBtaWxsaXNlY29uZCBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBhIG5ldyB0aW1lc3RhbXAgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IGRhdGUuXG4gICAgICovICAgIHN0YXRpYyBub3coKSB7XG4gICAgICAgIHJldHVybiBudC5mcm9tTWlsbGlzKERhdGUubm93KCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcCBmcm9tIHRoZSBnaXZlbiBkYXRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGUgLSBUaGUgZGF0ZSB0byBpbml0aWFsaXplIHRoZSBgVGltZXN0YW1wYCBmcm9tLlxuICAgICAqIEByZXR1cm5zIEEgbmV3IGBUaW1lc3RhbXBgIHJlcHJlc2VudGluZyB0aGUgc2FtZSBwb2ludCBpbiB0aW1lIGFzIHRoZSBnaXZlblxuICAgICAqICAgICBkYXRlLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbURhdGUodCkge1xuICAgICAgICByZXR1cm4gbnQuZnJvbU1pbGxpcyh0LmdldFRpbWUoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbWlsbGlzZWNvbmRzIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSBVbml4IGVwb2NoXG4gICAgICogICAgIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqIEByZXR1cm5zIEEgbmV3IGBUaW1lc3RhbXBgIHJlcHJlc2VudGluZyB0aGUgc2FtZSBwb2ludCBpbiB0aW1lIGFzIHRoZSBnaXZlblxuICAgICAqICAgICBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbU1pbGxpcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBNYXRoLmZsb29yKHQgLyAxZTMpLCBuID0gTWF0aC5mbG9vcigxZTYgKiAodCAtIDFlMyAqIGUpKTtcbiAgICAgICAgcmV0dXJuIG5ldyBudChlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBgVGltZXN0YW1wYCB0byBhIEphdmFTY3JpcHQgYERhdGVgIG9iamVjdC4gVGhpcyBjb252ZXJzaW9uXG4gICAgICogY2F1c2VzIGEgbG9zcyBvZiBwcmVjaXNpb24gc2luY2UgYERhdGVgIG9iamVjdHMgb25seSBzdXBwb3J0IG1pbGxpc2Vjb25kXG4gICAgICogcHJlY2lzaW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMgSmF2YVNjcmlwdCBgRGF0ZWAgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc2FtZSBwb2ludCBpbiB0aW1lIGFzXG4gICAgICogICAgIHRoaXMgYFRpbWVzdGFtcGAsIHdpdGggbWlsbGlzZWNvbmQgcHJlY2lzaW9uLlxuICAgICAqLyAgICB0b0RhdGUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLnRvTWlsbGlzKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGBUaW1lc3RhbXBgIHRvIGEgbnVtZXJpYyB0aW1lc3RhbXAgKGluIG1pbGxpc2Vjb25kcyBzaW5jZVxuICAgICAqIGVwb2NoKS4gVGhpcyBvcGVyYXRpb24gY2F1c2VzIGEgbG9zcyBvZiBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgcG9pbnQgaW4gdGltZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgdGltZXN0YW1wLCByZXByZXNlbnRlZCBhc1xuICAgICAqICAgICB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSBVbml4IGVwb2NoIDE5NzAtMDEtMDFUMDA6MDA6MDBaLlxuICAgICAqLyAgICB0b01pbGxpcygpIHtcbiAgICAgICAgcmV0dXJuIDFlMyAqIHRoaXMuc2Vjb25kcyArIHRoaXMubmFub3NlY29uZHMgLyAxZTY7XG4gICAgfVxuICAgIF9jb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWNvbmRzID09PSB0LnNlY29uZHMgPyBaKHRoaXMubmFub3NlY29uZHMsIHQubmFub3NlY29uZHMpIDogWih0aGlzLnNlY29uZHMsIHQuc2Vjb25kcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBUaW1lc3RhbXBgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYFRpbWVzdGFtcGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQuc2Vjb25kcyA9PT0gdGhpcy5zZWNvbmRzICYmIHQubmFub3NlY29uZHMgPT09IHRoaXMubmFub3NlY29uZHM7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBUaW1lc3RhbXBgLiAqLyAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiVGltZXN0YW1wKHNlY29uZHM9XCIgKyB0aGlzLnNlY29uZHMgKyBcIiwgbmFub3NlY29uZHM9XCIgKyB0aGlzLm5hbm9zZWNvbmRzICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgVGltZXN0YW1wYC4gKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2Vjb25kczogdGhpcy5zZWNvbmRzLFxuICAgICAgICAgICAgbmFub3NlY29uZHM6IHRoaXMubmFub3NlY29uZHNcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhpcyBvYmplY3QgdG8gYSBwcmltaXRpdmUgc3RyaW5nLCB3aGljaCBhbGxvd3MgYFRpbWVzdGFtcGAgb2JqZWN0c1xuICAgICAqIHRvIGJlIGNvbXBhcmVkIHVzaW5nIHRoZSBgPmAsIGA8PWAsIGA+PWAgYW5kIGA+YCBvcGVyYXRvcnMuXG4gICAgICovICAgIHZhbHVlT2YoKSB7XG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzdHJpbmcgb2YgdGhlIGZvcm0gPHNlY29uZHM+LjxuYW5vc2Vjb25kcz4gd2hlcmVcbiAgICAgICAgLy8gPHNlY29uZHM+IGlzIHRyYW5zbGF0ZWQgdG8gaGF2ZSBhIG5vbi1uZWdhdGl2ZSB2YWx1ZSBhbmQgYm90aCA8c2Vjb25kcz5cbiAgICAgICAgLy8gYW5kIDxuYW5vc2Vjb25kcz4gYXJlIGxlZnQtcGFkZGVkIHdpdGggemVyb2VzIHRvIGJlIGEgY29uc2lzdGVudCBsZW5ndGguXG4gICAgICAgIC8vIFN0cmluZ3Mgd2l0aCB0aGlzIGZvcm1hdCB0aGVuIGhhdmUgYSBsZXhpb2dyYXBoaWNhbCBvcmRlcmluZyB0aGF0IG1hdGNoZXNcbiAgICAgICAgLy8gdGhlIGV4cGVjdGVkIG9yZGVyaW5nLiBUaGUgPHNlY29uZHM+IHRyYW5zbGF0aW9uIGlzIGRvbmUgdG8gYXZvaWQgaGF2aW5nXG4gICAgICAgIC8vIGEgbGVhZGluZyBuZWdhdGl2ZSBzaWduIChpLmUuIGEgbGVhZGluZyAnLScgY2hhcmFjdGVyKSBpbiBpdHMgc3RyaW5nXG4gICAgICAgIC8vIHJlcHJlc2VudGF0aW9uLCB3aGljaCB3b3VsZCBhZmZlY3QgaXRzIGxleGlvZ3JhcGhpY2FsIG9yZGVyaW5nLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5zZWNvbmRzIC0gLTYyMTM1NTk2ODAwO1xuICAgICAgICAvLyBOb3RlOiBVcCB0byAxMiBkZWNpbWFsIGRpZ2l0cyBhcmUgcmVxdWlyZWQgdG8gcmVwcmVzZW50IGFsbCB2YWxpZFxuICAgICAgICAvLyAnc2Vjb25kcycgdmFsdWVzLlxuICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcodCkucGFkU3RhcnQoMTIsIFwiMFwiKSArIFwiLlwiICsgU3RyaW5nKHRoaXMubmFub3NlY29uZHMpLnBhZFN0YXJ0KDksIFwiMFwiKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgdmVyc2lvbiBvZiBhIGRvY3VtZW50IGluIEZpcmVzdG9yZS4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgdmVyc2lvblxuICogdGltZXN0YW1wLCBzdWNoIGFzIHVwZGF0ZV90aW1lIG9yIHJlYWRfdGltZS5cbiAqLyBjbGFzcyBzdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVGltZXN0YW1wKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBzdCh0KTtcbiAgICB9XG4gICAgc3RhdGljIG1pbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBzdChuZXcgbnQoMCwgMCkpO1xuICAgIH1cbiAgICBzdGF0aWMgbWF4KCkge1xuICAgICAgICByZXR1cm4gbmV3IHN0KG5ldyBudCgyNTM0MDIzMDA3OTksIDk5OTk5OTk5OSkpO1xuICAgIH1cbiAgICBjb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuX2NvbXBhcmVUbyh0LnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuaXNFcXVhbCh0LnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgbnVtYmVyIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB2ZXJzaW9uIGZvciB1c2UgaW4gc3BlYyB0ZXN0cy4gKi8gICAgdG9NaWNyb3NlY29uZHMoKSB7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gbWljcm9zZWNvbmRzLlxuICAgICAgICByZXR1cm4gMWU2ICogdGhpcy50aW1lc3RhbXAuc2Vjb25kcyArIHRoaXMudGltZXN0YW1wLm5hbm9zZWNvbmRzIC8gMWUzO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiU25hcHNob3RWZXJzaW9uKFwiICsgdGhpcy50aW1lc3RhbXAudG9TdHJpbmcoKSArIFwiKVwiO1xuICAgIH1cbiAgICB0b1RpbWVzdGFtcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxuICovXG5jbGFzcyBpdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB2b2lkIDAgPT09IGUgPyBlID0gMCA6IGUgPiB0Lmxlbmd0aCAmJiBPKCksIHZvaWQgMCA9PT0gbiA/IG4gPSB0Lmxlbmd0aCAtIGUgOiBuID4gdC5sZW5ndGggLSBlICYmIE8oKSwgXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSB0LCB0aGlzLm9mZnNldCA9IGUsIHRoaXMubGVuID0gbjtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IGl0LmNvbXBhcmF0b3IodGhpcywgdCk7XG4gICAgfVxuICAgIGNoaWxkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgaXQgPyB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSkgOiBlLnB1c2godCksIHRoaXMuY29uc3RydWN0KGUpO1xuICAgIH1cbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovICAgIGxpbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgcG9wRmlyc3QodCkge1xuICAgICAgICByZXR1cm4gdCA9IHZvaWQgMCA9PT0gdCA/IDEgOiB0LCB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHQsIHRoaXMubGVuZ3RoIC0gdCk7XG4gICAgfVxuICAgIHBvcExhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZmlyc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XG4gICAgfVxuICAgIGxhc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyB0XTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc1ByZWZpeE9mKHQpIHtcbiAgICAgICAgaWYgKHQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxlbmd0aDsgZSsrKSBpZiAodGhpcy5nZXQoZSkgIT09IHQuZ2V0KGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaXNJbW1lZGlhdGVQYXJlbnRPZih0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHQubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgaWYgKHRoaXMuZ2V0KGUpICE9PSB0LmdldChlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBmb3IgKGxldCBlID0gdGhpcy5vZmZzZXQsIG4gPSB0aGlzLmxpbWl0KCk7IGUgPCBuOyBlKyspIHQodGhpcy5zZWdtZW50c1tlXSk7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0KHMpLCBpID0gZS5nZXQocyk7XG4gICAgICAgICAgICBpZiAobiA8IGkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmIChuID4gaSkgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoIDwgZS5sZW5ndGggPyAtMSA6IHQubGVuZ3RoID4gZS5sZW5ndGggPyAxIDogMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHJ0IGV4dGVuZHMgaXQge1xuICAgIGNvbnN0cnVjdCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgcnQodCwgZSwgbik7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oXCIvXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4udCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBzZWdtZW50ICgke259KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLmApO1xuICAgICAgICAgICAgLy8gU3RyaXAgbGVhZGluZyBhbmQgdHJhbGluZyBzbGFzaGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKC4uLm4uc3BsaXQoXCIvXCIpLmZpbHRlcigodCA9PiB0Lmxlbmd0aCA+IDApKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBydChlKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBydChbXSk7XG4gICAgfVxufVxuXG5jb25zdCBvdCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgdXQgZXh0ZW5kcyBpdCB7XG4gICAgY29uc3RydWN0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1dCh0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG90LnRlc3QodCk7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLm1hcCgodCA9PiAodCA9IHQucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL2AvZywgXCJcXFxcYFwiKSwgXG4gICAgICAgIHV0LmlzVmFsaWRJZGVudGlmaWVyKHQpIHx8ICh0ID0gXCJgXCIgKyB0ICsgXCJgXCIpLCB0KSkpLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxuICAgICAqLyAgICBpc0tleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gMSA9PT0gdGhpcy5sZW5ndGggJiYgXCJfX25hbWVfX1wiID09PSB0aGlzLmdldCgwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IHV0KFsgXCJfX25hbWVfX1wiIF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VydmVyRm9ybWF0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IFwiXCIsIHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCk7XG4gICAgICAgICAgICBlLnB1c2gobiksIG4gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKDtzIDwgdC5sZW5ndGg7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRbc107XG4gICAgICAgICAgICBpZiAoXCJcXFxcXCIgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocyArIDEgPT09IHQubGVuZ3RoKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFtzICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKFwiXFxcXFwiICE9PSBlICYmIFwiLlwiICE9PSBlICYmIFwiYFwiICE9PSBlKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgdCk7XG4gICAgICAgICAgICAgICAgbiArPSBlLCBzICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IGUgPyAociA9ICFyLCBzKyspIDogXCIuXCIgIT09IGUgfHwgciA/IChuICs9IGUsIHMrKykgOiAoaSgpLCBzKyspO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpKCksIHIpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiBcIiArIHQpO1xuICAgICAgICByZXR1cm4gbmV3IHV0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHlQYXRoKCkge1xuICAgICAgICByZXR1cm4gbmV3IHV0KFtdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIGN0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUGF0aCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3QocnQuZnJvbVN0cmluZyh0KSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tTmFtZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3QocnQuZnJvbVN0cmluZyh0KS5wb3BGaXJzdCg1KSk7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBjdChydC5lbXB0eVBhdGgoKSk7XG4gICAgfVxuICAgIGdldCBjb2xsZWN0aW9uR3JvdXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgucG9wTGFzdCgpLmxhc3RTZWdtZW50KCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGlzIGluIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbklkLiAqLyAgICBoYXNDb2xsZWN0aW9uSWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmxlbmd0aCA+PSAyICYmIHRoaXMucGF0aC5nZXQodGhpcy5wYXRoLmxlbmd0aCAtIDIpID09PSB0O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBncm91cCAoaS5lLiB0aGUgbmFtZSBvZiB0aGUgcGFyZW50IGNvbGxlY3Rpb24pIGZvciB0aGlzIGtleS4gKi8gICAgZ2V0Q29sbGVjdGlvbkdyb3VwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmdldCh0aGlzLnBhdGgubGVuZ3RoIC0gMik7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRoZSBmdWxseSBxdWFsaWZpZWQgcGF0aCB0byB0aGUgcGFyZW50IGNvbGxlY3Rpb24uICovICAgIGdldENvbGxlY3Rpb25QYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnBvcExhc3QoKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0ICYmIDAgPT09IHJ0LmNvbXBhcmF0b3IodGhpcy5wYXRoLCB0LnBhdGgpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC50b1N0cmluZygpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIHJldHVybiBydC5jb21wYXJhdG9yKHQucGF0aCwgZS5wYXRoKTtcbiAgICB9XG4gICAgc3RhdGljIGlzRG9jdW1lbnRLZXkodCkge1xuICAgICAgICByZXR1cm4gdC5sZW5ndGggJSAyID09IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHdpdGggdGhlIGdpdmVuIHNlZ21lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlZ21lbnRzIC0gVGhlIHNlZ21lbnRzIG9mIHRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudFxuICAgICAqIEByZXR1cm5zIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VnbWVudHModCkge1xuICAgICAgICByZXR1cm4gbmV3IGN0KG5ldyBydCh0LnNsaWNlKCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBpbml0aWFsIG11dGF0aW9uIGJhdGNoIGlkIGZvciBlYWNoIGluZGV4LiBHZXRzIHVwZGF0ZWQgZHVyaW5nIGluZGV4XG4gKiBiYWNrZmlsbC5cbiAqL1xuLyoqXG4gKiBBbiBpbmRleCBkZWZpbml0aW9uIGZvciBmaWVsZCBpbmRleGVzIGluIEZpcmVzdG9yZS5cbiAqXG4gKiBFdmVyeSBpbmRleCBpcyBhc3NvY2lhdGVkIHdpdGggYSBjb2xsZWN0aW9uLiBUaGUgZGVmaW5pdGlvbiBjb250YWlucyBhIGxpc3RcbiAqIG9mIGZpZWxkcyBhbmQgdGhlaXIgaW5kZXgga2luZCAod2hpY2ggY2FuIGJlIGBBU0NFTkRJTkdgLCBgREVTQ0VORElOR2Agb3JcbiAqIGBDT05UQUlOU2AgZm9yIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBxdWVyaWVzKS5cbiAqXG4gKiBVbmxpa2UgdGhlIGJhY2tlbmQsIHRoZSBTREsgZG9lcyBub3QgZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGNvbGxlY3Rpb24gb3JcbiAqIGNvbGxlY3Rpb24gZ3JvdXAtc2NvcGVkIGluZGljZXMuIEV2ZXJ5IGluZGV4IGNhbiBiZSB1c2VkIGZvciBib3RoIHNpbmdsZVxuICogY29sbGVjdGlvbiBhbmQgY29sbGVjdGlvbiBncm91cCBxdWVyaWVzLlxuICovXG5jbGFzcyBhdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IElELiBSZXR1cm5zIC0xIGlmIHRoZSBpbmRleCBJRCBpcyBub3QgYXZhaWxhYmxlIChlLmcuIHRoZSBpbmRleFxuICAgICAqIGhhcyBub3QgeWV0IGJlZW4gcGVyc2lzdGVkKS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNvbGxlY3Rpb24gSUQgdGhpcyBpbmRleCBhcHBsaWVzIHRvLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUgZmllbGQgc2VnbWVudHMgZm9yIHRoaXMgaW5kZXguICovXG4gICAgbiwgXG4gICAgLyoqIFNob3dzIGhvdyB1cC10by1kYXRlIHRoZSBpbmRleCBpcyBmb3IgdGhlIGN1cnJlbnQgdXNlci4gKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuaW5kZXhJZCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5maWVsZHMgPSBuLCB0aGlzLmluZGV4U3RhdGUgPSBzO1xuICAgIH1cbn1cblxuLyoqIEFuIElEIGZvciBhbiBpbmRleCB0aGF0IGhhcyBub3QgeWV0IGJlZW4gYWRkZWQgdG8gcGVyc2lzdGVuY2UuICAqL1xuLyoqIFJldHVybnMgdGhlIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBzZWdtZW50IGZvciB0aGlzIGluZGV4LiAqL1xuZnVuY3Rpb24gaHQodCkge1xuICAgIHJldHVybiB0LmZpZWxkcy5maW5kKCh0ID0+IDIgLyogQ09OVEFJTlMgKi8gPT09IHQua2luZCkpO1xufVxuXG4vKiogUmV0dXJucyBhbGwgZGlyZWN0aW9uYWwgKGFzY2VuZGluZy9kZXNjZW5kaW5nKSBzZWdtZW50cyBmb3IgdGhpcyBpbmRleC4gKi8gZnVuY3Rpb24gbHQodCkge1xuICAgIHJldHVybiB0LmZpZWxkcy5maWx0ZXIoKHQgPT4gMiAvKiBDT05UQUlOUyAqLyAhPT0gdC5raW5kKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgb3JkZXIgb2YgdGhlIGRvY3VtZW50IGtleSBjb21wb25lbnQgZm9yIHRoZSBnaXZlbiBpbmRleC5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBXZWIgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uLlxuICovXG4vKipcbiAqIENvbXBhcmVzIGluZGV4ZXMgYnkgY29sbGVjdGlvbiBncm91cCBhbmQgc2VnbWVudHMuIElnbm9yZXMgdXBkYXRlIHRpbWUgYW5kXG4gKiBpbmRleCBJRC5cbiAqL1xuZnVuY3Rpb24gZnQodCwgZSkge1xuICAgIGxldCBuID0gWih0LmNvbGxlY3Rpb25Hcm91cCwgZS5jb2xsZWN0aW9uR3JvdXApO1xuICAgIGlmICgwICE9PSBuKSByZXR1cm4gbjtcbiAgICBmb3IgKGxldCBzID0gMDsgcyA8IE1hdGgubWluKHQuZmllbGRzLmxlbmd0aCwgZS5maWVsZHMubGVuZ3RoKTsgKytzKSBpZiAobiA9IF90KHQuZmllbGRzW3NdLCBlLmZpZWxkc1tzXSksIFxuICAgIDAgIT09IG4pIHJldHVybiBuO1xuICAgIHJldHVybiBaKHQuZmllbGRzLmxlbmd0aCwgZS5maWVsZHMubGVuZ3RoKTtcbn1cblxuLyoqIFJldHVybnMgYSBkZWJ1ZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZmllbGQgaW5kZXggKi8gYXQuVU5LTk9XTl9JRCA9IC0xO1xuXG4vKiogQW4gaW5kZXggY29tcG9uZW50IGNvbnNpc3Rpbmcgb2YgZmllbGQgcGF0aCBhbmQgaW5kZXggdHlwZS4gICovXG5jbGFzcyBkdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSBmaWVsZCBwYXRoIG9mIHRoZSBjb21wb25lbnQuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBmaWVsZHMgc29ydGluZyBvcmRlci4gKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMuZmllbGRQYXRoID0gdCwgdGhpcy5raW5kID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF90KHQsIGUpIHtcbiAgICBjb25zdCBuID0gdXQuY29tcGFyYXRvcih0LmZpZWxkUGF0aCwgZS5maWVsZFBhdGgpO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IFoodC5raW5kLCBlLmtpbmQpO1xufVxuXG4vKipcbiAqIFN0b3JlcyB0aGUgXCJoaWdoIHdhdGVyIG1hcmtcIiB0aGF0IGluZGljYXRlcyBob3cgdXBkYXRlZCB0aGUgSW5kZXggaXMgZm9yIHRoZVxuICogY3VycmVudCB1c2VyLlxuICovIGNsYXNzIHd0IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgd2hlbiB0aGUgaW5kZXggd2FzIGxhc3QgdXBkYXRlZCAocmVsYXRpdmUgdG8gb3RoZXIgaW5kZXhlcykuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSB0aGUgbGF0ZXN0IGluZGV4ZWQgcmVhZCB0aW1lLCBkb2N1bWVudCBhbmQgYmF0Y2ggaWQuICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID0gdCwgdGhpcy5vZmZzZXQgPSBlO1xuICAgIH1cbiAgICAvKiogVGhlIHN0YXRlIG9mIGFuIGluZGV4IHRoYXQgaGFzIG5vdCB5ZXQgYmVlbiBiYWNrZmlsbGVkLiAqLyAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd3QoMCwgeXQubWluKCkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIG9mZnNldCB0aGF0IG1hdGNoZXMgYWxsIGRvY3VtZW50cyB3aXRoIGEgcmVhZCB0aW1lIGhpZ2hlciB0aGFuXG4gKiBgcmVhZFRpbWVgLlxuICovIGZ1bmN0aW9uIG10KHQsIGUpIHtcbiAgICAvLyBXZSB3YW50IHRvIGNyZWF0ZSBhbiBvZmZzZXQgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHMgd2l0aCBhIHJlYWQgdGltZVxuICAgIC8vIGdyZWF0ZXIgdGhhbiB0aGUgcHJvdmlkZWQgcmVhZCB0aW1lLiBUbyBkbyBzbywgd2UgdGVjaG5pY2FsbHkgbmVlZCB0b1xuICAgIC8vIGNyZWF0ZSBhbiBvZmZzZXQgZm9yIGAocmVhZFRpbWUsIE1BWF9ET0NVTUVOVF9LRVkpYC4gV2hpbGUgd2UgY291bGQgdXNlXG4gICAgLy8gVW5pY29kZSBjb2RlcG9pbnRzIHRvIGdlbmVyYXRlIE1BWF9ET0NVTUVOVF9LRVksIGl0IGlzIG11Y2ggZWFzaWVyIHRvIHVzZVxuICAgIC8vIGAocmVhZFRpbWUgKyAxLCBEb2N1bWVudEtleS5lbXB0eSgpKWAgc2luY2UgYD4gRG9jdW1lbnRLZXkuZW1wdHkoKWAgbWF0Y2hlc1xuICAgIC8vIGFsbCB2YWxpZCBkb2N1bWVudCBJRHMuXG4gICAgY29uc3QgbiA9IHQudG9UaW1lc3RhbXAoKS5zZWNvbmRzLCBzID0gdC50b1RpbWVzdGFtcCgpLm5hbm9zZWNvbmRzICsgMSwgaSA9IHN0LmZyb21UaW1lc3RhbXAoMWU5ID09PSBzID8gbmV3IG50KG4gKyAxLCAwKSA6IG5ldyBudChuLCBzKSk7XG4gICAgcmV0dXJuIG5ldyB5dChpLCBjdC5lbXB0eSgpLCBlKTtcbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgb2Zmc2V0IGJhc2VkIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudC4gKi8gZnVuY3Rpb24gZ3QodCkge1xuICAgIHJldHVybiBuZXcgeXQodC5yZWFkVGltZSwgdC5rZXksIC0xKTtcbn1cblxuLyoqXG4gKiBTdG9yZXMgdGhlIGxhdGVzdCByZWFkIHRpbWUsIGRvY3VtZW50IGFuZCBiYXRjaCBJRCB0aGF0IHdlcmUgcHJvY2Vzc2VkIGZvciBhblxuICogaW5kZXguXG4gKi8gY2xhc3MgeXQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBsYXRlc3QgcmVhZCB0aW1lIHZlcnNpb24gdGhhdCBoYXMgYmVlbiBpbmRleGVkIGJ5IEZpcmVzdG9yZSBmb3IgdGhpc1xuICAgICAqIGZpZWxkIGluZGV4LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBrZXkgb2YgdGhlIGxhc3QgZG9jdW1lbnQgdGhhdCB3YXMgaW5kZXhlZCBmb3IgdGhpcyBxdWVyeS4gVXNlXG4gICAgICogYERvY3VtZW50S2V5LmVtcHR5KClgIGlmIG5vIGRvY3VtZW50IGhhcyBiZWVuIGluZGV4ZWQuXG4gICAgICovXG4gICAgZSwgXG4gICAgLypcbiAgICAgKiBUaGUgbGFyZ2VzdCBtdXRhdGlvbiBiYXRjaCBpZCB0aGF0J3MgYmVlbiBwcm9jZXNzZWQgYnkgRmlyZXN0b3JlLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy5yZWFkVGltZSA9IHQsIHRoaXMuZG9jdW1lbnRLZXkgPSBlLCB0aGlzLmxhcmdlc3RCYXRjaElkID0gbjtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYmVmb3JlIGFsbCByZWd1bGFyIG9mZnNldHMuICovICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgeXQoc3QubWluKCksIGN0LmVtcHR5KCksIC0xKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYWZ0ZXIgYWxsIHJlZ3VsYXIgb2Zmc2V0cy4gKi8gICAgc3RhdGljIG1heCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB5dChzdC5tYXgoKSwgY3QuZW1wdHkoKSwgLTEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcHQodCwgZSkge1xuICAgIGxldCBuID0gdC5yZWFkVGltZS5jb21wYXJlVG8oZS5yZWFkVGltZSk7XG4gICAgcmV0dXJuIDAgIT09IG4gPyBuIDogKG4gPSBjdC5jb21wYXJhdG9yKHQuZG9jdW1lbnRLZXksIGUuZG9jdW1lbnRLZXkpLCAwICE9PSBuID8gbiA6IFoodC5sYXJnZXN0QmF0Y2hJZCwgZS5sYXJnZXN0QmF0Y2hJZCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBJdCA9IFwiVGhlIGN1cnJlbnQgdGFiIGlzIG5vdCBpbiB0aGUgcmVxdWlyZWQgc3RhdGUgdG8gcGVyZm9ybSB0aGlzIG9wZXJhdGlvbi4gSXQgbWlnaHQgYmUgbmVjZXNzYXJ5IHRvIHJlZnJlc2ggdGhlIGJyb3dzZXIgdGFiLlwiO1xuXG4vKipcbiAqIEEgYmFzZSBjbGFzcyByZXByZXNlbnRpbmcgYSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbiwgZW5jYXBzdWxhdGluZyBib3RoIHRoZVxuICogdHJhbnNhY3Rpb24ncyBzZXF1ZW5jZSBudW1iZXJzIGFzIHdlbGwgYXMgYSBsaXN0IG9mIG9uQ29tbWl0dGVkIGxpc3RlbmVycy5cbiAqXG4gKiBXaGVuIHlvdSBjYWxsIFBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCksIGl0IHdpbGwgY3JlYXRlIGEgdHJhbnNhY3Rpb24gYW5kXG4gKiBwYXNzIGl0IHRvIHlvdXIgY2FsbGJhY2suIFlvdSB0aGVuIHBhc3MgaXQgdG8gYW55IG1ldGhvZCB0aGF0IG9wZXJhdGVzXG4gKiBvbiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBUdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMgPSBbXTtcbiAgICB9XG4gICAgYWRkT25Db21taXR0ZWRMaXN0ZW5lcih0KSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMucHVzaCh0KTtcbiAgICB9XG4gICAgcmFpc2VPbkNvbW1pdHRlZEV2ZW50KCkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzLmZvckVhY2goKHQgPT4gdCgpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBWZXJpZmllcyB0aGUgZXJyb3IgdGhyb3duIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uIElmIGEgTG9jYWxTdG9yZVxuICogb3BlcmF0aW9uIGZhaWxzIGJlY2F1c2UgdGhlIHByaW1hcnkgbGVhc2UgaGFzIGJlZW4gdGFrZW4gYnkgYW5vdGhlciBjbGllbnQsXG4gKiB3ZSBpZ25vcmUgdGhlIGVycm9yICh0aGUgcGVyc2lzdGVuY2UgbGF5ZXIgd2lsbCBpbW1lZGlhdGVseSBjYWxsXG4gKiBgYXBwbHlQcmltYXJ5TGVhc2VgIHRvIHByb3BhZ2F0ZSB0aGUgcHJpbWFyeSBzdGF0ZSBjaGFuZ2UpLiBBbGwgb3RoZXIgZXJyb3JzXG4gKiBhcmUgcmUtdGhyb3duLlxuICpcbiAqIEBwYXJhbSBlcnIgLSBBbiBlcnJvciByZXR1cm5lZCBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgYWZ0ZXIgd2UgcmVjb3ZlcmVkLCBvciB0aGUgb3JpZ2luYWwgZXJyb3IuXG4gKi8gYXN5bmMgZnVuY3Rpb24gRXQodCkge1xuICAgIGlmICh0LmNvZGUgIT09IEIuRkFJTEVEX1BSRUNPTkRJVElPTiB8fCB0Lm1lc3NhZ2UgIT09IEl0KSB0aHJvdyB0O1xuICAgIEMoXCJMb2NhbFN0b3JlXCIsIFwiVW5leHBlY3RlZGx5IGxvc3QgcHJpbWFyeSBsZWFzZVwiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGVyc2lzdGVuY2VQcm9taXNlIGlzIGVzc2VudGlhbGx5IGEgcmUtaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZSBleGNlcHRcbiAqIGl0IGhhcyBhIC5uZXh0KCkgbWV0aG9kIGluc3RlYWQgb2YgLnRoZW4oKSBhbmQgLm5leHQoKSBhbmQgLmNhdGNoKCkgY2FsbGJhY2tzXG4gKiBhcmUgZXhlY3V0ZWQgc3luY2hyb25vdXNseSB3aGVuIGEgUGVyc2lzdGVuY2VQcm9taXNlIHJlc29sdmVzIHJhdGhlciB0aGFuXG4gKiBhc3luY2hyb25vdXNseSAoUHJvbWlzZSBpbXBsZW1lbnRhdGlvbnMgdXNlIHNldEltbWVkaWF0ZSgpIG9yIHNpbWlsYXIpLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIGludGVyb3BlcmF0ZSB3aXRoIEluZGV4ZWREQiB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHlcbiAqIGNvbW1pdCB0cmFuc2FjdGlvbnMgaWYgY29udHJvbCBpcyByZXR1cm5lZCB0byB0aGUgZXZlbnQgbG9vcCB3aXRob3V0XG4gKiBzeW5jaHJvbm91c2x5IGluaXRpYXRpbmcgYW5vdGhlciBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uLlxuICpcbiAqIE5PVEU6IC50aGVuKCkgYW5kIC5jYXRjaCgpIG9ubHkgYWxsb3cgYSBzaW5nbGUgY29uc3VtZXIsIHVubGlrZSBub3JtYWxcbiAqIFByb21pc2VzLlxuICovIGNsYXNzIEF0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIC8vIE5PVEU6IG5leHQvY2F0Y2hDYWxsYmFjayB3aWxsIGFsd2F5cyBwb2ludCB0byBvdXIgb3duIHdyYXBwZXIgZnVuY3Rpb25zLFxuICAgICAgICAvLyBub3QgdGhlIHVzZXIncyByYXcgbmV4dCgpIG9yIGNhdGNoKCkgY2FsbGJhY2tzLlxuICAgICAgICB0aGlzLm5leHRDYWxsYmFjayA9IG51bGwsIHRoaXMuY2F0Y2hDYWxsYmFjayA9IG51bGwsIFxuICAgICAgICAvLyBXaGVuIHRoZSBvcGVyYXRpb24gcmVzb2x2ZXMsIHdlJ2xsIHNldCByZXN1bHQgb3IgZXJyb3IgYW5kIG1hcmsgaXNEb25lLlxuICAgICAgICB0aGlzLnJlc3VsdCA9IHZvaWQgMCwgdGhpcy5lcnJvciA9IHZvaWQgMCwgdGhpcy5pc0RvbmUgPSAhMSwgXG4gICAgICAgIC8vIFNldCB0byB0cnVlIHdoZW4gLnRoZW4oKSBvciAuY2F0Y2goKSBhcmUgY2FsbGVkIGFuZCBwcmV2ZW50cyBhZGRpdGlvbmFsXG4gICAgICAgIC8vIGNoYWluaW5nLlxuICAgICAgICB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMSwgdCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLnJlc3VsdCA9IHQsIHRoaXMubmV4dENhbGxiYWNrICYmIFxuICAgICAgICAgICAgLy8gdmFsdWUgc2hvdWxkIGJlIGRlZmluZWQgdW5sZXNzIFQgaXMgVm9pZCwgYnV0IHdlIGNhbid0IGV4cHJlc3NcbiAgICAgICAgICAgIC8vIHRoYXQgaW4gdGhlIHR5cGUgc3lzdGVtLlxuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sodCk7XG4gICAgICAgIH0pLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLmVycm9yID0gdCwgdGhpcy5jYXRjaENhbGxiYWNrICYmIHRoaXMuY2F0Y2hDYWxsYmFjayh0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjYXRjaCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5leHQodm9pZCAwLCB0KTtcbiAgICB9XG4gICAgbmV4dCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgJiYgTygpLCB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMCwgdGhpcy5pc0RvbmUgPyB0aGlzLmVycm9yID8gdGhpcy53cmFwRmFpbHVyZShlLCB0aGlzLmVycm9yKSA6IHRoaXMud3JhcFN1Y2Nlc3ModCwgdGhpcy5yZXN1bHQpIDogbmV3IEF0KCgobiwgcykgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBTdWNjZXNzKHQsIGUpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9LCB0aGlzLmNhdGNoQ2FsbGJhY2sgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBGYWlsdXJlKGUsIHQpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvUHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0KHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHdyYXBVc2VyRnVuY3Rpb24odCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQoKTtcbiAgICAgICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgQXQgPyBlIDogQXQucmVzb2x2ZShlKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgcmV0dXJuIEF0LnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3cmFwU3VjY2Vzcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiBBdC5yZXNvbHZlKGUpO1xuICAgIH1cbiAgICB3cmFwRmFpbHVyZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiBBdC5yZWplY3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyByZXNvbHZlKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGUodCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc3RhdGljIHJlamVjdCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQXQoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBuKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyB3YWl0Rm9yKFxuICAgIC8vIEFjY2VwdCBhbGwgUHJvbWlzZSB0eXBlcyBpbiB3YWl0Rm9yKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQXQoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9IDAsIGkgPSAwLCByID0gITE7XG4gICAgICAgICAgICB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICsrcywgdC5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICsraSwgciAmJiBpID09PSBzICYmIGUoKTtcbiAgICAgICAgICAgICAgICB9KSwgKHQgPT4gbih0KSkpO1xuICAgICAgICAgICAgfSkpLCByID0gITAsIGkgPT09IHMgJiYgZSgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVuIGFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnMgdGhhdCBhc3luY2hyb25vdXNseSBldmFsdWF0ZSB0byBhXG4gICAgICogYm9vbGVhbiwgaW1wbGVtZW50cyBhIHNob3J0LWNpcmN1aXRpbmcgYG9yYCBiZXR3ZWVuIHRoZSByZXN1bHRzLiBQcmVkaWNhdGVzXG4gICAgICogd2lsbCBiZSBldmFsdWF0ZWQgdW50aWwgb25lIG9mIHRoZW0gcmV0dXJucyBgdHJ1ZWAsIHRoZW4gc3RvcC4gVGhlIGZpbmFsXG4gICAgICogcmVzdWx0IHdpbGwgYmUgd2hldGhlciBhbnkgb2YgdGhlbSByZXR1cm5lZCBgdHJ1ZWAuXG4gICAgICovICAgIHN0YXRpYyBvcih0KSB7XG4gICAgICAgIGxldCBlID0gQXQucmVzb2x2ZSghMSk7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5uZXh0KCh0ID0+IHQgPyBBdC5yZXNvbHZlKHQpIDogbigpKSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBzdGF0aWMgZm9yRWFjaCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4ucHVzaChlLmNhbGwodGhpcywgdCwgcykpO1xuICAgICAgICB9KSksIHRoaXMud2FpdEZvcihuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uY3VycmVudGx5IG1hcCBhbGwgYXJyYXkgZWxlbWVudHMgdGhyb3VnaCBhc3luY2hyb25vdXMgZnVuY3Rpb24uXG4gICAgICovICAgIHN0YXRpYyBtYXBBcnJheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXQoKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdC5sZW5ndGgsIHIgPSBuZXcgQXJyYXkoaSk7XG4gICAgICAgICAgICBsZXQgbyA9IDA7XG4gICAgICAgICAgICBmb3IgKGxldCB1ID0gMDsgdSA8IGk7IHUrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSB1O1xuICAgICAgICAgICAgICAgIGUodFtjXSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJbY10gPSB0LCArK28sIG8gPT09IGkgJiYgbihyKTtcbiAgICAgICAgICAgICAgICB9KSwgKHQgPT4gcyh0KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFuIGFsdGVybmF0aXZlIHRvIHJlY3Vyc2l2ZSBQZXJzaXN0ZW5jZVByb21pc2UgY2FsbHMsIHRoYXQgYXZvaWRzXG4gICAgICogcG90ZW50aWFsIG1lbW9yeSBwcm9ibGVtcyBmcm9tIHVuYm91bmRlZCBjaGFpbnMgb2YgcHJvbWlzZXMuXG4gICAgICpcbiAgICAgKiBUaGUgYGFjdGlvbmAgd2lsbCBiZSBjYWxsZWQgcmVwZWF0ZWRseSB3aGlsZSBgY29uZGl0aW9uYCBpcyB0cnVlLlxuICAgICAqLyAgICBzdGF0aWMgZG9XaGlsZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXQoKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICEwID09PSB0KCkgPyBlKCkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpKCk7XG4gICAgICAgICAgICAgICAgfSksIHMpIDogbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGkoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFJlZmVyZW5jZXMgdG8gYHdpbmRvd2AgYXJlIGd1YXJkZWQgYnkgU2ltcGxlRGIuaXNBdmFpbGFibGUoKVxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXG4vKipcbiAqIFdyYXBzIGFuIElEQlRyYW5zYWN0aW9uIGFuZCBleHBvc2VzIGEgc3RvcmUoKSBtZXRob2QgdG8gZ2V0IGEgaGFuZGxlIHRvIGFcbiAqIHNwZWNpZmljIG9iamVjdCBzdG9yZS5cbiAqL1xuY2xhc3MgUnQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSB0LCB0aGlzLnRyYW5zYWN0aW9uID0gZSwgdGhpcy5hYm9ydGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIEluZGV4ZWREYiB0cmFuc2FjdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuUCA9IG5ldyBVLCB0aGlzLnRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLlAucmVzb2x2ZSgpO1xuICAgICAgICB9LCB0aGlzLnRyYW5zYWN0aW9uLm9uYWJvcnQgPSAoKSA9PiB7XG4gICAgICAgICAgICBlLmVycm9yID8gdGhpcy5QLnJlamVjdChuZXcgdnQodCwgZS5lcnJvcikpIDogdGhpcy5QLnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmVycm9yID0gZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0geHQoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5QLnJlamVjdChuZXcgdnQodCwgbikpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgb3Blbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFJ0KGUsIHQudHJhbnNhY3Rpb24ocywgbikpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgdnQoZSwgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlAucHJvbWlzZTtcbiAgICB9XG4gICAgYWJvcnQodCkge1xuICAgICAgICB0ICYmIHRoaXMuUC5yZWplY3QodCksIHRoaXMuYWJvcnRlZCB8fCAoQyhcIlNpbXBsZURiXCIsIFwiQWJvcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQgPyB0Lm1lc3NhZ2UgOiBcIkNsaWVudC1pbml0aWF0ZWQgYWJvcnRcIiksIFxuICAgICAgICB0aGlzLmFib3J0ZWQgPSAhMCwgdGhpcy50cmFuc2FjdGlvbi5hYm9ydCgpKTtcbiAgICB9XG4gICAgVigpIHtcbiAgICAgICAgLy8gSWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgVjMgSW5kZXhlZERCLCB3ZSBpbnZva2UgY29tbWl0KCkgZXhwbGljaXRseSB0b1xuICAgICAgICAvLyBzcGVlZCB1cCBpbmRleCBEQiBwcm9jZXNzaW5nIGlmIHRoZSBldmVudCBsb29wIHJlbWFpbnMgYmxvY2tzLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCB0ID0gdGhpcy50cmFuc2FjdGlvbjtcbiAgICAgICAgdGhpcy5hYm9ydGVkIHx8IFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgdC5jb21taXQgfHwgdC5jb21taXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFNpbXBsZURiU3RvcmU8S2V5VHlwZSwgVmFsdWVUeXBlPiBmb3IgdGhlIHNwZWNpZmllZCBzdG9yZS4gQWxsXG4gICAgICogb3BlcmF0aW9ucyBwZXJmb3JtZWQgb24gdGhlIFNpbXBsZURiU3RvcmUgaGFwcGVuIHdpdGhpbiB0aGUgY29udGV4dCBvZiB0aGlzXG4gICAgICogdHJhbnNhY3Rpb24gYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGFueW1vcmUgb25jZSB0aGUgdHJhbnNhY3Rpb24gaXNcbiAgICAgKiBjb21wbGV0ZWQuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgd2UgY2FuJ3QgYWN0dWFsbHkgZW5mb3JjZSB0aGF0IHRoZSBLZXlUeXBlIGFuZCBWYWx1ZVR5cGUgYXJlXG4gICAgICogY29ycmVjdCwgYnV0IHRoZXkgYWxsb3cgdHlwZSBzYWZldHkgdGhyb3VnaCB0aGUgcmVzdCBvZiB0aGUgY29uc3VtaW5nIGNvZGUuXG4gICAgICovICAgIHN0b3JlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMudHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUodCk7XG4gICAgICAgIHJldHVybiBuZXcgU3QoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEgd3JhcHBlciBhcm91bmQgSW5kZXhlZERiIHdpdGggYSBzaW1wbGlmaWVkIGludGVyZmFjZSB0aGF0IHVzZXNcbiAqIFByb21pc2UtbGlrZSByZXR1cm4gdmFsdWVzIHRvIGNoYWluIG9wZXJhdGlvbnMuIFJlYWwgcHJvbWlzZXMgY2Fubm90IGJlIHVzZWRcbiAqIHNpbmNlIC50aGVuKCkgY29udGludWF0aW9ucyBhcmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgKGUuZy4gdmlhXG4gKiAuc2V0SW1tZWRpYXRlKSwgd2hpY2ggd291bGQgY2F1c2UgSW5kZXhlZERCIHRvIGVuZCB0aGUgdHJhbnNhY3Rpb24uXG4gKiBTZWUgUGVyc2lzdGVuY2VQcm9taXNlIGZvciBtb3JlIGRldGFpbHMuXG4gKi8gY2xhc3MgYnQge1xuICAgIC8qXG4gICAgICogQ3JlYXRlcyBhIG5ldyBTaW1wbGVEYiB3cmFwcGVyIGZvciBJbmRleGVkRGIgZGF0YWJhc2UgYG5hbWVgLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGB2ZXJzaW9uYCBtdXN0IG5vdCBiZSBhIGRvd25ncmFkZS4gSW5kZXhlZERCIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgKiBkb3duZ3JhZGluZyB0aGUgc2NoZW1hIHZlcnNpb24uIFdlIGN1cnJlbnRseSBkbyBub3Qgc3VwcG9ydCBhbnkgd2F5IHRvIGRvXG4gICAgICogdmVyc2lvbmluZyBvdXRzaWRlIG9mIEluZGV4ZWREQidzIHZlcnNpb25pbmcgbWVjaGFuaXNtLCBhcyBvbmx5XG4gICAgICogdmVyc2lvbi11cGdyYWRlIHRyYW5zYWN0aW9ucyBhcmUgYWxsb3dlZCB0byBkbyB0aGluZ3MgbGlrZSBjcmVhdGVcbiAgICAgKiBvYmplY3RzdG9yZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLm5hbWUgPSB0LCB0aGlzLnZlcnNpb24gPSBlLCB0aGlzLlMgPSBuO1xuICAgICAgICAvLyBOT1RFOiBBY2NvcmRpbmcgdG8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE5NzA1MCwgdGhlXG4gICAgICAgIC8vIGJ1ZyB3ZSdyZSBjaGVja2luZyBmb3Igc2hvdWxkIGV4aXN0IGluIGlPUyA+PSAxMi4yIGFuZCA8IDEzLCBidXQgZm9yXG4gICAgICAgIC8vIHdoYXRldmVyIHJlYXNvbiBpdCdzIG11Y2ggaGFyZGVyIHRvIGhpdCBhZnRlciAxMi4yIHNvIHdlIG9ubHkgcHJvYWN0aXZlbHlcbiAgICAgICAgLy8gbG9nIG9uIDEyLjIuXG4gICAgICAgIDEyLjIgPT09IGJ0LkQoZ2V0VUEoKSkgJiYgeChcIkZpcmVzdG9yZSBwZXJzaXN0ZW5jZSBzdWZmZXJzIGZyb20gYSBidWcgaW4gaU9TIDEyLjIgU2FmYXJpIHRoYXQgbWF5IGNhdXNlIHlvdXIgYXBwIHRvIHN0b3Agd29ya2luZy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuXCIpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLiAqLyAgICBzdGF0aWMgZGVsZXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIEMoXCJTaW1wbGVEYlwiLCBcIlJlbW92aW5nIGRhdGFiYXNlOlwiLCB0KSwgRHQod2luZG93LmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZSh0KSkudG9Qcm9taXNlKCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgSW5kZXhlZERCIGlzIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gKi8gICAgc3RhdGljIEMoKSB7XG4gICAgICAgIGlmICghaXNJbmRleGVkREJBdmFpbGFibGUoKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAoYnQuTigpKSByZXR1cm4gITA7XG4gICAgICAgIC8vIFdlIGV4dGVuc2l2ZWx5IHVzZSBpbmRleGVkIGFycmF5IHZhbHVlcyBhbmQgY29tcG91bmQga2V5cyxcbiAgICAgICAgLy8gd2hpY2ggSUUgYW5kIEVkZ2UgZG8gbm90IHN1cHBvcnQuIEhvd2V2ZXIsIHRoZXkgc3RpbGwgaGF2ZSBpbmRleGVkREJcbiAgICAgICAgLy8gZGVmaW5lZCBvbiB0aGUgd2luZG93LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciB0aGVtIGhlcmUgYW5kIG1ha2Ugc3VyZVxuICAgICAgICAvLyB0byByZXR1cm4gdGhhdCBwZXJzaXN0ZW5jZSBpcyBub3QgZW5hYmxlZCBmb3IgdGhvc2UgYnJvd3NlcnMuXG4gICAgICAgIC8vIEZvciB0cmFja2luZyBzdXBwb3J0IG9mIHRoaXMgZmVhdHVyZSwgc2VlIGhlcmU6XG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vc3RhdHVzL2luZGV4ZWRkYmFycmF5c2FuZG11bHRpZW50cnlzdXBwb3J0L1xuICAgICAgICAvLyBDaGVjayB0aGUgVUEgc3RyaW5nIHRvIGZpbmQgb3V0IHRoZSBicm93c2VyLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBnZXRVQSgpLCBlID0gYnQuRCh0KSwgbiA9IDAgPCBlICYmIGUgPCAxMCwgcyA9IGJ0LmsodCksIGkgPSAwIDwgcyAmJiBzIDwgNC41O1xuICAgICAgICAvLyBJRSAxMFxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcbiAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XG4gICAgICAgIC8vIEVkZ2VcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xuICAgICAgICAvLyBpT1MgU2FmYXJpOiBEaXNhYmxlIGZvciB1c2VycyBydW5uaW5nIGlPUyB2ZXJzaW9uIDwgMTAuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEodC5pbmRleE9mKFwiTVNJRSBcIikgPiAwIHx8IHQuaW5kZXhPZihcIlRyaWRlbnQvXCIpID4gMCB8fCB0LmluZGV4T2YoXCJFZGdlL1wiKSA+IDAgfHwgbiB8fCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBiYWNraW5nIEluZGV4ZWREQiBzdG9yZSBpcyB0aGUgTm9kZSBJbmRleGVkREJTaGltXG4gICAgICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0pLlxuICAgICAqLyAgICBzdGF0aWMgTigpIHtcbiAgICAgICAgdmFyIHQ7XG4gICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBwcm9jZXNzICYmIFwiWUVTXCIgPT09IChudWxsID09PSAodCA9IHByb2Nlc3MuZW52KSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0Lk8pO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZnJvbSBhIHRyYW5zYWN0aW9uLiAqLyAgICBzdGF0aWMgTSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKGUpO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIGlPUyB2ZXJzaW9uLiBSZXR1cm5zIC0xIGlmIG5vdCBmb3VuZC4gKi9cbiAgICBzdGF0aWMgRCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lm1hdGNoKC9pKD86cGhvbmV8cGFkfHBvZCkgb3MgKFtcXGRfXSspL2kpLCBuID0gZSA/IGVbMV0uc3BsaXQoXCJfXCIpLnNsaWNlKDAsIDIpLmpvaW4oXCIuXCIpIDogXCItMVwiO1xuICAgICAgICByZXR1cm4gTnVtYmVyKG4pO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIEFuZHJvaWQgdmVyc2lvbi4gUmV0dXJucyAtMSBpZiBub3QgZm91bmQuICovXG4gICAgc3RhdGljIGsodCkge1xuICAgICAgICBjb25zdCBlID0gdC5tYXRjaCgvQW5kcm9pZCAoW1xcZC5dKykvaSksIG4gPSBlID8gZVsxXS5zcGxpdChcIi5cIikuc2xpY2UoMCwgMikuam9pbihcIi5cIikgOiBcIi0xXCI7XG4gICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UsIGNyZWF0aW5nIG9yIHVwZ3JhZGluZyBpdCBpZiBuZWNlc3NhcnkuXG4gICAgICovICAgIGFzeW5jIEYodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYiB8fCAoQyhcIlNpbXBsZURiXCIsIFwiT3BlbmluZyBkYXRhYmFzZTpcIiwgdGhpcy5uYW1lKSwgdGhpcy5kYiA9IGF3YWl0IG5ldyBQcm9taXNlKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBJbnZlc3RpZ2F0ZSBicm93c2VyIGNvbXBhdGliaWxpdHkuXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW5kZXhlZERCX0FQSS9Vc2luZ19JbmRleGVkREJcbiAgICAgICAgICAgIC8vIHN1Z2dlc3RzIElFOSBhbmQgb2xkZXIgV2ViS2l0IGJyb3dzZXJzIGhhbmRsZSB1cGdyYWRlXG4gICAgICAgICAgICAvLyBkaWZmZXJlbnRseS4gVGhleSBleHBlY3Qgc2V0VmVyc2lvbiwgYXMgZGVzY3JpYmVkIGhlcmU6XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCVmVyc2lvbkNoYW5nZVJlcXVlc3Qvc2V0VmVyc2lvblxuICAgICAgICAgICAgY29uc3QgcyA9IGluZGV4ZWREQi5vcGVuKHRoaXMubmFtZSwgdGhpcy52ZXJzaW9uKTtcbiAgICAgICAgICAgIHMub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBlKG4pO1xuICAgICAgICAgICAgfSwgcy5vbmJsb2NrZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbihuZXcgdnQodCwgXCJDYW5ub3QgdXBncmFkZSBJbmRleGVkREIgc2NoZW1hIHdoaWxlIGFub3RoZXIgdGFiIGlzIG9wZW4uIENsb3NlIGFsbCB0YWJzIHRoYXQgYWNjZXNzIEZpcmVzdG9yZSBhbmQgcmVsb2FkIHRoaXMgcGFnZSB0byBwcm9jZWVkLlwiKSk7XG4gICAgICAgICAgICB9LCBzLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQuZXJyb3I7XG4gICAgICAgICAgICAgICAgXCJWZXJzaW9uRXJyb3JcIiA9PT0gcy5uYW1lID8gbihuZXcgTChCLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBGaXJlc3RvcmUgU0RLIHdhcyBwcmV2aW91c2x5IHVzZWQgYW5kIHNvIHRoZSBwZXJzaXN0ZWQgZGF0YSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIG9mIHRoZSBTREsgeW91IGFyZSBub3cgdXNpbmcuIFRoZSBTREsgd2lsbCBvcGVyYXRlIHdpdGggcGVyc2lzdGVuY2UgZGlzYWJsZWQuIElmIHlvdSBuZWVkIHBlcnNpc3RlbmNlLCBwbGVhc2UgcmUtdXBncmFkZSB0byBhIG5ld2VyIHZlcnNpb24gb2YgdGhlIFNESyBvciBlbHNlIGNsZWFyIHRoZSBwZXJzaXN0ZWQgSW5kZXhlZERCIGRhdGEgZm9yIHlvdXIgYXBwIHRvIHN0YXJ0IGZyZXNoLlwiKSkgOiBcIkludmFsaWRTdGF0ZUVycm9yXCIgPT09IHMubmFtZSA/IG4obmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlVuYWJsZSB0byBvcGVuIGFuIEluZGV4ZWREQiBjb25uZWN0aW9uLiBUaGlzIGNvdWxkIGJlIGR1ZSB0byBydW5uaW5nIGluIGEgcHJpdmF0ZSBicm93c2luZyBzZXNzaW9uIG9uIGEgYnJvd3NlciB3aG9zZSBwcml2YXRlIGJyb3dzaW5nIHNlc3Npb25zIGRvIG5vdCBzdXBwb3J0IEluZGV4ZWREQjogXCIgKyBzKSkgOiBuKG5ldyB2dCh0LCBzKSk7XG4gICAgICAgICAgICB9LCBzLm9udXBncmFkZW5lZWRlZCA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIEMoXCJTaW1wbGVEYlwiLCAnRGF0YWJhc2UgXCInICsgdGhpcy5uYW1lICsgJ1wiIHJlcXVpcmVzIHVwZ3JhZGUgZnJvbSB2ZXJzaW9uOicsIHQub2xkVmVyc2lvbik7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLlMuJChlLCBzLnRyYW5zYWN0aW9uLCB0Lm9sZFZlcnNpb24sIHRoaXMudmVyc2lvbikubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBDKFwiU2ltcGxlRGJcIiwgXCJEYXRhYmFzZSB1cGdyYWRlIHRvIHZlcnNpb24gXCIgKyB0aGlzLnZlcnNpb24gKyBcIiBjb21wbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSkpLCB0aGlzLkIgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gdCA9PiB0aGlzLkIodCkpLCB0aGlzLmRiO1xuICAgIH1cbiAgICBMKHQpIHtcbiAgICAgICAgdGhpcy5CID0gdCwgdGhpcy5kYiAmJiAodGhpcy5kYi5vbnZlcnNpb25jaGFuZ2UgPSBlID0+IHQoZSkpO1xuICAgIH1cbiAgICBhc3luYyBydW5UcmFuc2FjdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBcInJlYWRvbmx5XCIgPT09IGU7XG4gICAgICAgIGxldCByID0gMDtcbiAgICAgICAgZm9yICg7Oykge1xuICAgICAgICAgICAgKytyO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRiID0gYXdhaXQgdGhpcy5GKHQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBSdC5vcGVuKHRoaXMuZGIsIHQsIGkgPyBcInJlYWRvbmx5XCIgOiBcInJlYWR3cml0ZVwiLCBuKSwgciA9IHMoZSkubmV4dCgodCA9PiAoZS5WKCksIFxuICAgICAgICAgICAgICAgIHQpKSkuY2F0Y2goKHQgPT4gKFxuICAgICAgICAgICAgICAgIC8vIEFib3J0IHRoZSB0cmFuc2FjdGlvbiBpZiB0aGVyZSB3YXMgYW4gZXJyb3IuXG4gICAgICAgICAgICAgICAgZS5hYm9ydCh0KSwgQXQucmVqZWN0KHQpKSkpLnRvUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIC8vIEFzIG5vdGVkIGFib3ZlLCBlcnJvcnMgYXJlIHByb3BhZ2F0ZWQgYnkgYWJvcnRpbmcgdGhlIHRyYW5zYWN0aW9uLiBTb1xuICAgICAgICAgICAgICAgIC8vIHdlIHN3YWxsb3cgYW55IGVycm9yIGhlcmUgdG8gYXZvaWQgdGhlIGJyb3dzZXIgbG9nZ2luZyBpdCBhcyB1bmhhbmRsZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuY2F0Y2goKCgpID0+IHt9KSksIFxuICAgICAgICAgICAgICAgIC8vIFdhaXQgZm9yIHRoZSB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSAoaS5lLiBJbmRleGVkRGIncyBvbnN1Y2Nlc3MgZXZlbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBmaXJlKSwgYnV0IHN0aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgdHJhbnNhY3Rpb25GblJlc3VsdCBiYWNrIHRvIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhbGxlci5cbiAgICAgICAgICAgICAgICBhd2FpdCBlLnYsIHI7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQsIG4gPSBcIkZpcmViYXNlRXJyb3JcIiAhPT0gZS5uYW1lICYmIHIgPCAzO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8oc2NobWlkdC1zZWJhc3RpYW4pOiBXZSBjb3VsZCBwcm9iYWJseSBiZSBzbWFydGVyIGFib3V0IHRoaXMgYW5kXG4gICAgICAgICAgICAgICAgLy8gbm90IHJldHJ5IGV4Y2VwdGlvbnMgdGhhdCBhcmUgbGlrZWx5IHVucmVjb3ZlcmFibGUgKHN1Y2ggYXMgcXVvdGFcbiAgICAgICAgICAgICAgICAvLyBleGNlZWRlZCBlcnJvcnMpLlxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IFdlIGNhbm5vdCB1c2UgYW4gaW5zdGFuY2VvZiBjaGVjayBmb3IgRmlyZXN0b3JlRXhjZXB0aW9uLCBzaW5jZSB0aGVcbiAgICAgICAgICAgICAgICAvLyBleGNlcHRpb24gaXMgd3JhcHBlZCBpbiBhIGdlbmVyaWMgZXJyb3IgYnkgb3VyIGFzeW5jL2F3YWl0IGhhbmRsaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQyhcIlNpbXBsZURiXCIsIFwiVHJhbnNhY3Rpb24gZmFpbGVkIHdpdGggZXJyb3I6XCIsIGUubWVzc2FnZSwgXCJSZXRyeWluZzpcIiwgbiksIFxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKSwgIW4pIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5kYiAmJiB0aGlzLmRiLmNsb3NlKCksIHRoaXMuZGIgPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxuICovIGNsYXNzIFB0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuVSA9IHQsIHRoaXMucSA9ICExLCB0aGlzLksgPSBudWxsO1xuICAgIH1cbiAgICBnZXQgaXNEb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xO1xuICAgIH1cbiAgICBnZXQgRygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSztcbiAgICB9XG4gICAgc2V0IGN1cnNvcih0KSB7XG4gICAgICAgIHRoaXMuVSA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBzdG9wIGl0ZXJhdGlvbiBhdCBhbnkgcG9pbnQuXG4gICAgICovICAgIGRvbmUoKSB7XG4gICAgICAgIHRoaXMucSA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc2tpcCB0byB0aGF0IG5leHQga2V5LCB3aGljaCBjb3VsZCBiZVxuICAgICAqIGFuIGluZGV4IG9yIGEgcHJpbWFyeSBrZXkuXG4gICAgICovICAgIGoodCkge1xuICAgICAgICB0aGlzLksgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIGZyb20gdGhlIG9iamVjdCBzdG9yZS5cbiAgICAgKlxuICAgICAqIE5PVEU6IFlvdSBDQU5OT1QgZG8gdGhpcyB3aXRoIGEga2V5c09ubHkgcXVlcnkuXG4gICAgICovICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIER0KHRoaXMuVS5kZWxldGUoKSk7XG4gICAgfVxufVxuXG4vKiogQW4gZXJyb3IgdGhhdCB3cmFwcyBleGNlcHRpb25zIHRoYXQgdGhyb3duIGR1cmluZyBJbmRleGVkREIgZXhlY3V0aW9uLiAqLyBjbGFzcyB2dCBleHRlbmRzIEwge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoQi5VTkFWQUlMQUJMRSwgYEluZGV4ZWREQiB0cmFuc2FjdGlvbiAnJHt0fScgZmFpbGVkOiAke2V9YCksIHRoaXMubmFtZSA9IFwiSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvclwiO1xuICAgIH1cbn1cblxuLyoqIFZlcmlmaWVzIHdoZXRoZXIgYGVgIGlzIGFuIEluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IuICovIGZ1bmN0aW9uIFZ0KHQpIHtcbiAgICAvLyBVc2UgbmFtZSBlcXVhbGl0eSwgYXMgaW5zdGFuY2VvZiBjaGVja3Mgb24gZXJyb3JzIGRvbid0IHdvcmsgd2l0aCBlcnJvcnNcbiAgICAvLyB0aGF0IHdyYXAgb3RoZXIgZXJyb3JzLlxuICAgIHJldHVybiBcIkluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3JcIiA9PT0gdC5uYW1lO1xufVxuXG4vKipcbiAqIEEgd3JhcHBlciBhcm91bmQgYW4gSURCT2JqZWN0U3RvcmUgcHJvdmlkaW5nIGFuIEFQSSB0aGF0OlxuICpcbiAqIDEpIEhhcyBnZW5lcmljIEtleVR5cGUgLyBWYWx1ZVR5cGUgcGFyYW1ldGVycyB0byBwcm92aWRlIHN0cm9uZ2x5LXR5cGVkXG4gKiBtZXRob2RzIGZvciBhY3RpbmcgYWdhaW5zdCB0aGUgb2JqZWN0IHN0b3JlLlxuICogMikgRGVhbHMgd2l0aCBJbmRleGVkREIncyBvbnN1Y2Nlc3MgLyBvbmVycm9yIGV2ZW50IGNhbGxiYWNrcywgbWFraW5nIGV2ZXJ5XG4gKiBtZXRob2QgcmV0dXJuIGEgUGVyc2lzdGVuY2VQcm9taXNlIGluc3RlYWQuXG4gKiAzKSBQcm92aWRlcyBhIGhpZ2hlci1sZXZlbCBBUEkgdG8gYXZvaWQgbmVlZGluZyB0byBkbyBleGNlc3NpdmUgd3JhcHBpbmcgb2ZcbiAqIGludGVybWVkaWF0ZSBJbmRleGVkREIgdHlwZXMgKElEQkN1cnNvcldpdGhWYWx1ZSwgZXRjLilcbiAqLyBjbGFzcyBTdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnN0b3JlID0gdDtcbiAgICB9XG4gICAgcHV0KHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgPyAoQyhcIlNpbXBsZURiXCIsIFwiUFVUXCIsIHRoaXMuc3RvcmUubmFtZSwgdCwgZSksIG4gPSB0aGlzLnN0b3JlLnB1dChlLCB0KSkgOiAoQyhcIlNpbXBsZURiXCIsIFwiUFVUXCIsIHRoaXMuc3RvcmUubmFtZSwgXCI8YXV0by1rZXk+XCIsIHQpLCBcbiAgICAgICAgbiA9IHRoaXMuc3RvcmUucHV0KHQpKSwgRHQobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgdmFsdWUgaW50byBhbiBPYmplY3QgU3RvcmUgYW5kIHJldHVybnMgdGhlIG5ldyBrZXkuIFNpbWlsYXIgdG9cbiAgICAgKiBJbmRleGVkRGIncyBgYWRkKClgLCB0aGlzIG1ldGhvZCB3aWxsIGZhaWwgb24gcHJpbWFyeSBrZXkgY29sbGlzaW9ucy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBvYmplY3QgdG8gd3JpdGUuXG4gICAgICogQHJldHVybnMgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gYWRkLlxuICAgICAqLyAgICBhZGQodCkge1xuICAgICAgICBDKFwiU2ltcGxlRGJcIiwgXCJBRERcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCB0KTtcbiAgICAgICAgcmV0dXJuIER0KHRoaXMuc3RvcmUuYWRkKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgZnJvbSB0aGUgc3BlY2lmaWVkIHN0b3JlLCBvciBudWxsXG4gICAgICogaWYgbm8gb2JqZWN0IGV4aXN0cyB3aXRoIHRoZSBzcGVjaWZpZWQga2V5LlxuICAgICAqXG4gICAgICogQGtleSBUaGUga2V5IG9mIHRoZSBvYmplY3QgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIFRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBvciBudWxsIGlmIG5vIG9iamVjdCBleGlzdHMuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIC8vIFdlJ3JlIGRvaW5nIGFuIHVuc2FmZSBjYXN0IHRvIFZhbHVlVHlwZS5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgcmV0dXJuIER0KHRoaXMuc3RvcmUuZ2V0KHQpKS5uZXh0KChlID0+IChcbiAgICAgICAgLy8gTm9ybWFsaXplIG5vbmV4aXN0ZW5jZSB0byBudWxsLlxuICAgICAgICB2b2lkIDAgPT09IGUgJiYgKGUgPSBudWxsKSwgQyhcIlNpbXBsZURiXCIsIFwiR0VUXCIsIHRoaXMuc3RvcmUubmFtZSwgdCwgZSksIGUpKSk7XG4gICAgfVxuICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIEMoXCJTaW1wbGVEYlwiLCBcIkRFTEVURVwiLCB0aGlzLnN0b3JlLm5hbWUsIHQpO1xuICAgICAgICByZXR1cm4gRHQodGhpcy5zdG9yZS5kZWxldGUodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB3ZSBldmVyIG5lZWQgbW9yZSBvZiB0aGUgY291bnQgdmFyaWFudHMsIHdlIGNhbiBhZGQgb3ZlcmxvYWRzLiBGb3Igbm93LFxuICAgICAqIGFsbCB3ZSBuZWVkIGlzIHRvIGNvdW50IGV2ZXJ5dGhpbmcgaW4gYSBzdG9yZS5cbiAgICAgKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByb3dzIGluIHRoZSBzdG9yZS5cbiAgICAgKi8gICAgY291bnQoKSB7XG4gICAgICAgIEMoXCJTaW1wbGVEYlwiLCBcIkNPVU5UXCIsIHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIHJldHVybiBEdCh0aGlzLnN0b3JlLmNvdW50KCkpO1xuICAgIH1cbiAgICBXKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMub3B0aW9ucyh0LCBlKTtcbiAgICAgICAgLy8gVXNlIGBnZXRBbGwoKWAgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgSW5kZXhlZERCIHYzLCBhcyBpdCBpcyByb3VnaGx5XG4gICAgICAgIC8vIDIwJSBmYXN0ZXIuIFVuZm9ydHVuYXRlbHksIGdldEFsbCgpIGRvZXMgbm90IHN1cHBvcnQgY3VzdG9tIGluZGljZXMuXG4gICAgICAgICAgICAgICAgaWYgKG4uaW5kZXggfHwgXCJmdW5jdGlvblwiICE9IHR5cGVvZiB0aGlzLnN0b3JlLmdldEFsbCkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuY3Vyc29yKG4pLCBlID0gW107XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5IKHQsICgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGUucHVzaChuKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3RvcmUuZ2V0QWxsKG4ucmFuZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICB0Lm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbih0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZSh0LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMgZnJvbSB0aGUgcHJvdmlkZWQgaW5kZXggcmFuZ2UuIExvYWRzIGFsbFxuICAgICAqIGVsZW1lbnRzIGlmIG5vIGxpbWl0IGlzIHByb3ZpZGVkLlxuICAgICAqLyAgICBKKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuZ2V0QWxsKHQsIG51bGwgPT09IGUgPyB2b2lkIDAgOiBlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBBdCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIG4ub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGUodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfSwgbi5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0KGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFkodCwgZSkge1xuICAgICAgICBDKFwiU2ltcGxlRGJcIiwgXCJERUxFVEUgQUxMXCIsIHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLm9wdGlvbnModCwgZSk7XG4gICAgICAgIG4uWCA9ICExO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5jdXJzb3Iobik7XG4gICAgICAgIHJldHVybiB0aGlzLkgocywgKCh0LCBlLCBuKSA9PiBuLmRlbGV0ZSgpKSk7XG4gICAgfVxuICAgIFoodCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgZSA/IG4gPSB0IDogKG4gPSB7fSwgZSA9IHQpO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5jdXJzb3Iobik7XG4gICAgICAgIHJldHVybiB0aGlzLkgocywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzdG9yZSwgYnV0IHdhaXRzIGZvciB0aGUgZ2l2ZW4gY2FsbGJhY2sgdG8gY29tcGxldGUgZm9yXG4gICAgICogZWFjaCBlbnRyeSBiZWZvcmUgaXRlcmF0aW5nIHRoZSBuZXh0IGVudHJ5LiBUaGlzIGFsbG93cyB0aGUgY2FsbGJhY2sgdG8gZG9cbiAgICAgKiBhc3luY2hyb25vdXMgd29yayB0byBkZXRlcm1pbmUgaWYgdGhpcyBpdGVyYXRpb24gc2hvdWxkIGNvbnRpbnVlLlxuICAgICAqXG4gICAgICogVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHNob3VsZCByZXR1cm4gYHRydWVgIHRvIGNvbnRpbnVlIGl0ZXJhdGlvbiwgYW5kXG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICovICAgIHR0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuY3Vyc29yKHt9KTtcbiAgICAgICAgcmV0dXJuIG5ldyBBdCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIGUub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB4dCh0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgcyhlKTtcbiAgICAgICAgICAgIH0sIGUub25zdWNjZXNzID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBzID8gdChzLnByaW1hcnlLZXksIHMudmFsdWUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0ID8gcy5jb250aW51ZSgpIDogbigpO1xuICAgICAgICAgICAgICAgIH0pKSA6IG4oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBBdCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGkodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICghaSkgcmV0dXJuIHZvaWQgcygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgUHQoaSksIG8gPSBlKGkucHJpbWFyeUtleSwgaS52YWx1ZSwgcik7XG4gICAgICAgICAgICAgICAgaWYgKG8gaW5zdGFuY2VvZiBBdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gby5jYXRjaCgodCA9PiAoci5kb25lKCksIEF0LnJlamVjdCh0KSkpKTtcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByLmlzRG9uZSA/IHMoKSA6IG51bGwgPT09IHIuRyA/IGkuY29udGludWUoKSA6IGkuY29udGludWUoci5HKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBBdC53YWl0Rm9yKG4pKSk7XG4gICAgfVxuICAgIG9wdGlvbnModCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdCAmJiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IG4gPSB0IDogZSA9IHQpLCB7XG4gICAgICAgICAgICBpbmRleDogbixcbiAgICAgICAgICAgIHJhbmdlOiBlXG4gICAgICAgIH07XG4gICAgfVxuICAgIGN1cnNvcih0KSB7XG4gICAgICAgIGxldCBlID0gXCJuZXh0XCI7XG4gICAgICAgIGlmICh0LnJldmVyc2UgJiYgKGUgPSBcInByZXZcIiksIHQuaW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnN0b3JlLmluZGV4KHQuaW5kZXgpO1xuICAgICAgICAgICAgcmV0dXJuIHQuWCA/IG4ub3BlbktleUN1cnNvcih0LnJhbmdlLCBlKSA6IG4ub3BlbkN1cnNvcih0LnJhbmdlLCBlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5vcGVuQ3Vyc29yKHQucmFuZ2UsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBXcmFwcyBhbiBJREJSZXF1ZXN0IGluIGEgUGVyc2lzdGVuY2VQcm9taXNlLCB1c2luZyB0aGUgb25zdWNjZXNzIC8gb25lcnJvclxuICogaGFuZGxlcnMgdG8gcmVzb2x2ZSAvIHJlamVjdCB0aGUgUGVyc2lzdGVuY2VQcm9taXNlIGFzIGFwcHJvcHJpYXRlLlxuICovIGZ1bmN0aW9uIER0KHQpIHtcbiAgICByZXR1cm4gbmV3IEF0KCgoZSwgbikgPT4ge1xuICAgICAgICB0Lm9uc3VjY2VzcyA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIGUobik7XG4gICAgICAgIH0sIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHh0KHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIG4oZSk7XG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vLyBHdWFyZCBzbyB3ZSBvbmx5IHJlcG9ydCB0aGUgZXJyb3Igb25jZS5cbmxldCBDdCA9ICExO1xuXG5mdW5jdGlvbiB4dCh0KSB7XG4gICAgY29uc3QgZSA9IGJ0LkQoZ2V0VUEoKSk7XG4gICAgaWYgKGUgPj0gMTIuMiAmJiBlIDwgMTMpIHtcbiAgICAgICAgY29uc3QgZSA9IFwiQW4gaW50ZXJuYWwgZXJyb3Igd2FzIGVuY291bnRlcmVkIGluIHRoZSBJbmRleGVkIERhdGFiYXNlIHNlcnZlclwiO1xuICAgICAgICBpZiAodC5tZXNzYWdlLmluZGV4T2YoZSkgPj0gMCkge1xuICAgICAgICAgICAgLy8gV3JhcCBlcnJvciBpbiBhIG1vcmUgZGVzY3JpcHRpdmUgb25lLlxuICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBMKFwiaW50ZXJuYWxcIiwgYElPU19JTkRFWEVEREJfQlVHMTogSW5kZXhlZERiIGhhcyB0aHJvd24gJyR7ZX0nLiBUaGlzIGlzIGxpa2VseSBkdWUgdG8gYW4gdW5hdm9pZGFibGUgYnVnIGluIGlPUy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuYCk7XG4gICAgICAgICAgICByZXR1cm4gQ3QgfHwgKEN0ID0gITAsIFxuICAgICAgICAgICAgLy8gVGhyb3cgYSBnbG9iYWwgZXhjZXB0aW9uIG91dHNpZGUgb2YgdGhpcyBwcm9taXNlIGNoYWluLCBmb3IgdGhlIHVzZXIgdG9cbiAgICAgICAgICAgIC8vIHBvdGVudGlhbGx5IGNhdGNoLlxuICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgICAgICB9KSwgMCkpLCB0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0O1xufVxuXG4vKiogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhlIHNjaGVkdWxpbmcgb2YgSW5kZXggQmFja2ZpbGxlci4gKi9cbmNsYXNzIE50IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IHQsIHRoaXMuZXQgPSBlLCB0aGlzLnRhc2sgPSBudWxsO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5udCgxNWUzKTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy50YXNrICYmICh0aGlzLnRhc2suY2FuY2VsKCksIHRoaXMudGFzayA9IG51bGwpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMudGFzaztcbiAgICB9XG4gICAgbnQodCkge1xuICAgICAgICBDKFwiSW5kZXhCYWNraWxsZXJcIiwgYFNjaGVkdWxlZCBpbiAke3R9bXNgKSwgdGhpcy50YXNrID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwiaW5kZXhfYmFja2ZpbGxcIiAvKiBJbmRleEJhY2tmaWxsICovICwgdCwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGFzayA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIEMoXCJJbmRleEJhY2tpbGxlclwiLCBgRG9jdW1lbnRzIHdyaXR0ZW46ICR7YXdhaXQgdGhpcy5ldC5zdCgpfWApO1xuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgIFZ0KHQpID8gQyhcIkluZGV4QmFja2lsbGVyXCIsIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBpbmRleCBiYWNrZmlsbDogXCIsIHQpIDogYXdhaXQgRXQodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm50KDZlNCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKiBJbXBsZW1lbnRzIHRoZSBzdGVwcyBmb3IgYmFja2ZpbGxpbmcgaW5kZXhlcy4gKi8gY2xhc3Mga3Qge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIExvY2FsU3RvcmUgcHJvdmlkZXMgYWNjZXNzIHRvIEluZGV4TWFuYWdlciBhbmQgTG9jYWxEb2N1bWVudFZpZXcuXG4gICAgICogVGhlc2UgcHJvcGVydGllcyB3aWxsIHVwZGF0ZSB3aGVuIHRoZSB1c2VyIGNoYW5nZXMuIENvbnNlcXVlbnRseSxcbiAgICAgKiBtYWtpbmcgYSBsb2NhbCBjb3B5IG9mIEluZGV4TWFuYWdlciBhbmQgTG9jYWxEb2N1bWVudFZpZXcgd2lsbCByZXF1aXJlXG4gICAgICogdXBkYXRlcyBvdmVyIHRpbWUuIFRoZSBzaW1wbGVyIHNvbHV0aW9uIGlzIHRvIHJlbHkgb24gTG9jYWxTdG9yZSB0byBoYXZlXG4gICAgICogYW4gdXAtdG8tZGF0ZSByZWZlcmVuY2VzIHRvIEluZGV4TWFuYWdlciBhbmQgTG9jYWxEb2N1bWVudFN0b3JlLlxuICAgICAqL1xuICAgIHQsIGUpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gdCwgdGhpcy5wZXJzaXN0ZW5jZSA9IGU7XG4gICAgfVxuICAgIGFzeW5jIHN0KHQgPSA1MCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkJhY2tmaWxsIEluZGV4ZXNcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAoZSA9PiB0aGlzLml0KGUsIHQpKSk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgaW5kZXggZW50cmllcyB1bnRpbCB0aGUgY2FwIGlzIHJlYWNoZWQuIFJldHVybnMgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgcHJvY2Vzc2VkLiAqLyAgICBpdCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgU2V0O1xuICAgICAgICBsZXQgcyA9IGUsIGkgPSAhMDtcbiAgICAgICAgcmV0dXJuIEF0LmRvV2hpbGUoKCgpID0+ICEwID09PSBpICYmIHMgPiAwKSwgKCgpID0+IHRoaXMubG9jYWxTdG9yZS5pbmRleE1hbmFnZXIuZ2V0TmV4dENvbGxlY3Rpb25Hcm91cFRvVXBkYXRlKHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUgJiYgIW4uaGFzKGUpKSByZXR1cm4gQyhcIkluZGV4QmFja2lsbGVyXCIsIGBQcm9jZXNzaW5nIGNvbGxlY3Rpb246ICR7ZX1gKSwgXG4gICAgICAgICAgICB0aGlzLnJ0KHQsIGUsIHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHMgLT0gdCwgbi5hZGQoZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBpID0gITE7XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IGUgLSBzKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyaXRlcyBlbnRyaWVzIGZvciB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBncm91cC4gUmV0dXJucyB0aGUgbnVtYmVyIG9mIGRvY3VtZW50cyBwcm9jZXNzZWQuXG4gICAgICovICAgIHJ0KHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVXNlIHRoZSBlYXJsaWVzdCBvZmZzZXQgb2YgYWxsIGZpZWxkIGluZGV4ZXMgdG8gcXVlcnkgdGhlIGxvY2FsIGNhY2hlLlxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlLmluZGV4TWFuYWdlci5nZXRNaW5PZmZzZXRGcm9tQ29sbGVjdGlvbkdyb3VwKHQsIGUpLm5leHQoKHMgPT4gdGhpcy5sb2NhbFN0b3JlLmxvY2FsRG9jdW1lbnRzLmdldE5leHREb2N1bWVudHModCwgZSwgcywgbikubmV4dCgobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gbi5jaGFuZ2VzO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZS5pbmRleE1hbmFnZXIudXBkYXRlSW5kZXhFbnRyaWVzKHQsIGkpLm5leHQoKCgpID0+IHRoaXMub3QocywgbikpKS5uZXh0KChuID0+IChDKFwiSW5kZXhCYWNraWxsZXJcIiwgYFVwZGF0aW5nIG9mZnNldDogJHtufWApLCBcbiAgICAgICAgICAgIHRoaXMubG9jYWxTdG9yZS5pbmRleE1hbmFnZXIudXBkYXRlQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4pKSkpLm5leHQoKCgpID0+IGkuc2l6ZSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdGhlIG5leHQgb2Zmc2V0IGJhc2VkIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICovICAgIG90KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSB0O1xuICAgICAgICByZXR1cm4gZS5jaGFuZ2VzLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gZ3QoZSk7XG4gICAgICAgICAgICBwdChzLCBuKSA+IDAgJiYgKG4gPSBzKTtcbiAgICAgICAgfSkpLCBuZXcgeXQobi5yZWFkVGltZSwgbi5kb2N1bWVudEtleSwgTWF0aC5tYXgoZS5iYXRjaElkLCB0Lmxhcmdlc3RCYXRjaElkKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBgTGlzdGVuU2VxdWVuY2VgIGlzIGEgbW9ub3RvbmljIHNlcXVlbmNlLiBJdCBpcyBpbml0aWFsaXplZCB3aXRoIGEgbWluaW11bSB2YWx1ZSB0b1xuICogZXhjZWVkLiBBbGwgc3Vic2VxdWVudCBjYWxscyB0byBuZXh0IHdpbGwgcmV0dXJuIGluY3JlYXNpbmcgdmFsdWVzLiBJZiBwcm92aWRlZCB3aXRoIGFcbiAqIGBTZXF1ZW5jZU51bWJlclN5bmNlcmAsIGl0IHdpbGwgYWRkaXRpb25hbGx5IGJ1bXAgaXRzIG5leHQgdmFsdWUgd2hlbiB0b2xkIG9mIGEgbmV3IHZhbHVlLCBhc1xuICogd2VsbCBhcyB3cml0ZSBvdXQgc2VxdWVuY2UgbnVtYmVycyB0aGF0IGl0IHByb2R1Y2VzIHZpYSBgbmV4dCgpYC5cbiAqLyBjbGFzcyBPdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSB0LCBlICYmIChlLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IHQgPT4gdGhpcy51dCh0KSwgdGhpcy5jdCA9IHQgPT4gZS53cml0ZVNlcXVlbmNlTnVtYmVyKHQpKTtcbiAgICB9XG4gICAgdXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlID0gTWF0aC5tYXgodCwgdGhpcy5wcmV2aW91c1ZhbHVlKSwgdGhpcy5wcmV2aW91c1ZhbHVlO1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICBjb25zdCB0ID0gKyt0aGlzLnByZXZpb3VzVmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzLmN0ICYmIHRoaXMuY3QodCksIHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gTXQodCkge1xuICAgIGxldCBlID0gMDtcbiAgICBmb3IgKGNvbnN0IG4gaW4gdCkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pICYmIGUrKztcbiAgICByZXR1cm4gZTtcbn1cblxuZnVuY3Rpb24gRnQodCwgZSkge1xuICAgIGZvciAoY29uc3QgbiBpbiB0KSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgbikgJiYgZShuLCB0W25dKTtcbn1cblxuZnVuY3Rpb24gJHQodCkge1xuICAgIGZvciAoY29uc3QgZSBpbiB0KSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIGUpKSByZXR1cm4gITE7XG4gICAgcmV0dXJuICEwO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gQW4gaW1tdXRhYmxlIHNvcnRlZCBtYXAgaW1wbGVtZW50YXRpb24sIGJhc2VkIG9uIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFja1xuLy8gdHJlZS5cbk90LmF0ID0gLTE7XG5cbmNsYXNzIEJ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IHQsIHRoaXMucm9vdCA9IGUgfHwgVXQuRU1QVFk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQgb3IgcmVwbGFjZWQuXG4gICAgaW5zZXJ0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCdCh0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdC5pbnNlcnQodCwgZSwgdGhpcy5jb21wYXJhdG9yKS5jb3B5KG51bGwsIG51bGwsIFV0LkJMQUNLLCBudWxsLCBudWxsKSk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cbiAgICByZW1vdmUodCkge1xuICAgICAgICByZXR1cm4gbmV3IEJ0KHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290LnJlbW92ZSh0LCB0aGlzLmNvbXBhcmF0b3IpLmNvcHkobnVsbCwgbnVsbCwgVXQuQkxBQ0ssIG51bGwsIG51bGwpKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsLlxuICAgIGdldCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5yb290O1xuICAgICAgICBmb3IgKDshZS5pc0VtcHR5KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29tcGFyYXRvcih0LCBlLmtleSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gbikgcmV0dXJuIGUudmFsdWU7XG4gICAgICAgICAgICBuIDwgMCA/IGUgPSBlLmxlZnQgOiBuID4gMCAmJiAoZSA9IGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCBpbiB0aGlzIHNvcnRlZCBtYXAsIG9yIC0xIGlmIGl0IGRvZXNuJ3RcbiAgICAvLyBleGlzdC5cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgLy8gTnVtYmVyIG9mIG5vZGVzIHRoYXQgd2VyZSBwcnVuZWQgd2hlbiBkZXNjZW5kaW5nIHJpZ2h0XG4gICAgICAgIGxldCBlID0gMCwgbiA9IHRoaXMucm9vdDtcbiAgICAgICAgZm9yICg7IW4uaXNFbXB0eSgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLmNvbXBhcmF0b3IodCwgbi5rZXkpO1xuICAgICAgICAgICAgaWYgKDAgPT09IHMpIHJldHVybiBlICsgbi5sZWZ0LnNpemU7XG4gICAgICAgICAgICBzIDwgMCA/IG4gPSBuLmxlZnQgOiAoXG4gICAgICAgICAgICAvLyBDb3VudCBhbGwgbm9kZXMgbGVmdCBvZiB0aGUgbm9kZSBwbHVzIHRoZSBub2RlIGl0c2VsZlxuICAgICAgICAgICAgZSArPSBuLmxlZnQuc2l6ZSArIDEsIG4gPSBuLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBOb2RlIG5vdCBmb3VuZFxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pc0VtcHR5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgbWFwLlxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgbWluS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1pbktleSgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgbWFwLlxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgIC8vIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgaW5vcmRlclRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaW5vcmRlclRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0KGUsIG4pLCAhMSkpKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0LnB1c2goYCR7ZX06JHtufWApLCAhMSkpKSwgYHske3Quam9pbihcIiwgXCIpfX1gO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzXG4gICAgLy8gYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgcmV2ZXJzZVRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QucmV2ZXJzZVRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhbiBpdGVyYXRvciBvdmVyIHRoZSBTb3J0ZWRNYXAuXG4gICAgZ2V0SXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgTHQodGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICExKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBMdCh0aGlzLnJvb3QsIHQsIHRoaXMuY29tcGFyYXRvciwgITEpO1xuICAgIH1cbiAgICBnZXRSZXZlcnNlSXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgTHQodGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG4gICAgZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgTHQodGhpcy5yb290LCB0LCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgU29ydGVkTWFwXG4vLyBBbiBpdGVyYXRvciBvdmVyIGFuIExMUkJOb2RlLlxuY2xhc3MgTHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5pc1JldmVyc2UgPSBzLCB0aGlzLm5vZGVTdGFjayA9IFtdO1xuICAgICAgICBsZXQgaSA9IDE7XG4gICAgICAgIGZvciAoOyF0LmlzRW1wdHkoKTsgKSBpZiAoaSA9IGUgPyBuKHQua2V5LCBlKSA6IDEsIFxuICAgICAgICAvLyBmbGlwIHRoZSBjb21wYXJpc29uIGlmIHdlJ3JlIGdvaW5nIGluIHJldmVyc2VcbiAgICAgICAgZSAmJiBzICYmIChpICo9IC0xKSwgaSA8IDApIFxuICAgICAgICAvLyBUaGlzIG5vZGUgaXMgbGVzcyB0aGFuIG91ciBzdGFydCBrZXkuIGlnbm9yZSBpdFxuICAgICAgICB0ID0gdGhpcy5pc1JldmVyc2UgPyB0LmxlZnQgOiB0LnJpZ2h0OyBlbHNlIHtcbiAgICAgICAgICAgIGlmICgwID09PSBpKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGV4YWN0bHkgZXF1YWwgdG8gb3VyIHN0YXJ0IGtleS4gUHVzaCBpdCBvbiB0aGUgc3RhY2ssXG4gICAgICAgICAgICAgICAgLy8gYnV0IHN0b3AgaXRlcmF0aW5nO1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2godCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZ3JlYXRlciB0aGFuIG91ciBzdGFydCBrZXksIGFkZCBpdCB0byB0aGUgc3RhY2sgYW5kIG1vdmVcbiAgICAgICAgICAgIC8vIHRvIHRoZSBuZXh0IG9uZVxuICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaCh0KSwgdCA9IHRoaXMuaXNSZXZlcnNlID8gdC5yaWdodCA6IHQubGVmdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXROZXh0KCkge1xuICAgICAgICBsZXQgdCA9IHRoaXMubm9kZVN0YWNrLnBvcCgpO1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAga2V5OiB0LmtleSxcbiAgICAgICAgICAgIHZhbHVlOiB0LnZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmlzUmV2ZXJzZSkgZm9yICh0ID0gdC5sZWZ0OyAhdC5pc0VtcHR5KCk7ICkgdGhpcy5ub2RlU3RhY2sucHVzaCh0KSwgdCA9IHQucmlnaHQ7IGVsc2UgZm9yICh0ID0gdC5yaWdodDsgIXQuaXNFbXB0eSgpOyApIHRoaXMubm9kZVN0YWNrLnB1c2godCksIFxuICAgICAgICB0ID0gdC5sZWZ0O1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgaGFzTmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubm9kZVN0YWNrLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIHBlZWsoKSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLm5vZGVTdGFjay5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5ub2RlU3RhY2tbdGhpcy5ub2RlU3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXk6IHQua2V5LFxuICAgICAgICAgICAgdmFsdWU6IHQudmFsdWVcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbiAvLyBlbmQgU29ydGVkTWFwSXRlcmF0b3Jcbi8vIFJlcHJlc2VudHMgYSBub2RlIGluIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFjayB0cmVlLlxuY2xhc3MgVXQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0LCB0aGlzLnZhbHVlID0gZSwgdGhpcy5jb2xvciA9IG51bGwgIT0gbiA/IG4gOiBVdC5SRUQsIHRoaXMubGVmdCA9IG51bGwgIT0gcyA/IHMgOiBVdC5FTVBUWSwgXG4gICAgICAgIHRoaXMucmlnaHQgPSBudWxsICE9IGkgPyBpIDogVXQuRU1QVFksIHRoaXMuc2l6ZSA9IHRoaXMubGVmdC5zaXplICsgMSArIHRoaXMucmlnaHQuc2l6ZTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgbm9kZSwgb3B0aW9uYWxseSByZXBsYWNpbmcgcGllY2VzIG9mIGl0LlxuICAgIGNvcHkodCwgZSwgbiwgcywgaSkge1xuICAgICAgICByZXR1cm4gbmV3IFV0KG51bGwgIT0gdCA/IHQgOiB0aGlzLmtleSwgbnVsbCAhPSBlID8gZSA6IHRoaXMudmFsdWUsIG51bGwgIT0gbiA/IG4gOiB0aGlzLmNvbG9yLCBudWxsICE9IHMgPyBzIDogdGhpcy5sZWZ0LCBudWxsICE9IGkgPyBpIDogdGhpcy5yaWdodCk7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSB0cmVlIGluIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZnVuY3Rpb25cbiAgICAvLyBmb3IgZWFjaCBub2RlLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgaW5vcmRlclRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZnQuaW5vcmRlclRyYXZlcnNhbCh0KSB8fCB0KHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fCB0aGlzLnJpZ2h0Lmlub3JkZXJUcmF2ZXJzYWwodCk7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBub2RlLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgcmV2ZXJzZVRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LnJldmVyc2VUcmF2ZXJzYWwodCkgfHwgdCh0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHwgdGhpcy5sZWZ0LnJldmVyc2VUcmF2ZXJzYWwodCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0gbm9kZSBpbiB0aGUgdHJlZS5cbiAgICBtaW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZnQuaXNFbXB0eSgpID8gdGhpcyA6IHRoaXMubGVmdC5taW4oKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIHRyZWUuXG4gICAgbWluS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5taW4oKS5rZXk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQuaXNFbXB0eSgpID8gdGhpcy5rZXkgOiB0aGlzLnJpZ2h0Lm1heEtleSgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlLCB3aXRoIHRoZSBrZXkvdmFsdWUgYWRkZWQuXG4gICAgaW5zZXJ0KHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSB0aGlzO1xuICAgICAgICBjb25zdCBpID0gbih0LCBzLmtleSk7XG4gICAgICAgIHJldHVybiBzID0gaSA8IDAgPyBzLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgcy5sZWZ0Lmluc2VydCh0LCBlLCBuKSwgbnVsbCkgOiAwID09PSBpID8gcy5jb3B5KG51bGwsIGUsIG51bGwsIG51bGwsIG51bGwpIDogcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIHMucmlnaHQuaW5zZXJ0KHQsIGUsIG4pKSwgXG4gICAgICAgIHMuZml4VXAoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWluKCkge1xuICAgICAgICBpZiAodGhpcy5sZWZ0LmlzRW1wdHkoKSkgcmV0dXJuIFV0LkVNUFRZO1xuICAgICAgICBsZXQgdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0LmxlZnQuaXNSZWQoKSB8fCB0LmxlZnQubGVmdC5pc1JlZCgpIHx8ICh0ID0gdC5tb3ZlUmVkTGVmdCgpKSwgdCA9IHQuY29weShudWxsLCBudWxsLCBudWxsLCB0LmxlZnQucmVtb3ZlTWluKCksIG51bGwpLCBcbiAgICAgICAgdC5maXhVcCgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQgaXRlbSByZW1vdmVkLlxuICAgIHJlbW92ZSh0LCBlKSB7XG4gICAgICAgIGxldCBuLCBzID0gdGhpcztcbiAgICAgICAgaWYgKGUodCwgcy5rZXkpIDwgMCkgcy5sZWZ0LmlzRW1wdHkoKSB8fCBzLmxlZnQuaXNSZWQoKSB8fCBzLmxlZnQubGVmdC5pc1JlZCgpIHx8IChzID0gcy5tb3ZlUmVkTGVmdCgpKSwgXG4gICAgICAgIHMgPSBzLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgcy5sZWZ0LnJlbW92ZSh0LCBlKSwgbnVsbCk7IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHMubGVmdC5pc1JlZCgpICYmIChzID0gcy5yb3RhdGVSaWdodCgpKSwgcy5yaWdodC5pc0VtcHR5KCkgfHwgcy5yaWdodC5pc1JlZCgpIHx8IHMucmlnaHQubGVmdC5pc1JlZCgpIHx8IChzID0gcy5tb3ZlUmVkUmlnaHQoKSksIFxuICAgICAgICAgICAgMCA9PT0gZSh0LCBzLmtleSkpIHtcbiAgICAgICAgICAgICAgICBpZiAocy5yaWdodC5pc0VtcHR5KCkpIHJldHVybiBVdC5FTVBUWTtcbiAgICAgICAgICAgICAgICBuID0gcy5yaWdodC5taW4oKSwgcyA9IHMuY29weShuLmtleSwgbi52YWx1ZSwgbnVsbCwgbnVsbCwgcy5yaWdodC5yZW1vdmVNaW4oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzID0gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIHMucmlnaHQucmVtb3ZlKHQsIGUpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcy5maXhVcCgpO1xuICAgIH1cbiAgICBpc1JlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3I7XG4gICAgfVxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUgYWZ0ZXIgcGVyZm9ybWluZyBhbnkgbmVlZGVkIHJvdGF0aW9ucy5cbiAgICBmaXhVcCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdC5yaWdodC5pc1JlZCgpICYmICF0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQucm90YXRlTGVmdCgpKSwgdC5sZWZ0LmlzUmVkKCkgJiYgdC5sZWZ0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQucm90YXRlUmlnaHQoKSksIFxuICAgICAgICB0LmxlZnQuaXNSZWQoKSAmJiB0LnJpZ2h0LmlzUmVkKCkgJiYgKHQgPSB0LmNvbG9yRmxpcCgpKSwgdDtcbiAgICB9XG4gICAgbW92ZVJlZExlZnQoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcy5jb2xvckZsaXAoKTtcbiAgICAgICAgcmV0dXJuIHQucmlnaHQubGVmdC5pc1JlZCgpICYmICh0ID0gdC5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIHQucmlnaHQucm90YXRlUmlnaHQoKSksIFxuICAgICAgICB0ID0gdC5yb3RhdGVMZWZ0KCksIHQgPSB0LmNvbG9yRmxpcCgpKSwgdDtcbiAgICB9XG4gICAgbW92ZVJlZFJpZ2h0KCkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuY29sb3JGbGlwKCk7XG4gICAgICAgIHJldHVybiB0LmxlZnQubGVmdC5pc1JlZCgpICYmICh0ID0gdC5yb3RhdGVSaWdodCgpLCB0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIHJvdGF0ZUxlZnQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgVXQuUkVELCBudWxsLCB0aGlzLnJpZ2h0LmxlZnQpO1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsIHRoaXMuY29sb3IsIHQsIG51bGwpO1xuICAgIH1cbiAgICByb3RhdGVSaWdodCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuY29weShudWxsLCBudWxsLCBVdC5SRUQsIHRoaXMubGVmdC5yaWdodCwgbnVsbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZnQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCBudWxsLCB0KTtcbiAgICB9XG4gICAgY29sb3JGbGlwKCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgIXRoaXMubGVmdC5jb2xvciwgbnVsbCwgbnVsbCksIGUgPSB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgIXRoaXMucmlnaHQuY29sb3IsIG51bGwsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KG51bGwsIG51bGwsICF0aGlzLmNvbG9yLCB0LCBlKTtcbiAgICB9XG4gICAgLy8gRm9yIHRlc3RpbmcuXG4gICAgY2hlY2tNYXhEZXB0aCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuY2hlY2soKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucG93KDIsIHQpIDw9IHRoaXMuc2l6ZSArIDE7XG4gICAgfVxuICAgIC8vIEluIGEgYmFsYW5jZWQgUkIgdHJlZSwgdGhlIGJsYWNrLWRlcHRoIChudW1iZXIgb2YgYmxhY2sgbm9kZXMpIGZyb20gcm9vdCB0b1xuICAgIC8vIGxlYXZlcyBpcyBlcXVhbCBvbiBib3RoIHNpZGVzLiAgVGhpcyBmdW5jdGlvbiB2ZXJpZmllcyB0aGF0IG9yIGFzc2VydHMuXG4gICAgY2hlY2soKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUmVkKCkgJiYgdGhpcy5sZWZ0LmlzUmVkKCkpIHRocm93IE8oKTtcbiAgICAgICAgaWYgKHRoaXMucmlnaHQuaXNSZWQoKSkgdGhyb3cgTygpO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5sZWZ0LmNoZWNrKCk7XG4gICAgICAgIGlmICh0ICE9PSB0aGlzLnJpZ2h0LmNoZWNrKCkpIHRocm93IE8oKTtcbiAgICAgICAgcmV0dXJuIHQgKyAodGhpcy5pc1JlZCgpID8gMCA6IDEpO1xuICAgIH1cbn1cblxuIC8vIGVuZCBMTFJCTm9kZVxuLy8gRW1wdHkgbm9kZSBpcyBzaGFyZWQgYmV0d2VlbiBhbGwgTExSQiB0cmVlcy5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5VdC5FTVBUWSA9IG51bGwsIFV0LlJFRCA9ICEwLCBVdC5CTEFDSyA9ICExO1xuXG4vLyBlbmQgTExSQkVtcHR5Tm9kZVxuVXQuRU1QVFkgPSBuZXcgXG4vLyBSZXByZXNlbnRzIGFuIGVtcHR5IG5vZGUgKGEgbGVhZiBub2RlIGluIHRoZSBSZWQtQmxhY2sgVHJlZSkuXG5jbGFzcyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgfVxuICAgIGdldCBrZXkoKSB7XG4gICAgICAgIHRocm93IE8oKTtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICB0aHJvdyBPKCk7XG4gICAgfVxuICAgIGdldCBjb2xvcigpIHtcbiAgICAgICAgdGhyb3cgTygpO1xuICAgIH1cbiAgICBnZXQgbGVmdCgpIHtcbiAgICAgICAgdGhyb3cgTygpO1xuICAgIH1cbiAgICBnZXQgcmlnaHQoKSB7XG4gICAgICAgIHRocm93IE8oKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgbm9kZS5cbiAgICBjb3B5KHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5L3ZhbHVlIGFkZGVkLlxuICAgIGluc2VydCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgVXQodCwgZSk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSB0cmVlLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IHJlbW92ZWQuXG4gICAgcmVtb3ZlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaW5vcmRlclRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgcmV2ZXJzZVRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgbWluS2V5KCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgbWF4S2V5KCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaXNSZWQoKSB7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLy8gRm9yIHRlc3RpbmcuXG4gICAgY2hlY2tNYXhEZXB0aCgpIHtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICBjaGVjaygpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU29ydGVkU2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGVsZW1lbnRzXG4gKiBpbiBvcmRlciBzcGVjaWZpZWQgYnkgdGhlIHByb3ZpZGVkIGNvbXBhcmF0b3IuXG4gKlxuICogTk9URTogaWYgcHJvdmlkZWQgY29tcGFyYXRvciByZXR1cm5zIDAgZm9yIHR3byBlbGVtZW50cywgd2UgY29uc2lkZXIgdGhlbSB0b1xuICogYmUgZXF1YWwhXG4gKi9cbmNsYXNzIHF0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IHQsIHRoaXMuZGF0YSA9IG5ldyBCdCh0aGlzLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICBoYXModCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5kYXRhLmdldCh0KTtcbiAgICB9XG4gICAgZmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWluS2V5KCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEubWF4S2V5KCk7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnNpemU7XG4gICAgfVxuICAgIGluZGV4T2YodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmluZGV4T2YodCk7XG4gICAgfVxuICAgIC8qKiBJdGVyYXRlcyBlbGVtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovICAgIGZvckVhY2godCkge1xuICAgICAgICB0aGlzLmRhdGEuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0KGUpLCAhMSkpKTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHJhbmdlWzBdICZsdDs9IGVsZW0gJmx0OyByYW5nZVsxXS4gKi8gICAgZm9yRWFjaEluUmFuZ2UodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbSh0WzBdKTtcbiAgICAgICAgZm9yICg7bi5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgcyA9IG4uZ2V0TmV4dCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29tcGFyYXRvcihzLmtleSwgdFsxXSkgPj0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgZShzLmtleSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBgZWxlbWBzIHN1Y2ggdGhhdDogc3RhcnQgJmx0Oz0gZWxlbSB1bnRpbCBmYWxzZSBpcyByZXR1cm5lZC5cbiAgICAgKi8gICAgZm9yRWFjaFdoaWxlKHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIGZvciAobiA9IHZvaWQgMCAhPT0gZSA/IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20oZSkgOiB0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKTsgbi5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgaWYgKCF0KG4uZ2V0TmV4dCgpLmtleSkpIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogRmluZHMgdGhlIGxlYXN0IGVsZW1lbnQgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIGBlbGVtYC4gKi8gICAgZmlyc3RBZnRlck9yRXF1YWwodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbSh0KTtcbiAgICAgICAgcmV0dXJuIGUuaGFzTmV4dCgpID8gZS5nZXROZXh0KCkua2V5IDogbnVsbDtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgS3QodGhpcy5kYXRhLmdldEl0ZXJhdG9yKCkpO1xuICAgIH1cbiAgICBnZXRJdGVyYXRvckZyb20odCkge1xuICAgICAgICByZXR1cm4gbmV3IEt0KHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odCkpO1xuICAgIH1cbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGFuIGVsZW1lbnQgKi8gICAgYWRkKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKHQpLmluc2VydCh0LCAhMCkpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyBhbiBlbGVtZW50ICovICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhcyh0KSA/IHRoaXMuY29weSh0aGlzLmRhdGEucmVtb3ZlKHQpKSA6IHRoaXM7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaXNFbXB0eSgpO1xuICAgIH1cbiAgICB1bmlvbldpdGgodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXM7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSBgcmVzdWx0YCBhbHdheXMgcmVmZXJzIHRvIHRoZSBsYXJnZXIgb25lIG9mIHRoZSB0d28gc2V0cy5cbiAgICAgICAgICAgICAgICByZXR1cm4gZS5zaXplIDwgdC5zaXplICYmIChlID0gdCwgdCA9IHRoaXMpLCB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZSA9IGUuYWRkKHQpO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgcXQpKSByZXR1cm4gITE7XG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IHQuc2l6ZSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCksIG4gPSB0LmRhdGEuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ZS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0TmV4dCgpLmtleSwgcyA9IG4uZ2V0TmV4dCgpLmtleTtcbiAgICAgICAgICAgIGlmICgwICE9PSB0aGlzLmNvbXBhcmF0b3IodCwgcykpIHJldHVybiAhMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0LnB1c2goZSk7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB0LnB1c2goZSkpKSwgXCJTb3J0ZWRTZXQoXCIgKyB0LnRvU3RyaW5nKCkgKyBcIilcIjtcbiAgICB9XG4gICAgY29weSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgcXQodGhpcy5jb21wYXJhdG9yKTtcbiAgICAgICAgcmV0dXJuIGUuZGF0YSA9IHQsIGU7XG4gICAgfVxufVxuXG5jbGFzcyBLdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLml0ZXIgPSB0O1xuICAgIH1cbiAgICBnZXROZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVyLmdldE5leHQoKS5rZXk7XG4gICAgfVxuICAgIGhhc05leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZXIuaGFzTmV4dCgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0d28gc29ydGVkIHNldHMgZm9yIGVxdWFsaXR5IHVzaW5nIHRoZWlyIG5hdHVyYWwgb3JkZXJpbmcuIFRoZVxuICogbWV0aG9kIGNvbXB1dGVzIHRoZSBpbnRlcnNlY3Rpb24gYW5kIGludm9rZXMgYG9uQWRkYCBmb3IgZXZlcnkgZWxlbWVudCB0aGF0XG4gKiBpcyBpbiBgYWZ0ZXJgIGJ1dCBub3QgYGJlZm9yZWAuIGBvblJlbW92ZWAgaXMgaW52b2tlZCBmb3IgZXZlcnkgZWxlbWVudCBpblxuICogYGJlZm9yZWAgYnV0IG1pc3NpbmcgZnJvbSBgYWZ0ZXJgLlxuICpcbiAqIFRoZSBtZXRob2QgY3JlYXRlcyBhIGNvcHkgb2YgYm90aCBgYmVmb3JlYCBhbmQgYGFmdGVyYCBhbmQgcnVucyBpbiBPKG4gbG9nXG4gKiBuKSwgd2hlcmUgbiBpcyB0aGUgc2l6ZSBvZiB0aGUgdHdvIGxpc3RzLlxuICpcbiAqIEBwYXJhbSBiZWZvcmUgLSBUaGUgZWxlbWVudHMgdGhhdCBleGlzdCBpbiB0aGUgb3JpZ2luYWwgc2V0LlxuICogQHBhcmFtIGFmdGVyIC0gVGhlIGVsZW1lbnRzIHRvIGRpZmYgYWdhaW5zdCB0aGUgb3JpZ2luYWwgc2V0LlxuICogQHBhcmFtIGNvbXBhcmF0b3IgLSBUaGUgY29tcGFyYXRvciBmb3IgdGhlIGVsZW1lbnRzIGluIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gKiBAcGFyYW0gb25BZGQgLSBBIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIHBhcnQgb2YgYFxuICogYWZ0ZXJgIGJ1dCBub3QgYGJlZm9yZWAuXG4gKiBAcGFyYW0gb25SZW1vdmUgLSBBIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIHBhcnQgb2ZcbiAqIGBiZWZvcmVgIGJ1dCBub3QgYGFmdGVyYC5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZXh0IGVsZW1lbnQgZnJvbSB0aGUgaXRlcmF0b3Igb3IgYHVuZGVmaW5lZGAgaWYgbm9uZSBhdmFpbGFibGUuXG4gKi9cbmZ1bmN0aW9uIEd0KHQpIHtcbiAgICByZXR1cm4gdC5oYXNOZXh0KCkgPyB0LmdldE5leHQoKSA6IHZvaWQgMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXMgYSBzZXQgb2YgZmllbGRzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcGFydGlhbGx5IHBhdGNoIGEgZG9jdW1lbnQuXG4gKiBGaWVsZE1hc2sgaXMgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIE9iamVjdFZhbHVlLlxuICogRXhhbXBsZXM6XG4gKiAgIGZvbyAtIE92ZXJ3cml0ZXMgZm9vIGVudGlyZWx5IHdpdGggdGhlIHByb3ZpZGVkIHZhbHVlLiBJZiBmb28gaXMgbm90XG4gKiAgICAgICAgIHByZXNlbnQgaW4gdGhlIGNvbXBhbmlvbiBPYmplY3RWYWx1ZSwgdGhlIGZpZWxkIGlzIGRlbGV0ZWQuXG4gKiAgIGZvby5iYXIgLSBPdmVyd3JpdGVzIG9ubHkgdGhlIGZpZWxkIGJhciBvZiB0aGUgb2JqZWN0IGZvby5cbiAqICAgICAgICAgICAgIElmIGZvbyBpcyBub3QgYW4gb2JqZWN0LCBmb28gaXMgcmVwbGFjZWQgd2l0aCBhbiBvYmplY3RcbiAqICAgICAgICAgICAgIGNvbnRhaW5pbmcgZm9vXG4gKi8gY2xhc3MgUXQge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0LCBcbiAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0aW9uIG9mIEZpZWxkTWFza1xuICAgICAgICAvLyBTb3J0IHRoZSBmaWVsZCBtYXNrIHRvIHN1cHBvcnQgYEZpZWxkTWFzay5pc0VxdWFsKClgIGFuZCBhc3NlcnQgYmVsb3cuXG4gICAgICAgIHQuc29ydCh1dC5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gbmV3IFF0KFtdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBGaWVsZE1hc2sgb2JqZWN0IHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBhZGRpbmcgYWxsIHRoZSBnaXZlblxuICAgICAqIGZpZWxkcyBwYXRocyB0byB0aGlzIGZpZWxkIG1hc2suXG4gICAgICovICAgIHVuaW9uV2l0aCh0KSB7XG4gICAgICAgIGxldCBlID0gbmV3IHF0KHV0LmNvbXBhcmF0b3IpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5maWVsZHMpIGUgPSBlLmFkZCh0KTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHQpIGUgPSBlLmFkZChuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBRdChlLnRvQXJyYXkoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgYGZpZWxkUGF0aGAgaXMgaW5jbHVkZWQgYnkgYXQgbGVhc3Qgb25lIGZpZWxkIGluIHRoaXMgZmllbGRcbiAgICAgKiBtYXNrLlxuICAgICAqXG4gICAgICogVGhpcyBpcyBhbiBPKG4pIG9wZXJhdGlvbiwgd2hlcmUgYG5gIGlzIHRoZSBzaXplIG9mIHRoZSBmaWVsZCBtYXNrLlxuICAgICAqLyAgICBjb3ZlcnModCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5maWVsZHMpIGlmIChlLmlzUHJlZml4T2YodCkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHR0KHRoaXMuZmllbGRzLCB0LmZpZWxkcywgKCh0LCBlKSA9PiB0LmlzRXF1YWwoZSkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xuLyoqIFRydWUgaWYgYW5kIG9ubHkgaWYgdGhlIEJhc2U2NCBjb252ZXJzaW9uIGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24ganQoKSB7XG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGF0b2I7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltbXV0YWJsZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBcInByb3RvXCIgYnl0ZSBzdHJpbmcuXG4gKlxuICogUHJvdG8gYnl0ZSBzdHJpbmdzIGNhbiBlaXRoZXIgYmUgQmFzZTY0LWVuY29kZWQgc3RyaW5ncyBvciBVaW50OEFycmF5cyB3aGVuXG4gKiBzZW50IG9uIHRoZSB3aXJlLiBUaGlzIGNsYXNzIGFic3RyYWN0cyBhd2F5IHRoaXMgZGlmZmVyZW50aWF0aW9uIGJ5IGhvbGRpbmdcbiAqIHRoZSBwcm90byBieXRlIHN0cmluZyBpbiBhIGNvbW1vbiBjbGFzcyB0aGF0IG11c3QgYmUgY29udmVydGVkIGludG8gYSBzdHJpbmdcbiAqIGJlZm9yZSBiZWluZyBzZW50IGFzIGEgcHJvdG8uXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyBXdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmJpbmFyeVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tQmFzZTY0U3RyaW5nKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGF0b2IodCk7XG4gICAgICAgIHJldHVybiBuZXcgV3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOyBSZW1vdmUgdGhlIGNvcHkgb2YgdGhlIGJ5dGUgc3RyaW5nIGhlcmUgYXMgdGhpcyBtZXRob2RcbiAgICAgICAgLy8gaXMgZnJlcXVlbnRseSBjYWxsZWQgZHVyaW5nIGluZGV4aW5nLlxuICAgICAgICBjb25zdCBlID0gXG4gICAgICAgIC8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYW4gVWludDhhcnJheSB0byBhIGJpbmFyeSBzdHJpbmcuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgbGV0IGUgPSBcIlwiO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgKytuKSBlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodFtuXSk7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGEgYmluYXJ5IHN0cmluZyB0byBhbiBVaW50OEFycmF5LlxuICovICh0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBXdChlKTtcbiAgICB9XG4gICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgICAgIGxldCB0ID0gMDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5leHQ6ICgpID0+IHQgPCB0aGlzLmJpbmFyeVN0cmluZy5sZW5ndGggPyB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQodCsrKSxcbiAgICAgICAgICAgICAgICBkb25lOiAhMVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdm9pZCAwLFxuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHRvQmFzZTY0KCkge1xuICAgICAgICByZXR1cm4gdCA9IHRoaXMuYmluYXJ5U3RyaW5nLCBidG9hKHQpO1xuICAgICAgICAvKiogQ29udmVydHMgYSBiaW5hcnkgc3RyaW5nIHRvIGEgQmFzZTY0IGVuY29kZWQgc3RyaW5nLiAqL1xuICAgICAgICB2YXIgdDtcbiAgICB9XG4gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZVtuXSA9IHQuY2hhckNvZGVBdChuKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgICAgIC8vIEEgUmVnRXhwIG1hdGNoaW5nIElTTyA4NjAxIFVUQyB0aW1lc3RhbXBzIHdpdGggb3B0aW9uYWwgZnJhY3Rpb24uXG4gICAgICAgICh0aGlzLmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGFwcHJveGltYXRlQnl0ZVNpemUoKSB7XG4gICAgICAgIHJldHVybiAyICogdGhpcy5iaW5hcnlTdHJpbmcubGVuZ3RoO1xuICAgIH1cbiAgICBjb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gWih0aGlzLmJpbmFyeVN0cmluZywgdC5iaW5hcnlTdHJpbmcpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJ5U3RyaW5nID09PSB0LmJpbmFyeVN0cmluZztcbiAgICB9XG59XG5cbld0LkVNUFRZX0JZVEVfU1RSSU5HID0gbmV3IFd0KFwiXCIpO1xuXG5jb25zdCB6dCA9IG5ldyBSZWdFeHAoL15cXGR7NH0tXFxkXFxkLVxcZFxcZFRcXGRcXGQ6XFxkXFxkOlxcZFxcZCg/OlxcLihcXGQrKSk/WiQvKTtcblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdmFsdWVzIGZvciBhIHRpbWVzdGFtcCB2YWx1ZSBpbnRvIGEgXCJzZWNvbmRzIGFuZFxuICogbmFub3NcIiByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBIdCh0KSB7XG4gICAgLy8gVGhlIGpzb24gaW50ZXJmYWNlIChmb3IgdGhlIGJyb3dzZXIpIHdpbGwgcmV0dXJuIGFuIGlzbyB0aW1lc3RhbXAgc3RyaW5nLFxuICAgIC8vIHdoaWxlIHRoZSBwcm90byBqcyBsaWJyYXJ5IChmb3Igbm9kZSkgd2lsbCByZXR1cm4gYVxuICAgIC8vIGdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXAgaW5zdGFuY2UuXG4gICAgaWYgKE0oISF0KSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkge1xuICAgICAgICAvLyBUaGUgZGF0ZSBzdHJpbmcgY2FuIGhhdmUgaGlnaGVyIHByZWNpc2lvbiAobmFub3MpIHRoYW4gdGhlIERhdGUgY2xhc3NcbiAgICAgICAgLy8gKG1pbGxpcyksIHNvIHdlIGRvIHNvbWUgY3VzdG9tIHBhcnNpbmcgaGVyZS5cbiAgICAgICAgLy8gUGFyc2UgdGhlIG5hbm9zIHJpZ2h0IG91dCBvZiB0aGUgc3RyaW5nLlxuICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgIGNvbnN0IG4gPSB6dC5leGVjKHQpO1xuICAgICAgICBpZiAoTSghIW4pLCBuWzFdKSB7XG4gICAgICAgICAgICAvLyBQYWQgdGhlIGZyYWN0aW9uIG91dCB0byA5IGRpZ2l0cyAobmFub3MpLlxuICAgICAgICAgICAgbGV0IHQgPSBuWzFdO1xuICAgICAgICAgICAgdCA9ICh0ICsgXCIwMDAwMDAwMDBcIikuc3Vic3RyKDAsIDkpLCBlID0gTnVtYmVyKHQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBhcnNlIHRoZSBkYXRlIHRvIGdldCB0aGUgc2Vjb25kcy5cbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IERhdGUodCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWNvbmRzOiBNYXRoLmZsb29yKHMuZ2V0VGltZSgpIC8gMWUzKSxcbiAgICAgICAgICAgIG5hbm9zOiBlXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHNlY29uZHM6IEp0KHQuc2Vjb25kcyksXG4gICAgICAgIG5hbm9zOiBKdCh0Lm5hbm9zKVxuICAgIH07XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhlIHBvc3NpYmxlIFByb3RvIHR5cGVzIGZvciBudW1iZXJzIGludG8gYSBKYXZhU2NyaXB0IG51bWJlci5cbiAqIFJldHVybnMgMCBpZiB0aGUgdmFsdWUgaXMgbm90IG51bWVyaWMuXG4gKi8gZnVuY3Rpb24gSnQodCkge1xuICAgIC8vIFRPRE8oYmpvcm5pY2spOiBIYW5kbGUgaW50NjQgZ3JlYXRlciB0aGFuIDUzIGJpdHMuXG4gICAgcmV0dXJuIFwibnVtYmVyXCIgPT0gdHlwZW9mIHQgPyB0IDogXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IE51bWJlcih0KSA6IDA7XG59XG5cbi8qKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdHlwZXMgZm9yIEJsb2JzIGludG8gYSBCeXRlU3RyaW5nLiAqLyBmdW5jdGlvbiBZdCh0KSB7XG4gICAgcmV0dXJuIFwic3RyaW5nXCIgPT0gdHlwZW9mIHQgPyBXdC5mcm9tQmFzZTY0U3RyaW5nKHQpIDogV3QuZnJvbVVpbnQ4QXJyYXkodCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBsb2NhbGx5LWFwcGxpZWQgU2VydmVyVGltZXN0YW1wLlxuICpcbiAqIFNlcnZlciBUaW1lc3RhbXBzIGFyZSBiYWNrZWQgYnkgTWFwVmFsdWVzIHRoYXQgY29udGFpbiBhbiBpbnRlcm5hbCBmaWVsZFxuICogYF9fdHlwZV9fYCB3aXRoIGEgdmFsdWUgb2YgYHNlcnZlcl90aW1lc3RhbXBgLiBUaGUgcHJldmlvdXMgdmFsdWUgYW5kIGxvY2FsXG4gKiB3cml0ZSB0aW1lIGFyZSBzdG9yZWQgaW4gaXRzIGBfX3ByZXZpb3VzX3ZhbHVlX19gIGFuZCBgX19sb2NhbF93cml0ZV90aW1lX19gXG4gKiBmaWVsZHMgcmVzcGVjdGl2ZWx5LlxuICpcbiAqIE5vdGVzOlxuICogLSBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSBpbnN0YW5jZXMgYXJlIGNyZWF0ZWQgYXMgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhXG4gKiAgIHRyYW5zZm9ybS4gVGhleSBjYW4gb25seSBleGlzdCBpbiB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50LiBUaGVyZWZvcmVcbiAqICAgdGhleSBkbyBub3QgbmVlZCB0byBiZSBwYXJzZWQgb3Igc2VyaWFsaXplZC5cbiAqIC0gV2hlbiBldmFsdWF0ZWQgbG9jYWxseSAoZS5nLiBmb3Igc25hcHNob3QuZGF0YSgpKSwgdGhleSBieSBkZWZhdWx0XG4gKiAgIGV2YWx1YXRlIHRvIGBudWxsYC4gVGhpcyBiZWhhdmlvciBjYW4gYmUgY29uZmlndXJlZCBieSBwYXNzaW5nIGN1c3RvbVxuICogICBGaWVsZFZhbHVlT3B0aW9ucyB0byB2YWx1ZSgpLlxuICogLSBXaXRoIHJlc3BlY3QgdG8gb3RoZXIgU2VydmVyVGltZXN0YW1wVmFsdWVzLCB0aGV5IHNvcnQgYnkgdGhlaXJcbiAqICAgbG9jYWxXcml0ZVRpbWUuXG4gKi8gZnVuY3Rpb24gWHQodCkge1xuICAgIHZhciBlLCBuO1xuICAgIHJldHVybiBcInNlcnZlcl90aW1lc3RhbXBcIiA9PT0gKG51bGwgPT09IChuID0gKChudWxsID09PSAoZSA9IG51bGwgPT0gdCA/IHZvaWQgMCA6IHQubWFwVmFsdWUpIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuZmllbGRzKSB8fCB7fSkuX190eXBlX18pIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4uc3RyaW5nVmFsdWUpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgU2VydmVyVGltZXN0YW1wIHByb3RvIHZhbHVlICh1c2luZyB0aGUgaW50ZXJuYWwgZm9ybWF0KS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZmllbGQgYmVmb3JlIHRoaXMgU2VydmVyVGltZXN0YW1wIHdhcyBzZXQuXG4gKlxuICogUHJlc2VydmluZyB0aGUgcHJldmlvdXMgdmFsdWVzIGFsbG93cyB0aGUgdXNlciB0byBkaXNwbGF5IHRoZSBsYXN0IHJlc29sZWRcbiAqIHZhbHVlIHVudGlsIHRoZSBiYWNrZW5kIHJlc3BvbmRzIHdpdGggdGhlIHRpbWVzdGFtcC5cbiAqL1xuZnVuY3Rpb24gWnQodCkge1xuICAgIGNvbnN0IGUgPSB0Lm1hcFZhbHVlLmZpZWxkcy5fX3ByZXZpb3VzX3ZhbHVlX187XG4gICAgcmV0dXJuIFh0KGUpID8gWnQoZSkgOiBlO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGxvY2FsIHRpbWUgYXQgd2hpY2ggdGhpcyB0aW1lc3RhbXAgd2FzIGZpcnN0IHNldC5cbiAqLyBmdW5jdGlvbiB0ZSh0KSB7XG4gICAgY29uc3QgZSA9IEh0KHQubWFwVmFsdWUuZmllbGRzLl9fbG9jYWxfd3JpdGVfdGltZV9fLnRpbWVzdGFtcFZhbHVlKTtcbiAgICByZXR1cm4gbmV3IG50KGUuc2Vjb25kcywgZS5uYW5vcyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIGVlIHtcbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RzIGEgRGF0YWJhc2VJbmZvIHVzaW5nIHRoZSBwcm92aWRlZCBob3N0LCBkYXRhYmFzZUlkIGFuZFxuICAgICAqIHBlcnNpc3RlbmNlS2V5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGFiYXNlSWQgLSBUaGUgZGF0YWJhc2UgdG8gdXNlLlxuICAgICAqIEBwYXJhbSBhcHBJZCAtIFRoZSBGaXJlYmFzZSBBcHAgSWQuXG4gICAgICogQHBhcmFtIHBlcnNpc3RlbmNlS2V5IC0gQSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhpcyBGaXJlc3RvcmUncyBsb2NhbFxuICAgICAqIHN0b3JhZ2UgKHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aGUgZGF0YWJhc2VJZCkuXG4gICAgICogQHBhcmFtIGhvc3QgLSBUaGUgRmlyZXN0b3JlIGJhY2tlbmQgaG9zdCB0byBjb25uZWN0IHRvLlxuICAgICAqIEBwYXJhbSBzc2wgLSBXaGV0aGVyIHRvIHVzZSBTU0wgd2hlbiBjb25uZWN0aW5nLlxuICAgICAqIEBwYXJhbSBmb3JjZUxvbmdQb2xsaW5nIC0gV2hldGhlciB0byB1c2UgdGhlIGZvcmNlTG9uZ1BvbGxpbmcgb3B0aW9uXG4gICAgICogd2hlbiB1c2luZyBXZWJDaGFubmVsIGFzIHRoZSBuZXR3b3JrIHRyYW5zcG9ydC5cbiAgICAgKiBAcGFyYW0gYXV0b0RldGVjdExvbmdQb2xsaW5nIC0gV2hldGhlciB0byB1c2UgdGhlIGRldGVjdEJ1ZmZlcmluZ1Byb3h5XG4gICAgICogb3B0aW9uIHdoZW4gdXNpbmcgV2ViQ2hhbm5lbCBhcyB0aGUgbmV0d29yayB0cmFuc3BvcnQuXG4gICAgICogQHBhcmFtIHVzZUZldGNoU3RyZWFtcyBXaGV0aGVyIHRvIHVzZSB0aGUgRmV0Y2ggQVBJIGluc3RlYWQgb2ZcbiAgICAgKiBYTUxIVFRQUmVxdWVzdFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gdCwgdGhpcy5hcHBJZCA9IGUsIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBuLCB0aGlzLmhvc3QgPSBzLCB0aGlzLnNzbCA9IGksIFxuICAgICAgICB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSByLCB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZyA9IG8sIHRoaXMudXNlRmV0Y2hTdHJlYW1zID0gdTtcbiAgICB9XG59XG5cbi8qKiBUaGUgZGVmYXVsdCBkYXRhYmFzZSBuYW1lIGZvciBhIHByb2plY3QuICovXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGRhdGFiYXNlIElEIGEgRmlyZXN0b3JlIGNsaWVudCBpcyBhc3NvY2lhdGVkIHdpdGguXG4gKiBAaW50ZXJuYWxcbiAqL1xuY2xhc3MgbmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wcm9qZWN0SWQgPSB0LCB0aGlzLmRhdGFiYXNlID0gZSB8fCBcIihkZWZhdWx0KVwiO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgbmUoXCJcIiwgXCJcIik7XG4gICAgfVxuICAgIGdldCBpc0RlZmF1bHREYXRhYmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiKGRlZmF1bHQpXCIgPT09IHRoaXMuZGF0YWJhc2U7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIG5lICYmIHQucHJvamVjdElkID09PSB0aGlzLnByb2plY3RJZCAmJiB0LmRhdGFiYXNlID09PSB0aGlzLmRhdGFiYXNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgYSB2YXJpYWJsZSBpcyBlaXRoZXIgdW5kZWZpbmVkIG9yIG51bGwuXG4gKi9cbmZ1bmN0aW9uIHNlKHQpIHtcbiAgICByZXR1cm4gbnVsbCA9PSB0O1xufVxuXG4vKiogUmV0dXJucyB3aGV0aGVyIHRoZSB2YWx1ZSByZXByZXNlbnRzIC0wLiAqLyBmdW5jdGlvbiBpZSh0KSB7XG4gICAgLy8gRGV0ZWN0IGlmIHRoZSB2YWx1ZSBpcyAtMC4wLiBCYXNlZCBvbiBwb2x5ZmlsbCBmcm9tXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2lzXG4gICAgcmV0dXJuIDAgPT09IHQgJiYgMSAvIHQgPT0gLTEgLyAwO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBhIHZhbHVlIGlzIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIGludGVnZXIgcmFuZ2VcbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byB0ZXN0IGZvciBiZWluZyBhbiBpbnRlZ2VyIGFuZCBpbiB0aGUgc2FmZSByYW5nZVxuICovIGZ1bmN0aW9uIHJlKHQpIHtcbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCAmJiBOdW1iZXIuaXNJbnRlZ2VyKHQpICYmICFpZSh0KSAmJiB0IDw9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSICYmIHQgPj0gTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IG9lID0ge1xuICAgIG1hcFZhbHVlOiB7XG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgX190eXBlX186IHtcbiAgICAgICAgICAgICAgICBzdHJpbmdWYWx1ZTogXCJfX21heF9fXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0sIHVlID0ge1xuICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbn07XG5cbi8qKiBFeHRyYWN0cyB0aGUgYmFja2VuZCdzIHR5cGUgb3JkZXIgZm9yIHRoZSBwcm92aWRlZCB2YWx1ZS4gKi9cbmZ1bmN0aW9uIGNlKHQpIHtcbiAgICByZXR1cm4gXCJudWxsVmFsdWVcIiBpbiB0ID8gMCAvKiBOdWxsVmFsdWUgKi8gOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCB8fCBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IDIgLyogTnVtYmVyVmFsdWUgKi8gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOiBcInN0cmluZ1ZhbHVlXCIgaW4gdCA/IDUgLyogU3RyaW5nVmFsdWUgKi8gOiBcImJ5dGVzVmFsdWVcIiBpbiB0ID8gNiAvKiBCbG9iVmFsdWUgKi8gOiBcInJlZmVyZW5jZVZhbHVlXCIgaW4gdCA/IDcgLyogUmVmVmFsdWUgKi8gOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8gOCAvKiBHZW9Qb2ludFZhbHVlICovIDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IDkgLyogQXJyYXlWYWx1ZSAqLyA6IFwibWFwVmFsdWVcIiBpbiB0ID8gWHQodCkgPyA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDogRWUodCkgPyA5MDA3MTk5MjU0NzQwOTkxIC8qIE1heFZhbHVlICovIDogMTAgLyogT2JqZWN0VmFsdWUgKi8gOiBPKCk7XG59XG5cbi8qKiBUZXN0cyBgbGVmdGAgYW5kIGByaWdodGAgZm9yIGVxdWFsaXR5IGJhc2VkIG9uIHRoZSBiYWNrZW5kIHNlbWFudGljcy4gKi8gZnVuY3Rpb24gYWUodCwgZSkge1xuICAgIGlmICh0ID09PSBlKSByZXR1cm4gITA7XG4gICAgY29uc3QgbiA9IGNlKHQpO1xuICAgIGlmIChuICE9PSBjZShlKSkgcmV0dXJuICExO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAwIC8qIE51bGxWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDkwMDcxOTkyNTQ3NDA5OTEgLyogTWF4VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gITA7XG5cbiAgICAgIGNhc2UgMSAvKiBCb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5ib29sZWFuVmFsdWUgPT09IGUuYm9vbGVhblZhbHVlO1xuXG4gICAgICBjYXNlIDQgLyogU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdGUodCkuaXNFcXVhbCh0ZShlKSk7XG5cbiAgICAgIGNhc2UgMyAvKiBUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdC50aW1lc3RhbXBWYWx1ZSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBlLnRpbWVzdGFtcFZhbHVlICYmIHQudGltZXN0YW1wVmFsdWUubGVuZ3RoID09PSBlLnRpbWVzdGFtcFZhbHVlLmxlbmd0aCkgXG4gICAgICAgICAgICAvLyBVc2Ugc3RyaW5nIGVxdWFsaXR5IGZvciBJU08gODYwMSB0aW1lc3RhbXBzXG4gICAgICAgICAgICByZXR1cm4gdC50aW1lc3RhbXBWYWx1ZSA9PT0gZS50aW1lc3RhbXBWYWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBIdCh0LnRpbWVzdGFtcFZhbHVlKSwgcyA9IEh0KGUudGltZXN0YW1wVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG4uc2Vjb25kcyA9PT0gcy5zZWNvbmRzICYmIG4ubmFub3MgPT09IHMubmFub3M7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0LnN0cmluZ1ZhbHVlID09PSBlLnN0cmluZ1ZhbHVlO1xuXG4gICAgICBjYXNlIDYgLyogQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBZdCh0LmJ5dGVzVmFsdWUpLmlzRXF1YWwoWXQoZS5ieXRlc1ZhbHVlKSk7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgNyAvKiBSZWZWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0LnJlZmVyZW5jZVZhbHVlID09PSBlLnJlZmVyZW5jZVZhbHVlO1xuXG4gICAgICBjYXNlIDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gSnQodC5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlKSA9PT0gSnQoZS5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlKSAmJiBKdCh0Lmdlb1BvaW50VmFsdWUubG9uZ2l0dWRlKSA9PT0gSnQoZS5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSk7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgMiAvKiBOdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiB0ICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gZSkgcmV0dXJuIEp0KHQuaW50ZWdlclZhbHVlKSA9PT0gSnQoZS5pbnRlZ2VyVmFsdWUpO1xuICAgICAgICAgICAgaWYgKFwiZG91YmxlVmFsdWVcIiBpbiB0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEp0KHQuZG91YmxlVmFsdWUpLCBzID0gSnQoZS5kb3VibGVWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPT09IHMgPyBpZShuKSA9PT0gaWUocykgOiBpc05hTihuKSAmJiBpc05hTihzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgfSh0LCBlKTtcblxuICAgICAgY2FzZSA5IC8qIEFycmF5VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdHQodC5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgZS5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgYWUpO1xuXG4gICAgICBjYXNlIDEwIC8qIE9iamVjdFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lm1hcFZhbHVlLmZpZWxkcyB8fCB7fSwgcyA9IGUubWFwVmFsdWUuZmllbGRzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKE10KG4pICE9PSBNdChzKSkgcmV0dXJuICExO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IGluIG4pIGlmIChuLmhhc093blByb3BlcnR5KHQpICYmICh2b2lkIDAgPT09IHNbdF0gfHwgIWFlKG5bdF0sIHNbdF0pKSkgcmV0dXJuICExO1xuICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICB9XG4gICAgICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIEFycmF5VmFsdWUgY29udGFpbnMgdGhlIHNwZWNpZmllZCBlbGVtZW50LiAqLyAodCwgZSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBPKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBoZSh0LCBlKSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gKHQudmFsdWVzIHx8IFtdKS5maW5kKCh0ID0+IGFlKHQsIGUpKSk7XG59XG5cbmZ1bmN0aW9uIGxlKHQsIGUpIHtcbiAgICBpZiAodCA9PT0gZSkgcmV0dXJuIDA7XG4gICAgY29uc3QgbiA9IGNlKHQpLCBzID0gY2UoZSk7XG4gICAgaWYgKG4gIT09IHMpIHJldHVybiBaKG4sIHMpO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAwIC8qIE51bGxWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDkwMDcxOTkyNTQ3NDA5OTEgLyogTWF4VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gMDtcblxuICAgICAgY2FzZSAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBaKHQuYm9vbGVhblZhbHVlLCBlLmJvb2xlYW5WYWx1ZSk7XG5cbiAgICAgIGNhc2UgMiAvKiBOdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gSnQodC5pbnRlZ2VyVmFsdWUgfHwgdC5kb3VibGVWYWx1ZSksIHMgPSBKdChlLmludGVnZXJWYWx1ZSB8fCBlLmRvdWJsZVZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBuIDwgcyA/IC0xIDogbiA+IHMgPyAxIDogbiA9PT0gcyA/IDAgOiBcbiAgICAgICAgICAgIC8vIG9uZSBvciBib3RoIGFyZSBOYU4uXG4gICAgICAgICAgICBpc05hTihuKSA/IGlzTmFOKHMpID8gMCA6IC0xIDogMTtcbiAgICAgICAgfSh0LCBlKTtcblxuICAgICAgY2FzZSAzIC8qIFRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZlKHQudGltZXN0YW1wVmFsdWUsIGUudGltZXN0YW1wVmFsdWUpO1xuXG4gICAgICBjYXNlIDQgLyogU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZmUodGUodCksIHRlKGUpKTtcblxuICAgICAgY2FzZSA1IC8qIFN0cmluZ1ZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIFoodC5zdHJpbmdWYWx1ZSwgZS5zdHJpbmdWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNiAvKiBCbG9iVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFl0KHQpLCBzID0gWXQoZSk7XG4gICAgICAgICAgICByZXR1cm4gbi5jb21wYXJlVG8ocyk7XG4gICAgICAgIH0odC5ieXRlc1ZhbHVlLCBlLmJ5dGVzVmFsdWUpO1xuXG4gICAgICBjYXNlIDcgLyogUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuc3BsaXQoXCIvXCIpLCBzID0gZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IG4ubGVuZ3RoICYmIHQgPCBzLmxlbmd0aDsgdCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFooblt0XSwgc1t0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFoobi5sZW5ndGgsIHMubGVuZ3RoKTtcbiAgICAgICAgfSh0LnJlZmVyZW5jZVZhbHVlLCBlLnJlZmVyZW5jZVZhbHVlKTtcblxuICAgICAgY2FzZSA4IC8qIEdlb1BvaW50VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFooSnQodC5sYXRpdHVkZSksIEp0KGUubGF0aXR1ZGUpKTtcbiAgICAgICAgICAgIGlmICgwICE9PSBuKSByZXR1cm4gbjtcbiAgICAgICAgICAgIHJldHVybiBaKEp0KHQubG9uZ2l0dWRlKSwgSnQoZS5sb25naXR1ZGUpKTtcbiAgICAgICAgfSh0Lmdlb1BvaW50VmFsdWUsIGUuZ2VvUG9pbnRWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnZhbHVlcyB8fCBbXSwgcyA9IGUudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBuLmxlbmd0aCAmJiB0IDwgcy5sZW5ndGg7ICsrdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBsZShuW3RdLCBzW3RdKTtcbiAgICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gWihuLmxlbmd0aCwgcy5sZW5ndGgpO1xuICAgICAgICB9KHQuYXJyYXlWYWx1ZSwgZS5hcnJheVZhbHVlKTtcblxuICAgICAgY2FzZSAxMCAvKiBPYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAodCA9PT0gb2UubWFwVmFsdWUgJiYgZSA9PT0gb2UubWFwVmFsdWUpIHJldHVybiAwO1xuICAgICAgICAgICAgaWYgKHQgPT09IG9lLm1hcFZhbHVlKSByZXR1cm4gMTtcbiAgICAgICAgICAgIGlmIChlID09PSBvZS5tYXBWYWx1ZSkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZmllbGRzIHx8IHt9LCBzID0gT2JqZWN0LmtleXMobiksIGkgPSBlLmZpZWxkcyB8fCB7fSwgciA9IE9iamVjdC5rZXlzKGkpO1xuICAgICAgICAgICAgLy8gRXZlbiB0aG91Z2ggTWFwVmFsdWVzIGFyZSBsaWtlbHkgc29ydGVkIGNvcnJlY3RseSBiYXNlZCBvbiB0aGVpciBpbnNlcnRpb25cbiAgICAgICAgICAgIC8vIG9yZGVyIChlLmcuIHdoZW4gcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZCksIGxvY2FsIG1vZGlmaWNhdGlvbnMgY2FuIGJyaW5nXG4gICAgICAgICAgICAvLyBlbGVtZW50cyBvdXQgb2Ygb3JkZXIuIFdlIG5lZWQgdG8gcmUtc29ydCB0aGUgZWxlbWVudHMgdG8gZW5zdXJlIHRoYXRcbiAgICAgICAgICAgIC8vIGNhbm9uaWNhbCBJRHMgYXJlIGluZGVwZW5kZW50IG9mIGluc2VydGlvbiBvcmRlci5cbiAgICAgICAgICAgIHMuc29ydCgpLCByLnNvcnQoKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcy5sZW5ndGggJiYgdCA8IHIubGVuZ3RoOyArK3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gWihzW3RdLCByW3RdKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGxlKG5bc1t0XV0sIGlbclt0XV0pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSBvKSByZXR1cm4gbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBaKHMubGVuZ3RoLCByLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBHZW5lcmF0ZXMgdGhlIGNhbm9uaWNhbCBJRCBmb3IgdGhlIHByb3ZpZGVkIGZpZWxkIHZhbHVlIChhcyB1c2VkIGluIFRhcmdldFxuICogc2VyaWFsaXphdGlvbikuXG4gKi8gKHQubWFwVmFsdWUsIGUubWFwVmFsdWUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBPKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmZSh0LCBlKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSAmJiB0Lmxlbmd0aCA9PT0gZS5sZW5ndGgpIHJldHVybiBaKHQsIGUpO1xuICAgIGNvbnN0IG4gPSBIdCh0KSwgcyA9IEh0KGUpLCBpID0gWihuLnNlY29uZHMsIHMuc2Vjb25kcyk7XG4gICAgcmV0dXJuIDAgIT09IGkgPyBpIDogWihuLm5hbm9zLCBzLm5hbm9zKTtcbn1cblxuZnVuY3Rpb24gZGUodCkge1xuICAgIHJldHVybiBfZSh0KTtcbn1cblxuZnVuY3Rpb24gX2UodCkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIHQgPyBcIm51bGxcIiA6IFwiYm9vbGVhblZhbHVlXCIgaW4gdCA/IFwiXCIgKyB0LmJvb2xlYW5WYWx1ZSA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCA/IFwiXCIgKyB0LmludGVnZXJWYWx1ZSA6IFwiZG91YmxlVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuZG91YmxlVmFsdWUgOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEh0KHQpO1xuICAgICAgICByZXR1cm4gYHRpbWUoJHtlLnNlY29uZHN9LCR7ZS5uYW5vc30pYDtcbiAgICB9KHQudGltZXN0YW1wVmFsdWUpIDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB0LnN0cmluZ1ZhbHVlIDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IFl0KHQuYnl0ZXNWYWx1ZSkudG9CYXNlNjQoKSA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiB0ID8gKG4gPSB0LnJlZmVyZW5jZVZhbHVlLCBcbiAgICBjdC5mcm9tTmFtZShuKS50b1N0cmluZygpKSA6IFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQgPyBgZ2VvKCR7KGUgPSB0Lmdlb1BvaW50VmFsdWUpLmxhdGl0dWRlfSwke2UubG9uZ2l0dWRlfSlgIDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIltcIiwgbiA9ICEwO1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdC52YWx1ZXMgfHwgW10pIG4gPyBuID0gITEgOiBlICs9IFwiLFwiLCBlICs9IF9lKHMpO1xuICAgICAgICByZXR1cm4gZSArIFwiXVwiO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHJlZmVyZW5jZSB2YWx1ZSBmb3IgdGhlIHByb3ZpZGVkIGRhdGFiYXNlIGFuZCBrZXkuICovICh0LmFycmF5VmFsdWUpIDogXCJtYXBWYWx1ZVwiIGluIHQgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIC8vIEl0ZXJhdGlvbiBvcmRlciBpbiBKYXZhU2NyaXB0IGlzIG5vdCBndWFyYW50ZWVkLiBUbyBlbnN1cmUgdGhhdCB3ZSBnZW5lcmF0ZVxuICAgICAgICAvLyBtYXRjaGluZyBjYW5vbmljYWwgSURzIGZvciBpZGVudGljYWwgbWFwcywgd2UgbmVlZCB0byBzb3J0IHRoZSBrZXlzLlxuICAgICAgICBjb25zdCBlID0gT2JqZWN0LmtleXModC5maWVsZHMgfHwge30pLnNvcnQoKTtcbiAgICAgICAgbGV0IG4gPSBcIntcIiwgcyA9ICEwO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZSkgcyA/IHMgPSAhMSA6IG4gKz0gXCIsXCIsIG4gKz0gYCR7aX06JHtfZSh0LmZpZWxkc1tpXSl9YDtcbiAgICAgICAgcmV0dXJuIG4gKyBcIn1cIjtcbiAgICB9KHQubWFwVmFsdWUpIDogTygpO1xuICAgIHZhciBlLCBuO1xufVxuXG5mdW5jdGlvbiB3ZSh0LCBlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVmZXJlbmNlVmFsdWU6IGBwcm9qZWN0cy8ke3QucHJvamVjdElkfS9kYXRhYmFzZXMvJHt0LmRhdGFiYXNlfS9kb2N1bWVudHMvJHtlLnBhdGguY2Fub25pY2FsU3RyaW5nKCl9YFxuICAgIH07XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhbiBJbnRlZ2VyVmFsdWUgLiAqLyBmdW5jdGlvbiBtZSh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImludGVnZXJWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIERvdWJsZVZhbHVlLiAqL1xuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGFuIEFycmF5VmFsdWUuICovXG5mdW5jdGlvbiBnZSh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImFycmF5VmFsdWVcIiBpbiB0O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBOdWxsVmFsdWUuICovIGZ1bmN0aW9uIHllKHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwibnVsbFZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIE5hTi4gKi8gZnVuY3Rpb24gcGUodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJkb3VibGVWYWx1ZVwiIGluIHQgJiYgaXNOYU4oTnVtYmVyKHQuZG91YmxlVmFsdWUpKTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgTWFwVmFsdWUuICovIGZ1bmN0aW9uIEllKHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwibWFwVmFsdWVcIiBpbiB0O1xufVxuXG4vKiogQ3JlYXRlcyBhIGRlZXAgY29weSBvZiBgc291cmNlYC4gKi8gZnVuY3Rpb24gVGUodCkge1xuICAgIGlmICh0Lmdlb1BvaW50VmFsdWUpIHJldHVybiB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IE9iamVjdC5hc3NpZ24oe30sIHQuZ2VvUG9pbnRWYWx1ZSlcbiAgICB9O1xuICAgIGlmICh0LnRpbWVzdGFtcFZhbHVlICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQudGltZXN0YW1wVmFsdWUpIHJldHVybiB7XG4gICAgICAgIHRpbWVzdGFtcFZhbHVlOiBPYmplY3QuYXNzaWduKHt9LCB0LnRpbWVzdGFtcFZhbHVlKVxuICAgIH07XG4gICAgaWYgKHQubWFwVmFsdWUpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiB7fVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRnQodC5tYXBWYWx1ZS5maWVsZHMsICgodCwgbikgPT4gZS5tYXBWYWx1ZS5maWVsZHNbdF0gPSBUZShuKSkpLCBlO1xuICAgIH1cbiAgICBpZiAodC5hcnJheVZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgdmFsdWVzOiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8ICh0LmFycmF5VmFsdWUudmFsdWVzIHx8IFtdKS5sZW5ndGg7ICsrbikgZS5hcnJheVZhbHVlLnZhbHVlc1tuXSA9IFRlKHQuYXJyYXlWYWx1ZS52YWx1ZXNbbl0pO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHQpO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIHRoZSBWYWx1ZSByZXByZXNlbnRzIHRoZSBjYW5vbmljYWwge0BsaW5rICNNQVhfVkFMVUV9IC4gKi8gZnVuY3Rpb24gRWUodCkge1xuICAgIHJldHVybiBcIl9fbWF4X19cIiA9PT0gKCgodC5tYXBWYWx1ZSB8fCB7fSkuZmllbGRzIHx8IHt9KS5fX3R5cGVfXyB8fCB7fSkuc3RyaW5nVmFsdWU7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBsb3dlc3QgdmFsdWUgZm9yIHRoZSBnaXZlbiB2YWx1ZSB0eXBlIChpbmNsdXNpdmUpLiAqLyBmdW5jdGlvbiBBZSh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IHVlIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBib29sZWFuVmFsdWU6ICExXG4gICAgfSA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCB8fCBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgIH0gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgIHNlY29uZHM6IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXG4gICAgICAgIH1cbiAgICB9IDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIHN0cmluZ1ZhbHVlOiBcIlwiXG4gICAgfSA6IFwiYnl0ZXNWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGJ5dGVzVmFsdWU6IFwiXCJcbiAgICB9IDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyB3ZShuZS5lbXB0eSgpLCBjdC5lbXB0eSgpKSA6IFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiAtOTAsXG4gICAgICAgICAgICBsb25naXR1ZGU6IC0xODBcbiAgICAgICAgfVxuICAgIH0gOiBcImFycmF5VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgIH0gOiBcIm1hcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgfSA6IE8oKTtcbn1cblxuLyoqIFJldHVybnMgdGhlIGxhcmdlc3QgdmFsdWUgZm9yIHRoZSBnaXZlbiB2YWx1ZSB0eXBlIChleGNsdXNpdmUpLiAqLyBmdW5jdGlvbiBSZSh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgYm9vbGVhblZhbHVlOiAhMVxuICAgIH0gOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICB9IDogXCJpbnRlZ2VyVmFsdWVcIiBpbiB0IHx8IFwiZG91YmxlVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgc2Vjb25kczogTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJcbiAgICAgICAgfVxuICAgIH0gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgc3RyaW5nVmFsdWU6IFwiXCJcbiAgICB9IDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGJ5dGVzVmFsdWU6IFwiXCJcbiAgICB9IDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IHdlKG5lLmVtcHR5KCksIGN0LmVtcHR5KCkpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiAtOTAsXG4gICAgICAgICAgICBsb25naXR1ZGU6IC0xODBcbiAgICAgICAgfVxuICAgIH0gOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgIH0gOiBcImFycmF5VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBtYXBWYWx1ZToge31cbiAgICB9IDogXCJtYXBWYWx1ZVwiIGluIHQgPyBvZSA6IE8oKTtcbn1cblxuZnVuY3Rpb24gYmUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBsZSh0LnZhbHVlLCBlLnZhbHVlKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiB0LmluY2x1c2l2ZSAmJiAhZS5pbmNsdXNpdmUgPyAtMSA6ICF0LmluY2x1c2l2ZSAmJiBlLmluY2x1c2l2ZSA/IDEgOiAwO1xufVxuXG5mdW5jdGlvbiBQZSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGxlKHQudmFsdWUsIGUudmFsdWUpO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IHQuaW5jbHVzaXZlICYmICFlLmluY2x1c2l2ZSA/IDEgOiAhdC5pbmNsdXNpdmUgJiYgZS5pbmNsdXNpdmUgPyAtMSA6IDA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIE9iamVjdFZhbHVlIHJlcHJlc2VudHMgYSBNYXBWYWx1ZSBpbiB0aGUgRmlyZXN0b3JlIFByb3RvIGFuZCBvZmZlcnMgdGhlXG4gKiBhYmlsaXR5IHRvIGFkZCBhbmQgcmVtb3ZlIGZpZWxkcyAodmlhIHRoZSBPYmplY3RWYWx1ZUJ1aWxkZXIpLlxuICovIGNsYXNzIHZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgdmUoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgZ2l2ZW4gcGF0aCBvciBudWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSB0aGUgcGF0aCB0byBzZWFyY2hcbiAgICAgKiBAcmV0dXJucyBUaGUgdmFsdWUgYXQgdGhlIHBhdGggb3IgbnVsbCBpZiB0aGUgcGF0aCBpcyBub3Qgc2V0LlxuICAgICAqLyAgICBmaWVsZCh0KSB7XG4gICAgICAgIGlmICh0LmlzRW1wdHkoKSkgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGggLSAxOyArK24pIGlmIChlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0LmdldChuKV0sIFxuICAgICAgICAgICAgIUllKGUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0Lmxhc3RTZWdtZW50KCldLCBlIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZmllbGQgdG8gdGhlIHByb3ZpZGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmllbGQgcGF0aCB0byBzZXQuXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHNNYXAodC5wb3BMYXN0KCkpW3QubGFzdFNlZ21lbnQoKV0gPSBUZShlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvdmlkZWQgZmllbGRzIHRvIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgbWFwIG9mIGZpZWxkcyB0byB2YWx1ZXMgKG9yIG51bGwgZm9yIGRlbGV0ZXMpLlxuICAgICAqLyAgICBzZXRBbGwodCkge1xuICAgICAgICBsZXQgZSA9IHV0LmVtcHR5UGF0aCgpLCBuID0ge30sIHMgPSBbXTtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlLmlzSW1tZWRpYXRlUGFyZW50T2YoaSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYXQgdGhpcyBwYXJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUNoYW5nZXModCwgbiwgcyksIG4gPSB7fSwgcyA9IFtdLCBlID0gaS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ID8gbltpLmxhc3RTZWdtZW50KCldID0gVGUodCkgOiBzLnB1c2goaS5sYXN0U2VnbWVudCgpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKGksIG4sIHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBmaWVsZCBhdCB0aGUgc3BlY2lmaWVkIHBhdGguIElmIHRoZXJlIGlzIG5vIGZpZWxkIGF0IHRoZVxuICAgICAqIHNwZWNpZmllZCBwYXRoLCBub3RoaW5nIGlzIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmaWVsZCBwYXRoIHRvIHJlbW92ZS5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZmllbGQodC5wb3BMYXN0KCkpO1xuICAgICAgICBJZShlKSAmJiBlLm1hcFZhbHVlLmZpZWxkcyAmJiBkZWxldGUgZS5tYXBWYWx1ZS5maWVsZHNbdC5sYXN0U2VnbWVudCgpXTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiBhZSh0aGlzLnZhbHVlLCB0LnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWFwIHRoYXQgY29udGFpbnMgdGhlIGxlYWYgZWxlbWVudCBvZiBgcGF0aGAuIElmIHRoZSBwYXJlbnRcbiAgICAgKiBlbnRyeSBkb2VzIG5vdCB5ZXQgZXhpc3QsIG9yIGlmIGl0IGlzIG5vdCBhIG1hcCwgYSBuZXcgbWFwIHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKi8gICAgZ2V0RmllbGRzTWFwKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnZhbHVlO1xuICAgICAgICBlLm1hcFZhbHVlLmZpZWxkcyB8fCAoZS5tYXBWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgbGV0IHMgPSBlLm1hcFZhbHVlLmZpZWxkc1t0LmdldChuKV07XG4gICAgICAgICAgICBJZShzKSAmJiBzLm1hcFZhbHVlLmZpZWxkcyB8fCAocyA9IHtcbiAgICAgICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZS5tYXBWYWx1ZS5maWVsZHNbdC5nZXQobildID0gcyksIGUgPSBzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlLm1hcFZhbHVlLmZpZWxkcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgYGZpZWxkc01hcGAgYnkgYWRkaW5nLCByZXBsYWNpbmcgb3IgZGVsZXRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGFwcGx5Q2hhbmdlcyh0LCBlLCBuKSB7XG4gICAgICAgIEZ0KGUsICgoZSwgbikgPT4gdFtlXSA9IG4pKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIG4pIGRlbGV0ZSB0W2VdO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB2ZShUZSh0aGlzLnZhbHVlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaWVsZE1hc2sgYnVpbHQgZnJvbSBhbGwgZmllbGRzIGluIGEgTWFwVmFsdWUuXG4gKi8gZnVuY3Rpb24gVmUodCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gRnQodC5maWVsZHMsICgodCwgbikgPT4ge1xuICAgICAgICBjb25zdCBzID0gbmV3IHV0KFsgdCBdKTtcbiAgICAgICAgaWYgKEllKG4pKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gVmUobi5tYXBWYWx1ZSkuZmllbGRzO1xuICAgICAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSBcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHRoZSBlbXB0eSBtYXAgYnkgYWRkaW5nIGl0IHRvIHRoZSBGaWVsZE1hc2suXG4gICAgICAgICAgICBlLnB1c2gocyk7IGVsc2UgXG4gICAgICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxlYWYgbm9kZXMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZS5wdXNoKHMuY2hpbGQobikpO1xuICAgICAgICB9IGVsc2UgXG4gICAgICAgIC8vIEZvciBuZXN0ZWQgYW5kIG5vbi1lbXB0eSBPYmplY3RWYWx1ZXMsIGFkZCB0aGUgRmllbGRQYXRoIG9mIHRoZSBsZWFmXG4gICAgICAgIC8vIG5vZGVzLlxuICAgICAgICBlLnB1c2gocyk7XG4gICAgfSkpLCBuZXcgUXQoZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUgd2l0aCBhIGtleSwgdmVyc2lvbiwgZGF0YSBhbmQgd2hldGhlciBpdFxuICogaGFzIGxvY2FsIG11dGF0aW9ucyBhcHBsaWVkIHRvIGl0LlxuICpcbiAqIERvY3VtZW50cyBjYW4gdHJhbnNpdGlvbiBiZXR3ZWVuIHN0YXRlcyB2aWEgYGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoKWAsXG4gKiBgY29udmVydFRvTm9Eb2N1bWVudCgpYCBhbmQgYGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCgpYC4gSWYgYSBkb2N1bWVudCBkb2VzXG4gKiBub3QgdHJhbnNpdGlvbiB0byBvbmUgb2YgdGhlc2Ugc3RhdGVzIGV2ZW4gYWZ0ZXIgYWxsIG11dGF0aW9ucyBoYXZlIGJlZW5cbiAqIGFwcGxpZWQsIGBpc1ZhbGlkRG9jdW1lbnQoKWAgcmV0dXJucyBmYWxzZSBhbmQgdGhlIGRvY3VtZW50IHNob3VsZCBiZSByZW1vdmVkXG4gKiBmcm9tIGFsbCB2aWV3cy5cbiAqLyBjbGFzcyBTZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gZSwgdGhpcy52ZXJzaW9uID0gbiwgdGhpcy5yZWFkVGltZSA9IHMsIHRoaXMuZGF0YSA9IGksIFxuICAgICAgICB0aGlzLmRvY3VtZW50U3RhdGUgPSByO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZG9jdW1lbnQgd2l0aCBubyBrbm93biB2ZXJzaW9uIG9yIGRhdGEsIGJ1dCB3aGljaCBjYW4gc2VydmUgYXNcbiAgICAgKiBiYXNlIGRvY3VtZW50IGZvciBtdXRhdGlvbnMuXG4gICAgICovICAgIHN0YXRpYyBuZXdJbnZhbGlkRG9jdW1lbnQodCkge1xuICAgICAgICByZXR1cm4gbmV3IFNlKHQsIDAgLyogSU5WQUxJRCAqLyAsIHN0Lm1pbigpLCBzdC5taW4oKSwgdmUuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3Qgd2l0aCB0aGUgZ2l2ZW4gZGF0YSBhdCB0aGVcbiAgICAgKiBnaXZlbiB2ZXJzaW9uLlxuICAgICAqLyAgICBzdGF0aWMgbmV3Rm91bmREb2N1bWVudCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2UodCwgMSAvKiBGT1VORF9ET0NVTUVOVCAqLyAsIGUsIHN0Lm1pbigpLCBuLCAwIC8qIFNZTkNFRCAqLyk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gbm90IGV4aXN0IGF0IHRoZSBnaXZlbiB2ZXJzaW9uLiAqLyAgICBzdGF0aWMgbmV3Tm9Eb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2UodCwgMiAvKiBOT19ET0NVTUVOVCAqLyAsIGUsIHN0Lm1pbigpLCB2ZS5lbXB0eSgpLCAwIC8qIFNZTkNFRCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCBhdCB0aGUgZ2l2ZW4gdmVyc2lvbiBidXRcbiAgICAgKiB3aG9zZSBkYXRhIGlzIG5vdCBrbm93biAoZS5nLiBhIGRvY3VtZW50IHRoYXQgd2FzIHVwZGF0ZWQgd2l0aG91dCBhIGtub3duXG4gICAgICogYmFzZSBkb2N1bWVudCkuXG4gICAgICovICAgIHN0YXRpYyBuZXdVbmtub3duRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IFNlKHQsIDMgLyogVU5LTk9XTl9ET0NVTUVOVCAqLyAsIGUsIHN0Lm1pbigpLCB2ZS5lbXB0eSgpLCAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgZG9jdW1lbnQgdHlwZSB0byBpbmRpY2F0ZSB0aGF0IGl0IGV4aXN0cyBhbmQgdGhhdCBpdHMgdmVyc2lvblxuICAgICAqIGFuZCBkYXRhIGFyZSBrbm93bi5cbiAgICAgKi8gICAgY29udmVydFRvRm91bmREb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDEgLyogRk9VTkRfRE9DVU1FTlQgKi8gLCB0aGlzLmRhdGEgPSBlLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBTWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZG9lc24ndCBleGlzdCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqLyAgICBjb252ZXJ0VG9Ob0RvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMiAvKiBOT19ET0NVTUVOVCAqLyAsIHRoaXMuZGF0YSA9IHZlLmVtcHR5KCksIFxuICAgICAgICB0aGlzLmRvY3VtZW50U3RhdGUgPSAwIC8qIFNZTkNFRCAqLyAsIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYXQgYSBnaXZlbiB2ZXJzaW9uIGJ1dFxuICAgICAqIHRoYXQgaXRzIGRhdGEgaXMgbm90IGtub3duIChlLmcuIGEgZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd25cbiAgICAgKiBiYXNlIGRvY3VtZW50KS5cbiAgICAgKi8gICAgY29udmVydFRvVW5rbm93bkRvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gdmUuZW1wdHkoKSwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gLCB0aGlzO1xuICAgIH1cbiAgICBzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gLCB0aGlzLnZlcnNpb24gPSBzdC5taW4oKSwgXG4gICAgICAgIHRoaXM7XG4gICAgfVxuICAgIHNldFJlYWRUaW1lKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVhZFRpbWUgPSB0LCB0aGlzO1xuICAgIH1cbiAgICBnZXQgaGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc0NvbW1pdHRlZE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0xvY2FsTXV0YXRpb25zIHx8IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xuICAgIH1cbiAgICBpc1ZhbGlkRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAwIC8qIElOVkFMSUQgKi8gIT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc0ZvdW5kRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEZPVU5EX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNOb0RvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMiAvKiBOT19ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzVW5rbm93bkRvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgU2UgJiYgdGhpcy5rZXkuaXNFcXVhbCh0LmtleSkgJiYgdGhpcy52ZXJzaW9uLmlzRXF1YWwodC52ZXJzaW9uKSAmJiB0aGlzLmRvY3VtZW50VHlwZSA9PT0gdC5kb2N1bWVudFR5cGUgJiYgdGhpcy5kb2N1bWVudFN0YXRlID09PSB0LmRvY3VtZW50U3RhdGUgJiYgdGhpcy5kYXRhLmlzRXF1YWwodC5kYXRhKTtcbiAgICB9XG4gICAgbXV0YWJsZUNvcHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgU2UodGhpcy5rZXksIHRoaXMuZG9jdW1lbnRUeXBlLCB0aGlzLnZlcnNpb24sIHRoaXMucmVhZFRpbWUsIHRoaXMuZGF0YS5jbG9uZSgpLCB0aGlzLmRvY3VtZW50U3RhdGUpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBEb2N1bWVudCgke3RoaXMua2V5fSwgJHt0aGlzLnZlcnNpb259LCAke0pTT04uc3RyaW5naWZ5KHRoaXMuZGF0YS52YWx1ZSl9LCB7ZG9jdW1lbnRUeXBlOiAke3RoaXMuZG9jdW1lbnRUeXBlfX0pLCB7ZG9jdW1lbnRTdGF0ZTogJHt0aGlzLmRvY3VtZW50U3RhdGV9fSlgO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0aGUgdmFsdWUgZm9yIGZpZWxkIGBmaWVsZGAgaW4gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gVGhyb3dzIGlmXG4gKiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QgaW4gYm90aCBkb2N1bWVudHMuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyBEZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5vcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgdGhpcy5saW1pdCA9IGksIFxuICAgICAgICB0aGlzLnN0YXJ0QXQgPSByLCB0aGlzLmVuZEF0ID0gbywgdGhpcy5odCA9IG51bGw7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGEgVGFyZ2V0IHdpdGggYSBwYXRoIGFuZCBvcHRpb25hbCBhZGRpdGlvbmFsIHF1ZXJ5IGNvbnN0cmFpbnRzLlxuICogUGF0aCBtdXN0IGN1cnJlbnRseSBiZSBlbXB0eSBpZiB0aGlzIGlzIGEgY29sbGVjdGlvbiBncm91cCBxdWVyeS5cbiAqXG4gKiBOT1RFOiB5b3Ugc2hvdWxkIGFsd2F5cyBjb25zdHJ1Y3QgYFRhcmdldGAgZnJvbSBgUXVlcnkudG9UYXJnZXRgIGluc3RlYWQgb2ZcbiAqIHVzaW5nIHRoaXMgZmFjdG9yeSBtZXRob2QsIGJlY2F1c2UgYFF1ZXJ5YCBwcm92aWRlcyBhbiBpbXBsaWNpdCBgb3JkZXJCeWBcbiAqIHByb3BlcnR5LlxuICovIGZ1bmN0aW9uIENlKHQsIGUgPSBudWxsLCBuID0gW10sIHMgPSBbXSwgaSA9IG51bGwsIHIgPSBudWxsLCBvID0gbnVsbCkge1xuICAgIHJldHVybiBuZXcgRGUodCwgZSwgbiwgcywgaSwgciwgbyk7XG59XG5cbmZ1bmN0aW9uIHhlKHQpIHtcbiAgICBjb25zdCBlID0gJCh0KTtcbiAgICBpZiAobnVsbCA9PT0gZS5odCkge1xuICAgICAgICBsZXQgdCA9IGUucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgbnVsbCAhPT0gZS5jb2xsZWN0aW9uR3JvdXAgJiYgKHQgKz0gXCJ8Y2c6XCIgKyBlLmNvbGxlY3Rpb25Hcm91cCksIHQgKz0gXCJ8ZjpcIiwgdCArPSBlLmZpbHRlcnMubWFwKCh0ID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoZSA9IHQpLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgZS5vcC50b1N0cmluZygpICsgZGUoZS52YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZTtcbiAgICAgICAgfSkpLmpvaW4oXCIsXCIpLCB0ICs9IFwifG9iOlwiLCB0ICs9IGUub3JkZXJCeS5tYXAoKHQgPT4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogTWFrZSB0aGlzIGNvbGxpc2lvbiByb2J1c3QuXG4gICAgICAgICAgICByZXR1cm4gdC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHQuZGlyO1xuICAgICAgICB9KHQpKSkuam9pbihcIixcIiksIHNlKGUubGltaXQpIHx8ICh0ICs9IFwifGw6XCIsIHQgKz0gZS5saW1pdCksIGUuc3RhcnRBdCAmJiAodCArPSBcInxsYjpcIiwgXG4gICAgICAgIHQgKz0gZS5zdGFydEF0LmluY2x1c2l2ZSA/IFwiYjpcIiA6IFwiYTpcIiwgdCArPSBlLnN0YXJ0QXQucG9zaXRpb24ubWFwKCh0ID0+IGRlKHQpKSkuam9pbihcIixcIikpLCBcbiAgICAgICAgZS5lbmRBdCAmJiAodCArPSBcInx1YjpcIiwgdCArPSBlLmVuZEF0LmluY2x1c2l2ZSA/IFwiYTpcIiA6IFwiYjpcIiwgdCArPSBlLmVuZEF0LnBvc2l0aW9uLm1hcCgodCA9PiBkZSh0KSkpLmpvaW4oXCIsXCIpKSwgXG4gICAgICAgIGUuaHQgPSB0O1xuICAgIH1cbiAgICByZXR1cm4gZS5odDtcbn1cblxuZnVuY3Rpb24gTmUodCkge1xuICAgIGxldCBlID0gdC5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xuICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAoZSArPSBcIiBjb2xsZWN0aW9uR3JvdXA9XCIgKyB0LmNvbGxlY3Rpb25Hcm91cCksIFxuICAgIHQuZmlsdGVycy5sZW5ndGggPiAwICYmIChlICs9IGAsIGZpbHRlcnM6IFske3QuZmlsdGVycy5tYXAoKHQgPT4ge1xuICAgICAgICByZXR1cm4gYCR7KGUgPSB0KS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKX0gJHtlLm9wfSAke2RlKGUudmFsdWUpfWA7XG4gICAgICAgIC8qKiBSZXR1cm5zIGEgZGVidWcgZGVzY3JpcHRpb24gZm9yIGBmaWx0ZXJgLiAqL1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyAoaS5lLiAnX19uYW1lX18nKS4gKi8gICAgfSkpLmpvaW4oXCIsIFwiKX1dYCksIFxuICAgIHNlKHQubGltaXQpIHx8IChlICs9IFwiLCBsaW1pdDogXCIgKyB0LmxpbWl0KSwgdC5vcmRlckJ5Lmxlbmd0aCA+IDAgJiYgKGUgKz0gYCwgb3JkZXJCeTogWyR7dC5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBgJHt0LmZpZWxkLmNhbm9uaWNhbFN0cmluZygpfSAoJHt0LmRpcn0pYDtcbiAgICB9KHQpKSkuam9pbihcIiwgXCIpfV1gKSwgdC5zdGFydEF0ICYmIChlICs9IFwiLCBzdGFydEF0OiBcIiwgZSArPSB0LnN0YXJ0QXQuaW5jbHVzaXZlID8gXCJiOlwiIDogXCJhOlwiLCBcbiAgICBlICs9IHQuc3RhcnRBdC5wb3NpdGlvbi5tYXAoKHQgPT4gZGUodCkpKS5qb2luKFwiLFwiKSksIHQuZW5kQXQgJiYgKGUgKz0gXCIsIGVuZEF0OiBcIiwgXG4gICAgZSArPSB0LmVuZEF0LmluY2x1c2l2ZSA/IFwiYTpcIiA6IFwiYjpcIiwgZSArPSB0LmVuZEF0LnBvc2l0aW9uLm1hcCgodCA9PiBkZSh0KSkpLmpvaW4oXCIsXCIpKSwgXG4gICAgYFRhcmdldCgke2V9KWA7XG59XG5cbmZ1bmN0aW9uIGtlKHQsIGUpIHtcbiAgICBpZiAodC5saW1pdCAhPT0gZS5saW1pdCkgcmV0dXJuICExO1xuICAgIGlmICh0Lm9yZGVyQnkubGVuZ3RoICE9PSBlLm9yZGVyQnkubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lm9yZGVyQnkubGVuZ3RoOyBuKyspIGlmICghSmUodC5vcmRlckJ5W25dLCBlLm9yZGVyQnlbbl0pKSByZXR1cm4gITE7XG4gICAgaWYgKHQuZmlsdGVycy5sZW5ndGggIT09IGUuZmlsdGVycy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHQuZmlsdGVycy5sZW5ndGg7IGkrKykgaWYgKG4gPSB0LmZpbHRlcnNbaV0sIHMgPSBlLmZpbHRlcnNbaV0sIFxuICAgIG4ub3AgIT09IHMub3AgfHwgIW4uZmllbGQuaXNFcXVhbChzLmZpZWxkKSB8fCAhYWUobi52YWx1ZSwgcy52YWx1ZSkpIHJldHVybiAhMTtcbiAgICB2YXIgbiwgcztcbiAgICByZXR1cm4gdC5jb2xsZWN0aW9uR3JvdXAgPT09IGUuY29sbGVjdGlvbkdyb3VwICYmICghIXQucGF0aC5pc0VxdWFsKGUucGF0aCkgJiYgKCEhWGUodC5zdGFydEF0LCBlLnN0YXJ0QXQpICYmIFhlKHQuZW5kQXQsIGUuZW5kQXQpKSk7XG59XG5cbmZ1bmN0aW9uIE9lKHQpIHtcbiAgICByZXR1cm4gY3QuaXNEb2N1bWVudEtleSh0LnBhdGgpICYmIG51bGwgPT09IHQuY29sbGVjdGlvbkdyb3VwICYmIDAgPT09IHQuZmlsdGVycy5sZW5ndGg7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBmaWVsZCBmaWx0ZXJzIHRoYXQgdGFyZ2V0IHRoZSBnaXZlbiBmaWVsZCBwYXRoLiAqLyBmdW5jdGlvbiBNZSh0LCBlKSB7XG4gICAgcmV0dXJuIHQuZmlsdGVycy5maWx0ZXIoKHQgPT4gdCBpbnN0YW5jZW9mIEJlICYmIHQuZmllbGQuaXNFcXVhbChlKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlcyB0aGF0IGFyZSB1c2VkIGluIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWVxuICogZmlsdGVycy4gUmV0dXJucyBgbnVsbGAgaWYgdGhlcmUgYXJlIG5vIHN1Y2ggZmlsdGVycy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSB0byB1c2UgYXMgdGhlIGxvd2VyIGJvdW5kIGZvciBhc2NlbmRpbmcgaW5kZXggc2VnbWVudCBhdFxuICogdGhlIHByb3ZpZGVkIGBmaWVsZFBhdGhgIChvciB0aGUgdXBwZXIgYm91bmQgZm9yIGFuIGRlc2NlbmRpbmcgc2VnbWVudCkuXG4gKi9cbmZ1bmN0aW9uIEZlKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IHVlLCBpID0gITA7XG4gICAgLy8gUHJvY2VzcyBhbGwgZmlsdGVycyB0byBmaW5kIGEgdmFsdWUgZm9yIHRoZSBjdXJyZW50IGZpZWxkIHNlZ21lbnRcbiAgICBmb3IgKGNvbnN0IG4gb2YgTWUodCwgZSkpIHtcbiAgICAgICAgbGV0IHQgPSB1ZSwgZSA9ICEwO1xuICAgICAgICBzd2l0Y2ggKG4ub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPFwiIC8qIExFU1NfVEhBTiAqLyA6XG4gICAgICAgICAgY2FzZSBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHQgPSBBZShuLnZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj09XCIgLyogRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIElOICovIDpcbiAgICAgICAgICBjYXNlIFwiPj1cIiAvKiBHUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHQgPSBuLnZhbHVlLCBlID0gITE7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA6XG4gICAgICAgICAgICB0ID0gdWU7XG4gLy8gUmVtYWluaW5nIGZpbHRlcnMgY2Fubm90IGJlIHVzZWQgYXMgbG93ZXIgYm91bmRzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgYmUoe1xuICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGVcbiAgICAgICAgfSkgPCAwICYmIChzID0gdCwgaSA9IGUpO1xuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBhZGRpdGlvbmFsIGJvdW5kLCBjb21wYXJlIHRoZSB2YWx1ZXMgYWdhaW5zdCB0aGUgZXhpc3RpbmdcbiAgICAvLyByYW5nZSB0byBzZWUgaWYgd2UgY2FuIG5hcnJvdyB0aGUgc2NvcGUuXG4gICAgICAgIGlmIChudWxsICE9PSBuKSBmb3IgKGxldCByID0gMDsgciA8IHQub3JkZXJCeS5sZW5ndGg7ICsrcikge1xuICAgICAgICBpZiAodC5vcmRlckJ5W3JdLmZpZWxkLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnBvc2l0aW9uW3JdO1xuICAgICAgICAgICAgYmUoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBzLFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0LFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogbi5pbmNsdXNpdmVcbiAgICAgICAgICAgIH0pIDwgMCAmJiAocyA9IHQsIGkgPSBuLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSB0byB1c2UgYXMgdGhlIHVwcGVyIGJvdW5kIGZvciBhc2NlbmRpbmcgaW5kZXggc2VnbWVudCBhdFxuICogdGhlIHByb3ZpZGVkIGBmaWVsZFBhdGhgIChvciB0aGUgbG93ZXIgYm91bmQgZm9yIGEgZGVzY2VuZGluZyBzZWdtZW50KS5cbiAqLyBmdW5jdGlvbiAkZSh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSBvZSwgaSA9ICEwO1xuICAgIC8vIFByb2Nlc3MgYWxsIGZpbHRlcnMgdG8gZmluZCBhIHZhbHVlIGZvciB0aGUgY3VycmVudCBmaWVsZCBzZWdtZW50XG4gICAgZm9yIChjb25zdCBuIG9mIE1lKHQsIGUpKSB7XG4gICAgICAgIGxldCB0ID0gb2UsIGUgPSAhMDtcbiAgICAgICAgc3dpdGNoIChuLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLyA6XG4gICAgICAgICAgICB0ID0gUmUobi52YWx1ZSksIGUgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj09XCIgLyogRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIElOICovIDpcbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBMRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCI8XCIgLyogTEVTU19USEFOICovIDpcbiAgICAgICAgICAgIHQgPSBuLnZhbHVlLCBlID0gITE7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA6XG4gICAgICAgICAgICB0ID0gb2U7XG4gLy8gUmVtYWluaW5nIGZpbHRlcnMgY2Fubm90IGJlIHVzZWQgYXMgdXBwZXIgYm91bmRzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgUGUoe1xuICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGVcbiAgICAgICAgfSkgPiAwICYmIChzID0gdCwgaSA9IGUpO1xuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBhZGRpdGlvbmFsIGJvdW5kLCBjb21wYXJlIHRoZSB2YWx1ZXMgYWdhaW5zdCB0aGUgZXhpc3RpbmdcbiAgICAvLyByYW5nZSB0byBzZWUgaWYgd2UgY2FuIG5hcnJvdyB0aGUgc2NvcGUuXG4gICAgICAgIGlmIChudWxsICE9PSBuKSBmb3IgKGxldCByID0gMDsgciA8IHQub3JkZXJCeS5sZW5ndGg7ICsrcikge1xuICAgICAgICBpZiAodC5vcmRlckJ5W3JdLmZpZWxkLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnBvc2l0aW9uW3JdO1xuICAgICAgICAgICAgUGUoe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBzLFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0LFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogbi5pbmNsdXNpdmVcbiAgICAgICAgICAgIH0pID4gMCAmJiAocyA9IHQsIGkgPSBuLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgfTtcbn1cblxuLyoqIFJldHVybnMgdGhlIG51bWJlciBvZiBzZWdtZW50cyBvZiBhIHBlcmZlY3QgaW5kZXggZm9yIHRoaXMgdGFyZ2V0LiAqLyBjbGFzcyBCZSBleHRlbmRzIGNsYXNzIHt9IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmllbGQgPSB0LCB0aGlzLm9wID0gZSwgdGhpcy52YWx1ZSA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmaWx0ZXIgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0LmlzS2V5RmllbGQoKSA/IFwiaW5cIiAvKiBJTiAqLyA9PT0gZSB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gZSA/IHRoaXMubHQodCwgZSwgbikgOiBuZXcgTGUodCwgZSwgbikgOiBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IGUgPyBuZXcgR2UodCwgbikgOiBcImluXCIgLyogSU4gKi8gPT09IGUgPyBuZXcgUWUodCwgbikgOiBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gZSA/IG5ldyBqZSh0LCBuKSA6IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSBlID8gbmV3IFdlKHQsIG4pIDogbmV3IEJlKHQsIGUsIG4pO1xuICAgIH1cbiAgICBzdGF0aWMgbHQodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovID09PSBlID8gbmV3IFVlKHQsIG4pIDogbmV3IHFlKHQsIG4pO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgLy8gVHlwZXMgZG8gbm90IGhhdmUgdG8gbWF0Y2ggaW4gTk9UX0VRVUFMIGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gPT09IHRoaXMub3AgPyBudWxsICE9PSBlICYmIHRoaXMuZnQobGUoZSwgdGhpcy52YWx1ZSkpIDogbnVsbCAhPT0gZSAmJiBjZSh0aGlzLnZhbHVlKSA9PT0gY2UoZSkgJiYgdGhpcy5mdChsZShlLCB0aGlzLnZhbHVlKSk7XG4gICAgICAgIC8vIE9ubHkgY29tcGFyZSB0eXBlcyB3aXRoIG1hdGNoaW5nIGJhY2tlbmQgb3JkZXIgKHN1Y2ggYXMgZG91YmxlIGFuZCBpbnQpLlxuICAgICAgICB9XG4gICAgZnQodCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPFwiIC8qIExFU1NfVEhBTiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdCA8IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBMRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPD0gMDtcblxuICAgICAgICAgIGNhc2UgXCI9PVwiIC8qIEVRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwID09PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwICE9PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIj5cIiAvKiBHUkVBVEVSX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPiAwO1xuXG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiB0ID49IDA7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIE8oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkdCgpIHtcbiAgICAgICAgcmV0dXJuIFsgXCI8XCIgLyogTEVTU19USEFOICovICwgXCI8PVwiIC8qIExFU1NfVEhBTl9PUl9FUVVBTCAqLyAsIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLyAsIFwiPj1cIiAvKiBHUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXS5pbmRleE9mKHRoaXMub3ApID49IDA7XG4gICAgfVxufVxuXG5jbGFzcyBMZSBleHRlbmRzIEJlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4pLCB0aGlzLmtleSA9IGN0LmZyb21OYW1lKG4ucmVmZXJlbmNlVmFsdWUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGN0LmNvbXBhcmF0b3IodC5rZXksIHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZnQoZSk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgVWUgZXh0ZW5kcyBCZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImluXCIgLyogSU4gKi8gLCBlKSwgdGhpcy5rZXlzID0gS2UoXCJpblwiIC8qIElOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXlzLnNvbWUoKGUgPT4gZS5pc0VxdWFsKHQua2V5KSkpO1xuICAgIH1cbn1cblxuLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyBub3QgcHJlc2VudCB3aXRoaW4gYW4gYXJyYXkuICovIGNsYXNzIHFlIGV4dGVuZHMgQmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBlKSwgdGhpcy5rZXlzID0gS2UoXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5rZXlzLnNvbWUoKGUgPT4gZS5pc0VxdWFsKHQua2V5KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gS2UodCwgZSkge1xuICAgIHZhciBuO1xuICAgIHJldHVybiAoKG51bGwgPT09IChuID0gZS5hcnJheVZhbHVlKSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLnZhbHVlcykgfHwgW10pLm1hcCgodCA9PiBjdC5mcm9tTmFtZSh0LnJlZmVyZW5jZVZhbHVlKSkpO1xufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucyBvcGVyYXRvci4gKi8gY2xhc3MgR2UgZXh0ZW5kcyBCZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBnZShlKSAmJiBoZShlLmFycmF5VmFsdWUsIHRoaXMudmFsdWUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgSU4gb3BlcmF0b3IuICovIGNsYXNzIFFlIGV4dGVuZHMgQmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJpblwiIC8qIElOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiBoZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIGUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgbm90LWluIG9wZXJhdG9yLiAqLyBjbGFzcyBqZSBleHRlbmRzIEJlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwibm90LWluXCIgLyogTk9UX0lOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBpZiAoaGUodGhpcy52YWx1ZS5hcnJheVZhbHVlLCB7XG4gICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgIH0pKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlICYmICFoZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIGUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgYXJyYXktY29udGFpbnMtYW55IG9wZXJhdG9yLiAqLyBjbGFzcyBXZSBleHRlbmRzIEJlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gISghZ2UoZSkgfHwgIWUuYXJyYXlWYWx1ZS52YWx1ZXMpICYmIGUuYXJyYXlWYWx1ZS52YWx1ZXMuc29tZSgodCA9PiBoZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIHQpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBib3VuZCBvZiBhIHF1ZXJ5LlxuICpcbiAqIFRoZSBib3VuZCBpcyBzcGVjaWZpZWQgd2l0aCB0aGUgZ2l2ZW4gY29tcG9uZW50cyByZXByZXNlbnRpbmcgYSBwb3NpdGlvbiBhbmRcbiAqIHdoZXRoZXIgaXQncyBqdXN0IGJlZm9yZSBvciBqdXN0IGFmdGVyIHRoZSBwb3NpdGlvbiAocmVsYXRpdmUgdG8gd2hhdGV2ZXIgdGhlXG4gKiBxdWVyeSBvcmRlciBpcykuXG4gKlxuICogVGhlIHBvc2l0aW9uIHJlcHJlc2VudHMgYSBsb2dpY2FsIGluZGV4IHBvc2l0aW9uIGZvciBhIHF1ZXJ5LiBJdCdzIGEgcHJlZml4XG4gKiBvZiB2YWx1ZXMgZm9yIHRoZSAocG90ZW50aWFsbHkgaW1wbGljaXQpIG9yZGVyIGJ5IGNsYXVzZXMgb2YgYSBxdWVyeS5cbiAqXG4gKiBCb3VuZCBwcm92aWRlcyBhIGZ1bmN0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIGEgZG9jdW1lbnQgY29tZXMgYmVmb3JlIG9yXG4gKiBhZnRlciBhIGJvdW5kLiBUaGlzIGlzIGluZmx1ZW5jZWQgYnkgd2hldGhlciB0aGUgcG9zaXRpb24gaXMganVzdCBiZWZvcmUgb3JcbiAqIGp1c3QgYWZ0ZXIgdGhlIHByb3ZpZGVkIHZhbHVlcy5cbiAqLyBjbGFzcyB6ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gdCwgdGhpcy5pbmNsdXNpdmUgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBbiBvcmRlcmluZyBvbiBhIGZpZWxkLCBpbiBzb21lIERpcmVjdGlvbi4gRGlyZWN0aW9uIGRlZmF1bHRzIHRvIEFTQ0VORElORy5cbiAqLyBjbGFzcyBIZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSA9IFwiYXNjXCIgLyogQVNDRU5ESU5HICovKSB7XG4gICAgICAgIHRoaXMuZmllbGQgPSB0LCB0aGlzLmRpciA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBKZSh0LCBlKSB7XG4gICAgcmV0dXJuIHQuZGlyID09PSBlLmRpciAmJiB0LmZpZWxkLmlzRXF1YWwoZS5maWVsZCk7XG59XG5cbmZ1bmN0aW9uIFllKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0LnBvc2l0aW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSBlW2ldLCBvID0gdC5wb3NpdGlvbltpXTtcbiAgICAgICAgaWYgKHIuZmllbGQuaXNLZXlGaWVsZCgpKSBzID0gY3QuY29tcGFyYXRvcihjdC5mcm9tTmFtZShvLnJlZmVyZW5jZVZhbHVlKSwgbi5rZXkpOyBlbHNlIHtcbiAgICAgICAgICAgIHMgPSBsZShvLCBuLmRhdGEuZmllbGQoci5maWVsZCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcImRlc2NcIiAvKiBERVNDRU5ESU5HICovID09PSByLmRpciAmJiAocyAqPSAtMSksIDAgIT09IHMpIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gcztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBhZnRlciBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqLyBmdW5jdGlvbiBYZSh0LCBlKSB7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBudWxsID09PSBlO1xuICAgIGlmIChudWxsID09PSBlKSByZXR1cm4gITE7XG4gICAgaWYgKHQuaW5jbHVzaXZlICE9PSBlLmluY2x1c2l2ZSB8fCB0LnBvc2l0aW9uLmxlbmd0aCAhPT0gZS5wb3NpdGlvbi5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQucG9zaXRpb24ubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgaWYgKCFhZSh0LnBvc2l0aW9uW25dLCBlLnBvc2l0aW9uW25dKSkgcmV0dXJuICExO1xuICAgIH1cbiAgICByZXR1cm4gITA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFF1ZXJ5IGVuY2Fwc3VsYXRlcyBhbGwgdGhlIHF1ZXJ5IGF0dHJpYnV0ZXMgd2Ugc3VwcG9ydCBpbiB0aGUgU0RLLiBJdCBjYW5cbiAqIGJlIHJ1biBhZ2FpbnN0IHRoZSBMb2NhbFN0b3JlLCBhcyB3ZWxsIGFzIGJlIGNvbnZlcnRlZCB0byBhIGBUYXJnZXRgIHRvXG4gKiBxdWVyeSB0aGUgUmVtb3RlU3RvcmUgcmVzdWx0cy5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovIGNsYXNzIFplIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIFF1ZXJ5IHdpdGggYSBwYXRoIGFuZCBvcHRpb25hbCBhZGRpdGlvbmFsIHF1ZXJ5IGNvbnN0cmFpbnRzLlxuICAgICAqIFBhdGggbXVzdCBjdXJyZW50bHkgYmUgZW1wdHkgaWYgdGhpcyBpcyBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IFwiRlwiIC8qIEZpcnN0ICovICwgbyA9IG51bGwsIHUgPSBudWxsKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5leHBsaWNpdE9yZGVyQnkgPSBuLCB0aGlzLmZpbHRlcnMgPSBzLCBcbiAgICAgICAgdGhpcy5saW1pdCA9IGksIHRoaXMubGltaXRUeXBlID0gciwgdGhpcy5zdGFydEF0ID0gbywgdGhpcy5lbmRBdCA9IHUsIHRoaXMuX3QgPSBudWxsLCBcbiAgICAgICAgLy8gVGhlIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgb2YgdGhpcyBgUXVlcnlgIGluc3RhbmNlLlxuICAgICAgICB0aGlzLnd0ID0gbnVsbCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0O1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgUXVlcnkgaW5zdGFuY2Ugd2l0aCB0aGUgb3B0aW9ucyBwcm92aWRlZC4gKi8gZnVuY3Rpb24gdG4odCwgZSwgbiwgcywgaSwgciwgbywgdSkge1xuICAgIHJldHVybiBuZXcgWmUodCwgZSwgbiwgcywgaSwgciwgbywgdSk7XG59XG5cbi8qKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIHF1ZXJ5IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzIGF0IGBwYXRoYCAqLyBmdW5jdGlvbiBlbih0KSB7XG4gICAgcmV0dXJuIG5ldyBaZSh0KTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY29udmVydCBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgaW50byBhIGNvbGxlY3Rpb24gcXVlcnkgYXQgYVxuICogc3BlY2lmaWMgcGF0aC4gVGhpcyBpcyB1c2VkIHdoZW4gZXhlY3V0aW5nIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcmllcywgc2luY2VcbiAqIHdlIGhhdmUgdG8gc3BsaXQgdGhlIHF1ZXJ5IGludG8gYSBzZXQgb2YgY29sbGVjdGlvbiBxdWVyaWVzIGF0IG11bHRpcGxlXG4gKiBwYXRocy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBxdWVyeSBkb2VzIG5vdCBzcGVjaWZ5IGFueSBxdWVyeSBjb25zdHJhaW50cyB0aGF0XG4gKiBjb3VsZCByZW1vdmUgcmVzdWx0cy5cbiAqL1xuZnVuY3Rpb24gbm4odCkge1xuICAgIHJldHVybiAwID09PSB0LmZpbHRlcnMubGVuZ3RoICYmIG51bGwgPT09IHQubGltaXQgJiYgbnVsbCA9PSB0LnN0YXJ0QXQgJiYgbnVsbCA9PSB0LmVuZEF0ICYmICgwID09PSB0LmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggfHwgMSA9PT0gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoICYmIHQuZXhwbGljaXRPcmRlckJ5WzBdLmZpZWxkLmlzS2V5RmllbGQoKSk7XG59XG5cbmZ1bmN0aW9uIHNuKHQpIHtcbiAgICByZXR1cm4gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoID4gMCA/IHQuZXhwbGljaXRPcmRlckJ5WzBdLmZpZWxkIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gcm4odCkge1xuICAgIGZvciAoY29uc3QgZSBvZiB0LmZpbHRlcnMpIGlmIChlLmR0KCkpIHJldHVybiBlLmZpZWxkO1xuICAgIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhbnkgb2YgdGhlIHByb3ZpZGVkIE9wZXJhdG9ycyBhcmUgaW5jbHVkZWQgaW4gdGhlIHF1ZXJ5IGFuZFxuICogcmV0dXJucyB0aGUgZmlyc3Qgb25lIHRoYXQgaXMsIG9yIG51bGwgaWYgbm9uZSBhcmUuXG4gKi9cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgY29sbGVjdGlvbiBncm91cCByYXRoZXIgdGhhbiBhIHNwZWNpZmljXG4gKiBjb2xsZWN0aW9uLlxuICovXG5mdW5jdGlvbiBvbih0KSB7XG4gICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltcGxpY2l0IG9yZGVyIGJ5IGNvbnN0cmFpbnQgdGhhdCBpcyB1c2VkIHRvIGV4ZWN1dGUgdGhlIFF1ZXJ5LFxuICogd2hpY2ggY2FuIGJlIGRpZmZlcmVudCBmcm9tIHRoZSBvcmRlciBieSBjb25zdHJhaW50cyB0aGUgdXNlciBwcm92aWRlZCAoZS5nLlxuICogdGhlIFNESyBhbmQgYmFja2VuZCBhbHdheXMgb3JkZXJzIGJ5IGBfX25hbWVfX2ApLlxuICovIGZ1bmN0aW9uIHVuKHQpIHtcbiAgICBjb25zdCBlID0gJCh0KTtcbiAgICBpZiAobnVsbCA9PT0gZS5fdCkge1xuICAgICAgICBlLl90ID0gW107XG4gICAgICAgIGNvbnN0IHQgPSBybihlKSwgbiA9IHNuKGUpO1xuICAgICAgICBpZiAobnVsbCAhPT0gdCAmJiBudWxsID09PSBuKSBcbiAgICAgICAgLy8gSW4gb3JkZXIgdG8gaW1wbGljaXRseSBhZGQga2V5IG9yZGVyaW5nLCB3ZSBtdXN0IGFsc28gYWRkIHRoZVxuICAgICAgICAvLyBpbmVxdWFsaXR5IGZpbHRlciBmaWVsZCBmb3IgaXQgdG8gYmUgYSB2YWxpZCBxdWVyeS5cbiAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IGluZXF1YWxpdHkgZmllbGQgYW5kIGtleSBvcmRlcmluZyBpcyBhc2NlbmRpbmcuXG4gICAgICAgIHQuaXNLZXlGaWVsZCgpIHx8IGUuX3QucHVzaChuZXcgSGUodCkpLCBlLl90LnB1c2gobmV3IEhlKHV0LmtleUZpZWxkKCksIFwiYXNjXCIgLyogQVNDRU5ESU5HICovKSk7IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHQgPSAhMTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBlLmV4cGxpY2l0T3JkZXJCeSkgZS5fdC5wdXNoKG4pLCBuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiAodCA9ICEwKTtcbiAgICAgICAgICAgIGlmICghdCkge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBvcmRlciBvZiB0aGUgaW1wbGljaXQga2V5IG9yZGVyaW5nIGFsd2F5cyBtYXRjaGVzIHRoZSBsYXN0XG4gICAgICAgICAgICAgICAgLy8gZXhwbGljaXQgb3JkZXIgYnlcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5leHBsaWNpdE9yZGVyQnkubGVuZ3RoID4gMCA/IGUuZXhwbGljaXRPcmRlckJ5W2UuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCAtIDFdLmRpciA6IFwiYXNjXCIgLyogQVNDRU5ESU5HICovO1xuICAgICAgICAgICAgICAgIGUuX3QucHVzaChuZXcgSGUodXQua2V5RmllbGQoKSwgdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlLl90O1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZSB0byBpdCdzIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgcmVwcmVzZW50YXRpb24uXG4gKi8gZnVuY3Rpb24gY24odCkge1xuICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgIGlmICghZS53dCkgaWYgKFwiRlwiIC8qIEZpcnN0ICovID09PSBlLmxpbWl0VHlwZSkgZS53dCA9IENlKGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIHVuKGUpLCBlLmZpbHRlcnMsIGUubGltaXQsIGUuc3RhcnRBdCwgZS5lbmRBdCk7IGVsc2Uge1xuICAgICAgICAvLyBGbGlwIHRoZSBvcmRlckJ5IGRpcmVjdGlvbnMgc2luY2Ugd2Ugd2FudCB0aGUgbGFzdCByZXN1bHRzXG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHVuKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gbi5kaXIgPyBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA6IFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi87XG4gICAgICAgICAgICB0LnB1c2gobmV3IEhlKG4uZmllbGQsIGUpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBuZWVkIHRvIHN3YXAgdGhlIGN1cnNvcnMgdG8gbWF0Y2ggdGhlIG5vdy1mbGlwcGVkIHF1ZXJ5IG9yZGVyaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmVuZEF0ID8gbmV3IHplKGUuZW5kQXQucG9zaXRpb24sIGUuZW5kQXQuaW5jbHVzaXZlKSA6IG51bGwsIHMgPSBlLnN0YXJ0QXQgPyBuZXcgemUoZS5zdGFydEF0LnBvc2l0aW9uLCBlLnN0YXJ0QXQuaW5jbHVzaXZlKSA6IG51bGw7XG4gICAgICAgIC8vIE5vdyByZXR1cm4gYXMgYSBMaW1pdFR5cGUuRmlyc3QgcXVlcnkuXG4gICAgICAgIGUud3QgPSBDZShlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCB0LCBlLmZpbHRlcnMsIGUubGltaXQsIG4sIHMpO1xuICAgIH1cbiAgICByZXR1cm4gZS53dDtcbn1cblxuZnVuY3Rpb24gYW4odCwgZSwgbikge1xuICAgIHJldHVybiBuZXcgWmUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIGUsIG4sIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG59XG5cbmZ1bmN0aW9uIGhuKHQsIGUpIHtcbiAgICByZXR1cm4ga2UoY24odCksIGNuKGUpKSAmJiB0LmxpbWl0VHlwZSA9PT0gZS5saW1pdFR5cGU7XG59XG5cbi8vIFRPRE8oYi8yOTE4MzE2NSk6IFRoaXMgaXMgdXNlZCB0byBnZXQgYSB1bmlxdWUgc3RyaW5nIGZyb20gYSBxdWVyeSB0bywgZm9yXG4vLyBleGFtcGxlLCB1c2UgYXMgYSBkaWN0aW9uYXJ5IGtleSwgYnV0IHRoZSBpbXBsZW1lbnRhdGlvbiBpcyBzdWJqZWN0IHRvXG4vLyBjb2xsaXNpb25zLiBNYWtlIGl0IGNvbGxpc2lvbi1mcmVlLlxuZnVuY3Rpb24gbG4odCkge1xuICAgIHJldHVybiBgJHt4ZShjbih0KSl9fGx0OiR7dC5saW1pdFR5cGV9YDtcbn1cblxuZnVuY3Rpb24gZm4odCkge1xuICAgIHJldHVybiBgUXVlcnkodGFyZ2V0PSR7TmUoY24odCkpfTsgbGltaXRUeXBlPSR7dC5saW1pdFR5cGV9KWA7XG59XG5cbi8qKiBSZXR1cm5zIHdoZXRoZXIgYGRvY2AgbWF0Y2hlcyB0aGUgY29uc3RyYWludHMgb2YgYHF1ZXJ5YC4gKi8gZnVuY3Rpb24gZG4odCwgZSkge1xuICAgIHJldHVybiBlLmlzRm91bmREb2N1bWVudCgpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUua2V5LnBhdGg7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCA/IGUua2V5Lmhhc0NvbGxlY3Rpb25JZCh0LmNvbGxlY3Rpb25Hcm91cCkgJiYgdC5wYXRoLmlzUHJlZml4T2YobikgOiBjdC5pc0RvY3VtZW50S2V5KHQucGF0aCkgPyB0LnBhdGguaXNFcXVhbChuKSA6IHQucGF0aC5pc0ltbWVkaWF0ZVBhcmVudE9mKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEEgZG9jdW1lbnQgbXVzdCBoYXZlIGEgdmFsdWUgZm9yIGV2ZXJ5IG9yZGVyaW5nIGNsYXVzZSBpbiBvcmRlciB0byBzaG93IHVwXG4gKiBpbiB0aGUgcmVzdWx0cy5cbiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5leHBsaWNpdE9yZGVyQnkpIFxuICAgICAgICAvLyBvcmRlciBieSBrZXkgYWx3YXlzIG1hdGNoZXNcbiAgICAgICAgaWYgKCFuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiBudWxsID09PSBlLmRhdGEuZmllbGQobi5maWVsZCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH0odCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoIW4ubWF0Y2hlcyhlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAodC5zdGFydEF0ICYmICFcbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBiZWZvcmUgYSBib3VuZCB1c2luZyB0aGUgcHJvdmlkZWQgc29ydFxuICogb3JkZXIuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgY29uc3QgcyA9IFllKHQsIGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIHQuaW5jbHVzaXZlID8gcyA8PSAwIDogcyA8IDA7XG4gICAgICAgIH0odC5zdGFydEF0LCB1bih0KSwgZSkpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHQuZW5kQXQgJiYgIWZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBZZSh0LCBlLCBuKTtcbiAgICAgICAgICAgIHJldHVybiB0LmluY2x1c2l2ZSA/IHMgPj0gMCA6IHMgPiAwO1xuICAgICAgICB9KHQuZW5kQXQsIHVuKHQpLCBlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBncm91cCB0aGF0IHRoaXMgcXVlcnkgdGFyZ2V0cy5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBXZWIgU0RLIHRvIGZhY2lsaXRhdGUgbXVsdGktdGFiXG4gKiBzeW5jaHJvbml6YXRpb24gZm9yIHF1ZXJ5IHJlc3VsdHMuXG4gKi8gKHQsIGUpO1xufVxuXG5mdW5jdGlvbiBfbih0KSB7XG4gICAgcmV0dXJuIHQuY29sbGVjdGlvbkdyb3VwIHx8ICh0LnBhdGgubGVuZ3RoICUgMiA9PSAxID8gdC5wYXRoLmxhc3RTZWdtZW50KCkgOiB0LnBhdGguZ2V0KHQucGF0aC5sZW5ndGggLSAyKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIG5ldyBjb21wYXJhdG9yIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcGFyZSB0d28gZG9jdW1lbnRzXG4gKiBiYXNlZCBvbiB0aGUgUXVlcnkncyBvcmRlcmluZyBjb25zdHJhaW50LlxuICovIGZ1bmN0aW9uIHduKHQpIHtcbiAgICByZXR1cm4gKGUsIG4pID0+IHtcbiAgICAgICAgbGV0IHMgPSAhMTtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIHVuKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbW4oaSwgZSwgbik7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdCkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBzID0gcyB8fCBpLmZpZWxkLmlzS2V5RmllbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBtbih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuZmllbGQuaXNLZXlGaWVsZCgpID8gY3QuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5kYXRhLmZpZWxkKHQpLCBpID0gbi5kYXRhLmZpZWxkKHQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gcyAmJiBudWxsICE9PSBpID8gbGUocywgaSkgOiBPKCk7XG4gICAgfSh0LmZpZWxkLCBlLCBuKTtcbiAgICBzd2l0Y2ggKHQuZGlyKSB7XG4gICAgICBjYXNlIFwiYXNjXCIgLyogQVNDRU5ESU5HICovIDpcbiAgICAgICAgcmV0dXJuIHM7XG5cbiAgICAgIGNhc2UgXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiAtMSAqIHM7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBPKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIGFuIERvdWJsZVZhbHVlIGZvciBgdmFsdWVgIHRoYXQgaXMgZW5jb2RlZCBiYXNlZCB0aGUgc2VyaWFsaXplcidzXG4gKiBgdXNlUHJvdG8zSnNvbmAgc2V0dGluZy5cbiAqLyBmdW5jdGlvbiBnbih0LCBlKSB7XG4gICAgaWYgKHQuZ3QpIHtcbiAgICAgICAgaWYgKGlzTmFOKGUpKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiTmFOXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGUgPT09IDEgLyAwKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiSW5maW5pdHlcIlxuICAgICAgICB9O1xuICAgICAgICBpZiAoZSA9PT0gLTEgLyAwKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiLUluZmluaXR5XCJcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZG91YmxlVmFsdWU6IGllKGUpID8gXCItMFwiIDogZVxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBJbnRlZ2VyVmFsdWUgZm9yIGB2YWx1ZWAuXG4gKi8gZnVuY3Rpb24geW4odCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGludGVnZXJWYWx1ZTogXCJcIiArIHRcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBudW1iZXIgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvIGEgcHJvdG8uXG4gKiBUaGUgcmV0dXJuIHZhbHVlIGlzIGFuIEludGVnZXJWYWx1ZSBpZiBpdCBjYW4gc2FmZWx5IHJlcHJlc2VudCB0aGUgdmFsdWUsXG4gKiBvdGhlcndpc2UgYSBEb3VibGVWYWx1ZSBpcyByZXR1cm5lZC5cbiAqLyBmdW5jdGlvbiBwbih0LCBlKSB7XG4gICAgcmV0dXJuIHJlKGUpID8geW4oZSkgOiBnbih0LCBlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBVc2VkIHRvIHJlcHJlc2VudCBhIGZpZWxkIHRyYW5zZm9ybSBvbiBhIG11dGF0aW9uLiAqLyBjbGFzcyBJbiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBzdHJ1Y3R1cmFsIHR5cGUgb2YgYFRyYW5zZm9ybU9wZXJhdGlvbmAgaXMgdW5pcXVlLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy81NDUxXG4gICAgICAgIHRoaXMuXyA9IHZvaWQgMDtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIGxvY2FsIHRyYW5zZm9ybSByZXN1bHQgYWdhaW5zdCB0aGUgcHJvdmlkZWQgYHByZXZpb3VzVmFsdWVgLFxuICogb3B0aW9uYWxseSB1c2luZyB0aGUgcHJvdmlkZWQgbG9jYWxXcml0ZVRpbWUuXG4gKi8gZnVuY3Rpb24gVG4odCwgZSwgbikge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgUm4gPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgICAgICBfX3R5cGVfXzoge1xuICAgICAgICAgICAgICAgICAgICBzdHJpbmdWYWx1ZTogXCJzZXJ2ZXJfdGltZXN0YW1wXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF9fbG9jYWxfd3JpdGVfdGltZV9fOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzOiB0LnNlY29uZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW5vczogdC5uYW5vc2Vjb25kc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZSAmJiAobi5maWVsZHMuX19wcmV2aW91c192YWx1ZV9fID0gZSksIHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiBuXG4gICAgICAgIH07XG4gICAgfShuLCBlKSA6IHQgaW5zdGFuY2VvZiBibiA/IFBuKHQsIGUpIDogdCBpbnN0YW5jZW9mIHZuID8gVm4odCwgZSkgOiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogU2luY2UgSmF2YVNjcmlwdCdzIGludGVnZXIgYXJpdGhtZXRpYyBpcyBsaW1pdGVkIHRvIDUzIGJpdFxuICAgICAgICAvLyBwcmVjaXNpb24gYW5kIHJlc29sdmVzIG92ZXJmbG93cyBieSByZWR1Y2luZyBwcmVjaXNpb24sIHdlIGRvIG5vdFxuICAgICAgICAvLyBtYW51YWxseSBjYXAgb3ZlcmZsb3dzIGF0IDJeNjMuXG4gICAgICAgIGNvbnN0IG4gPSBBbih0LCBlKSwgcyA9IERuKG4pICsgRG4odC55dCk7XG4gICAgICAgIHJldHVybiBtZShuKSAmJiBtZSh0Lnl0KSA/IHluKHMpIDogZ24odC5JdCwgcyk7XG4gICAgfSh0LCBlKTtcbn1cblxuLyoqXG4gKiBDb21wdXRlcyBhIGZpbmFsIHRyYW5zZm9ybSByZXN1bHQgYWZ0ZXIgdGhlIHRyYW5zZm9ybSBoYXMgYmVlbiBhY2tub3dsZWRnZWRcbiAqIGJ5IHRoZSBzZXJ2ZXIsIHBvdGVudGlhbGx5IHVzaW5nIHRoZSBzZXJ2ZXItcHJvdmlkZWQgdHJhbnNmb3JtUmVzdWx0LlxuICovIGZ1bmN0aW9uIEVuKHQsIGUsIG4pIHtcbiAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcbiAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcbiAgICAvLyBhcHBsaWNhdGlvbnMuXG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBibiA/IFBuKHQsIGUpIDogdCBpbnN0YW5jZW9mIHZuID8gVm4odCwgZSkgOiBuO1xufVxuXG4vKipcbiAqIElmIHRoaXMgdHJhbnNmb3JtIG9wZXJhdGlvbiBpcyBub3QgaWRlbXBvdGVudCwgcmV0dXJucyB0aGUgYmFzZSB2YWx1ZSB0b1xuICogcGVyc2lzdCBmb3IgdGhpcyB0cmFuc2Zvcm0uIElmIGEgYmFzZSB2YWx1ZSBpcyByZXR1cm5lZCwgdGhlIHRyYW5zZm9ybVxuICogb3BlcmF0aW9uIGlzIGFsd2F5cyBhcHBsaWVkIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXNcbiAqIGFscmVhZHkgYmVlbiB1cGRhdGVkLlxuICpcbiAqIEJhc2UgdmFsdWVzIHByb3ZpZGUgY29uc2lzdGVudCBiZWhhdmlvciBmb3Igbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtcyBhbmRcbiAqIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZSBsYXRlbmN5LWNvbXBlbnNhdGVkIHZhbHVlIGV2ZW4gaWYgdGhlIGJhY2tlbmRcbiAqIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlIHRyYW5zZm9ybSBvcGVyYXRpb24uIFRoZSBiYXNlIHZhbHVlIGlzIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMsIGFzIHRoZXkgY2FuIGJlIHJlLXBsYXllZCBldmVuIGlmIHRoZSBiYWNrZW5kIGhhc1xuICogYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCB0cmFuc2Zvcm1zLlxuICovIGZ1bmN0aW9uIEFuKHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIFNuID8gbWUobiA9IGUpIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuICEhdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdDtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGVpdGhlciBhbiBJbnRlZ2VyVmFsdWUgb3IgYSBEb3VibGVWYWx1ZS4gKi8gKG4pID8gZSA6IHtcbiAgICAgICAgaW50ZWdlclZhbHVlOiAwXG4gICAgfSA6IG51bGw7XG4gICAgdmFyIG47XG59XG5cbi8qKiBUcmFuc2Zvcm1zIGEgdmFsdWUgaW50byBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wLiAqL1xuY2xhc3MgUm4gZXh0ZW5kcyBJbiB7fVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSB1bmlvbiBvcGVyYXRpb24uICovIGNsYXNzIGJuIGV4dGVuZHMgSW4ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBQbih0LCBlKSB7XG4gICAgY29uc3QgbiA9IENuKGUpO1xuICAgIGZvciAoY29uc3QgZSBvZiB0LmVsZW1lbnRzKSBuLnNvbWUoKHQgPT4gYWUodCwgZSkpKSB8fCBuLnB1c2goZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgdmFsdWVzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSByZW1vdmUgb3BlcmF0aW9uLiAqLyBjbGFzcyB2biBleHRlbmRzIEluIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZWxlbWVudHMgPSB0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVm4odCwgZSkge1xuICAgIGxldCBuID0gQ24oZSk7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZWxlbWVudHMpIG4gPSBuLmZpbHRlcigodCA9PiAhYWUodCwgZSkpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKlxuICogSW1wbGVtZW50cyB0aGUgYmFja2VuZCBzZW1hbnRpY3MgZm9yIGxvY2FsbHkgY29tcHV0ZWQgTlVNRVJJQ19BREQgKGluY3JlbWVudClcbiAqIHRyYW5zZm9ybXMuIENvbnZlcnRzIGFsbCBmaWVsZCB2YWx1ZXMgdG8gaW50ZWdlcnMgb3IgZG91YmxlcywgYnV0IHVubGlrZSB0aGVcbiAqIGJhY2tlbmQgZG9lcyBub3QgY2FwIGludGVnZXIgdmFsdWVzIGF0IDJeNjMuIEluc3RlYWQsIEphdmFTY3JpcHQgbnVtYmVyXG4gKiBhcml0aG1ldGljIGlzIHVzZWQgYW5kIHByZWNpc2lvbiBsb3NzIGNhbiBvY2N1ciBmb3IgdmFsdWVzIGdyZWF0ZXIgdGhhbiAyXjUzLlxuICovIGNsYXNzIFNuIGV4dGVuZHMgSW4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5JdCA9IHQsIHRoaXMueXQgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gRG4odCkge1xuICAgIHJldHVybiBKdCh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKTtcbn1cblxuZnVuY3Rpb24gQ24odCkge1xuICAgIHJldHVybiBnZSh0KSAmJiB0LmFycmF5VmFsdWUudmFsdWVzID8gdC5hcnJheVZhbHVlLnZhbHVlcy5zbGljZSgpIDogW107XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQSBmaWVsZCBwYXRoIGFuZCB0aGUgVHJhbnNmb3JtT3BlcmF0aW9uIHRvIHBlcmZvcm0gdXBvbiBpdC4gKi8gY2xhc3MgeG4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5maWVsZCA9IHQsIHRoaXMudHJhbnNmb3JtID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIE5uKHQsIGUpIHtcbiAgICByZXR1cm4gdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBibiAmJiBlIGluc3RhbmNlb2YgYm4gfHwgdCBpbnN0YW5jZW9mIHZuICYmIGUgaW5zdGFuY2VvZiB2biA/IHR0KHQuZWxlbWVudHMsIGUuZWxlbWVudHMsIGFlKSA6IHQgaW5zdGFuY2VvZiBTbiAmJiBlIGluc3RhbmNlb2YgU24gPyBhZSh0Lnl0LCBlLnl0KSA6IHQgaW5zdGFuY2VvZiBSbiAmJiBlIGluc3RhbmNlb2YgUm47XG4gICAgfSh0LnRyYW5zZm9ybSwgZS50cmFuc2Zvcm0pO1xufVxuXG4vKiogVGhlIHJlc3VsdCBvZiBzdWNjZXNzZnVsbHkgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byB0aGUgYmFja2VuZC4gKi9cbmNsYXNzIGtuIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgdmVyc2lvbiBhdCB3aGljaCB0aGUgbXV0YXRpb24gd2FzIGNvbW1pdHRlZDpcbiAgICAgKlxuICAgICAqIC0gRm9yIG1vc3Qgb3BlcmF0aW9ucywgdGhpcyBpcyB0aGUgdXBkYXRlVGltZSBpbiB0aGUgV3JpdGVSZXN1bHQuXG4gICAgICogLSBGb3IgZGVsZXRlcywgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgKGJlY2F1c2UgZGVsZXRlcyBhcmVcbiAgICAgKiAgIG5vdCBzdG9yZWQgYW5kIGhhdmUgbm8gdXBkYXRlVGltZSkuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgdGhlc2UgdmVyc2lvbnMgY2FuIGJlIGRpZmZlcmVudDogTm8tb3Agd3JpdGVzIHdpbGwgbm90IGNoYW5nZVxuICAgICAqIHRoZSB1cGRhdGVUaW1lIGV2ZW4gdGhvdWdoIHRoZSBjb21taXRUaW1lIGFkdmFuY2VzLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSByZXN1bHRpbmcgZmllbGRzIHJldHVybmVkIGZyb20gdGhlIGJhY2tlbmQgYWZ0ZXIgYSBtdXRhdGlvblxuICAgICAqIGNvbnRhaW5pbmcgZmllbGQgdHJhbnNmb3JtcyBoYXMgYmVlbiBjb21taXR0ZWQuIENvbnRhaW5zIG9uZSBGaWVsZFZhbHVlXG4gICAgICogZm9yIGVhY2ggRmllbGRUcmFuc2Zvcm0gdGhhdCB3YXMgaW4gdGhlIG11dGF0aW9uLlxuICAgICAqXG4gICAgICogV2lsbCBiZSBlbXB0eSBpZiB0aGUgbXV0YXRpb24gZGlkIG5vdCBjb250YWluIGFueSBmaWVsZCB0cmFuc2Zvcm1zLlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdCwgdGhpcy50cmFuc2Zvcm1SZXN1bHRzID0gZTtcbiAgICB9XG59XG5cbi8qKlxuICogRW5jb2RlcyBhIHByZWNvbmRpdGlvbiBmb3IgYSBtdXRhdGlvbi4gVGhpcyBmb2xsb3dzIHRoZSBtb2RlbCB0aGF0IHRoZVxuICogYmFja2VuZCBhY2NlcHRzIHdpdGggdGhlIHNwZWNpYWwgY2FzZSBvZiBhbiBleHBsaWNpdCBcImVtcHR5XCIgcHJlY29uZGl0aW9uXG4gKiAobWVhbmluZyBubyBwcmVjb25kaXRpb24pLlxuICovIGNsYXNzIE9uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVGltZSA9IHQsIHRoaXMuZXhpc3RzID0gZTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgZW1wdHkgUHJlY29uZGl0aW9uLiAqLyAgICBzdGF0aWMgbm9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPbjtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIHdpdGggYW4gZXhpc3RzIGZsYWcuICovICAgIHN0YXRpYyBleGlzdHModCkge1xuICAgICAgICByZXR1cm4gbmV3IE9uKHZvaWQgMCwgdCk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IFByZWNvbmRpdGlvbiBiYXNlZCBvbiBhIHZlcnNpb24gYSBkb2N1bWVudCBleGlzdHMgYXQuICovICAgIHN0YXRpYyB1cGRhdGVUaW1lKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPbih0KTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgd2hldGhlciB0aGlzIFByZWNvbmRpdGlvbiBpcyBlbXB0eS4gKi8gICAgZ2V0IGlzTm9uZSgpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gdGhpcy51cGRhdGVUaW1lICYmIHZvaWQgMCA9PT0gdGhpcy5leGlzdHM7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5leGlzdHMgPT09IHQuZXhpc3RzICYmICh0aGlzLnVwZGF0ZVRpbWUgPyAhIXQudXBkYXRlVGltZSAmJiB0aGlzLnVwZGF0ZVRpbWUuaXNFcXVhbCh0LnVwZGF0ZVRpbWUpIDogIXQudXBkYXRlVGltZSk7XG4gICAgfVxufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIHRoZSBwcmVjb25kaXRpb25zIGlzIHZhbGlkIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnQuICovIGZ1bmN0aW9uIE1uKHQsIGUpIHtcbiAgICByZXR1cm4gdm9pZCAwICE9PSB0LnVwZGF0ZVRpbWUgPyBlLmlzRm91bmREb2N1bWVudCgpICYmIGUudmVyc2lvbi5pc0VxdWFsKHQudXBkYXRlVGltZSkgOiB2b2lkIDAgPT09IHQuZXhpc3RzIHx8IHQuZXhpc3RzID09PSBlLmlzRm91bmREb2N1bWVudCgpO1xufVxuXG4vKipcbiAqIEEgbXV0YXRpb24gZGVzY3JpYmVzIGEgc2VsZi1jb250YWluZWQgY2hhbmdlIHRvIGEgZG9jdW1lbnQuIE11dGF0aW9ucyBjYW5cbiAqIGNyZWF0ZSwgcmVwbGFjZSwgZGVsZXRlLCBhbmQgdXBkYXRlIHN1YnNldHMgb2YgZG9jdW1lbnRzLlxuICpcbiAqIE11dGF0aW9ucyBub3Qgb25seSBhY3Qgb24gdGhlIHZhbHVlIG9mIHRoZSBkb2N1bWVudCBidXQgYWxzbyBpdHMgdmVyc2lvbi5cbiAqXG4gKiBGb3IgbG9jYWwgbXV0YXRpb25zIChtdXRhdGlvbnMgdGhhdCBoYXZlbid0IGJlZW4gY29tbWl0dGVkIHlldCksIHdlIHByZXNlcnZlXG4gKiB0aGUgZXhpc3RpbmcgdmVyc2lvbiBmb3IgU2V0IGFuZCBQYXRjaCBtdXRhdGlvbnMuIEZvciBEZWxldGUgbXV0YXRpb25zLCB3ZVxuICogcmVzZXQgdGhlIHZlcnNpb24gdG8gMC5cbiAqXG4gKiBIZXJlJ3MgdGhlIGV4cGVjdGVkIHRyYW5zaXRpb24gdGFibGUuXG4gKlxuICogTVVUQVRJT04gICAgICAgICAgIEFQUExJRUQgVE8gICAgICAgICAgICBSRVNVTFRTIElOXG4gKlxuICogU2V0TXV0YXRpb24gICAgICAgIERvY3VtZW50KHYzKSAgICAgICAgICBEb2N1bWVudCh2MylcbiAqIFNldE11dGF0aW9uICAgICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgRG9jdW1lbnQodjApXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIERvY3VtZW50KHYwKVxuICogUGF0Y2hNdXRhdGlvbiAgICAgIERvY3VtZW50KHYzKSAgICAgICAgICBEb2N1bWVudCh2MylcbiAqIFBhdGNoTXV0YXRpb24gICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MylcbiAqIFBhdGNoTXV0YXRpb24gICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgVW5rbm93bkRvY3VtZW50KHYzKVxuICogRGVsZXRlTXV0YXRpb24gICAgIERvY3VtZW50KHYzKSAgICAgICAgICBOb0RvY3VtZW50KHYwKVxuICogRGVsZXRlTXV0YXRpb24gICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYwKVxuICogRGVsZXRlTXV0YXRpb24gICAgIEludmFsaWREb2N1bWVudCh2MCkgICBOb0RvY3VtZW50KHYwKVxuICpcbiAqIEZvciBhY2tub3dsZWRnZWQgbXV0YXRpb25zLCB3ZSB1c2UgdGhlIHVwZGF0ZVRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgYXNcbiAqIHRoZSByZXN1bHRpbmcgdmVyc2lvbiBmb3IgU2V0IGFuZCBQYXRjaCBtdXRhdGlvbnMuIEFzIGRlbGV0ZXMgaGF2ZSBub1xuICogZXhwbGljaXQgdXBkYXRlIHRpbWUsIHdlIHVzZSB0aGUgY29tbWl0VGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSBmb3JcbiAqIERlbGV0ZSBtdXRhdGlvbnMuXG4gKlxuICogSWYgYSBtdXRhdGlvbiBpcyBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmQgYnV0IGZhaWxzIHRoZSBwcmVjb25kaXRpb24gY2hlY2tcbiAqIGxvY2FsbHksIHdlIHRyYW5zaXRpb24gdG8gYW4gYFVua25vd25Eb2N1bWVudGAgYW5kIHJlbHkgb24gV2F0Y2ggdG8gc2VuZCB1c1xuICogdGhlIHVwZGF0ZWQgdmVyc2lvbi5cbiAqXG4gKiBGaWVsZCB0cmFuc2Zvcm1zIGFyZSB1c2VkIG9ubHkgd2l0aCBQYXRjaCBhbmQgU2V0IE11dGF0aW9ucy4gV2UgdXNlIHRoZVxuICogYHVwZGF0ZVRyYW5zZm9ybXNgIG1lc3NhZ2UgdG8gc3RvcmUgdHJhbnNmb3JtcywgcmF0aGVyIHRoYW4gdGhlIGB0cmFuc2Zvcm1zYHNcbiAqIG1lc3NhZ2VzLlxuICpcbiAqICMjIFN1YmNsYXNzaW5nIE5vdGVzXG4gKlxuICogRXZlcnkgdHlwZSBvZiBtdXRhdGlvbiBuZWVkcyB0byBpbXBsZW1lbnQgaXRzIG93biBhcHBseVRvUmVtb3RlRG9jdW1lbnQoKSBhbmRcbiAqIGFwcGx5VG9Mb2NhbFZpZXcoKSB0byBpbXBsZW1lbnQgdGhlIGFjdHVhbCBiZWhhdmlvciBvZiBhcHBseWluZyB0aGUgbXV0YXRpb25cbiAqIHRvIHNvbWUgc291cmNlIGRvY3VtZW50IChzZWUgYHNldE11dGF0aW9uQXBwbHlUb1JlbW90ZURvY3VtZW50KClgIGZvciBhblxuICogZXhhbXBsZSkuXG4gKi8gY2xhc3MgRm4ge31cblxuLyoqXG4gKiBBIHV0aWxpdHkgbWV0aG9kIHRvIGNhbGN1bGF0ZSBhIGBNdXRhdGlvbmAgcmVwcmVzZW50aW5nIHRoZSBvdmVybGF5IGZyb20gdGhlXG4gKiBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQsIGFuZCBhIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyB0aGUgZmllbGRzIHRoYXRcbiAqIGFyZSBtdXRhdGVkIGJ5IHRoZSBsb2NhbCBtdXRhdGlvbnMuXG4gKi8gZnVuY3Rpb24gJG4odCwgZSkge1xuICAgIGlmICghdC5oYXNMb2NhbE11dGF0aW9ucyB8fCBlICYmIDAgPT09IGUuZmllbGRzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgLy8gbWFzayBpcyBudWxsIHdoZW4gc2V0cyBvciBkZWxldGVzIGFyZSBhcHBsaWVkIHRvIHRoZSBjdXJyZW50IGRvY3VtZW50LlxuICAgICAgICBpZiAobnVsbCA9PT0gZSkgcmV0dXJuIHQuaXNOb0RvY3VtZW50KCkgPyBuZXcgem4odC5rZXksIE9uLm5vbmUoKSkgOiBuZXcgS24odC5rZXksIHQuZGF0YSwgT24ubm9uZSgpKTtcbiAgICB7XG4gICAgICAgIGNvbnN0IG4gPSB0LmRhdGEsIHMgPSB2ZS5lbXB0eSgpO1xuICAgICAgICBsZXQgaSA9IG5ldyBxdCh1dC5jb21wYXJhdG9yKTtcbiAgICAgICAgZm9yIChsZXQgdCBvZiBlLmZpZWxkcykgaWYgKCFpLmhhcyh0KSkge1xuICAgICAgICAgICAgbGV0IGUgPSBuLmZpZWxkKHQpO1xuICAgICAgICAgICAgLy8gSWYgd2UgYXJlIGRlbGV0aW5nIGEgbmVzdGVkIGZpZWxkLCB3ZSB0YWtlIHRoZSBpbW1lZGlhdGUgcGFyZW50IGFzXG4gICAgICAgICAgICAvLyB0aGUgbWFzayB1c2VkIHRvIGNvbnN0cnVjdCB0aGUgcmVzdWx0aW5nIG11dGF0aW9uLlxuICAgICAgICAgICAgLy8gSnVzdGlmaWNhdGlvbjogTmVzdGVkIGZpZWxkcyBjYW4gY3JlYXRlIHBhcmVudCBmaWVsZHMgaW1wbGljaXRseS4gSWZcbiAgICAgICAgICAgIC8vIG9ubHkgYSBsZWFmIGVudHJ5IGlzIGRlbGV0ZWQgaW4gbGF0ZXIgbXV0YXRpb25zLCB0aGUgcGFyZW50IGZpZWxkXG4gICAgICAgICAgICAvLyBzaG91bGQgc3RpbGwgcmVtYWluLCBidXQgd2UgbWF5IGhhdmUgbG9zdCB0aGlzIGluZm9ybWF0aW9uLlxuICAgICAgICAgICAgLy8gQ29uc2lkZXIgbXV0YXRpb24gKGZvby5iYXIgMSksIHRoZW4gbXV0YXRpb24gKGZvby5iYXIgZGVsZXRlKCkpLlxuICAgICAgICAgICAgLy8gVGhpcyBsZWF2ZXMgdGhlIGZpbmFsIHJlc3VsdCAoZm9vLCB7fSkuIERlc3BpdGUgdGhlIGZhY3QgdGhhdCBgZG9jYFxuICAgICAgICAgICAgLy8gaGFzIHRoZSBjb3JyZWN0IHJlc3VsdCwgYGZvb2AgaXMgbm90IGluIGBtYXNrYCwgYW5kIHRoZSByZXN1bHRpbmdcbiAgICAgICAgICAgIC8vIG11dGF0aW9uIHdvdWxkIG1pc3MgYGZvb2AuXG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsID09PSBlICYmIHQubGVuZ3RoID4gMSAmJiAodCA9IHQucG9wTGFzdCgpLCBlID0gbi5maWVsZCh0KSksIG51bGwgPT09IGUgPyBzLmRlbGV0ZSh0KSA6IHMuc2V0KHQsIGUpLCBcbiAgICAgICAgICAgIGkgPSBpLmFkZCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEduKHQua2V5LCBzLCBuZXcgUXQoaS50b0FycmF5KCkpLCBPbi5ub25lKCkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcHBsaWVzIHRoaXMgbXV0YXRpb24gdG8gdGhlIGdpdmVuIGRvY3VtZW50IGZvciB0aGUgcHVycG9zZXMgb2YgY29tcHV0aW5nIGFcbiAqIG5ldyByZW1vdGUgZG9jdW1lbnQuIElmIHRoZSBpbnB1dCBkb2N1bWVudCBkb2Vzbid0IG1hdGNoIHRoZSBleHBlY3RlZCBzdGF0ZVxuICogKGUuZy4gaXQgaXMgaW52YWxpZCBvciBvdXRkYXRlZCksIHRoZSBkb2N1bWVudCB0eXBlIG1heSB0cmFuc2l0aW9uIHRvXG4gKiB1bmtub3duLlxuICpcbiAqIEBwYXJhbSBtdXRhdGlvbiAtIFRoZSBtdXRhdGlvbiB0byBhcHBseS5cbiAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBtdXRhdGUuIFRoZSBpbnB1dCBkb2N1bWVudCBjYW4gYmUgYW5cbiAqICAgICBpbnZhbGlkIGRvY3VtZW50IGlmIHRoZSBjbGllbnQgaGFzIG5vIGtub3dsZWRnZSBvZiB0aGUgcHJlLW11dGF0aW9uIHN0YXRlXG4gKiAgICAgb2YgdGhlIGRvY3VtZW50LlxuICogQHBhcmFtIG11dGF0aW9uUmVzdWx0IC0gVGhlIHJlc3VsdCBvZiBhcHBseWluZyB0aGUgbXV0YXRpb24gZnJvbSB0aGUgYmFja2VuZC5cbiAqLyBmdW5jdGlvbiBCbih0LCBlLCBuKSB7XG4gICAgdCBpbnN0YW5jZW9mIEtuID8gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAvLyBVbmxpa2Ugc2V0TXV0YXRpb25BcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGFcbiAgICAgICAgLy8gcmVtb3RlIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uXG4gICAgICAgIC8vIG11c3QgaGF2ZSBoZWxkLlxuICAgICAgICBjb25zdCBzID0gdC52YWx1ZS5jbG9uZSgpLCBpID0gam4odC5maWVsZFRyYW5zZm9ybXMsIGUsIG4udHJhbnNmb3JtUmVzdWx0cyk7XG4gICAgICAgIHMuc2V0QWxsKGkpLCBlLmNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQobi52ZXJzaW9uLCBzKS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9KHQsIGUsIG4pIDogdCBpbnN0YW5jZW9mIEduID8gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBpZiAoIU1uKHQucHJlY29uZGl0aW9uLCBlKSkgXG4gICAgICAgIC8vIFNpbmNlIHRoZSBtdXRhdGlvbiB3YXMgbm90IHJlamVjdGVkLCB3ZSBrbm93IHRoYXQgdGhlIHByZWNvbmRpdGlvblxuICAgICAgICAvLyBtYXRjaGVkIG9uIHRoZSBiYWNrZW5kLiBXZSB0aGVyZWZvcmUgbXVzdCBub3QgaGF2ZSB0aGUgZXhwZWN0ZWQgdmVyc2lvblxuICAgICAgICAvLyBvZiB0aGUgZG9jdW1lbnQgaW4gb3VyIGNhY2hlIGFuZCBjb252ZXJ0IHRvIGFuIFVua25vd25Eb2N1bWVudCB3aXRoIGFcbiAgICAgICAgLy8ga25vd24gdXBkYXRlVGltZS5cbiAgICAgICAgcmV0dXJuIHZvaWQgZS5jb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQobi52ZXJzaW9uKTtcbiAgICAgICAgY29uc3QgcyA9IGpuKHQuZmllbGRUcmFuc2Zvcm1zLCBlLCBuLnRyYW5zZm9ybVJlc3VsdHMpLCBpID0gZS5kYXRhO1xuICAgICAgICBpLnNldEFsbChRbih0KSksIGkuc2V0QWxsKHMpLCBlLmNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQobi52ZXJzaW9uLCBpKS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9KHQsIGUsIG4pIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAvLyBVbmxpa2UgYXBwbHlUb0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhIHJlbW90ZVxuICAgICAgICAvLyBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvbiBtdXN0XG4gICAgICAgIC8vIGhhdmUgaGVsZC5cbiAgICAgICAgZS5jb252ZXJ0VG9Ob0RvY3VtZW50KG4udmVyc2lvbikuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSgwLCBlLCBuKTtcbn1cblxuLyoqXG4gKiBBcHBsaWVzIHRoaXMgbXV0YXRpb24gdG8gdGhlIGdpdmVuIGRvY3VtZW50IGZvciB0aGUgcHVycG9zZXMgb2YgY29tcHV0aW5nXG4gKiB0aGUgbmV3IGxvY2FsIHZpZXcgb2YgYSBkb2N1bWVudC4gSWYgdGhlIGlucHV0IGRvY3VtZW50IGRvZXNuJ3QgbWF0Y2ggdGhlXG4gKiBleHBlY3RlZCBzdGF0ZSwgdGhlIGRvY3VtZW50IGlzIG5vdCBtb2RpZmllZC5cbiAqXG4gKiBAcGFyYW0gbXV0YXRpb24gLSBUaGUgbXV0YXRpb24gdG8gYXBwbHkuXG4gKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gbXV0YXRlLiBUaGUgaW5wdXQgZG9jdW1lbnQgY2FuIGJlIGFuXG4gKiAgICAgaW52YWxpZCBkb2N1bWVudCBpZiB0aGUgY2xpZW50IGhhcyBubyBrbm93bGVkZ2Ugb2YgdGhlIHByZS1tdXRhdGlvbiBzdGF0ZVxuICogICAgIG9mIHRoZSBkb2N1bWVudC5cbiAqIEBwYXJhbSBwcmV2aW91c01hc2sgLSBUaGUgZmllbGRzIHRoYXQgaGF2ZSBiZWVuIHVwZGF0ZWQgYmVmb3JlIGFwcGx5aW5nIHRoaXMgbXV0YXRpb24uXG4gKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBBIHRpbWVzdGFtcCBpbmRpY2F0aW5nIHRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZVxuICogICAgIGJhdGNoIHRoaXMgbXV0YXRpb24gaXMgYSBwYXJ0IG9mLlxuICogQHJldHVybnMgQSBgRmllbGRNYXNrYCByZXByZXNlbnRpbmcgdGhlIGZpZWxkcyB0aGF0IGFyZSBjaGFuZ2VkIGJ5IGFwcGx5aW5nIHRoaXMgbXV0YXRpb24uXG4gKi8gZnVuY3Rpb24gTG4odCwgZSwgbiwgcykge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgS24gPyBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGlmICghTW4odC5wcmVjb25kaXRpb24sIGUpKSBcbiAgICAgICAgLy8gVGhlIG11dGF0aW9uIGZhaWxlZCB0byBhcHBseSAoZS5nLiBhIGRvY3VtZW50IElEIGNyZWF0ZWQgd2l0aCBhZGQoKVxuICAgICAgICAvLyBjYXVzZWQgYSBuYW1lIGNvbGxpc2lvbikuXG4gICAgICAgIHJldHVybiBuO1xuICAgICAgICBjb25zdCBpID0gdC52YWx1ZS5jbG9uZSgpLCByID0gV24odC5maWVsZFRyYW5zZm9ybXMsIHMsIGUpO1xuICAgICAgICByZXR1cm4gaS5zZXRBbGwociksIGUuY29udmVydFRvRm91bmREb2N1bWVudChlLnZlcnNpb24sIGkpLnNldEhhc0xvY2FsTXV0YXRpb25zKCksIFxuICAgICAgICBudWxsO1xuIC8vIFNldE11dGF0aW9uIG92ZXJ3cml0ZXMgYWxsIGZpZWxkcy5cbiAgICAgICAgfVxuICAgIC8qKlxuICogQSBtdXRhdGlvbiB0aGF0IG1vZGlmaWVzIGZpZWxkcyBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoIHRoZVxuICogZ2l2ZW4gdmFsdWVzLiBUaGUgdmFsdWVzIGFyZSBhcHBsaWVkIHRocm91Z2ggYSBmaWVsZCBtYXNrOlxuICpcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBib3RoIHRoZSBtYXNrIGFuZCB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZyBmaWVsZFxuICogICAgaXMgdXBkYXRlZC5cbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBuZWl0aGVyIHRoZSBtYXNrIG5vciB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZ1xuICogICAgZmllbGQgaXMgdW5tb2RpZmllZC5cbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiB0aGUgbWFzayBidXQgbm90IGluIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyBkZWxldGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIG5vdCBpbiB0aGUgbWFzayBidXQgaXMgaW4gdGhlIHZhbHVlcywgdGhlIHZhbHVlcyBtYXAgaXNcbiAqICAgIGlnbm9yZWQuXG4gKi8gKHQsIGUsIG4sIHMpIDogdCBpbnN0YW5jZW9mIEduID8gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICBpZiAoIU1uKHQucHJlY29uZGl0aW9uLCBlKSkgcmV0dXJuIG47XG4gICAgICAgIGNvbnN0IGkgPSBXbih0LmZpZWxkVHJhbnNmb3JtcywgcywgZSksIHIgPSBlLmRhdGE7XG4gICAgICAgIGlmIChyLnNldEFsbChRbih0KSksIHIuc2V0QWxsKGkpLCBlLmNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoZS52ZXJzaW9uLCByKS5zZXRIYXNMb2NhbE11dGF0aW9ucygpLCBcbiAgICAgICAgbnVsbCA9PT0gbikgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBuLnVuaW9uV2l0aCh0LmZpZWxkTWFzay5maWVsZHMpLnVuaW9uV2l0aCh0LmZpZWxkVHJhbnNmb3Jtcy5tYXAoKHQgPT4gdC5maWVsZCkpKTtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIGEgRmllbGRQYXRoL1ZhbHVlIG1hcCB3aXRoIHRoZSBjb250ZW50IG9mIHRoZSBQYXRjaE11dGF0aW9uLlxuICovICh0LCBlLCBuLCBzKSA6IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKE1uKHQucHJlY29uZGl0aW9uLCBlKSkgcmV0dXJuIGUuY29udmVydFRvTm9Eb2N1bWVudChlLnZlcnNpb24pLnNldEhhc0xvY2FsTXV0YXRpb25zKCksIFxuICAgICAgICBudWxsO1xuICAgICAgICByZXR1cm4gbjtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgdmVyaWZpZXMgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgcHJlY29uZGl0aW9uLlxuICpcbiAqIFRoZSBgdmVyaWZ5YCBvcGVyYXRpb24gaXMgb25seSB1c2VkIGluIFRyYW5zYWN0aW9ucywgYW5kIHRoaXMgY2xhc3Mgc2VydmVzXG4gKiBwcmltYXJpbHkgdG8gZmFjaWxpdGF0ZSBzZXJpYWxpemF0aW9uIGludG8gcHJvdG9zLlxuICovICh0LCBlLCBuKTtcbn1cblxuLyoqXG4gKiBJZiB0aGlzIG11dGF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvIHBlcnNpc3Qgd2l0aFxuICogdGhpcyBtdXRhdGlvbi4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgbXV0YXRpb24gaXMgYWx3YXlzIGFwcGxpZWRcbiAqIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogVGhlIGJhc2UgdmFsdWUgaXMgYSBzcGFyc2Ugb2JqZWN0IHRoYXQgY29uc2lzdHMgb2Ygb25seSB0aGUgZG9jdW1lbnRcbiAqIGZpZWxkcyBmb3Igd2hpY2ggdGhpcyBtdXRhdGlvbiBjb250YWlucyBhIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybWF0aW9uXG4gKiAoZS5nLiBhIG51bWVyaWMgaW5jcmVtZW50KS4gVGhlIHByb3ZpZGVkIHZhbHVlIGd1YXJhbnRlZXMgY29uc2lzdGVudFxuICogYmVoYXZpb3IgZm9yIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybXMgYW5kIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZVxuICogbGF0ZW5jeS1jb21wZW5zYXRlZCB2YWx1ZSBldmVuIGlmIHRoZSBiYWNrZW5kIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlXG4gKiBtdXRhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3IgaWRlbXBvdGVudCBtdXRhdGlvbnMsIGFzIHRoZXkgY2FuIGJlXG4gKiByZS1wbGF5ZWQgZXZlbiBpZiB0aGUgYmFja2VuZCBoYXMgYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCBtdXRhdGlvbnMuXG4gKi8gZnVuY3Rpb24gVW4odCwgZSkge1xuICAgIGxldCBuID0gbnVsbDtcbiAgICBmb3IgKGNvbnN0IHMgb2YgdC5maWVsZFRyYW5zZm9ybXMpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZGF0YS5maWVsZChzLmZpZWxkKSwgaSA9IEFuKHMudHJhbnNmb3JtLCB0IHx8IG51bGwpO1xuICAgICAgICBudWxsICE9IGkgJiYgKG51bGwgPT09IG4gJiYgKG4gPSB2ZS5lbXB0eSgpKSwgbi5zZXQocy5maWVsZCwgaSkpO1xuICAgIH1cbiAgICByZXR1cm4gbiB8fCBudWxsO1xufVxuXG5mdW5jdGlvbiBxbih0LCBlKSB7XG4gICAgcmV0dXJuIHQudHlwZSA9PT0gZS50eXBlICYmICghIXQua2V5LmlzRXF1YWwoZS5rZXkpICYmICghIXQucHJlY29uZGl0aW9uLmlzRXF1YWwoZS5wcmVjb25kaXRpb24pICYmICghIWZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gdCAmJiB2b2lkIDAgPT09IGUgfHwgISghdCB8fCAhZSkgJiYgdHQodCwgZSwgKCh0LCBlKSA9PiBObih0LCBlKSkpO1xuICAgIH0odC5maWVsZFRyYW5zZm9ybXMsIGUuZmllbGRUcmFuc2Zvcm1zKSAmJiAoMCAvKiBTZXQgKi8gPT09IHQudHlwZSA/IHQudmFsdWUuaXNFcXVhbChlLnZhbHVlKSA6IDEgLyogUGF0Y2ggKi8gIT09IHQudHlwZSB8fCB0LmRhdGEuaXNFcXVhbChlLmRhdGEpICYmIHQuZmllbGRNYXNrLmlzRXF1YWwoZS5maWVsZE1hc2spKSkpKTtcbn1cblxuLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgY3JlYXRlcyBvciByZXBsYWNlcyB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoIHRoZVxuICogb2JqZWN0IHZhbHVlIGNvbnRlbnRzLlxuICovIGNsYXNzIEtuIGV4dGVuZHMgRm4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMgPSBbXSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMudmFsdWUgPSBlLCB0aGlzLnByZWNvbmRpdGlvbiA9IG4sIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gcywgXG4gICAgICAgIHRoaXMudHlwZSA9IDAgLyogU2V0ICovO1xuICAgIH1cbiAgICBnZXRGaWVsZE1hc2soKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgR24gZXh0ZW5kcyBGbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSA9IFtdKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMua2V5ID0gdCwgdGhpcy5kYXRhID0gZSwgdGhpcy5maWVsZE1hc2sgPSBuLCB0aGlzLnByZWNvbmRpdGlvbiA9IHMsIFxuICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGksIHRoaXMudHlwZSA9IDEgLyogUGF0Y2ggKi87XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYXNrO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUW4odCkge1xuICAgIGNvbnN0IGUgPSBuZXcgTWFwO1xuICAgIHJldHVybiB0LmZpZWxkTWFzay5maWVsZHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgIGlmICghbi5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0LmRhdGEuZmllbGQobik7XG4gICAgICAgICAgICBlLnNldChuLCBzKTtcbiAgICAgICAgfVxuICAgIH0pKSwgZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhIG11dGF0aW9uXG4gKiBjb250YWluaW5nIHRyYW5zZm9ybXMgaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogcHJldmlvdXMgbXV0YXRpb25zLlxuICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgLSBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIGpuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBNKHQubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSB0W2ldLCBvID0gci50cmFuc2Zvcm0sIHUgPSBlLmRhdGEuZmllbGQoci5maWVsZCk7XG4gICAgICAgIHMuc2V0KHIuZmllbGQsIEVuKG8sIHUsIG5baV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2Ugd2hlbiBhcHBseWluZyBhXG4gKiB0cmFuc2Zvcm0gbG9jYWxseS5cbiAqXG4gKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gVGhlIGZpZWxkIHRyYW5zZm9ybXMgdG8gYXBwbHkgdGhlIHJlc3VsdCB0by5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIFRoZSBsb2NhbCB0aW1lIG9mIHRoZSBtdXRhdGlvbiAodXNlZCB0b1xuICogICAgIGdlbmVyYXRlIFNlcnZlclRpbWVzdGFtcFZhbHVlcykuXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIGFwcGx5IHRyYW5zZm9ybXMgb24uXG4gKiBAcmV0dXJucyBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cbiAqLyBmdW5jdGlvbiBXbih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IG5ldyBNYXA7XG4gICAgZm9yIChjb25zdCBpIG9mIHQpIHtcbiAgICAgICAgY29uc3QgdCA9IGkudHJhbnNmb3JtLCByID0gbi5kYXRhLmZpZWxkKGkuZmllbGQpO1xuICAgICAgICBzLnNldChpLmZpZWxkLCBUbih0LCByLCBlKSk7XG4gICAgfVxuICAgIHJldHVybiBzO1xufVxuXG4vKiogQSBtdXRhdGlvbiB0aGF0IGRlbGV0ZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkuICovIGNsYXNzIHpuIGV4dGVuZHMgRm4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IGUsIHRoaXMudHlwZSA9IDIgLyogRGVsZXRlICovICwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBbXTtcbiAgICB9XG4gICAgZ2V0RmllbGRNYXNrKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmNsYXNzIEhuIGV4dGVuZHMgRm4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IGUsIHRoaXMudHlwZSA9IDMgLyogVmVyaWZ5ICovICwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBbXTtcbiAgICB9XG4gICAgZ2V0RmllbGRNYXNrKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEpuIHtcbiAgICAvLyBUT0RPKGIvMzMwNzgxNjMpOiBqdXN0IHVzZSBzaW1wbGVzdCBmb3JtIG9mIGV4aXN0ZW5jZSBmaWx0ZXIgZm9yIG5vd1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5jb3VudCA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFcnJvciBDb2RlcyBkZXNjcmliaW5nIHRoZSBkaWZmZXJlbnQgd2F5cyBHUlBDIGNhbiBmYWlsLiBUaGVzZSBhcmUgY29waWVkXG4gKiBkaXJlY3RseSBmcm9tIEdSUEMncyBzb3VyY2VzIGhlcmU6XG4gKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAqXG4gKiBJbXBvcnRhbnQhIFRoZSBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBtYXR0ZXIgYmVjYXVzZSB0aGUgc3RyaW5nIGZvcm1zXG4gKiBhcmUgdXNlZCBmb3IgcmV2ZXJzZSBsb29rdXBzIGZyb20gdGhlIHdlYmNoYW5uZWwgc3RyZWFtLiBEbyBOT1QgY2hhbmdlIHRoZVxuICogbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMgb3IgY2hhbmdlIHRoaXMgaW50byBhIGNvbnN0IGVudW0uXG4gKi8gdmFyIFluLCBYbjtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgbm9uLXdyaXRlIG9wZXJhdGlvbi5cbiAqXG4gKiBTZWUgaXNQZXJtYW5lbnRXcml0ZUVycm9yIGZvciBjbGFzc2lmeWluZyB3cml0ZSBlcnJvcnMuXG4gKi9cbmZ1bmN0aW9uIFpuKHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBPKCk7XG5cbiAgICAgIGNhc2UgQi5DQU5DRUxMRUQ6XG4gICAgICBjYXNlIEIuVU5LTk9XTjpcbiAgICAgIGNhc2UgQi5ERUFETElORV9FWENFRURFRDpcbiAgICAgIGNhc2UgQi5SRVNPVVJDRV9FWEhBVVNURUQ6XG4gICAgICBjYXNlIEIuSU5URVJOQUw6XG4gICAgICBjYXNlIEIuVU5BVkFJTEFCTEU6XG4gLy8gVW5hdXRoZW50aWNhdGVkIG1lYW5zIHNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggb3VyIHRva2VuIGFuZCB3ZSBuZWVkXG4gICAgICAgIC8vIHRvIHJldHJ5IHdpdGggbmV3IGNyZWRlbnRpYWxzIHdoaWNoIHdpbGwgaGFwcGVuIGF1dG9tYXRpY2FsbHkuXG4gICAgICAgICAgICAgIGNhc2UgQi5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiAhMTtcblxuICAgICAgY2FzZSBCLklOVkFMSURfQVJHVU1FTlQ6XG4gICAgICBjYXNlIEIuTk9UX0ZPVU5EOlxuICAgICAgY2FzZSBCLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgY2FzZSBCLlBFUk1JU1NJT05fREVOSUVEOlxuICAgICAgY2FzZSBCLkZBSUxFRF9QUkVDT05ESVRJT046XG4gLy8gQWJvcnRlZCBtaWdodCBiZSByZXRyaWVkIGluIHNvbWUgc2NlbmFyaW9zLCBidXQgdGhhdCBpcyBkZXBlbmRhbnQgb25cbiAgICAgICAgLy8gdGhlIGNvbnRleHQgYW5kIHNob3VsZCBoYW5kbGVkIGluZGl2aWR1YWxseSBieSB0aGUgY2FsbGluZyBjb2RlLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2FwaXMvZGVzaWduL2Vycm9ycy5cbiAgICAgICAgICAgICAgY2FzZSBCLkFCT1JURUQ6XG4gICAgICBjYXNlIEIuT1VUX09GX1JBTkdFOlxuICAgICAgY2FzZSBCLlVOSU1QTEVNRU5URUQ6XG4gICAgICBjYXNlIEIuREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBlcnJvciBjb2RlIHJlcHJlc2VudHMgYSBwZXJtYW5lbnQgZXJyb3Igd2hlbiByZWNlaXZlZFxuICogaW4gcmVzcG9uc2UgdG8gYSB3cml0ZSBvcGVyYXRpb24uXG4gKlxuICogV3JpdGUgb3BlcmF0aW9ucyBtdXN0IGJlIGhhbmRsZWQgc3BlY2lhbGx5IGJlY2F1c2UgYXMgb2YgYi8xMTk0Mzc3NjQsIEFCT1JURURcbiAqIGVycm9ycyBvbiB0aGUgd3JpdGUgc3RyZWFtIHNob3VsZCBiZSByZXRyaWVkIHRvbyAoZXZlbiB0aG91Z2ggQUJPUlRFRCBlcnJvcnNcbiAqIGFyZSBub3QgZ2VuZXJhbGx5IHJldHJ5YWJsZSkuXG4gKlxuICogTm90ZSB0aGF0IGR1cmluZyB0aGUgaW5pdGlhbCBoYW5kc2hha2Ugb24gdGhlIHdyaXRlIHN0cmVhbSBhbiBBQk9SVEVEIGVycm9yXG4gKiBzaWduYWxzIHRoYXQgd2Ugc2hvdWxkIGRpc2NhcmQgb3VyIHN0cmVhbSB0b2tlbiAoaS5lLiBpdCBpcyBwZXJtYW5lbnQpLiBUaGlzXG4gKiBtZWFucyBhIGhhbmRzaGFrZSBlcnJvciBzaG91bGQgYmUgY2xhc3NpZmllZCB3aXRoIGlzUGVybWFuZW50RXJyb3IsIGFib3ZlLlxuICovXG4vKipcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIEdSUEMgc3RhdHVzIGNvZGUgbnVtYmVyLCBsaWtlIDAsIDEsIG9yIDE0LiBUaGVzZVxuICogYXJlIG5vdCB0aGUgc2FtZSBhcyBIVFRQIHN0YXR1cyBjb2Rlcy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBHUlBDIHN0YXR1cyBjb2RlLiBGYWlscyBpZiB0aGVyZVxuICogICAgIGlzIG5vIG1hdGNoLlxuICovXG5mdW5jdGlvbiB0cyh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgXG4gICAgLy8gVGhpcyBzaG91bGRuJ3Qgbm9ybWFsbHkgaGFwcGVuLCBidXQgaW4gY2VydGFpbiBlcnJvciBjYXNlcyAobGlrZSB0cnlpbmdcbiAgICAvLyB0byBzZW5kIGludmFsaWQgcHJvdG8gbWVzc2FnZXMpIHdlIG1heSBnZXQgYW4gZXJyb3Igd2l0aCBubyBHUlBDIGNvZGUuXG4gICAgcmV0dXJuIHgoXCJHUlBDIGVycm9yIGhhcyBubyAuY29kZVwiKSwgQi5VTktOT1dOO1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSBZbi5PSzpcbiAgICAgICAgcmV0dXJuIEIuT0s7XG5cbiAgICAgIGNhc2UgWW4uQ0FOQ0VMTEVEOlxuICAgICAgICByZXR1cm4gQi5DQU5DRUxMRUQ7XG5cbiAgICAgIGNhc2UgWW4uVU5LTk9XTjpcbiAgICAgICAgcmV0dXJuIEIuVU5LTk9XTjtcblxuICAgICAgY2FzZSBZbi5ERUFETElORV9FWENFRURFRDpcbiAgICAgICAgcmV0dXJuIEIuREVBRExJTkVfRVhDRUVERUQ7XG5cbiAgICAgIGNhc2UgWW4uUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgICByZXR1cm4gQi5SRVNPVVJDRV9FWEhBVVNURUQ7XG5cbiAgICAgIGNhc2UgWW4uSU5URVJOQUw6XG4gICAgICAgIHJldHVybiBCLklOVEVSTkFMO1xuXG4gICAgICBjYXNlIFluLlVOQVZBSUxBQkxFOlxuICAgICAgICByZXR1cm4gQi5VTkFWQUlMQUJMRTtcblxuICAgICAgY2FzZSBZbi5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiBCLlVOQVVUSEVOVElDQVRFRDtcblxuICAgICAgY2FzZSBZbi5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgICByZXR1cm4gQi5JTlZBTElEX0FSR1VNRU5UO1xuXG4gICAgICBjYXNlIFluLk5PVF9GT1VORDpcbiAgICAgICAgcmV0dXJuIEIuTk9UX0ZPVU5EO1xuXG4gICAgICBjYXNlIFluLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgICByZXR1cm4gQi5BTFJFQURZX0VYSVNUUztcblxuICAgICAgY2FzZSBZbi5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgICAgcmV0dXJuIEIuUEVSTUlTU0lPTl9ERU5JRUQ7XG5cbiAgICAgIGNhc2UgWW4uRkFJTEVEX1BSRUNPTkRJVElPTjpcbiAgICAgICAgcmV0dXJuIEIuRkFJTEVEX1BSRUNPTkRJVElPTjtcblxuICAgICAgY2FzZSBZbi5BQk9SVEVEOlxuICAgICAgICByZXR1cm4gQi5BQk9SVEVEO1xuXG4gICAgICBjYXNlIFluLk9VVF9PRl9SQU5HRTpcbiAgICAgICAgcmV0dXJuIEIuT1VUX09GX1JBTkdFO1xuXG4gICAgICBjYXNlIFluLlVOSU1QTEVNRU5URUQ6XG4gICAgICAgIHJldHVybiBCLlVOSU1QTEVNRU5URUQ7XG5cbiAgICAgIGNhc2UgWW4uREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gQi5EQVRBX0xPU1M7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBPKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIEhUVFAgcmVzcG9uc2UncyBlcnJvciBzdGF0dXMgdG8gdGhlIGVxdWl2YWxlbnQgZXJyb3IgY29kZS5cbiAqXG4gKiBAcGFyYW0gc3RhdHVzIC0gQW4gSFRUUCBlcnJvciByZXNwb25zZSBzdGF0dXMgKFwiRkFJTEVEX1BSRUNPTkRJVElPTlwiLFxuICogXCJVTktOT1dOXCIsIGV0Yy4pXG4gKiBAcmV0dXJucyBUaGUgZXF1aXZhbGVudCBDb2RlLiBOb24tbWF0Y2hpbmcgcmVzcG9uc2VzIGFyZSBtYXBwZWQgdG9cbiAqICAgICBDb2RlLlVOS05PV04uXG4gKi8gKFhuID0gWW4gfHwgKFluID0ge30pKVtYbi5PSyA9IDBdID0gXCJPS1wiLCBYbltYbi5DQU5DRUxMRUQgPSAxXSA9IFwiQ0FOQ0VMTEVEXCIsIFxuWG5bWG4uVU5LTk9XTiA9IDJdID0gXCJVTktOT1dOXCIsIFhuW1huLklOVkFMSURfQVJHVU1FTlQgPSAzXSA9IFwiSU5WQUxJRF9BUkdVTUVOVFwiLCBcblhuW1huLkRFQURMSU5FX0VYQ0VFREVEID0gNF0gPSBcIkRFQURMSU5FX0VYQ0VFREVEXCIsIFhuW1huLk5PVF9GT1VORCA9IDVdID0gXCJOT1RfRk9VTkRcIiwgXG5YbltYbi5BTFJFQURZX0VYSVNUUyA9IDZdID0gXCJBTFJFQURZX0VYSVNUU1wiLCBYbltYbi5QRVJNSVNTSU9OX0RFTklFRCA9IDddID0gXCJQRVJNSVNTSU9OX0RFTklFRFwiLCBcblhuW1huLlVOQVVUSEVOVElDQVRFRCA9IDE2XSA9IFwiVU5BVVRIRU5USUNBVEVEXCIsIFhuW1huLlJFU09VUkNFX0VYSEFVU1RFRCA9IDhdID0gXCJSRVNPVVJDRV9FWEhBVVNURURcIiwgXG5YbltYbi5GQUlMRURfUFJFQ09ORElUSU9OID0gOV0gPSBcIkZBSUxFRF9QUkVDT05ESVRJT05cIiwgWG5bWG4uQUJPUlRFRCA9IDEwXSA9IFwiQUJPUlRFRFwiLCBcblhuW1huLk9VVF9PRl9SQU5HRSA9IDExXSA9IFwiT1VUX09GX1JBTkdFXCIsIFhuW1huLlVOSU1QTEVNRU5URUQgPSAxMl0gPSBcIlVOSU1QTEVNRU5URURcIiwgXG5YbltYbi5JTlRFUk5BTCA9IDEzXSA9IFwiSU5URVJOQUxcIiwgWG5bWG4uVU5BVkFJTEFCTEUgPSAxNF0gPSBcIlVOQVZBSUxBQkxFXCIsIFhuW1huLkRBVEFfTE9TUyA9IDE1XSA9IFwiREFUQV9MT1NTXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgbWFwIGltcGxlbWVudGF0aW9uIHRoYXQgdXNlcyBvYmplY3RzIGFzIGtleXMuIE9iamVjdHMgbXVzdCBoYXZlIGFuXG4gKiBhc3NvY2lhdGVkIGVxdWFscyBmdW5jdGlvbiBhbmQgbXVzdCBiZSBpbW11dGFibGUuIEVudHJpZXMgaW4gdGhlIG1hcCBhcmVcbiAqIHN0b3JlZCB0b2dldGhlciB3aXRoIHRoZSBrZXkgYmVpbmcgcHJvZHVjZWQgZnJvbSB0aGUgbWFwS2V5Rm4uIFRoaXMgbWFwXG4gKiBhdXRvbWF0aWNhbGx5IGhhbmRsZXMgY29sbGlzaW9ucyBvZiBrZXlzLlxuICovXG5jbGFzcyBlcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLm1hcEtleUZuID0gdCwgdGhpcy5lcXVhbHNGbiA9IGUsIFxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGlubmVyIG1hcCBmb3IgYSBrZXkvdmFsdWUgcGFpci4gRHVlIHRvIHRoZSBwb3NzaWJpbGl0eSBvZiBjb2xsaXNpb25zIHdlXG4gICAgICAgICAqIGtlZXAgYSBsaXN0IG9mIGVudHJpZXMgdGhhdCB3ZSBkbyBhIGxpbmVhciBzZWFyY2ggdGhyb3VnaCB0byBmaW5kIGFuIGFjdHVhbFxuICAgICAgICAgKiBtYXRjaC4gTm90ZSB0aGF0IGNvbGxpc2lvbnMgc2hvdWxkIGJlIHJhcmUsIHNvIHdlIHN0aWxsIGV4cGVjdCBuZWFyXG4gICAgICAgICAqIGNvbnN0YW50IHRpbWUgbG9va3VwcyBpbiBwcmFjdGljZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5uZXIgPSB7fSwgXG4gICAgICAgIC8qKiBUaGUgbnVtYmVyIG9mIGVudHJpZXMgc3RvcmVkIGluIHRoZSBtYXAgKi9cbiAgICAgICAgdGhpcy5pbm5lclNpemUgPSAwO1xuICAgIH1cbiAgICAvKiogR2V0IGEgdmFsdWUgZm9yIHRoaXMga2V5LCBvciB1bmRlZmluZWQgaWYgaXQgZG9lcyBub3QgZXhpc3QuICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLm1hcEtleUZuKHQpLCBuID0gdGhpcy5pbm5lcltlXTtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gbikgZm9yIChjb25zdCBbZSwgc10gb2YgbikgaWYgKHRoaXMuZXF1YWxzRm4oZSwgdCkpIHJldHVybiBzO1xuICAgIH1cbiAgICBoYXModCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLmdldCh0KTtcbiAgICB9XG4gICAgLyoqIFB1dCB0aGlzIGtleSBhbmQgdmFsdWUgaW4gdGhlIG1hcC4gKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMubWFwS2V5Rm4odCksIHMgPSB0aGlzLmlubmVyW25dO1xuICAgICAgICBpZiAodm9pZCAwID09PSBzKSByZXR1cm4gdGhpcy5pbm5lcltuXSA9IFsgWyB0LCBlIF0gXSwgdm9pZCB0aGlzLmlubmVyU2l6ZSsrO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHMubGVuZ3RoOyBuKyspIGlmICh0aGlzLmVxdWFsc0ZuKHNbbl1bMF0sIHQpKSBcbiAgICAgICAgLy8gVGhpcyBpcyB1cGRhdGluZyBhbiBleGlzdGluZyBlbnRyeSBhbmQgZG9lcyBub3QgaW5jcmVhc2UgYGlubmVyU2l6ZWAuXG4gICAgICAgIHJldHVybiB2b2lkIChzW25dID0gWyB0LCBlIF0pO1xuICAgICAgICBzLnB1c2goWyB0LCBlIF0pLCB0aGlzLmlubmVyU2l6ZSsrO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhpcyBrZXkgZnJvbSB0aGUgbWFwLiBSZXR1cm5zIGEgYm9vbGVhbiBpZiBhbnl0aGluZyB3YXMgZGVsZXRlZC5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwS2V5Rm4odCksIG4gPSB0aGlzLmlubmVyW2VdO1xuICAgICAgICBpZiAodm9pZCAwID09PSBuKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IHMgPSAwOyBzIDwgbi5sZW5ndGg7IHMrKykgaWYgKHRoaXMuZXF1YWxzRm4obltzXVswXSwgdCkpIHJldHVybiAxID09PSBuLmxlbmd0aCA/IGRlbGV0ZSB0aGlzLmlubmVyW2VdIDogbi5zcGxpY2UocywgMSksIFxuICAgICAgICB0aGlzLmlubmVyU2l6ZS0tLCAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgRnQodGhpcy5pbm5lciwgKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtlLCBzXSBvZiBuKSB0KGUsIHMpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiAkdCh0aGlzLmlubmVyKTtcbiAgICB9XG4gICAgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5uZXJTaXplO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgbnMgPSBuZXcgQnQoY3QuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIHNzKCkge1xuICAgIHJldHVybiBucztcbn1cblxuY29uc3QgaXMgPSBuZXcgQnQoY3QuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIHJzKC4uLnQpIHtcbiAgICBsZXQgZSA9IGlzO1xuICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5pbnNlcnQobi5rZXksIG4pO1xuICAgIHJldHVybiBlO1xufVxuXG5mdW5jdGlvbiBvcyh0KSB7XG4gICAgbGV0IGUgPSBpcztcbiAgICByZXR1cm4gdC5mb3JFYWNoKCgodCwgbikgPT4gZSA9IGUuaW5zZXJ0KHQsIG4ub3ZlcmxheWVkRG9jdW1lbnQpKSksIGU7XG59XG5cbmZ1bmN0aW9uIHVzKCkge1xuICAgIHJldHVybiBhcygpO1xufVxuXG5mdW5jdGlvbiBjcygpIHtcbiAgICByZXR1cm4gYXMoKTtcbn1cblxuZnVuY3Rpb24gYXMoKSB7XG4gICAgcmV0dXJuIG5ldyBlcygodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xufVxuXG5jb25zdCBocyA9IG5ldyBCdChjdC5jb21wYXJhdG9yKTtcblxuY29uc3QgbHMgPSBuZXcgcXQoY3QuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIGZzKC4uLnQpIHtcbiAgICBsZXQgZSA9IGxzO1xuICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5hZGQobik7XG4gICAgcmV0dXJuIGU7XG59XG5cbmNvbnN0IGRzID0gbmV3IHF0KFopO1xuXG5mdW5jdGlvbiBfcygpIHtcbiAgICByZXR1cm4gZHM7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGV2ZW50IGZyb20gdGhlIFJlbW90ZVN0b3JlLiBJdCBpcyBzcGxpdCBpbnRvIHRhcmdldENoYW5nZXMgKGNoYW5nZXMgdG8gdGhlXG4gKiBzdGF0ZSBvciB0aGUgc2V0IG9mIGRvY3VtZW50cyBpbiBvdXIgd2F0Y2hlZCB0YXJnZXRzKSBhbmQgZG9jdW1lbnRVcGRhdGVzXG4gKiAoY2hhbmdlcyB0byB0aGUgYWN0dWFsIGRvY3VtZW50cykuXG4gKi8gY2xhc3Mgd3Mge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoaXMgZXZlbnQgYnJpbmdzIHVzIHVwIHRvLCBvciBNSU4gaWYgbm90IHNldC5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIG1hcCBmcm9tIHRhcmdldCB0byBjaGFuZ2VzIHRvIHRoZSB0YXJnZXQuIFNlZSBUYXJnZXRDaGFuZ2UuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2YgdGFyZ2V0cyB0aGF0IGlzIGtub3duIHRvIGJlIGluY29uc2lzdGVudC4gTGlzdGVucyBmb3IgdGhlc2VcbiAgICAgKiB0YXJnZXRzIHNob3VsZCBiZSByZS1lc3RhYmxpc2hlZCB3aXRob3V0IHJlc3VtZSB0b2tlbnMuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnRzIGhhdmUgY2hhbmdlZCBvciBiZWVuIGRlbGV0ZWQsIGFsb25nIHdpdGggdGhlXG4gICAgICogZG9jJ3MgbmV3IHZhbHVlcyAoaWYgbm90IGRlbGV0ZWQpLlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIEEgc2V0IG9mIHdoaWNoIGRvY3VtZW50IHVwZGF0ZXMgYXJlIGR1ZSBvbmx5IHRvIGxpbWJvIHJlc29sdXRpb24gdGFyZ2V0cy5cbiAgICAgKi9cbiAgICBpKSB7XG4gICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uID0gdCwgdGhpcy50YXJnZXRDaGFuZ2VzID0gZSwgdGhpcy50YXJnZXRNaXNtYXRjaGVzID0gbiwgdGhpcy5kb2N1bWVudFVwZGF0ZXMgPSBzLCBcbiAgICAgICAgdGhpcy5yZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSEFDSzogVmlld3MgcmVxdWlyZSBSZW1vdGVFdmVudHMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHZpZXcgaXNcbiAgICAgKiBDVVJSRU5ULCBidXQgc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgcmVjZWl2ZSByZW1vdGUgZXZlbnRzLiBTbyB0aGlzIG1ldGhvZCBpc1xuICAgICAqIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBhXG4gICAgICogQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldywgZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnQgdGFiLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBzdGF0aWMgY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIHMuc2V0KHQsIG1zLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlLCBuKSksIG5ldyB3cyhzdC5taW4oKSwgcywgX3MoKSwgc3MoKSwgZnMoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgVGFyZ2V0Q2hhbmdlIHNwZWNpZmllcyB0aGUgc2V0IG9mIGNoYW5nZXMgZm9yIGEgc3BlY2lmaWMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAqIGEgUmVtb3RlRXZlbnQuIFRoZXNlIGNoYW5nZXMgdHJhY2sgd2hpY2ggZG9jdW1lbnRzIGFyZSBhZGRlZCwgbW9kaWZpZWQgb3JcbiAqIHJlbW92ZWQsIGFzIHdlbGwgYXMgdGhlIHRhcmdldCdzIHJlc3VtZSB0b2tlbiBhbmQgd2hldGhlciB0aGUgdGFyZ2V0IGlzXG4gKiBtYXJrZWQgQ1VSUkVOVC5cbiAqIFRoZSBhY3R1YWwgY2hhbmdlcyAqdG8qIGRvY3VtZW50cyBhcmUgbm90IHBhcnQgb2YgdGhlIFRhcmdldENoYW5nZSBzaW5jZVxuICogZG9jdW1lbnRzIG1heSBiZSBwYXJ0IG9mIG11bHRpcGxlIHRhcmdldHMuXG4gKi8gY2xhc3MgbXMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmUgcmVzdW1lZFxuICAgICAqIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdCBtYXRjaGVzIHRoZVxuICAgICAqIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2hcbiAgICAgKiB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBcImN1cnJlbnRcIiAoc3luY2VkKSBzdGF0dXMgb2YgdGhpcyB0YXJnZXQuIE5vdGUgdGhhdCBcImN1cnJlbnRcIlxuICAgICAqIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbCB0aGF0IGltcGxpZXMgdGhhdCBhIHRhcmdldCBpc1xuICAgICAqIGJvdGggdXAtdG8tZGF0ZSBhbmQgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaCBzdHJlYW0uXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIG5ld2x5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAgICAgKiB0aGlzIHJlbW90ZSBldmVudC5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgYWxyZWFkeSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBidXQgcmVjZWl2ZWRcbiAgICAgKiBhbiB1cGRhdGUgZHVyaW5nIHRoaXMgcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSByZW1vdmVkIGZyb20gdGhpcyB0YXJnZXQgYXMgcGFydCBvZiB0aGlzXG4gICAgICogcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHQsIHRoaXMuY3VycmVudCA9IGUsIHRoaXMuYWRkZWREb2N1bWVudHMgPSBuLCB0aGlzLm1vZGlmaWVkRG9jdW1lbnRzID0gcywgXG4gICAgICAgIHRoaXMucmVtb3ZlZERvY3VtZW50cyA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgVGFyZ2V0Q2hhbmdlcyB0aGF0IGNhbiBiZSB1c2VkIHRvXG4gICAgICogYXBwbHkgYSBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3IChmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudFxuICAgICAqIHRhYikgb3IgZm9yIG5ldyBxdWVyaWVzICh0byByYWlzZSBzbmFwc2hvdHMgd2l0aCBjb3JyZWN0IENVUlJFTlQgc3RhdHVzKS5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgbXMobiwgZSwgZnMoKSwgZnMoKSwgZnMoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgY2hhbmdlZCBkb2N1bWVudCBhbmQgYSBsaXN0IG9mIHRhcmdldCBpZHMgdG8gd2hpY2ggdGhpcyBjaGFuZ2VcbiAqIGFwcGxpZXMuXG4gKlxuICogSWYgZG9jdW1lbnQgaGFzIGJlZW4gZGVsZXRlZCBOb0RvY3VtZW50IHdpbGwgYmUgcHJvdmlkZWQuXG4gKi8gY2xhc3MgZ3Mge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGFwcGxpZXMgdG8gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgaXMgcmVtb3ZlZCBmcm9tIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCBmb3IgdGhpcyBjaGFuZ2UuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG5ldyBkb2N1bWVudCBvciBOb0RvY3VtZW50IGlmIGl0IHdhcyBkZWxldGVkLiBJcyBudWxsIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IHdlbnQgb3V0IG9mIHZpZXcgd2l0aG91dCB0aGUgc2VydmVyIHNlbmRpbmcgYSBuZXcgZG9jdW1lbnQuXG4gICAgICovXG4gICAgcykge1xuICAgICAgICB0aGlzLlR0ID0gdCwgdGhpcy5yZW1vdmVkVGFyZ2V0SWRzID0gZSwgdGhpcy5rZXkgPSBuLCB0aGlzLkV0ID0gcztcbiAgICB9XG59XG5cbmNsYXNzIHlzIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLkF0ID0gZTtcbiAgICB9XG59XG5cbmNsYXNzIHBzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogV2hhdCBraW5kIG9mIGNoYW5nZSBvY2N1cnJlZCB0byB0aGUgd2F0Y2ggdGFyZ2V0LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgdGFyZ2V0IElEcyB0aGF0IHdlcmUgYWRkZWQvcmVtb3ZlZC9zZXQuICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBuID0gV3QuRU1QVFlfQllURV9TVFJJTkdcbiAgICAvKiogQW4gUlBDIGVycm9yIGluZGljYXRpbmcgd2h5IHRoZSB3YXRjaCBmYWlsZWQuICovICwgcyA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIHRoaXMudGFyZ2V0SWRzID0gZSwgdGhpcy5yZXN1bWVUb2tlbiA9IG4sIHRoaXMuY2F1c2UgPSBzO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQuICovIGNsYXNzIElzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgKGFkZHMgb3IgcmVtb3ZlcykgdGhhdCB3ZSBhcmUgd2FpdGluZyBvbi5cbiAgICAgICAgICogV2Ugb25seSBjb25zaWRlciB0YXJnZXRzIGFjdGl2ZSB0aGF0IGhhdmUgbm8gcGVuZGluZyByZXNwb25zZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlJ0ID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnQgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZXNlIGNoYW5nZXMgYXJlIGNvbnRpbnVvdXNseSB1cGRhdGVkIGFzIHdlIHJlY2VpdmUgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgICAgICogYWx3YXlzIHJlZmxlY3QgdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMgYWdhaW5zdCB0aGUgbGFzdCBpc3N1ZWQgc25hcHNob3QuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ0ID0gQXMoKSwgXG4gICAgICAgIC8qKiBTZWUgcHVibGljIGdldHRlcnMgZm9yIGV4cGxhbmF0aW9ucyBvZiB0aGVzZSBmaWVsZHMuICovXG4gICAgICAgIHRoaXMuUHQgPSBXdC5FTVBUWV9CWVRFX1NUUklORywgdGhpcy52dCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgc3RhdGUgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBuZXh0IHNuYXBzaG90LiBXZVxuICAgICAgICAgKiBpbml0aWFsaXplIHRvIHRydWUgc28gdGhhdCBuZXdseS1hZGRlZCB0YXJnZXRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgbmV4dFxuICAgICAgICAgKiBSZW1vdGVFdmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuVnQgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGlzIHRhcmdldCBoYXMgYmVlbiBtYXJrZWQgJ2N1cnJlbnQnLlxuICAgICAqXG4gICAgICogJ0N1cnJlbnQnIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbDogSXQgaW1wbGllcyB0aGF0IHRoZVxuICAgICAqIFdhdGNoIGJhY2tlbmQgaGFzIHNlbnQgdXMgYWxsIGNoYW5nZXMgdXAgdG8gdGhlIHBvaW50IGF0IHdoaWNoIHRoZSB0YXJnZXRcbiAgICAgKiB3YXMgYWRkZWQgYW5kIHRoYXQgdGhlIHRhcmdldCBpcyBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoXG4gICAgICogc3RyZWFtLlxuICAgICAqLyAgICBnZXQgY3VycmVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudnQ7XG4gICAgfVxuICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovICAgIGdldCByZXN1bWVUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUHQ7XG4gICAgfVxuICAgIC8qKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBwZW5kaW5nIHRhcmdldCBhZGRzIG9yIHRhcmdldCByZW1vdmVzLiAqLyAgICBnZXQgU3QoKSB7XG4gICAgICAgIHJldHVybiAwICE9PSB0aGlzLlJ0O1xuICAgIH1cbiAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovICAgIGdldCBEdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIHJlc3VtZSB0b2tlbiB0byB0aGUgVGFyZ2V0Q2hhbmdlLCBidXQgb25seSB3aGVuIGl0IGhhcyBhIG5ld1xuICAgICAqIHZhbHVlLiBFbXB0eSByZXN1bWVUb2tlbnMgYXJlIGRpc2NhcmRlZC5cbiAgICAgKi8gICAgQ3QodCkge1xuICAgICAgICB0LmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgJiYgKHRoaXMuVnQgPSAhMCwgdGhpcy5QdCA9IHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdGFyZ2V0IGNoYW5nZSBmcm9tIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogVG8gcmVzZXQgdGhlIGRvY3VtZW50IGNoYW5nZXMgYWZ0ZXIgcmFpc2luZyB0aGlzIHNuYXBzaG90LCBjYWxsXG4gICAgICogYGNsZWFyUGVuZGluZ0NoYW5nZXMoKWAuXG4gICAgICovICAgIHh0KCkge1xuICAgICAgICBsZXQgdCA9IGZzKCksIGUgPSBmcygpLCBuID0gZnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnQuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgIHQgPSB0LmFkZChzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIgLyogTW9kaWZpZWQgKi8gOlxuICAgICAgICAgICAgICAgIGUgPSBlLmFkZChzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgTygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIG5ldyBtcyh0aGlzLlB0LCB0aGlzLnZ0LCB0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXG4gICAgICovICAgIE50KCkge1xuICAgICAgICB0aGlzLlZ0ID0gITEsIHRoaXMuYnQgPSBBcygpO1xuICAgIH1cbiAgICBrdCh0LCBlKSB7XG4gICAgICAgIHRoaXMuVnQgPSAhMCwgdGhpcy5idCA9IHRoaXMuYnQuaW5zZXJ0KHQsIGUpO1xuICAgIH1cbiAgICBPdCh0KSB7XG4gICAgICAgIHRoaXMuVnQgPSAhMCwgdGhpcy5idCA9IHRoaXMuYnQucmVtb3ZlKHQpO1xuICAgIH1cbiAgICBNdCgpIHtcbiAgICAgICAgdGhpcy5SdCArPSAxO1xuICAgIH1cbiAgICBGdCgpIHtcbiAgICAgICAgdGhpcy5SdCAtPSAxO1xuICAgIH1cbiAgICAkdCgpIHtcbiAgICAgICAgdGhpcy5WdCA9ICEwLCB0aGlzLnZ0ID0gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXG4gKi9cbmNsYXNzIFRzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuQnQgPSB0LCBcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xuICAgICAgICB0aGlzLkx0ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXG4gICAgICAgIHRoaXMuVXQgPSBzcygpLCBcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xuICAgICAgICB0aGlzLnF0ID0gRXMoKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy4gVGhlc2UgdGFyZ2V0cyBhcmVcbiAgICAgICAgICoga25vd24gdG8gYmUgaW5jb25zaXN0ZW50IGFuZCB0aGVpciBsaXN0ZW5zIG5lZWRzIHRvIGJlIHJlLWVzdGFibGlzaGVkIGJ5XG4gICAgICAgICAqIFJlbW90ZVN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5LdCA9IG5ldyBxdChaKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBEb2N1bWVudFdhdGNoQ2hhbmdlIHRvIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxuICAgICAqLyAgICBHdCh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0LlR0KSB0LkV0ICYmIHQuRXQuaXNGb3VuZERvY3VtZW50KCkgPyB0aGlzLlF0KGUsIHQuRXQpIDogdGhpcy5qdChlLCB0LmtleSwgdC5FdCk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0LnJlbW92ZWRUYXJnZXRJZHMpIHRoaXMuanQoZSwgdC5rZXksIHQuRXQpO1xuICAgIH1cbiAgICAvKiogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBXYXRjaFRhcmdldENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy4gKi8gICAgV3QodCkge1xuICAgICAgICB0aGlzLmZvckVhY2hUYXJnZXQodCwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuenQoZSk7XG4gICAgICAgICAgICBzd2l0Y2ggKHQuc3RhdGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAwIC8qIE5vQ2hhbmdlICovIDpcbiAgICAgICAgICAgICAgICB0aGlzLkh0KGUpICYmIG4uQ3QodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4uRnQoKSwgbi5TdCB8fCBcbiAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIGEgZnJlc2hseSBhZGRlZCB0YXJnZXQsIHNvIHdlIG5lZWQgdG8gcmVzZXQgYW55IHN0YXRlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBoYWQgcHJldmlvdXNseS4gVGhpcyBjYW4gaGFwcGVuIGUuZy4gd2hlbiByZW1vdmUgYW5kIGFkZFxuICAgICAgICAgICAgICAgIC8vIGJhY2sgYSB0YXJnZXQgZm9yIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy5cbiAgICAgICAgICAgICAgICBuLk50KCksIG4uQ3QodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAyIC8qIFJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiByZW1vdmVkIHRhcmdldHMgdG8gd2UgY2FuIHBvc3QtZmlsdGVyIGFuZFxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgdGFyZ2V0IGNoYW5nZXMuXG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcbiAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cbiAgICAgICAgICAgICAgICBuLkZ0KCksIG4uU3QgfHwgdGhpcy5yZW1vdmVUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzIC8qIEN1cnJlbnQgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMuSHQoZSkgJiYgKG4uJHQoKSwgbi5DdCh0LnJlc3VtZVRva2VuKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA0IC8qIFJlc2V0ICovIDpcbiAgICAgICAgICAgICAgICB0aGlzLkh0KGUpICYmIChcbiAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgdGFyZ2V0IGFuZCBzeW50aGVzaXplcyByZW1vdmVzIGZvciBhbGwgZXhpc3RpbmdcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMuIFRoZSBiYWNrZW5kIHdpbGwgcmUtYWRkIGFueSBkb2N1bWVudHMgdGhhdCBzdGlsbFxuICAgICAgICAgICAgICAgIC8vIG1hdGNoIHRoZSB0YXJnZXQgYmVmb3JlIGl0IHNlbmRzIHRoZSBuZXh0IGdsb2JhbCBzbmFwc2hvdC5cbiAgICAgICAgICAgICAgICB0aGlzLkp0KGUpLCBuLkN0KHQucmVzdW1lVG9rZW4pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIE8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGFsbCB0YXJnZXRJZHMgdGhhdCB0aGUgd2F0Y2ggY2hhbmdlIGFwcGxpZXMgdG86IGVpdGhlciB0aGVcbiAgICAgKiB0YXJnZXRJZHMgZXhwbGljaXRseSBsaXN0ZWQgaW4gdGhlIGNoYW5nZSBvciB0aGUgdGFyZ2V0SWRzIG9mIGFsbCBjdXJyZW50bHlcbiAgICAgKiBhY3RpdmUgdGFyZ2V0cy5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHQudGFyZ2V0SWRzLmxlbmd0aCA+IDAgPyB0LnRhcmdldElkcy5mb3JFYWNoKGUpIDogdGhpcy5MdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5IdChuKSAmJiBlKG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZXhpc3RlbmNlIGZpbHRlcnMgYW5kIHN5bnRoZXNpemVzIGRlbGV0ZXMgZm9yIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAqIFRhcmdldHMgdGhhdCBhcmUgaW52YWxpZGF0ZWQgYnkgZmlsdGVyIG1pc21hdGNoZXMgYXJlIGFkZGVkIHRvXG4gICAgICogYHBlbmRpbmdUYXJnZXRSZXNldHNgLlxuICAgICAqLyAgICBZdCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkLCBuID0gdC5BdC5jb3VudCwgcyA9IHRoaXMuWHQoZSk7XG4gICAgICAgIGlmIChzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gcy50YXJnZXQ7XG4gICAgICAgICAgICBpZiAoT2UodCkpIGlmICgwID09PSBuKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhlIGV4aXN0ZW5jZSBmaWx0ZXIgdG9sZCB1cyB0aGUgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QuIFdlIGRlZHVjZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgdGhpcyBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCBhbmQgYXBwbHkgYSBkZWxldGVkIGRvY3VtZW50IHRvXG4gICAgICAgICAgICAgICAgLy8gb3VyIHVwZGF0ZXMuIFdpdGhvdXQgYXBwbHlpbmcgdGhpcyBkZWxldGVkIGRvY3VtZW50IHRoZXJlIG1pZ2h0IGJlXG4gICAgICAgICAgICAgICAgLy8gYW5vdGhlciBxdWVyeSB0aGF0IHdpbGwgcmFpc2UgdGhpcyBkb2N1bWVudCBhcyBwYXJ0IG9mIGEgc25hcHNob3RcbiAgICAgICAgICAgICAgICAvLyB1bnRpbCBpdCBpcyByZXNvbHZlZCwgZXNzZW50aWFsbHkgZXhwb3NpbmcgaW5jb25zaXN0ZW5jeSBiZXR3ZWVuXG4gICAgICAgICAgICAgICAgLy8gcXVlcmllcy5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IGN0KHQucGF0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5qdChlLCBuLCBTZS5uZXdOb0RvY3VtZW50KG4sIHN0Lm1pbigpKSk7XG4gICAgICAgICAgICB9IGVsc2UgTSgxID09PSBuKTsgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5adChlKSAhPT0gbiAmJiAoXG4gICAgICAgICAgICAgICAgLy8gRXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaDogV2UgcmVzZXQgdGhlIG1hcHBpbmcgYW5kIHJhaXNlIGEgbmV3XG4gICAgICAgICAgICAgICAgLy8gc25hcHNob3Qgd2l0aCBgaXNGcm9tQ2FjaGU6dHJ1ZWAuXG4gICAgICAgICAgICAgICAgdGhpcy5KdChlKSwgdGhpcy5LdCA9IHRoaXMuS3QuYWRkKGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgY3VycmVudGx5IGFjY3VtdWxhdGVkIHN0YXRlIGludG8gYSByZW1vdGUgZXZlbnQgYXQgdGhlXG4gICAgICogcHJvdmlkZWQgc25hcHNob3QgdmVyc2lvbi4gUmVzZXRzIHRoZSBhY2N1bXVsYXRlZCBjaGFuZ2VzIGJlZm9yZSByZXR1cm5pbmcuXG4gICAgICovICAgIHRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBNYXA7XG4gICAgICAgIHRoaXMuTHQuZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLlh0KHMpO1xuICAgICAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgICAgICBpZiAobi5jdXJyZW50ICYmIE9lKGkudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudCBxdWVyaWVzIGZvciBkb2N1bWVudCB0aGF0IGRvbid0IGV4aXN0IGNhbiBwcm9kdWNlIGFuIGVtcHR5XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBzZXQuIFRvIHVwZGF0ZSBvdXIgbG9jYWwgY2FjaGUsIHdlIHN5bnRoZXNpemUgYSBkb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgaWYgd2UgaGF2ZSBub3QgcHJldmlvdXNseSByZWNlaXZlZCB0aGUgZG9jdW1lbnQuIFRoaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzb2x2ZXMgdGhlIGxpbWJvIHN0YXRlIG9mIHRoZSBkb2N1bWVudCwgcmVtb3ZpbmcgaXQgZnJvbVxuICAgICAgICAgICAgICAgICAgICAvLyBsaW1ib0RvY3VtZW50UmVmcy5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZGVhbGx5IHdlIHdvdWxkIGhhdmUgYW4gZXhwbGljaXQgbG9va3VwIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICAvLyBpbnN0ZWFkIHJlc3VsdGluZyBpbiBhbiBleHBsaWNpdCBkZWxldGUgbWVzc2FnZSBhbmQgd2UgY291bGRcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoaXMgc3BlY2lhbCBsb2dpYy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBjdChpLnRhcmdldC5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPT0gdGhpcy5VdC5nZXQoZSkgfHwgdGhpcy5lZShzLCBlKSB8fCB0aGlzLmp0KHMsIGUsIFNlLm5ld05vRG9jdW1lbnQoZSwgdCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuLkR0ICYmIChlLnNldChzLCBuLnh0KCkpLCBuLk50KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIGxldCBuID0gZnMoKTtcbiAgICAgICAgLy8gV2UgZXh0cmFjdCB0aGUgc2V0IG9mIGxpbWJvLW9ubHkgZG9jdW1lbnQgdXBkYXRlcyBhcyB0aGUgR0MgbG9naWNcbiAgICAgICAgLy8gc3BlY2lhbC1jYXNlcyBkb2N1bWVudHMgdGhhdCBkbyBub3QgYXBwZWFyIGluIHRoZSB0YXJnZXQgY2FjaGUuXG4gICAgICAgIFxuICAgICAgICAvLyBUT0RPKGdzb2x0aXMpOiBFeHBhbmQgb24gdGhpcyBjb21tZW50IG9uY2UgR0MgaXMgYXZhaWxhYmxlIGluIHRoZSBKU1xuICAgICAgICAvLyBjbGllbnQuXG4gICAgICAgICAgICAgICAgdGhpcy5xdC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgbGV0IHMgPSAhMDtcbiAgICAgICAgICAgIGUuZm9yRWFjaFdoaWxlKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5YdCh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWUgfHwgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gPT09IGUucHVycG9zZSB8fCAocyA9ICExLCAhMSk7XG4gICAgICAgICAgICB9KSksIHMgJiYgKG4gPSBuLmFkZCh0KSk7XG4gICAgICAgIH0pKSwgdGhpcy5VdC5mb3JFYWNoKCgoZSwgbikgPT4gbi5zZXRSZWFkVGltZSh0KSkpO1xuICAgICAgICBjb25zdCBzID0gbmV3IHdzKHQsIGUsIHRoaXMuS3QsIHRoaXMuVXQsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5VdCA9IHNzKCksIHRoaXMucXQgPSBFcygpLCB0aGlzLkt0ID0gbmV3IHF0KFopLCBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBwcm92aWRlZCBkb2N1bWVudCB0byB0aGUgaW50ZXJuYWwgbGlzdCBvZiBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAqIGl0cyBkb2N1bWVudCBrZXkgdG8gdGhlIGdpdmVuIHRhcmdldCdzIG1hcHBpbmcuXG4gICAgICovXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAgICBRdCh0LCBlKSB7XG4gICAgICAgIGlmICghdGhpcy5IdCh0KSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5lZSh0LCBlLmtleSkgPyAyIC8qIE1vZGlmaWVkICovIDogMCAvKiBBZGRlZCAqLztcbiAgICAgICAgdGhpcy56dCh0KS5rdChlLmtleSwgbiksIHRoaXMuVXQgPSB0aGlzLlV0Lmluc2VydChlLmtleSwgZSksIHRoaXMucXQgPSB0aGlzLnF0Lmluc2VydChlLmtleSwgdGhpcy5uZShlLmtleSkuYWRkKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgZnJvbSB0aGUgdGFyZ2V0IG1hcHBpbmcuIElmIHRoZVxuICAgICAqIGRvY3VtZW50IG5vIGxvbmdlciBtYXRjaGVzIHRoZSB0YXJnZXQsIGJ1dCB0aGUgZG9jdW1lbnQncyBzdGF0ZSBpcyBzdGlsbFxuICAgICAqIGtub3duIChlLmcuIHdlIGtub3cgdGhhdCB0aGUgZG9jdW1lbnQgd2FzIGRlbGV0ZWQgb3Igd2UgcmVjZWl2ZWQgdGhlIGNoYW5nZVxuICAgICAqIHRoYXQgY2F1c2VkIHRoZSBmaWx0ZXIgbWlzbWF0Y2gpLCB0aGUgbmV3IGRvY3VtZW50IGNhbiBiZSBwcm92aWRlZFxuICAgICAqIHRvIHVwZGF0ZSB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAganQodCwgZSwgbikge1xuICAgICAgICBpZiAoIXRoaXMuSHQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMuenQodCk7XG4gICAgICAgIHRoaXMuZWUodCwgZSkgPyBzLmt0KGUsIDEgLyogUmVtb3ZlZCAqLykgOiBcbiAgICAgICAgLy8gVGhlIGRvY3VtZW50IG1heSBoYXZlIGVudGVyZWQgYW5kIGxlZnQgdGhlIHRhcmdldCBiZWZvcmUgd2UgcmFpc2VkIGFcbiAgICAgICAgLy8gc25hcHNob3QsIHNvIHdlIGNhbiBqdXN0IGlnbm9yZSB0aGUgY2hhbmdlLlxuICAgICAgICBzLk90KGUpLCB0aGlzLnF0ID0gdGhpcy5xdC5pbnNlcnQoZSwgdGhpcy5uZShlKS5kZWxldGUodCkpLCBuICYmICh0aGlzLlV0ID0gdGhpcy5VdC5pbnNlcnQoZSwgbikpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXQodCkge1xuICAgICAgICB0aGlzLkx0LmRlbGV0ZSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCBjb3VudCBvZiBkb2N1bWVudHMgaW4gdGhlIHRhcmdldC4gVGhpcyBpbmNsdWRlcyBib3RoXG4gICAgICogdGhlIG51bWJlciBvZiBkb2N1bWVudHMgdGhhdCB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdG8gYmUgcGFydCBvZiB0aGVcbiAgICAgKiB0YXJnZXQgYXMgd2VsbCBhcyBhbnkgYWNjdW11bGF0ZWQgY2hhbmdlcy5cbiAgICAgKi8gICAgWnQodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy56dCh0KS54dCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5CdC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLnNpemUgKyBlLmFkZGVkRG9jdW1lbnRzLnNpemUgLSBlLnJlbW92ZWREb2N1bWVudHMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaCBiZWZvcmUgd2UgY2FuIGNvbnNpZGVyIHRoZVxuICAgICAqIHNlcnZlciB0byBiZSAnaW4tc3luYycgd2l0aCB0aGUgY2xpZW50J3MgYWN0aXZlIHRhcmdldHMuXG4gICAgICovICAgIE10KHQpIHtcbiAgICAgICAgdGhpcy56dCh0KS5NdCgpO1xuICAgIH1cbiAgICB6dCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5MdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChlID0gbmV3IElzLCB0aGlzLkx0LnNldCh0LCBlKSksIGU7XG4gICAgfVxuICAgIG5lKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnF0LmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgKGUgPSBuZXcgcXQoWiksIHRoaXMucXQgPSB0aGlzLnF0Lmluc2VydCh0LCBlKSksIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgdGhlIHVzZXIgaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGlzIHRhcmdldCAoYnkgY2FsbGluZ1xuICAgICAqIGBnZXRUYXJnZXREYXRhRm9yVGFyZ2V0KClgKSBhbmQgdGhhdCB3ZSBhcmUgbm90IHdhaXRpbmcgZm9yIHBlbmRpbmcgQUREc1xuICAgICAqIGZyb20gd2F0Y2guXG4gICAgICovICAgIEh0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG51bGwgIT09IHRoaXMuWHQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IEMoXCJXYXRjaENoYW5nZUFnZ3JlZ2F0b3JcIiwgXCJEZXRlY3RlZCBpbmFjdGl2ZSB0YXJnZXRcIiwgdCksIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIFRhcmdldERhdGEgZm9yIGFuIGFjdGl2ZSB0YXJnZXQgKGkuZS4gYSB0YXJnZXQgdGhhdCB0aGUgdXNlclxuICAgICAqIGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhhdCBoYXMgbm8gb3V0c3RhbmRpbmcgdGFyZ2V0IGNoYW5nZSByZXF1ZXN0cykuXG4gICAgICovICAgIFh0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuTHQuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSAmJiBlLlN0ID8gbnVsbCA6IHRoaXMuQnQuc2UodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQgdG8gaXRzIGluaXRpYWwgc3RhdGUgKGUuZy4gc2V0c1xuICAgICAqICdjdXJyZW50JyB0byBmYWxzZSwgY2xlYXJzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHJlbW92ZXMgaXRzIHRhcmdldCBtYXBwaW5nXG4gICAgICogZnJvbSBhbGwgZG9jdW1lbnRzKS5cbiAgICAgKi8gICAgSnQodCkge1xuICAgICAgICB0aGlzLkx0LnNldCh0LCBuZXcgSXMpO1xuICAgICAgICB0aGlzLkJ0LmdldFJlbW90ZUtleXNGb3JUYXJnZXQodCkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmp0KHQsIGUsIC8qdXBkYXRlZERvY3VtZW50PSovIG51bGwpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdGhlIGRvY3VtZW50IHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogc3BlY2lmaWVkIHRhcmdldC5cbiAgICAgKi8gICAgZWUodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5CdC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLmhhcyhlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEVzKCkge1xuICAgIHJldHVybiBuZXcgQnQoY3QuY29tcGFyYXRvcik7XG59XG5cbmZ1bmN0aW9uIEFzKCkge1xuICAgIHJldHVybiBuZXcgQnQoY3QuY29tcGFyYXRvcik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IFJzID0gKCgpID0+IHtcbiAgICBjb25zdCB0ID0ge1xuICAgICAgICBhc2M6IFwiQVNDRU5ESU5HXCIsXG4gICAgICAgIGRlc2M6IFwiREVTQ0VORElOR1wiXG4gICAgfTtcbiAgICByZXR1cm4gdDtcbn0pKCksIGJzID0gKCgpID0+IHtcbiAgICBjb25zdCB0ID0ge1xuICAgICAgICBcIjxcIjogXCJMRVNTX1RIQU5cIixcbiAgICAgICAgXCI8PVwiOiBcIkxFU1NfVEhBTl9PUl9FUVVBTFwiLFxuICAgICAgICBcIj5cIjogXCJHUkVBVEVSX1RIQU5cIixcbiAgICAgICAgXCI+PVwiOiBcIkdSRUFURVJfVEhBTl9PUl9FUVVBTFwiLFxuICAgICAgICBcIj09XCI6IFwiRVFVQUxcIixcbiAgICAgICAgXCIhPVwiOiBcIk5PVF9FUVVBTFwiLFxuICAgICAgICBcImFycmF5LWNvbnRhaW5zXCI6IFwiQVJSQVlfQ09OVEFJTlNcIixcbiAgICAgICAgaW46IFwiSU5cIixcbiAgICAgICAgXCJub3QtaW5cIjogXCJOT1RfSU5cIixcbiAgICAgICAgXCJhcnJheS1jb250YWlucy1hbnlcIjogXCJBUlJBWV9DT05UQUlOU19BTllcIlxuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpO1xuXG4vKipcbiAqIFRoaXMgY2xhc3MgZ2VuZXJhdGVzIEpzb25PYmplY3QgdmFsdWVzIGZvciB0aGUgRGF0YXN0b3JlIEFQSSBzdWl0YWJsZSBmb3JcbiAqIHNlbmRpbmcgdG8gZWl0aGVyIEdSUEMgc3R1YiBtZXRob2RzIG9yIHZpYSB0aGUgSlNPTi9IVFRQIFJFU1QgQVBJLlxuICpcbiAqIFRoZSBzZXJpYWxpemVyIHN1cHBvcnRzIGJvdGggUHJvdG9idWYuanMgYW5kIFByb3RvMyBKU09OIGZvcm1hdHMuIEJ5XG4gKiBzZXR0aW5nIGB1c2VQcm90bzNKc29uYCB0byB0cnVlLCB0aGUgc2VyaWFsaXplciB3aWxsIHVzZSB0aGUgUHJvdG8zIEpTT05cbiAqIGZvcm1hdC5cbiAqXG4gKiBGb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgUHJvdG8zIEpTT04gZm9ybWF0IGNoZWNrXG4gKiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9wcm90b2NvbC1idWZmZXJzL2RvY3MvcHJvdG8zI2pzb25cbiAqXG4gKiBUT0RPKGtsaW10KTogV2UgY2FuIHJlbW92ZSB0aGUgZGF0YWJhc2VJZCBhcmd1bWVudCBpZiB3ZSBrZWVwIHRoZSBmdWxsXG4gKiByZXNvdXJjZSBuYW1lIGluIGRvY3VtZW50cy5cbiAqL1xuY2xhc3MgUHMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gdCwgdGhpcy5ndCA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBEYXRlIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICovXG5mdW5jdGlvbiB2cyh0LCBlKSB7XG4gICAgaWYgKHQuZ3QpIHtcbiAgICAgICAgcmV0dXJuIGAke25ldyBEYXRlKDFlMyAqIGUuc2Vjb25kcykudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9cXC5cXGQqLywgXCJcIikucmVwbGFjZShcIlpcIiwgXCJcIil9LiR7KFwiMDAwMDAwMDAwXCIgKyBlLm5hbm9zZWNvbmRzKS5zbGljZSgtOSl9WmA7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHNlY29uZHM6IFwiXCIgKyBlLnNlY29uZHMsXG4gICAgICAgIG5hbm9zOiBlLm5hbm9zZWNvbmRzXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGJ5dGVzIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW4gYSBwcm90by5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5mdW5jdGlvbiBWcyh0LCBlKSB7XG4gICAgcmV0dXJuIHQuZ3QgPyBlLnRvQmFzZTY0KCkgOiBlLnRvVWludDhBcnJheSgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBCeXRlU3RyaW5nIGJhc2VkIG9uIHRoZSBwcm90byBzdHJpbmcgdmFsdWUuXG4gKi8gZnVuY3Rpb24gU3ModCwgZSkge1xuICAgIHJldHVybiB2cyh0LCBlLnRvVGltZXN0YW1wKCkpO1xufVxuXG5mdW5jdGlvbiBEcyh0KSB7XG4gICAgcmV0dXJuIE0oISF0KSwgc3QuZnJvbVRpbWVzdGFtcChmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBIdCh0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBudChlLnNlY29uZHMsIGUubmFub3MpO1xuICAgIH0odCkpO1xufVxuXG5mdW5jdGlvbiBDcyh0LCBlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBydChbIFwicHJvamVjdHNcIiwgdC5wcm9qZWN0SWQsIFwiZGF0YWJhc2VzXCIsIHQuZGF0YWJhc2UgXSk7XG4gICAgfSh0KS5jaGlsZChcImRvY3VtZW50c1wiKS5jaGlsZChlKS5jYW5vbmljYWxTdHJpbmcoKTtcbn1cblxuZnVuY3Rpb24geHModCkge1xuICAgIGNvbnN0IGUgPSBydC5mcm9tU3RyaW5nKHQpO1xuICAgIHJldHVybiBNKGlpKGUpKSwgZTtcbn1cblxuZnVuY3Rpb24gTnModCwgZSkge1xuICAgIHJldHVybiBDcyh0LmRhdGFiYXNlSWQsIGUucGF0aCk7XG59XG5cbmZ1bmN0aW9uIGtzKHQsIGUpIHtcbiAgICBjb25zdCBuID0geHMoZSk7XG4gICAgaWYgKG4uZ2V0KDEpICE9PSB0LmRhdGFiYXNlSWQucHJvamVjdElkKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IHByb2plY3Q6IFwiICsgbi5nZXQoMSkgKyBcIiB2cyBcIiArIHQuZGF0YWJhc2VJZC5wcm9qZWN0SWQpO1xuICAgIGlmIChuLmdldCgzKSAhPT0gdC5kYXRhYmFzZUlkLmRhdGFiYXNlKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IGRhdGFiYXNlOiBcIiArIG4uZ2V0KDMpICsgXCIgdnMgXCIgKyB0LmRhdGFiYXNlSWQuZGF0YWJhc2UpO1xuICAgIHJldHVybiBuZXcgY3QoJHMobikpO1xufVxuXG5mdW5jdGlvbiBPcyh0LCBlKSB7XG4gICAgcmV0dXJuIENzKHQuZGF0YWJhc2VJZCwgZSk7XG59XG5cbmZ1bmN0aW9uIE1zKHQpIHtcbiAgICBjb25zdCBlID0geHModCk7XG4gICAgLy8gSW4gdjFiZXRhMSBxdWVyaWVzIGZvciBjb2xsZWN0aW9ucyBhdCB0aGUgcm9vdCBkaWQgbm90IGhhdmUgYSB0cmFpbGluZ1xuICAgIC8vIFwiL2RvY3VtZW50c1wiLiBJbiB2MSBhbGwgcmVzb3VyY2UgcGF0aHMgY29udGFpbiBcIi9kb2N1bWVudHNcIi4gUHJlc2VydmUgdGhlXG4gICAgLy8gYWJpbGl0eSB0byByZWFkIHRoZSB2MWJldGExIGZvcm0gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBxdWVyaWVzIHBlcnNpc3RlZFxuICAgIC8vIGluIHRoZSBsb2NhbCB0YXJnZXQgY2FjaGUuXG4gICAgICAgIHJldHVybiA0ID09PSBlLmxlbmd0aCA/IHJ0LmVtcHR5UGF0aCgpIDogJHMoZSk7XG59XG5cbmZ1bmN0aW9uIEZzKHQpIHtcbiAgICByZXR1cm4gbmV3IHJ0KFsgXCJwcm9qZWN0c1wiLCB0LmRhdGFiYXNlSWQucHJvamVjdElkLCBcImRhdGFiYXNlc1wiLCB0LmRhdGFiYXNlSWQuZGF0YWJhc2UgXSkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uICRzKHQpIHtcbiAgICByZXR1cm4gTSh0Lmxlbmd0aCA+IDQgJiYgXCJkb2N1bWVudHNcIiA9PT0gdC5nZXQoNCkpLCB0LnBvcEZpcnN0KDUpO1xufVxuXG4vKiogQ3JlYXRlcyBhIERvY3VtZW50IHByb3RvIGZyb20ga2V5IGFuZCBmaWVsZHMgKGJ1dCBubyBjcmVhdGUvdXBkYXRlIHRpbWUpICovIGZ1bmN0aW9uIEJzKHQsIGUsIG4pIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBOcyh0LCBlKSxcbiAgICAgICAgZmllbGRzOiBuLnZhbHVlLm1hcFZhbHVlLmZpZWxkc1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIExzKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0ga3ModCwgZS5uYW1lKSwgaSA9IERzKGUudXBkYXRlVGltZSksIHIgPSBuZXcgdmUoe1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiBlLmZpZWxkc1xuICAgICAgICB9XG4gICAgfSksIG8gPSBTZS5uZXdGb3VuZERvY3VtZW50KHMsIGksIHIpO1xuICAgIHJldHVybiBuICYmIG8uc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCksIG4gPyBvLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpIDogbztcbn1cblxuZnVuY3Rpb24gVXModCwgZSkge1xuICAgIHJldHVybiBcImZvdW5kXCIgaW4gZSA/IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgTSghIWUuZm91bmQpLCBlLmZvdW5kLm5hbWUsIGUuZm91bmQudXBkYXRlVGltZTtcbiAgICAgICAgY29uc3QgbiA9IGtzKHQsIGUuZm91bmQubmFtZSksIHMgPSBEcyhlLmZvdW5kLnVwZGF0ZVRpbWUpLCBpID0gbmV3IHZlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBlLmZvdW5kLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFNlLm5ld0ZvdW5kRG9jdW1lbnQobiwgcywgaSk7XG4gICAgfSh0LCBlKSA6IFwibWlzc2luZ1wiIGluIGUgPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIE0oISFlLm1pc3NpbmcpLCBNKCEhZS5yZWFkVGltZSk7XG4gICAgICAgIGNvbnN0IG4gPSBrcyh0LCBlLm1pc3NpbmcpLCBzID0gRHMoZS5yZWFkVGltZSk7XG4gICAgICAgIHJldHVybiBTZS5uZXdOb0RvY3VtZW50KG4sIHMpO1xuICAgIH0odCwgZSkgOiBPKCk7XG59XG5cbmZ1bmN0aW9uIHFzKHQsIGUpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAoXCJ0YXJnZXRDaGFuZ2VcIiBpbiBlKSB7XG4gICAgICAgIGUudGFyZ2V0Q2hhbmdlO1xuICAgICAgICAvLyBwcm90bzMgZGVmYXVsdCB2YWx1ZSBpcyB1bnNldCBpbiBKU09OICh1bmRlZmluZWQpLCBzbyB1c2UgJ05PX0NIQU5HRSdcbiAgICAgICAgLy8gaWYgdW5zZXRcbiAgICAgICAgY29uc3QgcyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5PX0NIQU5HRVwiID09PSB0ID8gMCAvKiBOb0NoYW5nZSAqLyA6IFwiQUREXCIgPT09IHQgPyAxIC8qIEFkZGVkICovIDogXCJSRU1PVkVcIiA9PT0gdCA/IDIgLyogUmVtb3ZlZCAqLyA6IFwiQ1VSUkVOVFwiID09PSB0ID8gMyAvKiBDdXJyZW50ICovIDogXCJSRVNFVFwiID09PSB0ID8gNCAvKiBSZXNldCAqLyA6IE8oKTtcbiAgICAgICAgfShlLnRhcmdldENoYW5nZS50YXJnZXRDaGFuZ2VUeXBlIHx8IFwiTk9fQ0hBTkdFXCIpLCBpID0gZS50YXJnZXRDaGFuZ2UudGFyZ2V0SWRzIHx8IFtdLCByID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIHQuZ3QgPyAoTSh2b2lkIDAgPT09IGUgfHwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSksIFd0LmZyb21CYXNlNjRTdHJpbmcoZSB8fCBcIlwiKSkgOiAoTSh2b2lkIDAgPT09IGUgfHwgZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpLCBcbiAgICAgICAgICAgIFd0LmZyb21VaW50OEFycmF5KGUgfHwgbmV3IFVpbnQ4QXJyYXkpKTtcbiAgICAgICAgfSh0LCBlLnRhcmdldENoYW5nZS5yZXN1bWVUb2tlbiksIG8gPSBlLnRhcmdldENoYW5nZS5jYXVzZSwgdSA9IG8gJiYgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHZvaWQgMCA9PT0gdC5jb2RlID8gQi5VTktOT1dOIDogdHModC5jb2RlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTChlLCB0Lm1lc3NhZ2UgfHwgXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIChvciBudWxsKSB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG9cbiAqIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXG4gKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXG4gKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwibnVtYmVyXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxuICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBJbnQzMlZhbHVlIG11c3QgYmUuIEJ1dCBHUlBDIGFjdHVhbGx5XG4gKiBleHBlY3RzIGEgeyB2YWx1ZTogPG51bWJlcj4gfSBzdHJ1Y3QuXG4gKi8gKG8pO1xuICAgICAgICBuID0gbmV3IHBzKHMsIGksIHIsIHUgfHwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50Q2hhbmdlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudENoYW5nZTtcbiAgICAgICAgcy5kb2N1bWVudCwgcy5kb2N1bWVudC5uYW1lLCBzLmRvY3VtZW50LnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IGkgPSBrcyh0LCBzLmRvY3VtZW50Lm5hbWUpLCByID0gRHMocy5kb2N1bWVudC51cGRhdGVUaW1lKSwgbyA9IG5ldyB2ZSh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogcy5kb2N1bWVudC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIHUgPSBTZS5uZXdGb3VuZERvY3VtZW50KGksIHIsIG8pLCBjID0gcy50YXJnZXRJZHMgfHwgW10sIGEgPSBzLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XG4gICAgICAgIG4gPSBuZXcgZ3MoYywgYSwgdS5rZXksIHUpO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudERlbGV0ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnREZWxldGU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBrcyh0LCBzLmRvY3VtZW50KSwgciA9IHMucmVhZFRpbWUgPyBEcyhzLnJlYWRUaW1lKSA6IHN0Lm1pbigpLCBvID0gU2UubmV3Tm9Eb2N1bWVudChpLCByKSwgdSA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBncyhbXSwgdSwgby5rZXksIG8pO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudFJlbW92ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnRSZW1vdmU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBrcyh0LCBzLmRvY3VtZW50KSwgciA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBncyhbXSwgciwgaSwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCEoXCJmaWx0ZXJcIiBpbiBlKSkgcmV0dXJuIE8oKTtcbiAgICAgICAge1xuICAgICAgICAgICAgZS5maWx0ZXI7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5maWx0ZXI7XG4gICAgICAgICAgICB0LnRhcmdldElkO1xuICAgICAgICAgICAgY29uc3QgcyA9IHQuY291bnQgfHwgMCwgaSA9IG5ldyBKbihzKSwgciA9IHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBuID0gbmV3IHlzKHIsIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuO1xufVxuXG5mdW5jdGlvbiBLcyh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBLbikgbiA9IHtcbiAgICAgICAgdXBkYXRlOiBCcyh0LCBlLmtleSwgZS52YWx1ZSlcbiAgICB9OyBlbHNlIGlmIChlIGluc3RhbmNlb2Ygem4pIG4gPSB7XG4gICAgICAgIGRlbGV0ZTogTnModCwgZS5rZXkpXG4gICAgfTsgZWxzZSBpZiAoZSBpbnN0YW5jZW9mIEduKSBuID0ge1xuICAgICAgICB1cGRhdGU6IEJzKHQsIGUua2V5LCBlLmRhdGEpLFxuICAgICAgICB1cGRhdGVNYXNrOiBzaShlLmZpZWxkTWFzaylcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIEhuKSkgcmV0dXJuIE8oKTtcbiAgICAgICAgbiA9IHtcbiAgICAgICAgICAgIHZlcmlmeTogTnModCwgZS5rZXkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBlLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwICYmIChuLnVwZGF0ZVRyYW5zZm9ybXMgPSBlLmZpZWxkVHJhbnNmb3Jtcy5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS50cmFuc2Zvcm07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgUm4pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiBcIlJFUVVFU1RfVElNRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgYm4pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiB2bikgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIHJlbW92ZUFsbEZyb21BcnJheToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogbi5lbGVtZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIFNuKSByZXR1cm4ge1xuICAgICAgICAgICAgZmllbGRQYXRoOiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxuICAgICAgICAgICAgaW5jcmVtZW50OiBuLnl0XG4gICAgICAgIH07XG4gICAgICAgIHRocm93IE8oKTtcbiAgICB9KDAsIHQpKSkpLCBlLnByZWNvbmRpdGlvbi5pc05vbmUgfHwgKG4uY3VycmVudERvY3VtZW50ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlLnVwZGF0ZVRpbWUgPyB7XG4gICAgICAgICAgICB1cGRhdGVUaW1lOiBTcyh0LCBlLnVwZGF0ZVRpbWUpXG4gICAgICAgIH0gOiB2b2lkIDAgIT09IGUuZXhpc3RzID8ge1xuICAgICAgICAgICAgZXhpc3RzOiBlLmV4aXN0c1xuICAgICAgICB9IDogTygpO1xuICAgIH0odCwgZS5wcmVjb25kaXRpb24pKSwgbjtcbn1cblxuZnVuY3Rpb24gR3ModCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmN1cnJlbnREb2N1bWVudCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdC51cGRhdGVUaW1lID8gT24udXBkYXRlVGltZShEcyh0LnVwZGF0ZVRpbWUpKSA6IHZvaWQgMCAhPT0gdC5leGlzdHMgPyBPbi5leGlzdHModC5leGlzdHMpIDogT24ubm9uZSgpO1xuICAgIH0oZS5jdXJyZW50RG9jdW1lbnQpIDogT24ubm9uZSgpLCBzID0gZS51cGRhdGVUcmFuc2Zvcm1zID8gZS51cGRhdGVUcmFuc2Zvcm1zLm1hcCgoZSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbnVsbDtcbiAgICAgICAgaWYgKFwic2V0VG9TZXJ2ZXJWYWx1ZVwiIGluIGUpIE0oXCJSRVFVRVNUX1RJTUVcIiA9PT0gZS5zZXRUb1NlcnZlclZhbHVlKSwgbiA9IG5ldyBSbjsgZWxzZSBpZiAoXCJhcHBlbmRNaXNzaW5nRWxlbWVudHNcIiBpbiBlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5hcHBlbmRNaXNzaW5nRWxlbWVudHMudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgbiA9IG5ldyBibih0KTtcbiAgICAgICAgfSBlbHNlIGlmIChcInJlbW92ZUFsbEZyb21BcnJheVwiIGluIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLnJlbW92ZUFsbEZyb21BcnJheS52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBuID0gbmV3IHZuKHQpO1xuICAgICAgICB9IGVsc2UgXCJpbmNyZW1lbnRcIiBpbiBlID8gbiA9IG5ldyBTbih0LCBlLmluY3JlbWVudCkgOiBPKCk7XG4gICAgICAgIGNvbnN0IHMgPSB1dC5mcm9tU2VydmVyRm9ybWF0KGUuZmllbGRQYXRoKTtcbiAgICAgICAgcmV0dXJuIG5ldyB4bihzLCBuKTtcbiAgICB9KHQsIGUpKSkgOiBbXTtcbiAgICBpZiAoZS51cGRhdGUpIHtcbiAgICAgICAgZS51cGRhdGUubmFtZTtcbiAgICAgICAgY29uc3QgaSA9IGtzKHQsIGUudXBkYXRlLm5hbWUpLCByID0gbmV3IHZlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBlLnVwZGF0ZS5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChlLnVwZGF0ZU1hc2spIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZmllbGRQYXRocyB8fCBbXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFF0KGUubWFwKCh0ID0+IHV0LmZyb21TZXJ2ZXJGb3JtYXQodCkpKSk7XG4gICAgICAgICAgICB9KGUudXBkYXRlTWFzayk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEduKGksIHIsIHQsIG4sIHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgS24oaSwgciwgbiwgcyk7XG4gICAgfVxuICAgIGlmIChlLmRlbGV0ZSkge1xuICAgICAgICBjb25zdCBzID0ga3ModCwgZS5kZWxldGUpO1xuICAgICAgICByZXR1cm4gbmV3IHpuKHMsIG4pO1xuICAgIH1cbiAgICBpZiAoZS52ZXJpZnkpIHtcbiAgICAgICAgY29uc3QgcyA9IGtzKHQsIGUudmVyaWZ5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBIbihzLCBuKTtcbiAgICB9XG4gICAgcmV0dXJuIE8oKTtcbn1cblxuZnVuY3Rpb24gUXModCwgZSkge1xuICAgIHJldHVybiB0ICYmIHQubGVuZ3RoID4gMCA/IChNKHZvaWQgMCAhPT0gZSksIHQubWFwKCh0ID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gTk9URTogRGVsZXRlcyBkb24ndCBoYXZlIGFuIHVwZGF0ZVRpbWUuXG4gICAgICAgIGxldCBuID0gdC51cGRhdGVUaW1lID8gRHModC51cGRhdGVUaW1lKSA6IERzKGUpO1xuICAgICAgICByZXR1cm4gbi5pc0VxdWFsKHN0Lm1pbigpKSAmJiAoXG4gICAgICAgIC8vIFRoZSBGaXJlc3RvcmUgRW11bGF0b3IgY3VycmVudGx5IHJldHVybnMgYW4gdXBkYXRlIHRpbWUgb2YgMCBmb3JcbiAgICAgICAgLy8gZGVsZXRlcyBvZiBub24tZXhpc3RpbmcgZG9jdW1lbnRzIChyYXRoZXIgdGhhbiBudWxsKS4gVGhpcyBicmVha3MgdGhlXG4gICAgICAgIC8vIHRlc3QgXCJnZXQgZGVsZXRlZCBkb2Mgd2hpbGUgb2ZmbGluZSB3aXRoIHNvdXJjZT1jYWNoZVwiIGFzIE5vRG9jdW1lbnRzXG4gICAgICAgIC8vIHdpdGggdmVyc2lvbiAwIGFyZSBmaWx0ZXJlZCBieSBJbmRleGVkRGIncyBSZW1vdGVEb2N1bWVudENhY2hlLlxuICAgICAgICAvLyBUT0RPKCMyMTQ5KTogUmVtb3ZlIHRoaXMgd2hlbiBFbXVsYXRvciBpcyBmaXhlZFxuICAgICAgICBuID0gRHMoZSkpLCBuZXcga24obiwgdC50cmFuc2Zvcm1SZXN1bHRzIHx8IFtdKTtcbiAgICB9KHQsIGUpKSkpIDogW107XG59XG5cbmZ1bmN0aW9uIGpzKHQsIGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkb2N1bWVudHM6IFsgT3ModCwgZS5wYXRoKSBdXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gV3ModCwgZSkge1xuICAgIC8vIERpc3NlY3QgdGhlIHBhdGggaW50byBwYXJlbnQsIGNvbGxlY3Rpb25JZCwgYW5kIG9wdGlvbmFsIGtleSBmaWx0ZXIuXG4gICAgY29uc3QgbiA9IHtcbiAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiB7fVxuICAgIH0sIHMgPSBlLnBhdGg7XG4gICAgbnVsbCAhPT0gZS5jb2xsZWN0aW9uR3JvdXAgPyAobi5wYXJlbnQgPSBPcyh0LCBzKSwgbi5zdHJ1Y3R1cmVkUXVlcnkuZnJvbSA9IFsge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6IGUuY29sbGVjdGlvbkdyb3VwLFxuICAgICAgICBhbGxEZXNjZW5kYW50czogITBcbiAgICB9IF0pIDogKG4ucGFyZW50ID0gT3ModCwgcy5wb3BMYXN0KCkpLCBuLnN0cnVjdHVyZWRRdWVyeS5mcm9tID0gWyB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogcy5sYXN0U2VnbWVudCgpXG4gICAgfSBdKTtcbiAgICBjb25zdCBpID0gZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAoMCA9PT0gdC5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgY29uc3QgZSA9IHQubWFwKCh0ID0+IFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGlmIChcIj09XCIgLyogRVFVQUwgKi8gPT09IHQub3ApIHtcbiAgICAgICAgICAgICAgICBpZiAocGUodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogWnModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OQU5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoeWUodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogWnModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OVUxMXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gPT09IHQub3ApIHtcbiAgICAgICAgICAgICAgICBpZiAocGUodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogWnModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OT1RfTkFOXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHllKHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6IFpzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTk9UX05VTExcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmllbGRGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IFpzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICBvcDogWHModC5vcCksXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnZhbHVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0KSkpO1xuICAgICAgICBpZiAoMSA9PT0gZS5sZW5ndGgpIHJldHVybiBlWzBdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29tcG9zaXRlRmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgb3A6IFwiQU5EXCIsXG4gICAgICAgICAgICAgICAgZmlsdGVyczogZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0oZS5maWx0ZXJzKTtcbiAgICBpICYmIChuLnN0cnVjdHVyZWRRdWVyeS53aGVyZSA9IGkpO1xuICAgIGNvbnN0IHIgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICByZXR1cm4gdC5tYXAoKHQgPT4gXG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogWnModC5maWVsZCksXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBZcyh0LmRpcilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCkpKTtcbiAgICB9KGUub3JkZXJCeSk7XG4gICAgciAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkub3JkZXJCeSA9IHIpO1xuICAgIGNvbnN0IG8gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0Lmd0IHx8IHNlKGUpID8gZSA6IHtcbiAgICAgICAgICAgIHZhbHVlOiBlXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyBhIG51bWJlciAob3IgbnVsbCkgZnJvbSBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxuICovICh0LCBlLmxpbWl0KTtcbiAgICB2YXIgdTtcbiAgICByZXR1cm4gbnVsbCAhPT0gbyAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkubGltaXQgPSBvKSwgZS5zdGFydEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5zdGFydEF0ID0ge1xuICAgICAgICBiZWZvcmU6ICh1ID0gZS5zdGFydEF0KS5pbmNsdXNpdmUsXG4gICAgICAgIHZhbHVlczogdS5wb3NpdGlvblxuICAgIH0pLCBlLmVuZEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJlZm9yZTogIXQuaW5jbHVzaXZlLFxuICAgICAgICAgICAgdmFsdWVzOiB0LnBvc2l0aW9uXG4gICAgICAgIH07XG4gICAgfShlLmVuZEF0KSksIG47XG59XG5cbmZ1bmN0aW9uIHpzKHQpIHtcbiAgICBsZXQgZSA9IE1zKHQucGFyZW50KTtcbiAgICBjb25zdCBuID0gdC5zdHJ1Y3R1cmVkUXVlcnksIHMgPSBuLmZyb20gPyBuLmZyb20ubGVuZ3RoIDogMDtcbiAgICBsZXQgaSA9IG51bGw7XG4gICAgaWYgKHMgPiAwKSB7XG4gICAgICAgIE0oMSA9PT0gcyk7XG4gICAgICAgIGNvbnN0IHQgPSBuLmZyb21bMF07XG4gICAgICAgIHQuYWxsRGVzY2VuZGFudHMgPyBpID0gdC5jb2xsZWN0aW9uSWQgOiBlID0gZS5jaGlsZCh0LmNvbGxlY3Rpb25JZCk7XG4gICAgfVxuICAgIGxldCByID0gW107XG4gICAgbi53aGVyZSAmJiAociA9IEpzKG4ud2hlcmUpKTtcbiAgICBsZXQgbyA9IFtdO1xuICAgIG4ub3JkZXJCeSAmJiAobyA9IG4ub3JkZXJCeS5tYXAoKHQgPT4gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IEhlKHRpKHQuZmllbGQpLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgY2FzZSBcIkFTQ0VORElOR1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFzY1wiIC8qIEFTQ0VORElORyAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiREVTQ0VORElOR1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImRlc2NcIiAvKiBERVNDRU5ESU5HICovO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgKHQuZGlyZWN0aW9uKSk7XG4gICAgfSh0KSkpKTtcbiAgICBsZXQgdSA9IG51bGw7XG4gICAgbi5saW1pdCAmJiAodSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIHJldHVybiBlID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgdCA/IHQudmFsdWUgOiB0LCBzZShlKSA/IG51bGwgOiBlO1xuICAgIH0obi5saW1pdCkpO1xuICAgIGxldCBjID0gbnVsbDtcbiAgICBuLnN0YXJ0QXQgJiYgKGMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuYmVmb3JlLCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgICAgIHJldHVybiBuZXcgemUobiwgZSk7XG4gICAgfShuLnN0YXJ0QXQpKTtcbiAgICBsZXQgYSA9IG51bGw7XG4gICAgcmV0dXJuIG4uZW5kQXQgJiYgKGEgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhdC5iZWZvcmUsIG4gPSB0LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyB6ZShuLCBlKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIChuLmVuZEF0KSksIHRuKGUsIGksIG8sIHIsIHUsIFwiRlwiIC8qIEZpcnN0ICovICwgYywgYSk7XG59XG5cbmZ1bmN0aW9uIEhzKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICBjYXNlIDAgLyogTGlzdGVuICovIDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIEV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovIDpcbiAgICAgICAgICAgIHJldHVybiBcImV4aXN0ZW5jZS1maWx0ZXItbWlzbWF0Y2hcIjtcblxuICAgICAgICAgIGNhc2UgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFwibGltYm8tZG9jdW1lbnRcIjtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gTygpO1xuICAgICAgICB9XG4gICAgfSgwLCBlLnB1cnBvc2UpO1xuICAgIHJldHVybiBudWxsID09IG4gPyBudWxsIDoge1xuICAgICAgICBcImdvb2ctbGlzdGVuLXRhZ3NcIjogblxuICAgIH07XG59XG5cbmZ1bmN0aW9uIEpzKHQpIHtcbiAgICByZXR1cm4gdCA/IHZvaWQgMCAhPT0gdC51bmFyeUZpbHRlciA/IFsgbmkodCkgXSA6IHZvaWQgMCAhPT0gdC5maWVsZEZpbHRlciA/IFsgZWkodCkgXSA6IHZvaWQgMCAhPT0gdC5jb21wb3NpdGVGaWx0ZXIgPyB0LmNvbXBvc2l0ZUZpbHRlci5maWx0ZXJzLm1hcCgodCA9PiBKcyh0KSkpLnJlZHVjZSgoKHQsIGUpID0+IHQuY29uY2F0KGUpKSkgOiBPKCkgOiBbXTtcbn1cblxuZnVuY3Rpb24gWXModCkge1xuICAgIHJldHVybiBSc1t0XTtcbn1cblxuZnVuY3Rpb24gWHModCkge1xuICAgIHJldHVybiBic1t0XTtcbn1cblxuZnVuY3Rpb24gWnModCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkUGF0aDogdC5jYW5vbmljYWxTdHJpbmcoKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHRpKHQpIHtcbiAgICByZXR1cm4gdXQuZnJvbVNlcnZlckZvcm1hdCh0LmZpZWxkUGF0aCk7XG59XG5cbmZ1bmN0aW9uIGVpKHQpIHtcbiAgICByZXR1cm4gQmUuY3JlYXRlKHRpKHQuZmllbGRGaWx0ZXIuZmllbGQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2UgXCJFUVVBTFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPT1cIiAvKiBFUVVBTCAqLztcblxuICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkdSRUFURVJfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPFwiIC8qIExFU1NfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJMRVNTX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovO1xuXG4gICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovO1xuXG4gICAgICAgICAgY2FzZSBcIk5PVF9JTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogTk9UX0lOICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBPKCk7XG4gICAgICAgIH1cbiAgICB9KHQuZmllbGRGaWx0ZXIub3ApLCB0LmZpZWxkRmlsdGVyLnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gbmkodCkge1xuICAgIHN3aXRjaCAodC51bmFyeUZpbHRlci5vcCkge1xuICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICBjb25zdCBlID0gdGkodC51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgIHJldHVybiBCZS5jcmVhdGUoZSwgXCI9PVwiIC8qIEVRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05VTExcIjpcbiAgICAgICAgY29uc3QgbiA9IHRpKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICByZXR1cm4gQmUuY3JlYXRlKG4sIFwiPT1cIiAvKiBFUVVBTCAqLyAsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSk7XG5cbiAgICAgIGNhc2UgXCJJU19OT1RfTkFOXCI6XG4gICAgICAgIGNvbnN0IHMgPSB0aSh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEJlLmNyZWF0ZShzLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgIGNvbnN0IGkgPSB0aSh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEJlLmNyZWF0ZShpLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE8oKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNpKHQpIHtcbiAgICBjb25zdCBlID0gW107XG4gICAgcmV0dXJuIHQuZmllbGRzLmZvckVhY2goKHQgPT4gZS5wdXNoKHQuY2Fub25pY2FsU3RyaW5nKCkpKSksIHtcbiAgICAgICAgZmllbGRQYXRoczogZVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGlpKHQpIHtcbiAgICAvLyBSZXNvdXJjZSBuYW1lcyBoYXZlIGF0IGxlYXN0IDQgY29tcG9uZW50cyAocHJvamVjdCBJRCwgZGF0YWJhc2UgSUQpXG4gICAgcmV0dXJuIHQubGVuZ3RoID49IDQgJiYgXCJwcm9qZWN0c1wiID09PSB0LmdldCgwKSAmJiBcImRhdGFiYXNlc1wiID09PSB0LmdldCgyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRW5jb2RlcyBhIHJlc291cmNlIHBhdGggaW50byBhIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtLlxuICovXG5mdW5jdGlvbiByaSh0KSB7XG4gICAgbGV0IGUgPSBcIlwiO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZS5sZW5ndGggPiAwICYmIChlID0gdWkoZSkpLCBlID0gb2kodC5nZXQobiksIGUpO1xuICAgIHJldHVybiB1aShlKTtcbn1cblxuLyoqIEVuY29kZXMgYSBzaW5nbGUgc2VnbWVudCBvZiBhIHJlc291cmNlIHBhdGggaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIG9pKHQsIGUpIHtcbiAgICBsZXQgbiA9IGU7XG4gICAgY29uc3QgcyA9IHQubGVuZ3RoO1xuICAgIGZvciAobGV0IGUgPSAwOyBlIDwgczsgZSsrKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0LmNoYXJBdChlKTtcbiAgICAgICAgc3dpdGNoIChzKSB7XG4gICAgICAgICAgY2FzZSBcIlxcMFwiOlxuICAgICAgICAgICAgbiArPSBcIlx1MDAwMVx1MDAxMFwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiXHUwMDAxXCI6XG4gICAgICAgICAgICBuICs9IFwiXHUwMDAxXHUwMDExXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBuICs9IHM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG47XG59XG5cbi8qKiBFbmNvZGVzIGEgcGF0aCBzZXBhcmF0b3IgaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIHVpKHQpIHtcbiAgICByZXR1cm4gdCArIFwiXHUwMDAxXHUwMDAxXCI7XG59XG5cbi8qKlxuICogRGVjb2RlcyB0aGUgZ2l2ZW4gSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0gb2YgYSByZXNvdXJjZSBwYXRoIGludG9cbiAqIGEgUmVzb3VyY2VQYXRoIGluc3RhbmNlLiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaXMgbm90IHN1aXRhYmxlIGZvciB1c2Ugd2l0aFxuICogZGVjb2RpbmcgcmVzb3VyY2UgbmFtZXMgZnJvbSB0aGUgc2VydmVyOyB0aG9zZSBhcmUgT25lIFBsYXRmb3JtIGZvcm1hdFxuICogc3RyaW5ncy5cbiAqLyBmdW5jdGlvbiBjaSh0KSB7XG4gICAgLy8gRXZlbnQgdGhlIGVtcHR5IHBhdGggbXVzdCBlbmNvZGUgYXMgYSBwYXRoIG9mIGF0IGxlYXN0IGxlbmd0aCAyLiBBIHBhdGhcbiAgICAvLyB3aXRoIGV4YWN0bHkgMiBtdXN0IGJlIHRoZSBlbXB0eSBwYXRoLlxuICAgIGNvbnN0IGUgPSB0Lmxlbmd0aDtcbiAgICBpZiAoTShlID49IDIpLCAyID09PSBlKSByZXR1cm4gTShcIlx1MDAwMVwiID09PSB0LmNoYXJBdCgwKSAmJiBcIlx1MDAwMVwiID09PSB0LmNoYXJBdCgxKSksIHJ0LmVtcHR5UGF0aCgpO1xuICAgIC8vIEVzY2FwZSBjaGFyYWN0ZXJzIGNhbm5vdCBleGlzdCBwYXN0IHRoZSBzZWNvbmQtdG8tbGFzdCBwb3NpdGlvbiBpbiB0aGVcbiAgICAvLyBzb3VyY2UgdmFsdWUuXG4gICAgICAgIGNvbnN0IG4gPSBlIC0gMiwgcyA9IFtdO1xuICAgIGxldCBpID0gXCJcIjtcbiAgICBmb3IgKGxldCByID0gMDsgciA8IGU7ICkge1xuICAgICAgICAvLyBUaGUgbGFzdCB0d28gY2hhcmFjdGVycyBvZiBhIHZhbGlkIGVuY29kZWQgcGF0aCBtdXN0IGJlIGEgc2VwYXJhdG9yLCBzb1xuICAgICAgICAvLyB0aGVyZSBtdXN0IGJlIGFuIGVuZCB0byB0aGlzIHNlZ21lbnQuXG4gICAgICAgIGNvbnN0IGUgPSB0LmluZGV4T2YoXCJcdTAwMDFcIiwgcik7XG4gICAgICAgIChlIDwgMCB8fCBlID4gbikgJiYgTygpO1xuICAgICAgICBzd2l0Y2ggKHQuY2hhckF0KGUgKyAxKSkge1xuICAgICAgICAgIGNhc2UgXCJcdTAwMDFcIjpcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnN1YnN0cmluZyhyLCBlKTtcbiAgICAgICAgICAgIGxldCBvO1xuICAgICAgICAgICAgMCA9PT0gaS5sZW5ndGggPyBcbiAgICAgICAgICAgIC8vIEF2b2lkIGNvcHlpbmcgZm9yIHRoZSBjb21tb24gY2FzZSBvZiBhIHNlZ21lbnQgdGhhdCBleGNsdWRlcyBcXDBcbiAgICAgICAgICAgIC8vIGFuZCBcXDAwMVxuICAgICAgICAgICAgbyA9IG4gOiAoaSArPSBuLCBvID0gaSwgaSA9IFwiXCIpLCBzLnB1c2gobyk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMTBcIjpcbiAgICAgICAgICAgIGkgKz0gdC5zdWJzdHJpbmcociwgZSksIGkgKz0gXCJcXDBcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAxMVwiOlxuICAgICAgICAgICAgLy8gVGhlIGVzY2FwZSBjaGFyYWN0ZXIgY2FuIGJlIHVzZWQgaW4gdGhlIG91dHB1dCB0byBlbmNvZGUgaXRzZWxmLlxuICAgICAgICAgICAgaSArPSB0LnN1YnN0cmluZyhyLCBlICsgMSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBPKCk7XG4gICAgICAgIH1cbiAgICAgICAgciA9IGUgKyAyO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IHJ0KHMpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBhaSA9IFsgXCJ1c2VySWRcIiwgXCJiYXRjaElkXCIgXTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIG5hbWUgJ293bmVyJyBpcyBjaG9zZW4gdG8gZW5zdXJlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGhcbiAqIG9sZGVyIGNsaWVudHMgdGhhdCBvbmx5IHN1cHBvcnRlZCBzaW5nbGUgbG9ja2VkIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2VcbiAqIGxheWVyLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSBbdXNlcklkLCBlbmNvZGVkUGF0aF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnNcbiAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gKi9cbmZ1bmN0aW9uIGhpKHQsIGUpIHtcbiAgICByZXR1cm4gWyB0LCByaShlKSBdO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxsIGluZGV4IGtleSBvZiBbdXNlcklkLCBlbmNvZGVkUGF0aCwgYmF0Y2hJZF0gZm9yIGluc2VydGluZ1xuICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXG4gKi8gZnVuY3Rpb24gbGkodCwgZSwgbikge1xuICAgIHJldHVybiBbIHQsIHJpKGUpLCBuIF07XG59XG5cbi8qKlxuICogQmVjYXVzZSB3ZSBzdG9yZSBhbGwgdGhlIHVzZWZ1bCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBzdG9yZSBpbiB0aGUga2V5LFxuICogdGhlcmUgaXMgbm8gdXNlZnVsIGluZm9ybWF0aW9uIHRvIHN0b3JlIGFzIHRoZSB2YWx1ZS4gVGhlIHJhdyAodW5lbmNvZGVkKVxuICogcGF0aCBjYW5ub3QgYmUgc3RvcmVkIGJlY2F1c2UgSW5kZXhlZERiIGRvZXNuJ3Qgc3RvcmUgcHJvdG90eXBlXG4gKiBpbmZvcm1hdGlvbi5cbiAqLyBjb25zdCBmaSA9IHt9LCBkaSA9IFsgXCJwcmVmaXhQYXRoXCIsIFwiY29sbGVjdGlvbkdyb3VwXCIsIFwicmVhZFRpbWVcIiwgXCJkb2N1bWVudElkXCIgXSwgX2kgPSBbIFwicHJlZml4UGF0aFwiLCBcImNvbGxlY3Rpb25Hcm91cFwiLCBcImRvY3VtZW50SWRcIiBdLCB3aSA9IFsgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJyZWFkVGltZVwiLCBcInByZWZpeFBhdGhcIiwgXCJkb2N1bWVudElkXCIgXSwgbWkgPSBbIFwiY2Fub25pY2FsSWRcIiwgXCJ0YXJnZXRJZFwiIF0sIGdpID0gWyBcInRhcmdldElkXCIsIFwicGF0aFwiIF0sIHlpID0gWyBcInBhdGhcIiwgXCJ0YXJnZXRJZFwiIF0sIHBpID0gWyBcImNvbGxlY3Rpb25JZFwiLCBcInBhcmVudFwiIF0sIElpID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiBdLCBUaSA9IFsgXCJ1aWRcIiwgXCJzZXF1ZW5jZU51bWJlclwiIF0sIEVpID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiwgXCJhcnJheVZhbHVlXCIsIFwiZGlyZWN0aW9uYWxWYWx1ZVwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiLCBcImRvY3VtZW50S2V5XCIgXSwgQWkgPSBbIFwiaW5kZXhJZFwiLCBcInVpZFwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiIF0sIFJpID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwiZG9jdW1lbnRJZFwiIF0sIGJpID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwibGFyZ2VzdEJhdGNoSWRcIiBdLCBQaSA9IFsgXCJ1c2VySWRcIiwgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJsYXJnZXN0QmF0Y2hJZFwiIF0sIHZpID0gWyAuLi5bIC4uLlsgLi4uWyAuLi5bIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1wiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiIF0sIFwiY2xpZW50TWV0YWRhdGFcIiBdLCBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIgXSwgXCJjb2xsZWN0aW9uUGFyZW50c1wiIF0sIFwiYnVuZGxlc1wiLCBcIm5hbWVkUXVlcmllc1wiIF0sIFZpID0gWyAuLi52aSwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgU2kgPSBbIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1YxNFwiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiLCBcImNsaWVudE1ldGFkYXRhXCIsIFwicmVtb3RlRG9jdW1lbnRHbG9iYWxcIiwgXCJjb2xsZWN0aW9uUGFyZW50c1wiLCBcImJ1bmRsZXNcIiwgXCJuYW1lZFF1ZXJpZXNcIiwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgRGkgPSBTaSwgQ2kgPSBbIC4uLkRpLCBcImluZGV4Q29uZmlndXJhdGlvblwiLCBcImluZGV4U3RhdGVcIiwgXCJpbmRleEVudHJpZXNcIiBdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgeGkgZXh0ZW5kcyBUdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmllID0gdCwgdGhpcy5jdXJyZW50U2VxdWVuY2VOdW1iZXIgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gTmkodCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIHJldHVybiBidC5NKG4uaWUsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cbiAqLyBjbGFzcyBraSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgdW5pcXVlIElEIG9mIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gVGhlIG9yaWdpbmFsIHdyaXRlIHRpbWUgb2YgdGhpcyBtdXRhdGlvbi5cbiAgICAgKiBAcGFyYW0gYmFzZU11dGF0aW9ucyAtIE11dGF0aW9ucyB0aGF0IGFyZSB1c2VkIHRvIHBvcHVsYXRlIHRoZSBiYXNlXG4gICAgICogdmFsdWVzIHdoZW4gdGhpcyBtdXRhdGlvbiBpcyBhcHBsaWVkIGxvY2FsbHkuIFRoaXMgY2FuIGJlIHVzZWQgdG8gbG9jYWxseVxuICAgICAqIG92ZXJ3cml0ZSB2YWx1ZXMgdGhhdCBhcmUgcGVyc2lzdGVkIGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuIEJhc2VcbiAgICAgKiBtdXRhdGlvbnMgYXJlIG5ldmVyIHNlbnQgdG8gdGhlIGJhY2tlbmQuXG4gICAgICogQHBhcmFtIG11dGF0aW9ucyAtIFRoZSB1c2VyLXByb3ZpZGVkIG11dGF0aW9ucyBpbiB0aGlzIG11dGF0aW9uIGJhdGNoLlxuICAgICAqIFVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGFyZSBhcHBsaWVkIGJvdGggbG9jYWxseSBhbmQgcmVtb3RlbHkgb24gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IHQsIHRoaXMubG9jYWxXcml0ZVRpbWUgPSBlLCB0aGlzLmJhc2VNdXRhdGlvbnMgPSBuLCB0aGlzLm11dGF0aW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpcyBNdXRhdGlvbkJhdGNoIHRvIHRoZSBzcGVjaWZpZWQgZG9jdW1lbnRcbiAgICAgKiB0byBjb21wdXRlIHRoZSBzdGF0ZSBvZiB0aGUgcmVtb3RlIGRvY3VtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxuICAgICAqIEBwYXJhbSBiYXRjaFJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIE11dGF0aW9uQmF0Y2ggdG8gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi8gICAgYXBwbHlUb1JlbW90ZURvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubXV0YXRpb25SZXN1bHRzO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5tdXRhdGlvbnNbZV07XG4gICAgICAgICAgICBpZiAocy5rZXkuaXNFcXVhbCh0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBCbihzLCB0LCBuW2VdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcbiAgICAgKiBiYXRjaC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICogQHBhcmFtIG11dGF0ZWRGaWVsZHMgLSBGaWVsZHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBiZWZvcmUgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgKiBAcmV0dXJucyBBIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyBhbGwgdGhlIGZpZWxkcyB0aGF0IGFyZSBtdXRhdGVkLlxuICAgICAqLyAgICBhcHBseVRvTG9jYWxWaWV3KHQsIGUpIHtcbiAgICAgICAgLy8gRmlyc3QsIGFwcGx5IHRoZSBiYXNlIHN0YXRlLiBUaGlzIGFsbG93cyB1cyB0byBhcHBseSBub24taWRlbXBvdGVudFxuICAgICAgICAvLyB0cmFuc2Zvcm0gYWdhaW5zdCBhIGNvbnNpc3RlbnQgc2V0IG9mIHZhbHVlcy5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuYmFzZU11dGF0aW9ucykgbi5rZXkuaXNFcXVhbCh0LmtleSkgJiYgKGUgPSBMbihuLCB0LCBlLCB0aGlzLmxvY2FsV3JpdGVUaW1lKSk7XG4gICAgICAgIC8vIFNlY29uZCwgYXBwbHkgYWxsIHVzZXItcHJvdmlkZWQgbXV0YXRpb25zLlxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0aGlzLm11dGF0aW9ucykgbi5rZXkuaXNFcXVhbCh0LmtleSkgJiYgKGUgPSBMbihuLCB0LCBlLCB0aGlzLmxvY2FsV3JpdGVUaW1lKSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBmb3IgYWxsIHByb3ZpZGVkIGRvY3VtZW50cyBnaXZlbiB0aGUgbXV0YXRpb25zIGluXG4gICAgICogdGhpcyBiYXRjaC4gUmV0dXJucyBhIGBEb2N1bWVudEtleWAgdG8gYE11dGF0aW9uYCBtYXAgd2hpY2ggY2FuIGJlIHVzZWQgdG9cbiAgICAgKiByZXBsYWNlIGFsbCB0aGUgbXV0YXRpb24gYXBwbGljYXRpb25zLlxuICAgICAqLyAgICBhcHBseVRvTG9jYWxEb2N1bWVudFNldCh0LCBlKSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogVGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBPKG5eMikuIElmIHdlIGFwcGx5IHRoZSBtdXRhdGlvbnNcbiAgICAgICAgLy8gZGlyZWN0bHkgKGFzIGRvbmUgaW4gYGFwcGx5VG9Mb2NhbFZpZXcoKWApLCB3ZSBjYW4gcmVkdWNlIHRoZSBjb21wbGV4aXR5XG4gICAgICAgIC8vIHRvIE8obikuXG4gICAgICAgIGNvbnN0IG4gPSBjcygpO1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbnMuZm9yRWFjaCgocyA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdC5nZXQocy5rZXkpLCByID0gaS5vdmVybGF5ZWREb2N1bWVudDtcbiAgICAgICAgICAgIC8vIFRPRE8obXV0YWJsZWRvY3VtZW50cyk6IFRoaXMgbWV0aG9kIHNob3VsZCB0YWtlIGEgTXV0YWJsZURvY3VtZW50TWFwXG4gICAgICAgICAgICAvLyBhbmQgd2Ugc2hvdWxkIHJlbW92ZSB0aGlzIGNhc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IHRoaXMuYXBwbHlUb0xvY2FsVmlldyhyLCBpLm11dGF0ZWRGaWVsZHMpO1xuICAgICAgICAgICAgLy8gU2V0IG11dGF0ZWRGaWVsZHMgdG8gbnVsbCBpZiB0aGUgZG9jdW1lbnQgaXMgb25seSBmcm9tIGxvY2FsIG11dGF0aW9ucy5cbiAgICAgICAgICAgIC8vIFRoaXMgY3JlYXRlcyBhIFNldCBvciBEZWxldGUgbXV0YXRpb24sIGluc3RlYWQgb2YgdHJ5aW5nIHRvIGNyZWF0ZSBhXG4gICAgICAgICAgICAvLyBwYXRjaCBtdXRhdGlvbiBhcyB0aGUgb3ZlcmxheS5cbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBlLmhhcyhzLmtleSkgPyBudWxsIDogbztcbiAgICAgICAgICAgIGNvbnN0IHUgPSAkbihyLCBvKTtcbiAgICAgICAgICAgIG51bGwgIT09IHUgJiYgbi5zZXQocy5rZXksIHUpLCByLmlzVmFsaWREb2N1bWVudCgpIHx8IHIuY29udmVydFRvTm9Eb2N1bWVudChzdC5taW4oKSk7XG4gICAgICAgIH0pKSwgbjtcbiAgICB9XG4gICAga2V5cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25zLnJlZHVjZSgoKHQsIGUpID0+IHQuYWRkKGUua2V5KSksIGZzKCkpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmF0Y2hJZCA9PT0gdC5iYXRjaElkICYmIHR0KHRoaXMubXV0YXRpb25zLCB0Lm11dGF0aW9ucywgKCh0LCBlKSA9PiBxbih0LCBlKSkpICYmIHR0KHRoaXMuYmFzZU11dGF0aW9ucywgdC5iYXNlTXV0YXRpb25zLCAoKHQsIGUpID0+IHFuKHQsIGUpKSk7XG4gICAgfVxufVxuXG4vKiogVGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIG11dGF0aW9uIGJhdGNoIHRvIHRoZSBiYWNrZW5kLiAqLyBjbGFzcyBPaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgXG4gICAgLyoqXG4gICAgICogQSBwcmUtY29tcHV0ZWQgbWFwcGluZyBmcm9tIGVhY2ggbXV0YXRlZCBkb2N1bWVudCB0byB0aGUgcmVzdWx0aW5nXG4gICAgICogdmVyc2lvbi5cbiAgICAgKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2ggPSB0LCB0aGlzLmNvbW1pdFZlcnNpb24gPSBlLCB0aGlzLm11dGF0aW9uUmVzdWx0cyA9IG4sIHRoaXMuZG9jVmVyc2lvbnMgPSBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IE11dGF0aW9uQmF0Y2hSZXN1bHQgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgcmVzdWx0cy4gVGhlcmVcbiAgICAgKiBtdXN0IGJlIG9uZSByZXN1bHQgZm9yIGVhY2ggbXV0YXRpb24gaW4gdGhlIGJhdGNoLiBUaGlzIHN0YXRpYyBmYWN0b3J5XG4gICAgICogY2FjaGVzIGEgZG9jdW1lbnQ9Jmd0O3ZlcnNpb24gbWFwcGluZyAoZG9jVmVyc2lvbnMpLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbSh0LCBlLCBuKSB7XG4gICAgICAgIE0odC5tdXRhdGlvbnMubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgICAgIGxldCBzID0gaHM7XG4gICAgICAgIGNvbnN0IGkgPSB0Lm11dGF0aW9ucztcbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBpLmxlbmd0aDsgdCsrKSBzID0gcy5pbnNlcnQoaVt0XS5rZXksIG5bdF0udmVyc2lvbik7XG4gICAgICAgIHJldHVybiBuZXcgT2kodCwgZSwgbiwgcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRhdGlvbiBvZiBhbiBvdmVybGF5IGNvbXB1dGVkIGJ5IEZpcmVzdG9yZS5cbiAqXG4gKiBIb2xkcyBpbmZvcm1hdGlvbiBhYm91dCBhIG11dGF0aW9uIGFuZCB0aGUgbGFyZ2VzdCBiYXRjaCBpZCBpbiBGaXJlc3RvcmUgd2hlblxuICogdGhlIG11dGF0aW9uIHdhcyBjcmVhdGVkLlxuICovIGNsYXNzIE1pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMubGFyZ2VzdEJhdGNoSWQgPSB0LCB0aGlzLm11dGF0aW9uID0gZTtcbiAgICB9XG4gICAgZ2V0S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbi5rZXk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdCAmJiB0aGlzLm11dGF0aW9uID09PSB0Lm11dGF0aW9uO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBPdmVybGF5e1xcbiAgICAgIGxhcmdlc3RCYXRjaElkOiAke3RoaXMubGFyZ2VzdEJhdGNoSWR9LFxcbiAgICAgIG11dGF0aW9uOiAke3RoaXMubXV0YXRpb24udG9TdHJpbmcoKX1cXG4gICAgfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbW11dGFibGUgc2V0IG9mIG1ldGFkYXRhIHRoYXQgdGhlIGxvY2FsIHN0b3JlIHRyYWNrcyBmb3IgZWFjaCB0YXJnZXQuXG4gKi8gY2xhc3MgRmkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgdGFyZ2V0IGJlaW5nIGxpc3RlbmVkIHRvLiAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSB0YXJnZXQgSUQgdG8gd2hpY2ggdGhlIHRhcmdldCBjb3JyZXNwb25kczsgQXNzaWduZWQgYnkgdGhlXG4gICAgICogTG9jYWxTdG9yZSBmb3IgdXNlciBsaXN0ZW5zIGFuZCBieSB0aGUgU3luY0VuZ2luZSBmb3IgbGltYm8gd2F0Y2hlcy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIHB1cnBvc2Ugb2YgdGhlIHRhcmdldC4gKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2VxdWVuY2UgbnVtYmVyIG9mIHRoZSBsYXN0IHRyYW5zYWN0aW9uIGR1cmluZyB3aGljaCB0aGlzIHRhcmdldCBkYXRhXG4gICAgICogd2FzIG1vZGlmaWVkLlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKiBUaGUgbGF0ZXN0IHNuYXBzaG90IHZlcnNpb24gc2VlbiBmb3IgdGhpcyB0YXJnZXQuICovXG4gICAgaSA9IHN0Lm1pbigpXG4gICAgLyoqXG4gICAgICogVGhlIG1heGltdW0gc25hcHNob3QgdmVyc2lvbiBhdCB3aGljaCB0aGUgYXNzb2NpYXRlZCB2aWV3XG4gICAgICogY29udGFpbmVkIG5vIGxpbWJvIGRvY3VtZW50cy5cbiAgICAgKi8gLCByID0gc3QubWluKClcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHRhcmdldCB0byBiZVxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XG4gICAgICogbWF0Y2hlcyB0aGUgdGFyZ2V0LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqLyAsIG8gPSBXdC5FTVBUWV9CWVRFX1NUUklORykge1xuICAgICAgICB0aGlzLnRhcmdldCA9IHQsIHRoaXMudGFyZ2V0SWQgPSBlLCB0aGlzLnB1cnBvc2UgPSBuLCB0aGlzLnNlcXVlbmNlTnVtYmVyID0gcywgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSBpLCBcbiAgICAgICAgdGhpcy5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uID0gciwgdGhpcy5yZXN1bWVUb2tlbiA9IG87XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBzZXF1ZW5jZSBudW1iZXIuICovICAgIHdpdGhTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgRmkodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdCwgdGhpcy5zbmFwc2hvdFZlcnNpb24sIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgdGhpcy5yZXN1bWVUb2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIHJlc3VtZSB0b2tlbiBhbmRcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uLlxuICAgICAqLyAgICB3aXRoUmVzdW1lVG9rZW4odCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IEZpKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHRoaXMuc2VxdWVuY2VOdW1iZXIsIGUsIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIGxhc3QgbGltYm8gZnJlZVxuICAgICAqIHNuYXBzaG90IHZlcnNpb24gbnVtYmVyLlxuICAgICAqLyAgICB3aXRoTGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgRmkodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdGhpcy5zZXF1ZW5jZU51bWJlciwgdGhpcy5zbmFwc2hvdFZlcnNpb24sIHQsIHRoaXMucmVzdW1lVG9rZW4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBTZXJpYWxpemVyIGZvciB2YWx1ZXMgc3RvcmVkIGluIHRoZSBMb2NhbFN0b3JlLiAqLyBjbGFzcyAkaSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnJlID0gdDtcbiAgICB9XG59XG5cbi8qKiBEZWNvZGVzIGEgcmVtb3RlIGRvY3VtZW50IGZyb20gc3RvcmFnZSBsb2NhbGx5IHRvIGEgRG9jdW1lbnQuICovIGZ1bmN0aW9uIEJpKHQsIGUpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAoZS5kb2N1bWVudCkgbiA9IExzKHQucmUsIGUuZG9jdW1lbnQsICEhZS5oYXNDb21taXR0ZWRNdXRhdGlvbnMpOyBlbHNlIGlmIChlLm5vRG9jdW1lbnQpIHtcbiAgICAgICAgY29uc3QgdCA9IGN0LmZyb21TZWdtZW50cyhlLm5vRG9jdW1lbnQucGF0aCksIHMgPSBLaShlLm5vRG9jdW1lbnQucmVhZFRpbWUpO1xuICAgICAgICBuID0gU2UubmV3Tm9Eb2N1bWVudCh0LCBzKSwgZS5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiYgbi5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIWUudW5rbm93bkRvY3VtZW50KSByZXR1cm4gTygpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ID0gY3QuZnJvbVNlZ21lbnRzKGUudW5rbm93bkRvY3VtZW50LnBhdGgpLCBzID0gS2koZS51bmtub3duRG9jdW1lbnQudmVyc2lvbik7XG4gICAgICAgICAgICBuID0gU2UubmV3VW5rbm93bkRvY3VtZW50KHQsIHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlLnJlYWRUaW1lICYmIG4uc2V0UmVhZFRpbWUoZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IG50KHRbMF0sIHRbMV0pO1xuICAgICAgICByZXR1cm4gc3QuZnJvbVRpbWVzdGFtcChlKTtcbiAgICB9KGUucmVhZFRpbWUpKSwgbjtcbn1cblxuLyoqIEVuY29kZXMgYSBkb2N1bWVudCBmb3Igc3RvcmFnZSBsb2NhbGx5LiAqLyBmdW5jdGlvbiBMaSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUua2V5LCBzID0ge1xuICAgICAgICBwcmVmaXhQYXRoOiBuLmdldENvbGxlY3Rpb25QYXRoKCkucG9wTGFzdCgpLnRvQXJyYXkoKSxcbiAgICAgICAgY29sbGVjdGlvbkdyb3VwOiBuLmNvbGxlY3Rpb25Hcm91cCxcbiAgICAgICAgZG9jdW1lbnRJZDogbi5wYXRoLmxhc3RTZWdtZW50KCksXG4gICAgICAgIHJlYWRUaW1lOiBVaShlLnJlYWRUaW1lKSxcbiAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiBlLmhhc0NvbW1pdHRlZE11dGF0aW9uc1xuICAgIH07XG4gICAgaWYgKGUuaXNGb3VuZERvY3VtZW50KCkpIHMuZG9jdW1lbnQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiBOcyh0LCBlLmtleSksXG4gICAgICAgICAgICBmaWVsZHM6IGUuZGF0YS52YWx1ZS5tYXBWYWx1ZS5maWVsZHMsXG4gICAgICAgICAgICB1cGRhdGVUaW1lOiB2cyh0LCBlLnZlcnNpb24udG9UaW1lc3RhbXAoKSlcbiAgICAgICAgfTtcbiAgICB9KHQucmUsIGUpOyBlbHNlIGlmIChlLmlzTm9Eb2N1bWVudCgpKSBzLm5vRG9jdW1lbnQgPSB7XG4gICAgICAgIHBhdGg6IG4ucGF0aC50b0FycmF5KCksXG4gICAgICAgIHJlYWRUaW1lOiBxaShlLnZlcnNpb24pXG4gICAgfTsgZWxzZSB7XG4gICAgICAgIGlmICghZS5pc1Vua25vd25Eb2N1bWVudCgpKSByZXR1cm4gTygpO1xuICAgICAgICBzLnVua25vd25Eb2N1bWVudCA9IHtcbiAgICAgICAgICAgIHBhdGg6IG4ucGF0aC50b0FycmF5KCksXG4gICAgICAgICAgICB2ZXJzaW9uOiBxaShlLnZlcnNpb24pXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBzO1xufVxuXG5mdW5jdGlvbiBVaSh0KSB7XG4gICAgY29uc3QgZSA9IHQudG9UaW1lc3RhbXAoKTtcbiAgICByZXR1cm4gWyBlLnNlY29uZHMsIGUubmFub3NlY29uZHMgXTtcbn1cblxuZnVuY3Rpb24gcWkodCkge1xuICAgIGNvbnN0IGUgPSB0LnRvVGltZXN0YW1wKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogZS5zZWNvbmRzLFxuICAgICAgICBuYW5vc2Vjb25kczogZS5uYW5vc2Vjb25kc1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIEtpKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IG50KHQuc2Vjb25kcywgdC5uYW5vc2Vjb25kcyk7XG4gICAgcmV0dXJuIHN0LmZyb21UaW1lc3RhbXAoZSk7XG59XG5cbi8qKiBFbmNvZGVzIGEgYmF0Y2ggb2YgbXV0YXRpb25zIGludG8gYSBEYk11dGF0aW9uQmF0Y2ggZm9yIGxvY2FsIHN0b3JhZ2UuICovXG4vKiogRGVjb2RlcyBhIERiTXV0YXRpb25CYXRjaCBpbnRvIGEgTXV0YXRpb25CYXRjaCAqL1xuZnVuY3Rpb24gR2kodCwgZSkge1xuICAgIGNvbnN0IG4gPSAoZS5iYXNlTXV0YXRpb25zIHx8IFtdKS5tYXAoKGUgPT4gR3ModC5yZSwgZSkpKTtcbiAgICAvLyBTcXVhc2ggb2xkIHRyYW5zZm9ybSBtdXRhdGlvbnMgaW50byBleGlzdGluZyBwYXRjaCBvciBzZXQgbXV0YXRpb25zLlxuICAgIC8vIFRoZSByZXBsYWNlbWVudCBvZiByZXByZXNlbnRpbmcgYHRyYW5zZm9ybXNgIHdpdGggYHVwZGF0ZV90cmFuc2Zvcm1zYFxuICAgIC8vIG9uIHRoZSBTREsgbWVhbnMgdGhhdCBvbGQgYHRyYW5zZm9ybWAgbXV0YXRpb25zIHN0b3JlZCBpbiBJbmRleGVkREIgbmVlZFxuICAgIC8vIHRvIGJlIHVwZGF0ZWQgdG8gYHVwZGF0ZV90cmFuc2Zvcm1zYC5cbiAgICAvLyBUT0RPKGIvMTc0NjA4Mzc0KTogUmVtb3ZlIHRoaXMgY29kZSBvbmNlIHdlIHBlcmZvcm0gYSBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubXV0YXRpb25zLmxlbmd0aCAtIDE7ICsrdCkge1xuICAgICAgICBjb25zdCBuID0gZS5tdXRhdGlvbnNbdF07XG4gICAgICAgIGlmICh0ICsgMSA8IGUubXV0YXRpb25zLmxlbmd0aCAmJiB2b2lkIDAgIT09IGUubXV0YXRpb25zW3QgKyAxXS50cmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLm11dGF0aW9uc1t0ICsgMV07XG4gICAgICAgICAgICBuLnVwZGF0ZVRyYW5zZm9ybXMgPSBzLnRyYW5zZm9ybS5maWVsZFRyYW5zZm9ybXMsIGUubXV0YXRpb25zLnNwbGljZSh0ICsgMSwgMSksIFxuICAgICAgICAgICAgKyt0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHMgPSBlLm11dGF0aW9ucy5tYXAoKGUgPT4gR3ModC5yZSwgZSkpKSwgaSA9IG50LmZyb21NaWxsaXMoZS5sb2NhbFdyaXRlVGltZU1zKTtcbiAgICByZXR1cm4gbmV3IGtpKGUuYmF0Y2hJZCwgaSwgbiwgcyk7XG59XG5cbi8qKiBEZWNvZGVzIGEgRGJUYXJnZXQgaW50byBUYXJnZXREYXRhICovIGZ1bmN0aW9uIFFpKHQpIHtcbiAgICBjb25zdCBlID0gS2kodC5yZWFkVGltZSksIG4gPSB2b2lkIDAgIT09IHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA/IEtpKHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbikgOiBzdC5taW4oKTtcbiAgICBsZXQgcztcbiAgICB2YXIgaTtcbiAgICByZXR1cm4gdm9pZCAwICE9PSB0LnF1ZXJ5LmRvY3VtZW50cyA/IChNKDEgPT09IChpID0gdC5xdWVyeSkuZG9jdW1lbnRzLmxlbmd0aCksIFxuICAgIHMgPSBjbihlbihNcyhpLmRvY3VtZW50c1swXSkpKSkgOiBzID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gY24oenModCkpO1xuICAgIH0odC5xdWVyeSksIG5ldyBGaShzLCB0LnRhcmdldElkLCAwIC8qIExpc3RlbiAqLyAsIHQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBlLCBuLCBXdC5mcm9tQmFzZTY0U3RyaW5nKHQucmVzdW1lVG9rZW4pKTtcbn1cblxuLyoqIEVuY29kZXMgVGFyZ2V0RGF0YSBpbnRvIGEgRGJUYXJnZXQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi8gZnVuY3Rpb24gamkodCwgZSkge1xuICAgIGNvbnN0IG4gPSBxaShlLnNuYXBzaG90VmVyc2lvbiksIHMgPSBxaShlLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24pO1xuICAgIGxldCBpO1xuICAgIGkgPSBPZShlLnRhcmdldCkgPyBqcyh0LnJlLCBlLnRhcmdldCkgOiBXcyh0LnJlLCBlLnRhcmdldCk7XG4gICAgLy8gV2UgY2FuJ3Qgc3RvcmUgdGhlIHJlc3VtZVRva2VuIGFzIGEgQnl0ZVN0cmluZyBpbiBJbmRleGVkRGIsIHNvIHdlXG4gICAgLy8gY29udmVydCBpdCB0byBhIGJhc2U2NCBzdHJpbmcgZm9yIHN0b3JhZ2UuXG4gICAgICAgIGNvbnN0IHIgPSBlLnJlc3VtZVRva2VuLnRvQmFzZTY0KCk7XG4gICAgLy8gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIGFsd2F5cyAwIHVudGlsIHdlIGRvIHJlYWwgR0MuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIHRhcmdldElkOiBlLnRhcmdldElkLFxuICAgICAgICBjYW5vbmljYWxJZDogeGUoZS50YXJnZXQpLFxuICAgICAgICByZWFkVGltZTogbixcbiAgICAgICAgcmVzdW1lVG9rZW46IHIsXG4gICAgICAgIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjogZS5zZXF1ZW5jZU51bWJlcixcbiAgICAgICAgbGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbjogcyxcbiAgICAgICAgcXVlcnk6IGlcbiAgICB9O1xufVxuXG4vKipcbiAqIEEgaGVscGVyIGZ1bmN0aW9uIGZvciBmaWd1cmluZyBvdXQgd2hhdCBraW5kIG9mIHF1ZXJ5IGhhcyBiZWVuIHN0b3JlZC5cbiAqL1xuLyoqXG4gKiBFbmNvZGVzIGEgYEJ1bmRsZWRRdWVyeWAgZnJvbSBidW5kbGUgcHJvdG8gdG8gYSBRdWVyeSBvYmplY3QuXG4gKlxuICogVGhpcyByZWNvbnN0cnVjdHMgdGhlIG9yaWdpbmFsIHF1ZXJ5IHVzZWQgdG8gYnVpbGQgdGhlIGJ1bmRsZSBiZWluZyBsb2FkZWQsXG4gKiBpbmNsdWRpbmcgZmVhdHVyZXMgZXhpc3RzIG9ubHkgaW4gU0RLcyAoZm9yIGV4YW1wbGU6IGxpbWl0LXRvLWxhc3QpLlxuICovXG5mdW5jdGlvbiBXaSh0KSB7XG4gICAgY29uc3QgZSA9IHpzKHtcbiAgICAgICAgcGFyZW50OiB0LnBhcmVudCxcbiAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiB0LnN0cnVjdHVyZWRRdWVyeVxuICAgIH0pO1xuICAgIHJldHVybiBcIkxBU1RcIiA9PT0gdC5saW1pdFR5cGUgPyBhbihlLCBlLmxpbWl0LCBcIkxcIiAvKiBMYXN0ICovKSA6IGU7XG59XG5cbi8qKiBFbmNvZGVzIGEgTmFtZWRRdWVyeSBwcm90byBvYmplY3QgdG8gYSBOYW1lZFF1ZXJ5IG1vZGVsIG9iamVjdC4gKi9cbi8qKiBFbmNvZGVzIGEgRGJEb2N1bWVudE92ZXJsYXkgb2JqZWN0IHRvIGFuIE92ZXJsYXkgbW9kZWwgb2JqZWN0LiAqL1xuZnVuY3Rpb24gemkodCwgZSkge1xuICAgIHJldHVybiBuZXcgTWkoZS5sYXJnZXN0QmF0Y2hJZCwgR3ModC5yZSwgZS5vdmVybGF5TXV0YXRpb24pKTtcbn1cblxuLyoqIERlY29kZXMgYW4gT3ZlcmxheSBtb2RlbCBvYmplY3QgaW50byBhIERiRG9jdW1lbnRPdmVybGF5IG9iamVjdC4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgRGJEb2N1bWVudE92ZXJsYXlLZXkgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gdXNlciBhbmRcbiAqIGRvY3VtZW50IGtleS5cbiAqL1xuZnVuY3Rpb24gSGkodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICByZXR1cm4gWyB0LCByaShlLnBhdGgucG9wTGFzdCgpKSwgbiBdO1xufVxuXG5mdW5jdGlvbiBKaSh0LCBlLCBuLCBzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5kZXhJZDogdCxcbiAgICAgICAgdWlkOiBlLnVpZCB8fCBcIlwiLFxuICAgICAgICBzZXF1ZW5jZU51bWJlcjogbixcbiAgICAgICAgcmVhZFRpbWU6IHFpKHMucmVhZFRpbWUpLFxuICAgICAgICBkb2N1bWVudEtleTogcmkocy5kb2N1bWVudEtleS5wYXRoKSxcbiAgICAgICAgbGFyZ2VzdEJhdGNoSWQ6IHMubGFyZ2VzdEJhdGNoSWRcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBZaSB7XG4gICAgZ2V0QnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gWGkodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaWQ6IChlID0gdCkuYnVuZGxlSWQsXG4gICAgICAgICAgICAgICAgY3JlYXRlVGltZTogS2koZS5jcmVhdGVUaW1lKSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBlLnZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIERiQnVuZGxlIHRvIGEgQnVuZGxlTWV0YWRhdGEgb2JqZWN0LiAqL1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIEJ1bmRsZU1ldGFkYXRhIHRvIGEgRGJCdW5kbGUuICovICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBYaSh0KS5wdXQoe1xuICAgICAgICAgICAgYnVuZGxlSWQ6IChuID0gZSkuaWQsXG4gICAgICAgICAgICBjcmVhdGVUaW1lOiBxaShEcyhuLmNyZWF0ZVRpbWUpKSxcbiAgICAgICAgICAgIHZlcnNpb246IG4udmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG47XG4gICAgICAgIC8qKiBFbmNvZGVzIGEgRGJOYW1lZFF1ZXJ5IHRvIGEgTmFtZWRRdWVyeS4gKi8gICAgfVxuICAgIGdldE5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gWmkodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogKGUgPSB0KS5uYW1lLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiBXaShlLmJ1bmRsZWRRdWVyeSksXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IEtpKGUucmVhZFRpbWUpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIE5hbWVkUXVlcnkgZnJvbSBhIGJ1bmRsZSBwcm90byB0byBhIERiTmFtZWRRdWVyeS4gKi8gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gWmkodCkucHV0KGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogdC5uYW1lLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBxaShEcyh0LnJlYWRUaW1lKSksXG4gICAgICAgICAgICAgICAgYnVuZGxlZFF1ZXJ5OiB0LmJ1bmRsZWRRdWVyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgYnVuZGxlcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gWGkodCkge1xuICAgIHJldHVybiBOaSh0LCBcImJ1bmRsZXNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBuYW1lZFF1ZXJpZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIFppKHQpIHtcbiAgICByZXR1cm4gTmkodCwgXCJuYW1lZFF1ZXJpZXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltcGxlbWVudGF0aW9uIG9mIERvY3VtZW50T3ZlcmxheUNhY2hlIHVzaW5nIEluZGV4ZWREYi5cbiAqLyBjbGFzcyB0ciB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgZG9jdW1lbnQgc2VyaWFsaXplci5cbiAgICAgKiBAcGFyYW0gdXNlcklkIC0gVGhlIHVzZXJJZCBmb3Igd2hpY2ggd2UgYXJlIGFjY2Vzc2luZyBvdmVybGF5cy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuSXQgPSB0LCB0aGlzLnVzZXJJZCA9IGU7XG4gICAgfVxuICAgIHN0YXRpYyBvZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnVpZCB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gbmV3IHRyKHQsIG4pO1xuICAgIH1cbiAgICBnZXRPdmVybGF5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGVyKHQpLmdldChIaSh0aGlzLnVzZXJJZCwgZSkpLm5leHQoKHQgPT4gdCA/IHppKHRoaXMuSXQsIHQpIDogbnVsbCkpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB1cygpO1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaChlLCAoZSA9PiB0aGlzLmdldE92ZXJsYXkodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBudWxsICE9PSB0ICYmIG4uc2V0KGUsIHQpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIHNhdmVPdmVybGF5cyh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgTWkoZSwgaSk7XG4gICAgICAgICAgICBzLnB1c2godGhpcy51ZSh0LCByKSk7XG4gICAgICAgIH0pKSwgQXQud2FpdEZvcihzKTtcbiAgICB9XG4gICAgcmVtb3ZlT3ZlcmxheXNGb3JCYXRjaElkKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBTZXQ7XG4gICAgICAgIC8vIEdldCB0aGUgc2V0IG9mIHVuaXF1ZSBjb2xsZWN0aW9uIHBhdGhzLlxuICAgICAgICAgICAgICAgIGUuZm9yRWFjaCgodCA9PiBzLmFkZChyaSh0LmdldENvbGxlY3Rpb25QYXRoKCkpKSkpO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiBzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIGUsIG4gXSwgWyB0aGlzLnVzZXJJZCwgZSwgbiArIDEgXSwgXG4gICAgICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCk7XG4gICAgICAgICAgICBpLnB1c2goZXIodCkuWShcImNvbGxlY3Rpb25QYXRoT3ZlcmxheUluZGV4XCIsIHMpKTtcbiAgICAgICAgfSkpLCBBdC53YWl0Rm9yKGkpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdXMoKSwgaSA9IHJpKGUpLCByID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgaSwgbiBdLCBbIHRoaXMudXNlcklkLCBpLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIGVyKHQpLlcoXCJjb2xsZWN0aW9uUGF0aE92ZXJsYXlJbmRleFwiLCByKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHppKHRoaXMuSXQsIGUpO1xuICAgICAgICAgICAgICAgIHMuc2V0KHQuZ2V0S2V5KCksIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gdXMoKTtcbiAgICAgICAgbGV0IHI7XG4gICAgICAgIC8vIFdlIHdhbnQgYmF0Y2ggSURzIGxhcmdlciB0aGFuIGBzaW5jZUJhdGNoSWRgLCBhbmQgc28gdGhlIGxvd2VyIGJvdW5kXG4gICAgICAgIC8vIGlzIG5vdCBpbmNsdXNpdmUuXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIGUsIG4gXSwgWyB0aGlzLnVzZXJJZCwgZSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMCk7XG4gICAgICAgIHJldHVybiBlcih0KS5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcImNvbGxlY3Rpb25Hcm91cE92ZXJsYXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IG9cbiAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBXZSBkbyBub3Qgd2FudCB0byByZXR1cm4gcGFydGlhbCBiYXRjaCBvdmVybGF5cywgZXZlbiBpZiB0aGUgc2l6ZVxuICAgICAgICAgICAgLy8gb2YgdGhlIHJlc3VsdCBzZXQgZXhjZWVkcyB0aGUgZ2l2ZW4gYGNvdW50YCBhcmd1bWVudC4gVGhlcmVmb3JlLCB3ZVxuICAgICAgICAgICAgLy8gY29udGludWUgdG8gYWdncmVnYXRlIHJlc3VsdHMgZXZlbiBhZnRlciB0aGUgcmVzdWx0IHNpemUgZXhjZWVkc1xuICAgICAgICAgICAgLy8gYGNvdW50YCBpZiB0aGVyZSBhcmUgbW9yZSBvdmVybGF5cyBmcm9tIHRoZSBgY3VycmVudEJhdGNoSWRgLlxuICAgICAgICAgICAgY29uc3QgbyA9IHppKHRoaXMuSXQsIGUpO1xuICAgICAgICAgICAgaS5zaXplKCkgPCBzIHx8IG8ubGFyZ2VzdEJhdGNoSWQgPT09IHIgPyAoaS5zZXQoby5nZXRLZXkoKSwgbyksIHIgPSBvLmxhcmdlc3RCYXRjaElkKSA6IG4uZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICB1ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBlcih0KS5wdXQoZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgY29uc3QgW3MsIGksIHJdID0gSGkoZSwgbi5tdXRhdGlvbi5rZXkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IGUsXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvblBhdGg6IGksXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRJZDogcixcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IG4ubXV0YXRpb24ua2V5LmdldENvbGxlY3Rpb25Hcm91cCgpLFxuICAgICAgICAgICAgICAgIGxhcmdlc3RCYXRjaElkOiBuLmxhcmdlc3RCYXRjaElkLFxuICAgICAgICAgICAgICAgIG92ZXJsYXlNdXRhdGlvbjogS3ModC5yZSwgbi5tdXRhdGlvbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odGhpcy5JdCwgdGhpcy51c2VySWQsIGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBkb2N1bWVudCBvdmVybGF5IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBlcih0KSB7XG4gICAgcmV0dXJuIE5pKHQsIFwiZG9jdW1lbnRPdmVybGF5c1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIE5vdGU6IFRoaXMgY29kZSBpcyBjb3BpZWQgZnJvbSB0aGUgYmFja2VuZC4gQ29kZSB0aGF0IGlzIG5vdCB1c2VkIGJ5XG4vLyBGaXJlc3RvcmUgd2FzIHJlbW92ZWQuXG4vKiogRmlyZXN0b3JlIGluZGV4IHZhbHVlIHdyaXRlci4gICovXG5jbGFzcyBuciB7XG4gICAgY29uc3RydWN0b3IoKSB7fVxuICAgIC8vIFRoZSB3cml0ZSBtZXRob2RzIGJlbG93IHNob3J0LWNpcmN1aXQgd3JpdGluZyB0ZXJtaW5hdG9ycyBmb3IgdmFsdWVzXG4gICAgLy8gY29udGFpbmluZyBhICh0ZXJtaW5hdGluZykgdHJ1bmNhdGVkIHZhbHVlLlxuICAgIC8vIEFzIGFuIGV4YW1wbGUsIGNvbnNpZGVyIHRoZSByZXN1bHRpbmcgZW5jb2RpbmcgZm9yOlxuICAgIC8vIFtcImJhclwiLCBbMiwgXCJmb29cIl1dIC0+IChTVFJJTkcsIFwiYmFyXCIsIFRFUk0sIEFSUkFZLCBOVU1CRVIsIDIsIFNUUklORywgXCJmb29cIiwgVEVSTSwgVEVSTSwgVEVSTSlcbiAgICAvLyBbXCJiYXJcIiwgWzIsIHRydW5jYXRlZChcImZvb1wiKV1dIC0+IChTVFJJTkcsIFwiYmFyXCIsIFRFUk0sIEFSUkFZLCBOVU1CRVIsIDIsIFNUUklORywgXCJmb29cIiwgVFJVTkMpXG4gICAgLy8gW1wiYmFyXCIsIHRydW5jYXRlZChbXCJmb29cIl0pXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWS4gU1RSSU5HLCBcImZvb1wiLCBURVJNLCBUUlVOQylcbiAgICAvKiogV3JpdGVzIGFuIGluZGV4IHZhbHVlLiAgKi9cbiAgICBjZSh0LCBlKSB7XG4gICAgICAgIHRoaXMuYWUodCwgZSksIFxuICAgICAgICAvLyBXcml0ZSBzZXBhcmF0b3IgdG8gc3BsaXQgaW5kZXggdmFsdWVzXG4gICAgICAgIC8vIChzZWUgZ28vZmlyZXN0b3JlLXN0b3JhZ2UtZm9ybWF0I2VuY29kaW5ncykuXG4gICAgICAgIGUuaGUoKTtcbiAgICB9XG4gICAgYWUodCwgZSkge1xuICAgICAgICBpZiAoXCJudWxsVmFsdWVcIiBpbiB0KSB0aGlzLmxlKGUsIDUpOyBlbHNlIGlmIChcImJvb2xlYW5WYWx1ZVwiIGluIHQpIHRoaXMubGUoZSwgMTApLCBcbiAgICAgICAgZS5mZSh0LmJvb2xlYW5WYWx1ZSA/IDEgOiAwKTsgZWxzZSBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiB0KSB0aGlzLmxlKGUsIDE1KSwgZS5mZShKdCh0LmludGVnZXJWYWx1ZSkpOyBlbHNlIGlmIChcImRvdWJsZVZhbHVlXCIgaW4gdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IEp0KHQuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgaXNOYU4obikgPyB0aGlzLmxlKGUsIDEzKSA6ICh0aGlzLmxlKGUsIDE1KSwgaWUobikgPyBcbiAgICAgICAgICAgIC8vIC0wLjAsIDAgYW5kIDAuMCBhcmUgYWxsIGNvbnNpZGVyZWQgdGhlIHNhbWVcbiAgICAgICAgICAgIGUuZmUoMCkgOiBlLmZlKG4pKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICB0aGlzLmxlKGUsIDIwKSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgbiA/IGUuZGUobikgOiAoZS5kZShgJHtuLnNlY29uZHMgfHwgXCJcIn1gKSwgZS5mZShuLm5hbm9zIHx8IDApKTtcbiAgICAgICAgfSBlbHNlIGlmIChcInN0cmluZ1ZhbHVlXCIgaW4gdCkgdGhpcy5fZSh0LnN0cmluZ1ZhbHVlLCBlKSwgdGhpcy53ZShlKTsgZWxzZSBpZiAoXCJieXRlc1ZhbHVlXCIgaW4gdCkgdGhpcy5sZShlLCAzMCksIFxuICAgICAgICBlLm1lKFl0KHQuYnl0ZXNWYWx1ZSkpLCB0aGlzLndlKGUpOyBlbHNlIGlmIChcInJlZmVyZW5jZVZhbHVlXCIgaW4gdCkgdGhpcy5nZSh0LnJlZmVyZW5jZVZhbHVlLCBlKTsgZWxzZSBpZiAoXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2VvUG9pbnRWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMubGUoZSwgNDUpLCBlLmZlKG4ubGF0aXR1ZGUgfHwgMCksIGUuZmUobi5sb25naXR1ZGUgfHwgMCk7XG4gICAgICAgIH0gZWxzZSBcIm1hcFZhbHVlXCIgaW4gdCA/IEVlKHQpID8gdGhpcy5sZShlLCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikgOiAodGhpcy55ZSh0Lm1hcFZhbHVlLCBlKSwgXG4gICAgICAgIHRoaXMud2UoZSkpIDogXCJhcnJheVZhbHVlXCIgaW4gdCA/ICh0aGlzLnBlKHQuYXJyYXlWYWx1ZSwgZSksIHRoaXMud2UoZSkpIDogTygpO1xuICAgIH1cbiAgICBfZSh0LCBlKSB7XG4gICAgICAgIHRoaXMubGUoZSwgMjUpLCB0aGlzLkllKHQsIGUpO1xuICAgIH1cbiAgICBJZSh0LCBlKSB7XG4gICAgICAgIGUuZGUodCk7XG4gICAgfVxuICAgIHllKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHQuZmllbGRzIHx8IHt9O1xuICAgICAgICB0aGlzLmxlKGUsIDU1KTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIE9iamVjdC5rZXlzKG4pKSB0aGlzLl9lKHQsIGUpLCB0aGlzLmFlKG5bdF0sIGUpO1xuICAgIH1cbiAgICBwZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgdGhpcy5sZShlLCA1MCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSB0aGlzLmFlKHQsIGUpO1xuICAgIH1cbiAgICBnZSh0LCBlKSB7XG4gICAgICAgIHRoaXMubGUoZSwgMzcpO1xuICAgICAgICBjdC5mcm9tTmFtZSh0KS5wYXRoLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5sZShlLCA2MCksIHRoaXMuSWUodCwgZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgbGUodCwgZSkge1xuICAgICAgICB0LmZlKGUpO1xuICAgIH1cbiAgICB3ZSh0KSB7XG4gICAgICAgIC8vIFdoaWxlIHRoZSBTREsgZG9lcyBub3QgaW1wbGVtZW50IHRydW5jYXRpb24sIHRoZSB0cnVuY2F0aW9uIG1hcmtlciBpc1xuICAgICAgICAvLyB1c2VkIHRvIHRlcm1pbmF0ZSBhbGwgdmFyaWFibGUgbGVuZ3RoIHZhbHVlcyAod2hpY2ggYXJlIHN0cmluZ3MsIGJ5dGVzLFxuICAgICAgICAvLyByZWZlcmVuY2VzLCBhcnJheXMgYW5kIG1hcHMpLlxuICAgICAgICB0LmZlKDIpO1xuICAgIH1cbn1cblxubnIuVGUgPSBuZXcgbnI7XG5cbi8qKlxuICogQ291bnRzIHRoZSBudW1iZXIgb2YgemVyb3MgaW4gYSBieXRlLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIHNyKHQpIHtcbiAgICBpZiAoMCA9PT0gdCkgcmV0dXJuIDg7XG4gICAgbGV0IGUgPSAwO1xuICAgIHJldHVybiB0ID4+IDQgPT0gMCAmJiAoXG4gICAgLy8gVGVzdCBpZiB0aGUgZmlyc3QgZm91ciBiaXRzIGFyZSB6ZXJvLlxuICAgIGUgKz0gNCwgdCA8PD0gNCksIHQgPj4gNiA9PSAwICYmIChcbiAgICAvLyBUZXN0IGlmIHRoZSBmaXJzdCB0d28gKG9yIG5leHQgdHdvKSBiaXRzIGFyZSB6ZXJvLlxuICAgIGUgKz0gMiwgdCA8PD0gMiksIHQgPj4gNyA9PSAwICYmIChcbiAgICAvLyBUZXN0IGlmIHRoZSByZW1haW5pbmcgYml0IGlzIHplcm8uXG4gICAgZSArPSAxKSwgZTtcbn1cblxuLyoqIENvdW50cyB0aGUgbnVtYmVyIG9mIGxlYWRpbmcgemVyb3MgaW4gdGhlIGdpdmVuIGJ5dGUgYXJyYXkuICovXG4vKipcbiAqIFJldHVybnMgdGhlIG51bWJlciBvZiBieXRlcyByZXF1aXJlZCB0byBzdG9yZSBcInZhbHVlXCIuIExlYWRpbmcgemVybyBieXRlc1xuICogYXJlIHNraXBwZWQuXG4gKi9cbmZ1bmN0aW9uIGlyKHQpIHtcbiAgICAvLyBUaGlzIGlzIGp1c3QgdGhlIG51bWJlciBvZiBieXRlcyBmb3IgdGhlIHVuc2lnbmVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBudW1iZXIuXG4gICAgY29uc3QgZSA9IDY0IC0gZnVuY3Rpb24odCkge1xuICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgODsgKytuKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gc3IoMjU1ICYgdFtuXSk7XG4gICAgICAgICAgICBpZiAoZSArPSBzLCA4ICE9PSBzKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZTtcbiAgICB9KHQpO1xuICAgIHJldHVybiBNYXRoLmNlaWwoZSAvIDgpO1xufVxuXG4vKipcbiAqIE9yZGVyZWRDb2RlV3JpdGVyIGlzIGEgbWluaW1hbC1hbGxvY2F0aW9uIGltcGxlbWVudGF0aW9uIG9mIHRoZSB3cml0aW5nXG4gKiBiZWhhdmlvciBkZWZpbmVkIGJ5IHRoZSBiYWNrZW5kLlxuICpcbiAqIFRoZSBjb2RlIGlzIHBvcnRlZCBmcm9tIGl0cyBKYXZhIGNvdW50ZXJwYXJ0LlxuICovIGNsYXNzIHJyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5idWZmZXIgPSBuZXcgVWludDhBcnJheSgxMDI0KSwgdGhpcy5wb3NpdGlvbiA9IDA7XG4gICAgfVxuICAgIEVlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRbU3ltYm9sLml0ZXJhdG9yXSgpO1xuICAgICAgICBsZXQgbiA9IGUubmV4dCgpO1xuICAgICAgICBmb3IgKDshbi5kb25lOyApIHRoaXMuQWUobi52YWx1ZSksIG4gPSBlLm5leHQoKTtcbiAgICAgICAgdGhpcy5SZSgpO1xuICAgIH1cbiAgICBiZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0W1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICAgICAgbGV0IG4gPSBlLm5leHQoKTtcbiAgICAgICAgZm9yICg7IW4uZG9uZTsgKSB0aGlzLlBlKG4udmFsdWUpLCBuID0gZS5uZXh0KCk7XG4gICAgICAgIHRoaXMudmUoKTtcbiAgICB9XG4gICAgLyoqIFdyaXRlcyB1dGY4IGJ5dGVzIGludG8gdGhpcyBieXRlIHNlcXVlbmNlLCBhc2NlbmRpbmcuICovICAgIFZlKHQpIHtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmNoYXJDb2RlQXQoMCk7XG4gICAgICAgICAgICBpZiAodCA8IDEyOCkgdGhpcy5BZSh0KTsgZWxzZSBpZiAodCA8IDIwNDgpIHRoaXMuQWUoOTYwIHwgdCA+Pj4gNiksIHRoaXMuQWUoMTI4IHwgNjMgJiB0KTsgZWxzZSBpZiAoZSA8IFwiXFx1ZDgwMFwiIHx8IFwiXFx1ZGJmZlwiIDwgZSkgdGhpcy5BZSg0ODAgfCB0ID4+PiAxMiksIFxuICAgICAgICAgICAgdGhpcy5BZSgxMjggfCA2MyAmIHQgPj4+IDYpLCB0aGlzLkFlKDEyOCB8IDYzICYgdCk7IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmNvZGVQb2ludEF0KDApO1xuICAgICAgICAgICAgICAgIHRoaXMuQWUoMjQwIHwgdCA+Pj4gMTgpLCB0aGlzLkFlKDEyOCB8IDYzICYgdCA+Pj4gMTIpLCB0aGlzLkFlKDEyOCB8IDYzICYgdCA+Pj4gNiksIFxuICAgICAgICAgICAgICAgIHRoaXMuQWUoMTI4IHwgNjMgJiB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLlJlKCk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgdXRmOCBieXRlcyBpbnRvIHRoaXMgYnl0ZSBzZXF1ZW5jZSwgZGVzY2VuZGluZyAqLyAgICBTZSh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgaWYgKHQgPCAxMjgpIHRoaXMuUGUodCk7IGVsc2UgaWYgKHQgPCAyMDQ4KSB0aGlzLlBlKDk2MCB8IHQgPj4+IDYpLCB0aGlzLlBlKDEyOCB8IDYzICYgdCk7IGVsc2UgaWYgKGUgPCBcIlxcdWQ4MDBcIiB8fCBcIlxcdWRiZmZcIiA8IGUpIHRoaXMuUGUoNDgwIHwgdCA+Pj4gMTIpLCBcbiAgICAgICAgICAgIHRoaXMuUGUoMTI4IHwgNjMgJiB0ID4+PiA2KSwgdGhpcy5QZSgxMjggfCA2MyAmIHQpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5jb2RlUG9pbnRBdCgwKTtcbiAgICAgICAgICAgICAgICB0aGlzLlBlKDI0MCB8IHQgPj4+IDE4KSwgdGhpcy5QZSgxMjggfCA2MyAmIHQgPj4+IDEyKSwgdGhpcy5QZSgxMjggfCA2MyAmIHQgPj4+IDYpLCBcbiAgICAgICAgICAgICAgICB0aGlzLlBlKDEyOCB8IDYzICYgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52ZSgpO1xuICAgIH1cbiAgICBEZSh0KSB7XG4gICAgICAgIC8vIFZhbHVlcyBhcmUgZW5jb2RlZCB3aXRoIGEgc2luZ2xlIGJ5dGUgbGVuZ3RoIHByZWZpeCwgZm9sbG93ZWQgYnkgdGhlXG4gICAgICAgIC8vIGFjdHVhbCB2YWx1ZSBpbiBiaWctZW5kaWFuIGZvcm1hdCB3aXRoIGxlYWRpbmcgMCBieXRlcyBkcm9wcGVkLlxuICAgICAgICBjb25zdCBlID0gdGhpcy5DZSh0KSwgbiA9IGlyKGUpO1xuICAgICAgICB0aGlzLnhlKDEgKyBuKSwgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IDI1NSAmIG47XG4gICAgICAgIC8vIFdyaXRlIHRoZSBsZW5ndGhcbiAgICAgICAgZm9yIChsZXQgdCA9IGUubGVuZ3RoIC0gbjsgdCA8IGUubGVuZ3RoOyArK3QpIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSAyNTUgJiBlW3RdO1xuICAgIH1cbiAgICBOZSh0KSB7XG4gICAgICAgIC8vIFZhbHVlcyBhcmUgZW5jb2RlZCB3aXRoIGEgc2luZ2xlIGJ5dGUgbGVuZ3RoIHByZWZpeCwgZm9sbG93ZWQgYnkgdGhlXG4gICAgICAgIC8vIGludmVydGVkIHZhbHVlIGluIGJpZy1lbmRpYW4gZm9ybWF0IHdpdGggbGVhZGluZyAwIGJ5dGVzIGRyb3BwZWQuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLkNlKHQpLCBuID0gaXIoZSk7XG4gICAgICAgIHRoaXMueGUoMSArIG4pLCB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gfigyNTUgJiBuKTtcbiAgICAgICAgLy8gV3JpdGUgdGhlIGxlbmd0aFxuICAgICAgICBmb3IgKGxldCB0ID0gZS5sZW5ndGggLSBuOyB0IDwgZS5sZW5ndGg7ICsrdCkgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IH4oMjU1ICYgZVt0XSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdyaXRlcyB0aGUgXCJpbmZpbml0eVwiIGJ5dGUgc2VxdWVuY2UgdGhhdCBzb3J0cyBhZnRlciBhbGwgb3RoZXIgYnl0ZVxuICAgICAqIHNlcXVlbmNlcyB3cml0dGVuIGluIGFzY2VuZGluZyBvcmRlci5cbiAgICAgKi8gICAga2UoKSB7XG4gICAgICAgIHRoaXMuT2UoMjU1KSwgdGhpcy5PZSgyNTUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgdGhlIFwiaW5maW5pdHlcIiBieXRlIHNlcXVlbmNlIHRoYXQgc29ydHMgYmVmb3JlIGFsbCBvdGhlciBieXRlXG4gICAgICogc2VxdWVuY2VzIHdyaXR0ZW4gaW4gZGVzY2VuZGluZyBvcmRlci5cbiAgICAgKi8gICAgTWUoKSB7XG4gICAgICAgIHRoaXMuRmUoMjU1KSwgdGhpcy5GZSgyNTUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJ1ZmZlciBzdWNoIHRoYXQgaXQgaXMgdGhlIHNhbWUgYXMgd2hlbiBpdCB3YXMgbmV3bHlcbiAgICAgKiBjb25zdHJ1Y3RlZC5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSAwO1xuICAgIH1cbiAgICBzZWVkKHQpIHtcbiAgICAgICAgdGhpcy54ZSh0Lmxlbmd0aCksIHRoaXMuYnVmZmVyLnNldCh0LCB0aGlzLnBvc2l0aW9uKSwgdGhpcy5wb3NpdGlvbiArPSB0Lmxlbmd0aDtcbiAgICB9XG4gICAgLyoqIE1ha2VzIGEgY29weSBvZiB0aGUgZW5jb2RlZCBieXRlcyBpbiB0aGlzIGJ1ZmZlci4gICovICAgICRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIuc2xpY2UoMCwgdGhpcy5wb3NpdGlvbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZXMgYHZhbGAgaW50byBhbiBlbmNvZGluZyBzbyB0aGF0IHRoZSBvcmRlciBtYXRjaGVzIHRoZSBJRUVFIDc1NFxuICAgICAqIGZsb2F0aW5nLXBvaW50IGNvbXBhcmlzb24gcmVzdWx0cyB3aXRoIHRoZSBmb2xsb3dpbmcgZXhjZXB0aW9uczpcbiAgICAgKiAgIC0wLjAgPCAwLjBcbiAgICAgKiAgIGFsbCBub24tTmFOIDwgTmFOXG4gICAgICogICBOYU4gPSBOYU5cbiAgICAgKi8gICAgQ2UodCkge1xuICAgICAgICBjb25zdCBlID0gXG4gICAgICAgIC8qKiBDb252ZXJ0cyBhIEphdmFTY3JpcHQgbnVtYmVyIHRvIGEgYnl0ZSBhcnJheSAodXNpbmcgYmlnIGVuZGlhbiBlbmNvZGluZykuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKDgpKTtcbiAgICAgICAgICAgIHJldHVybiBlLnNldEZsb2F0NjQoMCwgdCwgLyogbGl0dGxlRW5kaWFuPSAqLyAhMSksIG5ldyBVaW50OEFycmF5KGUuYnVmZmVyKTtcbiAgICAgICAgfSh0KSwgbiA9IDAgIT0gKDEyOCAmIGVbMF0pO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZmlyc3QgYml0IGlzIHNldC4gV2UgdXNlIGEgYml0IG1hc2sgc2luY2UgdmFsdWVbMF0gaXNcbiAgICAgICAgLy8gZW5jb2RlZCBhcyBhIG51bWJlciBmcm9tIDAgdG8gMjU1LlxuICAgICAgICAgICAgICAgIC8vIFJldmVydCB0aGUgdHdvIGNvbXBsZW1lbnQgdG8gZ2V0IG5hdHVyYWwgb3JkZXJpbmdcbiAgICAgICAgZVswXSBePSBuID8gMjU1IDogMTI4O1xuICAgICAgICBmb3IgKGxldCB0ID0gMTsgdCA8IGUubGVuZ3RoOyArK3QpIGVbdF0gXj0gbiA/IDI1NSA6IDA7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICAvKiogV3JpdGVzIGEgc2luZ2xlIGJ5dGUgYXNjZW5kaW5nIHRvIHRoZSBidWZmZXIuICovICAgIEFlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IDI1NSAmIHQ7XG4gICAgICAgIDAgPT09IGUgPyAodGhpcy5PZSgwKSwgdGhpcy5PZSgyNTUpKSA6IDI1NSA9PT0gZSA/ICh0aGlzLk9lKDI1NSksIHRoaXMuT2UoMCkpIDogdGhpcy5PZShlKTtcbiAgICB9XG4gICAgLyoqIFdyaXRlcyBhIHNpbmdsZSBieXRlIGRlc2NlbmRpbmcgdG8gdGhlIGJ1ZmZlci4gICovICAgIFBlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IDI1NSAmIHQ7XG4gICAgICAgIDAgPT09IGUgPyAodGhpcy5GZSgwKSwgdGhpcy5GZSgyNTUpKSA6IDI1NSA9PT0gZSA/ICh0aGlzLkZlKDI1NSksIHRoaXMuRmUoMCkpIDogdGhpcy5GZSh0KTtcbiAgICB9XG4gICAgUmUoKSB7XG4gICAgICAgIHRoaXMuT2UoMCksIHRoaXMuT2UoMSk7XG4gICAgfVxuICAgIHZlKCkge1xuICAgICAgICB0aGlzLkZlKDApLCB0aGlzLkZlKDEpO1xuICAgIH1cbiAgICBPZSh0KSB7XG4gICAgICAgIHRoaXMueGUoMSksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSB0O1xuICAgIH1cbiAgICBGZSh0KSB7XG4gICAgICAgIHRoaXMueGUoMSksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSB+dDtcbiAgICB9XG4gICAgeGUodCkge1xuICAgICAgICBjb25zdCBlID0gdCArIHRoaXMucG9zaXRpb247XG4gICAgICAgIGlmIChlIDw9IHRoaXMuYnVmZmVyLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICAvLyBUcnkgZG91YmxpbmcuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSAyICogdGhpcy5idWZmZXIubGVuZ3RoO1xuICAgICAgICAvLyBTdGlsbCBub3QgYmlnIGVub3VnaD8gSnVzdCBhbGxvY2F0ZSB0aGUgcmlnaHQgc2l6ZS5cbiAgICAgICAgICAgICAgICBuIDwgZSAmJiAobiA9IGUpO1xuICAgICAgICAvLyBDcmVhdGUgdGhlIG5ldyBidWZmZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBVaW50OEFycmF5KG4pO1xuICAgICAgICBzLnNldCh0aGlzLmJ1ZmZlciksIC8vIGNvcHkgb2xkIGRhdGFcbiAgICAgICAgdGhpcy5idWZmZXIgPSBzO1xuICAgIH1cbn1cblxuY2xhc3Mgb3Ige1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5CZSA9IHQ7XG4gICAgfVxuICAgIG1lKHQpIHtcbiAgICAgICAgdGhpcy5CZS5FZSh0KTtcbiAgICB9XG4gICAgZGUodCkge1xuICAgICAgICB0aGlzLkJlLlZlKHQpO1xuICAgIH1cbiAgICBmZSh0KSB7XG4gICAgICAgIHRoaXMuQmUuRGUodCk7XG4gICAgfVxuICAgIGhlKCkge1xuICAgICAgICB0aGlzLkJlLmtlKCk7XG4gICAgfVxufVxuXG5jbGFzcyB1ciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLkJlID0gdDtcbiAgICB9XG4gICAgbWUodCkge1xuICAgICAgICB0aGlzLkJlLmJlKHQpO1xuICAgIH1cbiAgICBkZSh0KSB7XG4gICAgICAgIHRoaXMuQmUuU2UodCk7XG4gICAgfVxuICAgIGZlKHQpIHtcbiAgICAgICAgdGhpcy5CZS5OZSh0KTtcbiAgICB9XG4gICAgaGUoKSB7XG4gICAgICAgIHRoaXMuQmUuTWUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW1wbGVtZW50cyBgRGlyZWN0aW9uYWxJbmRleEJ5dGVFbmNvZGVyYCB1c2luZyBgT3JkZXJlZENvZGVXcml0ZXJgIGZvciB0aGVcbiAqIGFjdHVhbCBlbmNvZGluZy5cbiAqLyBjbGFzcyBjciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuQmUgPSBuZXcgcnIsIHRoaXMuTGUgPSBuZXcgb3IodGhpcy5CZSksIHRoaXMuVWUgPSBuZXcgdXIodGhpcy5CZSk7XG4gICAgfVxuICAgIHNlZWQodCkge1xuICAgICAgICB0aGlzLkJlLnNlZWQodCk7XG4gICAgfVxuICAgIHFlKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgLyogQVNDRU5ESU5HICovID09PSB0ID8gdGhpcy5MZSA6IHRoaXMuVWU7XG4gICAgfVxuICAgICRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5CZS4kZSgpO1xuICAgIH1cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy5CZS5yZXNldCgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBSZXByZXNlbnRzIGFuIGluZGV4IGVudHJ5IHNhdmVkIGJ5IHRoZSBTREsgaW4gcGVyc2lzdGVkIHN0b3JhZ2UuICovIGNsYXNzIGFyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuaW5kZXhJZCA9IHQsIHRoaXMuZG9jdW1lbnRLZXkgPSBlLCB0aGlzLmFycmF5VmFsdWUgPSBuLCB0aGlzLmRpcmVjdGlvbmFsVmFsdWUgPSBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIEluZGV4RW50cnkgZW50cnkgdGhhdCBzb3J0cyBpbW1lZGlhdGVseSBhZnRlciB0aGUgY3VycmVudFxuICAgICAqIGRpcmVjdGlvbmFsIHZhbHVlLlxuICAgICAqLyAgICBLZSgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuZGlyZWN0aW9uYWxWYWx1ZS5sZW5ndGgsIGUgPSAwID09PSB0IHx8IDI1NSA9PT0gdGhpcy5kaXJlY3Rpb25hbFZhbHVlW3QgLSAxXSA/IHQgKyAxIDogdCwgbiA9IG5ldyBVaW50OEFycmF5KGUpO1xuICAgICAgICByZXR1cm4gbi5zZXQodGhpcy5kaXJlY3Rpb25hbFZhbHVlLCAwKSwgZSAhPT0gdCA/IG4uc2V0KFsgMCBdLCB0aGlzLmRpcmVjdGlvbmFsVmFsdWUubGVuZ3RoKSA6ICsrbltuLmxlbmd0aCAtIDFdLCBcbiAgICAgICAgbmV3IGFyKHRoaXMuaW5kZXhJZCwgdGhpcy5kb2N1bWVudEtleSwgdGhpcy5hcnJheVZhbHVlLCBuKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGhyKHQsIGUpIHtcbiAgICBsZXQgbiA9IHQuaW5kZXhJZCAtIGUuaW5kZXhJZDtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiAobiA9IGxyKHQuYXJyYXlWYWx1ZSwgZS5hcnJheVZhbHVlKSwgMCAhPT0gbiA/IG4gOiAobiA9IGxyKHQuZGlyZWN0aW9uYWxWYWx1ZSwgZS5kaXJlY3Rpb25hbFZhbHVlKSwgXG4gICAgMCAhPT0gbiA/IG4gOiBjdC5jb21wYXJhdG9yKHQuZG9jdW1lbnRLZXksIGUuZG9jdW1lbnRLZXkpKSk7XG59XG5cbmZ1bmN0aW9uIGxyKHQsIGUpIHtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoICYmIG4gPCBlLmxlbmd0aDsgKytuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0W25dIC0gZVtuXTtcbiAgICAgICAgaWYgKDAgIT09IHMpIHJldHVybiBzO1xuICAgIH1cbiAgICByZXR1cm4gdC5sZW5ndGggLSBlLmxlbmd0aDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBsaWdodCBxdWVyeSBwbGFubmVyIGZvciBGaXJlc3RvcmUuXG4gKlxuICogVGhpcyBjbGFzcyBtYXRjaGVzIGEgYEZpZWxkSW5kZXhgIGFnYWluc3QgYSBGaXJlc3RvcmUgUXVlcnkgYFRhcmdldGAuIEl0XG4gKiBkZXRlcm1pbmVzIHdoZXRoZXIgYSBnaXZlbiBpbmRleCBjYW4gYmUgdXNlZCB0byBzZXJ2ZSB0aGUgc3BlY2lmaWVkIHRhcmdldC5cbiAqXG4gKiBUaGUgZm9sbG93aW5nIHRhYmxlIHNob3djYXNlcyBzb21lIHBvc3NpYmxlIGluZGV4IGNvbmZpZ3VyYXRpb25zOlxuICpcbiAqIFF1ZXJ5ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IEluZGV4XG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogd2hlcmUoJ2EnLCAnPT0nLCAnYScpLndoZXJlKCdiJywgJz09JywgJ2InKSAgICAgICAgIHwgYSBBU0MsIGIgREVTQ1xuICogd2hlcmUoJ2EnLCAnPT0nLCAnYScpLndoZXJlKCdiJywgJz09JywgJ2InKSAgICAgICAgIHwgYSBBU0NcbiAqIHdoZXJlKCdhJywgJz09JywgJ2EnKS53aGVyZSgnYicsICc9PScsICdiJykgICAgICAgICB8IGIgREVTQ1xuICogd2hlcmUoJ2EnLCAnPj0nLCAnYScpLm9yZGVyQnkoJ2EnKSAgICAgICAgICAgICAgICAgIHwgYSBBU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJywgJ2Rlc2MnKSAgICAgICAgICB8IGEgREVTQ1xuICogd2hlcmUoJ2EnLCAnPj0nLCAnYScpLm9yZGVyQnkoJ2EnKS5vcmRlckJ5KCdiJykgICAgIHwgYSBBU0MsIGIgQVNDXG4gKiB3aGVyZSgnYScsICc+PScsICdhJykub3JkZXJCeSgnYScpLm9yZGVyQnkoJ2InKSAgICAgfCBhIEFTQ1xuICogd2hlcmUoJ2EnLCAnYXJyYXktY29udGFpbnMnLCAnYScpLm9yZGVyQnkoJ2InKSAgICAgIHwgYSBDT05UQUlOUywgYiBBU0NFTkRJTkdcbiAqIHdoZXJlKCdhJywgJ2FycmF5LWNvbnRhaW5zJywgJ2EnKS5vcmRlckJ5KCdiJykgICAgICB8IGEgQ09OVEFJTlNcbiAqLyBjbGFzcyBmciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb25JZCA9IG51bGwgIT0gdC5jb2xsZWN0aW9uR3JvdXAgPyB0LmNvbGxlY3Rpb25Hcm91cCA6IHQucGF0aC5sYXN0U2VnbWVudCgpLCBcbiAgICAgICAgdGhpcy5HZSA9IHQub3JkZXJCeSwgdGhpcy5RZSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5maWx0ZXJzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZTtcbiAgICAgICAgICAgIHQuZHQoKSA/IHRoaXMuamUgPSB0IDogdGhpcy5RZS5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgaW5kZXggY2FuIGJlIHVzZWQgdG8gc2VydmUgdGhlIFRhcmdldEluZGV4TWF0Y2hlcidzXG4gICAgICogdGFyZ2V0LlxuICAgICAqXG4gICAgICogQW4gaW5kZXggaXMgY29uc2lkZXJlZCBjYXBhYmxlIG9mIHNlcnZpbmcgdGhlIHRhcmdldCB3aGVuOlxuICAgICAqIC0gVGhlIHRhcmdldCB1c2VzIGFsbCBpbmRleCBzZWdtZW50cyBmb3IgaXRzIGZpbHRlcnMgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgKiAgIFRoZSB0YXJnZXQgY2FuIGhhdmUgYWRkaXRpb25hbCBmaWx0ZXIgYW5kIG9yZGVyQnkgY2xhdXNlcywgYnV0IG5vdFxuICAgICAqICAgZmV3ZXIuXG4gICAgICogLSBJZiBhbiBBcnJheUNvbnRhaW5zL0FycmF5Q29udGFpbnNBbnlmaWx0ZXIgaXMgdXNlZCwgdGhlIGluZGV4IG11c3QgYWxzb1xuICAgICAqICAgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgYENPTlRBSU5TYCBzZWdtZW50LlxuICAgICAqIC0gQWxsIGRpcmVjdGlvbmFsIGluZGV4IHNlZ21lbnRzIGNhbiBiZSBtYXBwZWQgdG8gdGhlIHRhcmdldCBhcyBhIHNlcmllcyBvZlxuICAgICAqICAgZXF1YWxpdHkgZmlsdGVycywgYSBzaW5nbGUgaW5lcXVhbGl0eSBmaWx0ZXIgYW5kIGEgc2VyaWVzIG9mIG9yZGVyQnlcbiAgICAgKiAgIGNsYXVzZXMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhlIGVxdWFsaXR5IGZpbHRlcnMgbWF5IGFwcGVhciBvdXQgb2Ygb3JkZXIuXG4gICAgICogLSBUaGUgb3B0aW9uYWwgc2VnbWVudCBmb3IgdGhlIGluZXF1YWxpdHkgZmlsdGVyIG11c3QgYXBwZWFyIGFmdGVyIGFsbFxuICAgICAqICAgZXF1YWxpdHkgc2VnbWVudHMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhhdCBvcmRlckJ5IGNsYXVzZSBvZiB0aGUgdGFyZ2V0IG11c3QgYXBwZWFyXG4gICAgICogICBpbiBvcmRlciBhZnRlciBhbGwgZXF1YWxpdHkgYW5kIGluZXF1YWxpdHkgc2VnbWVudHMuIFNpbmdsZSBvcmRlckJ5XG4gICAgICogICBjbGF1c2VzIGNhbm5vdCBiZSBza2lwcGVkLCBidXQgYSBjb250aW51b3VzIG9yZGVyQnkgc3VmZml4IG1heSBiZVxuICAgICAqICAgb21pdHRlZC5cbiAgICAgKi8gICAgV2UodCkge1xuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBhcnJheSBlbGVtZW50LCBmaW5kIGEgbWF0Y2hpbmcgZmlsdGVyLlxuICAgICAgICBjb25zdCBlID0gaHQodCk7XG4gICAgICAgIGlmICh2b2lkIDAgIT09IGUgJiYgIXRoaXMuemUoZSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IGx0KHQpO1xuICAgICAgICBsZXQgcyA9IDAsIGkgPSAwO1xuICAgICAgICAvLyBQcm9jZXNzIGFsbCBlcXVhbGl0aWVzIGZpcnN0LiBFcXVhbGl0aWVzIGNhbiBhcHBlYXIgb3V0IG9mIG9yZGVyLlxuICAgICAgICBmb3IgKDtzIDwgbi5sZW5ndGggJiYgdGhpcy56ZShuW3NdKTsgKytzKSA7XG4gICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSBwcm9jZXNzZWQgYWxsIHNlZ21lbnRzLCBhbGwgc2VnbWVudHMgYXJlIHVzZWQgdG8gc2VydmVcbiAgICAgICAgLy8gdGhlIGVxdWFsaXR5IGZpbHRlcnMgYW5kIHdlIGRvIG5vdCBuZWVkIHRvIG1hcCBhbnkgc2VnbWVudHMgdG8gdGhlXG4gICAgICAgIC8vIHRhcmdldCdzIGluZXF1YWxpdHkgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgICAgICAgICAgICBpZiAocyA9PT0gbi5sZW5ndGgpIHJldHVybiAhMDtcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gaW5lcXVhbGl0eSBmaWx0ZXIsIHRoZSBuZXh0IHNlZ21lbnQgbXVzdCBtYXRjaCBib3RoIHRoZVxuICAgICAgICAvLyBmaWx0ZXIgYW5kIHRoZSBmaXJzdCBvcmRlckJ5IGNsYXVzZS5cbiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0aGlzLmplKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltzXTtcbiAgICAgICAgICAgIGlmICghdGhpcy5IZSh0aGlzLmplLCB0KSB8fCAhdGhpcy5KZSh0aGlzLkdlW2krK10sIHQpKSByZXR1cm4gITE7XG4gICAgICAgICAgICArK3M7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQWxsIHJlbWFpbmluZyBzZWdtZW50cyBuZWVkIHRvIHJlcHJlc2VudCB0aGUgcHJlZml4IG9mIHRoZSB0YXJnZXQnc1xuICAgICAgICAvLyBvcmRlckJ5LlxuICAgICAgICAgICAgICAgIGZvciAoO3MgPCBuLmxlbmd0aDsgKytzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltzXTtcbiAgICAgICAgICAgIGlmIChpID49IHRoaXMuR2UubGVuZ3RoIHx8ICF0aGlzLkplKHRoaXMuR2VbaSsrXSwgdCkpIHJldHVybiAhMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIHplKHQpIHtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuUWUpIGlmICh0aGlzLkhlKGUsIHQpKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgSGUodCwgZSkge1xuICAgICAgICBpZiAodm9pZCAwID09PSB0IHx8ICF0LmZpZWxkLmlzRXF1YWwoZS5maWVsZFBhdGgpKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IG4gPSBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IHQub3AgfHwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IHQub3A7XG4gICAgICAgIHJldHVybiAyIC8qIENPTlRBSU5TICovID09PSBlLmtpbmQgPT09IG47XG4gICAgfVxuICAgIEplKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICEhdC5maWVsZC5pc0VxdWFsKGUuZmllbGRQYXRoKSAmJiAoMCAvKiBBU0NFTkRJTkcgKi8gPT09IGUua2luZCAmJiBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA9PT0gdC5kaXIgfHwgMSAvKiBERVNDRU5ESU5HICovID09PSBlLmtpbmQgJiYgXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gdC5kaXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqLyBjbGFzcyBkciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuWWUgPSBuZXcgX3I7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWWUuYWRkKGUpLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUodGhpcy5ZZS5nZXRFbnRyaWVzKGUpKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSgwIC8qIE5PTkUgKi8pO1xuICAgIH1cbiAgICBnZXRGaWVsZEluZGV4ZXModCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZShbXSk7XG4gICAgfVxuICAgIGdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSh0KSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRNaW5PZmZzZXQodCwgZSkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh5dC5taW4oKSk7XG4gICAgfVxuICAgIGdldE1pbk9mZnNldEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh5dC5taW4oKSk7XG4gICAgfVxuICAgIHVwZGF0ZUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZUluZGV4RW50cmllcyh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEludGVybmFsIGltcGxlbWVudGF0aW9uIG9mIHRoZSBjb2xsZWN0aW9uLXBhcmVudCBpbmRleCBleHBvc2VkIGJ5IE1lbW9yeUluZGV4TWFuYWdlci5cbiAqIEFsc28gdXNlZCBmb3IgaW4tbWVtb3J5IGNhY2hpbmcgYnkgSW5kZXhlZERiSW5kZXhNYW5hZ2VyIGFuZCBpbml0aWFsIGluZGV4IHBvcHVsYXRpb25cbiAqIGluIGluZGV4ZWRkYl9zY2hlbWEudHNcbiAqLyBjbGFzcyBfciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaW5kZXggPSB7fTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBmYWxzZSBpZiB0aGUgZW50cnkgYWxyZWFkeSBleGlzdGVkLlxuICAgIGFkZCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lmxhc3RTZWdtZW50KCksIG4gPSB0LnBvcExhc3QoKSwgcyA9IHRoaXMuaW5kZXhbZV0gfHwgbmV3IHF0KHJ0LmNvbXBhcmF0b3IpLCBpID0gIXMuaGFzKG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleFtlXSA9IHMuYWRkKG4pLCBpO1xuICAgIH1cbiAgICBoYXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBuID0gdC5wb3BMYXN0KCksIHMgPSB0aGlzLmluZGV4W2VdO1xuICAgICAgICByZXR1cm4gcyAmJiBzLmhhcyhuKTtcbiAgICB9XG4gICAgZ2V0RW50cmllcyh0KSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pbmRleFt0XSB8fCBuZXcgcXQocnQuY29tcGFyYXRvcikpLnRvQXJyYXkoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHdyID0gbmV3IFVpbnQ4QXJyYXkoMCk7XG5cbi8qKlxuICogQSBwZXJzaXN0ZWQgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVW5saWtlIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdlYiBTREsgZG9lcyBub3QgbWVtb2l6ZSBpbmRleFxuICogZGF0YSBhcyBpdCBzdXBwb3J0cyBtdWx0aS10YWIgYWNjZXNzLlxuICovXG5jbGFzcyBtciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnVzZXIgPSB0LCB0aGlzLmRhdGFiYXNlSWQgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGluLW1lbW9yeSBjb3B5IG9mIHRoZSBpbmRleCBlbnRyaWVzIHdlJ3ZlIGFscmVhZHkgd3JpdHRlbiBzaW5jZSB0aGUgU0RLXG4gICAgICAgICAqIGxhdW5jaGVkLiBVc2VkIHRvIGF2b2lkIHJlLXdyaXRpbmcgdGhlIHNhbWUgZW50cnkgcmVwZWF0ZWRseS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBpcyAqTk9UKiBhIGNvbXBsZXRlIGNhY2hlIG9mIHdoYXQncyBpbiBwZXJzaXN0ZW5jZSBhbmQgc28gY2FuIG5ldmVyIGJlXG4gICAgICAgICAqIHVzZWQgdG8gc2F0aXNmeSByZWFkcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuWGUgPSBuZXcgX3IsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBmcm9tIGEgdGFyZ2V0IHRvIGl0cyBlcXVpdmFsZW50IGxpc3Qgb2Ygc3ViLXRhcmdldHMuIEVhY2ggc3ViLXRhcmdldFxuICAgICAgICAgKiBjb250YWlucyBvbmx5IG9uZSB0ZXJtIGZyb20gdGhlIHRhcmdldCdzIGRpc2p1bmN0aXZlIG5vcm1hbCBmb3JtIChETkYpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5aZSA9IG5ldyBlcygodCA9PiB4ZSh0KSksICgodCwgZSkgPT4ga2UodCwgZSkpKSwgdGhpcy51aWQgPSB0LnVpZCB8fCBcIlwiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IGVudHJ5IHRvIHRoZSBjb2xsZWN0aW9uIHBhcmVudCBpbmRleC5cbiAgICAgKlxuICAgICAqIFJlcGVhdGVkIGNhbGxzIGZvciB0aGUgc2FtZSBjb2xsZWN0aW9uUGF0aCBzaG91bGQgYmUgYXZvaWRlZCB3aXRoaW4gYVxuICAgICAqIHRyYW5zYWN0aW9uIGFzIEluZGV4ZWREYkluZGV4TWFuYWdlciBvbmx5IGNhY2hlcyB3cml0ZXMgb25jZSBhIHRyYW5zYWN0aW9uXG4gICAgICogaGFzIGJlZW4gY29tbWl0dGVkLlxuICAgICAqLyAgICBhZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlKSB7XG4gICAgICAgIGlmICghdGhpcy5YZS5oYXMoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmxhc3RTZWdtZW50KCksIHMgPSBlLnBvcExhc3QoKTtcbiAgICAgICAgICAgIHQuYWRkT25Db21taXR0ZWRMaXN0ZW5lcigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY29sbGVjdGlvbiB0byB0aGUgaW4gbWVtb3J5IGNhY2hlIG9ubHkgaWYgdGhlIHRyYW5zYWN0aW9uIHdhc1xuICAgICAgICAgICAgICAgIC8vIHN1Y2Nlc3NmdWxseSBjb21taXR0ZWQuXG4gICAgICAgICAgICAgICAgdGhpcy5YZS5hZGQoZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCBpID0ge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogbixcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IHJpKHMpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGdyKHQpLnB1dChpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRDb2xsZWN0aW9uUGFyZW50cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXSwgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZSwgXCJcIiBdLCBbIGV0KGUpLCBcIlwiIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIGdyKHQpLlcocykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdCkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgY29sbGVjdGlvbklkIGd1YXJkIHNob3VsZG4ndCBiZSBuZWNlc3NhcnkgKGFuZCBpc24ndCBhcyBsb25nXG4gICAgICAgICAgICAgICAgLy8gYXMgd2UncmUgcnVubmluZyBpbiBhIHJlYWwgYnJvd3NlciksIGJ1dCB0aGVyZSdzIGEgYnVnIGluXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhlZGRic2hpbSB0aGF0IGJyZWFrcyBvdXIgcmFuZ2UgaW4gb3VyIHRlc3RzIHJ1bm5pbmcgaW4gbm9kZTpcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0vaXNzdWVzLzMzNFxuICAgICAgICAgICAgICAgIGlmIChzLmNvbGxlY3Rpb25JZCAhPT0gZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgbi5wdXNoKGNpKHMucGFyZW50KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBhZGRGaWVsZEluZGV4KHQsIGUpIHtcbiAgICAgICAgLy8gVE9ETyhpbmRleGluZyk6IFZlcmlmeSB0aGF0IHRoZSBhdXRvLWluY3JlbWVudGluZyBpbmRleCBJRCB3b3JrcyBpblxuICAgICAgICAvLyBTYWZhcmkgJiBGaXJlZm94LlxuICAgICAgICBjb25zdCBuID0gcHIodCksIHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGluZGV4SWQ6IHQuaW5kZXhJZCxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IHQuY29sbGVjdGlvbkdyb3VwLFxuICAgICAgICAgICAgICAgIGZpZWxkczogdC5maWVsZHMubWFwKCh0ID0+IFsgdC5maWVsZFBhdGguY2Fub25pY2FsU3RyaW5nKCksIHQua2luZCBdKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0oZSk7XG4gICAgICAgIGRlbGV0ZSBzLmluZGV4SWQ7XG4gICAgICAgIC8vIGBpbmRleElkYCBpcyBhdXRvLXBvcHVsYXRlZCBieSBJbmRleGVkRGJcbiAgICAgICAgY29uc3QgaSA9IG4uYWRkKHMpO1xuICAgICAgICBpZiAoZS5pbmRleFN0YXRlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gSXIodCk7XG4gICAgICAgICAgICByZXR1cm4gaS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICBuLnB1dChKaSh0LCB0aGlzLnVzZXIsIGUuaW5kZXhTdGF0ZS5zZXF1ZW5jZU51bWJlciwgZS5pbmRleFN0YXRlLm9mZnNldCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpLm5leHQoKTtcbiAgICB9XG4gICAgZGVsZXRlRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBwcih0KSwgcyA9IElyKHQpLCBpID0geXIodCk7XG4gICAgICAgIHJldHVybiBuLmRlbGV0ZShlLmluZGV4SWQpLm5leHQoKCgpID0+IHMuZGVsZXRlKElEQktleVJhbmdlLmJvdW5kKFsgZS5pbmRleElkIF0sIFsgZS5pbmRleElkICsgMSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCkpKSkubmV4dCgoKCkgPT4gaS5kZWxldGUoSURCS2V5UmFuZ2UuYm91bmQoWyBlLmluZGV4SWQgXSwgWyBlLmluZGV4SWQgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSkpKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdUYXJnZXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0geXIodCk7XG4gICAgICAgIGxldCBzID0gITA7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaCh0aGlzLnRuKGUpLCAoZSA9PiB0aGlzLmVuKHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgcyAmJiAocyA9ICEhdCksIGkuc2V0KGUsIHQpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAocykge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gZnMoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIEF0LmZvckVhY2goaSwgKChpLCByKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvO1xuICAgICAgICAgICAgICAgICAgICBDKFwiSW5kZXhlZERiSW5kZXhNYW5hZ2VyXCIsIGBVc2luZyBpbmRleCAke28gPSBpLCBgaWQ9JHtvLmluZGV4SWR9fGNnPSR7by5jb2xsZWN0aW9uR3JvdXB9fGY9JHtvLmZpZWxkcy5tYXAoKHQgPT4gYCR7dC5maWVsZFBhdGh9OiR7dC5raW5kfWApKS5qb2luKFwiLFwiKX1gfSB0byBleGVjdXRlICR7eGUoZSl9YCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaHQoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwID09PSBuKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBNZSh0LCBuLmZpZWxkUGF0aCkpIHN3aXRjaCAoZS5vcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS52YWx1ZS5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgZS52YWx1ZSBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbWFpbmluZyBmaWx0ZXJzIGFyZSBub3QgYXJyYXkgZmlsdGVycy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyB0aGUgbGlzdCBvZiB2YWx1ZXMgdGhhdCBhcmUgdXNlZCBpbiAhPSBvciBOT1RfSU4gZmlsdGVycy4gUmV0dXJuc1xuICogYG51bGxgIGlmIHRoZXJlIGFyZSBubyBzdWNoIGZpbHRlcnMuXG4gKi8gKHIsIGkpLCBjID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBNYXA7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHMgb2YgbHQoZSkpIGZvciAoY29uc3QgZSBvZiBNZSh0LCBzLmZpZWxkUGF0aCkpIHN3aXRjaCAoZS5vcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBFUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpblwiIC8qIElOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbmNvZGUgZXF1YWxpdHkgcHJlZml4LCB3aGljaCBpcyBlbmNvZGVkIGluIHRoZSBpbmRleCB2YWx1ZSBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaW5lcXVhbGl0eSAoZS5nLiBgYSA9PSAnYScgJiYgYiAhPSAnYidgIGlzIGVuY29kZWQgdG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBgdmFsdWUgIT0gJ2FiJ2ApLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2V0KHMuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCBlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogTk9UX0lOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RJbi9Ob3RFcXVhbCBpcyBhbHdheXMgYSBzdWZmaXguIFRoZXJlIGNhbm5vdCBiZSBhbnkgcmVtYWluaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VnbWVudHMgYW5kIGhlbmNlIHdlIGNhbiByZXR1cm4gZWFybHkgaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5zZXQocy5maWVsZFBhdGguY2Fub25pY2FsU3RyaW5nKCksIGUudmFsdWUpLCBBcnJheS5mcm9tKG4udmFsdWVzKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbWFpbmluZyBmaWx0ZXJzIGNhbm5vdCBiZSB1c2VkIGFzIG5vdEluIGJvdW5kcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIGxvd2VyIGJvdW5kIG9mIGZpZWxkIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIGFzIGEgc3RhcnRpbmcgcG9pbnQgdG9cbiAqIHNjYW4gdGhlIGluZGV4IGRlZmluZWQgYnkgYGZpZWxkSW5kZXhgLiBSZXR1cm5zIGBNSU5fVkFMVUVgIGlmIG5vIGxvd2VyIGJvdW5kXG4gKiBleGlzdHMuXG4gKi8gKHIsIGkpLCBhID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSAhMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBlYWNoIHNlZ21lbnQsIHJldHJpZXZlIGEgbG93ZXIgYm91bmQgaWYgdGhlcmUgaXMgYSBzdWl0YWJsZSBmaWx0ZXIgb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0QXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgbHQoZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gMCAvKiBBU0NFTkRJTkcgKi8gPT09IGkua2luZCA/IEZlKHQsIGkuZmllbGRQYXRoLCB0LnN0YXJ0QXQpIDogJGUodCwgaS5maWVsZFBhdGgsIHQuc3RhcnRBdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKGUudmFsdWUpLCBzICYmIChzID0gZS5pbmNsdXNpdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB6ZShuLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgYW4gdXBwZXIgYm91bmQgb2YgZmllbGQgdmFsdWVzIHRoYXQgY2FuIGJlIHVzZWQgYXMgYW4gZW5kaW5nIHBvaW50XG4gKiB3aGVuIHNjYW5uaW5nIHRoZSBpbmRleCBkZWZpbmVkIGJ5IGBmaWVsZEluZGV4YC4gUmV0dXJucyBgTUFYX1ZBTFVFYCBpZiBub1xuICogdXBwZXIgYm91bmQgZXhpc3RzLlxuICovIChyLCBpKSwgaCA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzID0gITA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZWFjaCBzZWdtZW50LCByZXRyaWV2ZSBhbiB1cHBlciBib3VuZCBpZiB0aGVyZSBpcyBhIHN1aXRhYmxlIGZpbHRlciBvclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5kQXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgbHQoZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gMCAvKiBBU0NFTkRJTkcgKi8gPT09IGkua2luZCA/ICRlKHQsIGkuZmllbGRQYXRoLCB0LmVuZEF0KSA6IEZlKHQsIGkuZmllbGRQYXRoLCB0LmVuZEF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnB1c2goZS52YWx1ZSksIHMgJiYgKHMgPSBlLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHplKG4sIHMpO1xuICAgICAgICAgICAgICAgICAgICB9KHIsIGkpLCBsID0gdGhpcy5ubihpLCByLCBhKSwgZiA9IHRoaXMubm4oaSwgciwgaCksIGQgPSB0aGlzLnNuKGksIHIsIGMpLCBfID0gdGhpcy5ybihpLmluZGV4SWQsIHUsIGwsIGEuaW5jbHVzaXZlLCBmLCBoLmluY2x1c2l2ZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBBdC5mb3JFYWNoKF8sIChpID0+IG4uSihpLCBlLmxpbWl0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGN0LmZyb21TZWdtZW50cyhlLmRvY3VtZW50S2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmhhcyhuKSB8fCAodCA9IHQuYWRkKG4pLCBzLnB1c2gobikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUobnVsbCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdG4odCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMuWmUuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSB8fCAoXG4gICAgICAgIC8vIFRPRE8ob3JxdWVyeSk6IEltcGxlbWVudCBETkYgdHJhbnNmb3JtXG4gICAgICAgIGUgPSBbIHQgXSwgdGhpcy5aZS5zZXQodCwgZSksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RzIGEga2V5IHJhbmdlIHF1ZXJ5IG9uIGBEYkluZGV4RW50cnlTdG9yZWAgdGhhdCB1bmlvbnMgYWxsXG4gICAgICogYm91bmRzLlxuICAgICAqLyAgICBybih0LCBlLCBuLCBzLCBpLCByLCBvKSB7XG4gICAgICAgIC8vIFRoZSBudW1iZXIgb2YgdG90YWwgaW5kZXggc2NhbnMgd2UgdW5pb24gdG9nZXRoZXIuIFRoaXMgaXMgc2ltaWxhciB0byBhXG4gICAgICAgIC8vIGRpc3RyaWJ1dGVkIG5vcm1hbCBmb3JtLCBidXQgYWRhcHRlZCBmb3IgYXJyYXkgdmFsdWVzLiBXZSBjcmVhdGUgYSBzaW5nbGVcbiAgICAgICAgLy8gaW5kZXggcmFuZ2UgcGVyIHZhbHVlIGluIGFuIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWSBmaWx0ZXJcbiAgICAgICAgLy8gY29tYmluZWQgd2l0aCB0aGUgdmFsdWVzIGZyb20gdGhlIHF1ZXJ5IGJvdW5kcy5cbiAgICAgICAgY29uc3QgdSA9IChudWxsICE9IGUgPyBlLmxlbmd0aCA6IDEpICogTWF0aC5tYXgobi5sZW5ndGgsIGkubGVuZ3RoKSwgYyA9IHUgLyAobnVsbCAhPSBlID8gZS5sZW5ndGggOiAxKSwgYSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBoID0gMDsgaCA8IHU7ICsraCkge1xuICAgICAgICAgICAgY29uc3QgdSA9IGUgPyB0aGlzLm9uKGVbaCAvIGNdKSA6IHdyLCBsID0gdGhpcy51bih0LCB1LCBuW2ggJSBjXSwgcyksIGYgPSB0aGlzLmNuKHQsIHUsIGlbaCAlIGNdLCByKSwgZCA9IG8ubWFwKChlID0+IHRoaXMudW4odCwgdSwgZSwgXG4gICAgICAgICAgICAvKiBpbmNsdXNpdmU9ICovICEwKSkpO1xuICAgICAgICAgICAgYS5wdXNoKC4uLnRoaXMuY3JlYXRlUmFuZ2UobCwgZiwgZCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhO1xuICAgIH1cbiAgICAvKiogR2VuZXJhdGVzIHRoZSBsb3dlciBib3VuZCBmb3IgYGFycmF5VmFsdWVgIGFuZCBgZGlyZWN0aW9uYWxWYWx1ZWAuICovICAgIHVuKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBhcih0LCBjdC5lbXB0eSgpLCBlLCBuKTtcbiAgICAgICAgcmV0dXJuIHMgPyBpIDogaS5LZSgpO1xuICAgIH1cbiAgICAvKiogR2VuZXJhdGVzIHRoZSB1cHBlciBib3VuZCBmb3IgYGFycmF5VmFsdWVgIGFuZCBgZGlyZWN0aW9uYWxWYWx1ZWAuICovICAgIGNuKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBhcih0LCBjdC5lbXB0eSgpLCBlLCBuKTtcbiAgICAgICAgcmV0dXJuIHMgPyBpLktlKCkgOiBpO1xuICAgIH1cbiAgICBlbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgZnIoZSksIHMgPSBudWxsICE9IGUuY29sbGVjdGlvbkdyb3VwID8gZS5jb2xsZWN0aW9uR3JvdXAgOiBlLnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRJbmRleGVzKHQsIHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBpbmRleCB3aXRoIHRoZSBtb3N0IG51bWJlciBvZiBzZWdtZW50cy5cbiAgICAgICAgICAgIGxldCBlID0gbnVsbDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiB0KSB7XG4gICAgICAgICAgICAgICAgbi5XZShzKSAmJiAoIWUgfHwgcy5maWVsZHMubGVuZ3RoID4gZS5maWVsZHMubGVuZ3RoKSAmJiAoZSA9IHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0SW5kZXhUeXBlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSAyIC8qIEZVTEwgKi87XG4gICAgICAgIHJldHVybiBBdC5mb3JFYWNoKHRoaXMudG4oZSksIChlID0+IHRoaXMuZW4odCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0ID8gMCAvKiBOT05FICovICE9PSBuICYmIHQuZmllbGRzLmxlbmd0aCA8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG5ldyBxdCh1dC5jb21wYXJhdG9yKSwgbiA9ICExO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiB0LmZpbHRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhvcnF1ZXJ5KTogVXNlIHRoZSBmbGF0dGVuZWQgZmlsdGVycyBoZXJlXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzO1xuICAgICAgICAgICAgICAgICAgICAvLyBfX25hbWVfXyBpcyBub3QgYW4gZXhwbGljaXQgc2VnbWVudCBvZiBhbnkgaW5kZXgsIHNvIHdlIGRvbid0IG5lZWQgdG9cbiAgICAgICAgICAgICAgICAgICAgLy8gY291bnQgaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5maWVsZC5pc0tleUZpZWxkKCkgfHwgKFxuICAgICAgICAgICAgICAgICAgICAvLyBBUlJBWV9DT05UQUlOUyBvciBBUlJBWV9DT05UQUlOU19BTlkgZmlsdGVycyBtdXN0IGJlIGNvdW50ZWQgc2VwYXJhdGVseS5cbiAgICAgICAgICAgICAgICAgICAgLy8gRm9yIGluc3RhbmNlLCBpdCBpcyBwb3NzaWJsZSB0byBoYXZlIGFuIGluZGV4IGZvciBcImEgQVJSQVkgYSBBU0NcIi4gRXZlblxuICAgICAgICAgICAgICAgICAgICAvLyB0aG91Z2ggdGhlc2UgYXJlIG9uIHRoZSBzYW1lIGZpZWxkLCB0aGV5IHNob3VsZCBiZSBjb3VudGVkIGFzIHR3b1xuICAgICAgICAgICAgICAgICAgICAvLyBzZXBhcmF0ZSBzZWdtZW50cyBpbiBhbiBpbmRleC5cbiAgICAgICAgICAgICAgICAgICAgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovID09PSB0Lm9wIHx8IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSB0Lm9wID8gbiA9ICEwIDogZSA9IGUuYWRkKHQuZmllbGQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQub3JkZXJCeSkgXG4gICAgICAgICAgICAgICAgLy8gX19uYW1lX18gaXMgbm90IGFuIGV4cGxpY2l0IHNlZ21lbnQgb2YgYW55IGluZGV4LCBzbyB3ZSBkb24ndCBuZWVkIHRvXG4gICAgICAgICAgICAgICAgLy8gY291bnQgaXQuXG4gICAgICAgICAgICAgICAgbi5maWVsZC5pc0tleUZpZWxkKCkgfHwgKGUgPSBlLmFkZChuLmZpZWxkKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuc2l6ZSArIChuID8gMSA6IDApO1xuICAgICAgICAgICAgfShlKSAmJiAobiA9IDEgLyogUEFSVElBTCAqLykgOiBuID0gMCAvKiBOT05FICovO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGJ5dGUgZW5jb2RlZCBmb3JtIG9mIHRoZSBkaXJlY3Rpb25hbCB2YWx1ZXMgaW4gdGhlIGZpZWxkIGluZGV4LlxuICAgICAqIFJldHVybnMgYG51bGxgIGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBoYXZlIGFsbCBmaWVsZHMgc3BlY2lmaWVkIGluIHRoZVxuICAgICAqIGluZGV4LlxuICAgICAqLyAgICBhbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgY3I7XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiBsdCh0KSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuZGF0YS5maWVsZChzLmZpZWxkUGF0aCk7XG4gICAgICAgICAgICBpZiAobnVsbCA9PSB0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLnFlKHMua2luZCk7XG4gICAgICAgICAgICBuci5UZS5jZSh0LCBpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbi4kZSgpO1xuICAgIH1cbiAgICAvKiogRW5jb2RlcyBhIHNpbmdsZSB2YWx1ZSB0byB0aGUgYXNjZW5kaW5nIGluZGV4IGZvcm1hdC4gKi8gICAgb24odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IGNyO1xuICAgICAgICByZXR1cm4gbnIuVGUuY2UodCwgZS5xZSgwIC8qIEFTQ0VORElORyAqLykpLCBlLiRlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gZW5jb2RlZCBmb3JtIG9mIHRoZSBkb2N1bWVudCBrZXkgdGhhdCBzb3J0cyBiYXNlZCBvbiB0aGUga2V5XG4gICAgICogb3JkZXJpbmcgb2YgdGhlIGZpZWxkIGluZGV4LlxuICAgICAqLyAgICBobih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgY3I7XG4gICAgICAgIHJldHVybiBuci5UZS5jZSh3ZSh0aGlzLmRhdGFiYXNlSWQsIGUpLCBuLnFlKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBsdCh0KTtcbiAgICAgICAgICAgIHJldHVybiAwID09PSBlLmxlbmd0aCA/IDAgLyogQVNDRU5ESU5HICovIDogZVtlLmxlbmd0aCAtIDFdLmtpbmQ7XG4gICAgICAgIH0odCkpKSwgbi4kZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIHRoZSBnaXZlbiBmaWVsZCB2YWx1ZXMgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpY2F0aW9uIGluIGB0YXJnZXRgLlxuICAgICAqIEZvciBJTiBxdWVyaWVzLCBhIGxpc3Qgb2YgcG9zc2libGUgdmFsdWVzIGlzIHJldHVybmVkLlxuICAgICAqLyAgICBzbih0LCBlLCBuKSB7XG4gICAgICAgIGlmIChudWxsID09PSBuKSByZXR1cm4gW107XG4gICAgICAgIGxldCBzID0gW107XG4gICAgICAgIHMucHVzaChuZXcgY3IpO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgciBvZiBsdCh0KSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG5baSsrXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBzKSBpZiAodGhpcy5sbihlLCByLmZpZWxkUGF0aCkgJiYgZ2UodCkpIHMgPSB0aGlzLmZuKHMsIHIsIHQpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbi5xZShyLmtpbmQpO1xuICAgICAgICAgICAgICAgIG5yLlRlLmNlKHQsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRuKHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIHRoZSBnaXZlbiBib3VuZHMgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpY2F0aW9uIGluIGB0YXJnZXRgLiBGb3IgSU5cbiAgICAgKiBxdWVyaWVzLCBhIGxpc3Qgb2YgcG9zc2libGUgdmFsdWVzIGlzIHJldHVybmVkLlxuICAgICAqLyAgICBubih0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNuKHQsIGUsIG4ucG9zaXRpb24pO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgYnl0ZSByZXByZXNlbnRhdGlvbiBmb3IgdGhlIHByb3ZpZGVkIGVuY29kZXJzLiAqLyAgICBkbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgKytuKSBlW25dID0gdFtuXS4kZSgpO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNlcGFyYXRlIGVuY29kZXIgZm9yIGVhY2ggZWxlbWVudCBvZiBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqIFRoZSBtZXRob2QgYXBwZW5kcyBlYWNoIHZhbHVlIHRvIGFsbCBleGlzdGluZyBlbmNvZGVycyAoZS5nLiBmaWx0ZXIoXCJhXCIsXG4gICAgICogXCI9PVwiLCBcImExXCIpLmZpbHRlcihcImJcIiwgXCJpblwiLCBbXCJiMVwiLCBcImIyXCJdKSBiZWNvbWVzIFtcImExLGIxXCIsIFwiYTEsYjJcIl0pLiBBXG4gICAgICogbGlzdCBvZiBuZXcgZW5jb2RlcnMgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIGZuKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFsgLi4udCBdLCBpID0gW107XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuLmFycmF5VmFsdWUudmFsdWVzIHx8IFtdKSBmb3IgKGNvbnN0IG4gb2Ygcykge1xuICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBjcjtcbiAgICAgICAgICAgIHMuc2VlZChuLiRlKCkpLCBuci5UZS5jZSh0LCBzLnFlKGUua2luZCkpLCBpLnB1c2gocyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICAgIGxuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICEhdC5maWx0ZXJzLmZpbmQoKHQgPT4gdCBpbnN0YW5jZW9mIEJlICYmIHQuZmllbGQuaXNFcXVhbChlKSAmJiAoXCJpblwiIC8qIElOICovID09PSB0Lm9wIHx8IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSB0Lm9wKSkpO1xuICAgIH1cbiAgICBnZXRGaWVsZEluZGV4ZXModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gcHIodCksIHMgPSBJcih0KTtcbiAgICAgICAgcmV0dXJuIChlID8gbi5XKFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgSURCS2V5UmFuZ2UuYm91bmQoZSwgZSkpIDogbi5XKCkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIEF0LmZvckVhY2godCwgKHQgPT4gcy5nZXQoWyB0LmluZGV4SWQsIHRoaXMudWlkIF0pLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgICAgIGUucHVzaChmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlID8gbmV3IHd0KGUuc2VxdWVuY2VOdW1iZXIsIG5ldyB5dChLaShlLnJlYWRUaW1lKSwgbmV3IGN0KGNpKGUuZG9jdW1lbnRLZXkpKSwgZS5sYXJnZXN0QmF0Y2hJZCkpIDogd3QuZW1wdHkoKSwgcyA9IHQuZmllbGRzLm1hcCgoKFt0LCBlXSkgPT4gbmV3IGR0KHV0LmZyb21TZXJ2ZXJGb3JtYXQodCksIGUpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgYXQodC5pbmRleElkLCB0LmNvbGxlY3Rpb25Hcm91cCwgcywgbik7XG4gICAgICAgICAgICAgICAgfSh0LCBuKSk7XG4gICAgICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TmV4dENvbGxlY3Rpb25Hcm91cFRvVXBkYXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRJbmRleGVzKHQpLm5leHQoKHQgPT4gMCA9PT0gdC5sZW5ndGggPyBudWxsIDogKHQuc29ydCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmluZGV4U3RhdGUuc2VxdWVuY2VOdW1iZXIgLSBlLmluZGV4U3RhdGUuc2VxdWVuY2VOdW1iZXI7XG4gICAgICAgICAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiBaKHQuY29sbGVjdGlvbkdyb3VwLCBlLmNvbGxlY3Rpb25Hcm91cCk7XG4gICAgICAgIH0pKSwgdFswXS5jb2xsZWN0aW9uR3JvdXApKSk7XG4gICAgfVxuICAgIHVwZGF0ZUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBwcih0KSwgaSA9IElyKHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5fbih0KS5uZXh0KCh0ID0+IHMuVyhcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsIElEQktleVJhbmdlLmJvdW5kKGUsIGUpKS5uZXh0KChlID0+IEF0LmZvckVhY2goZSwgKGUgPT4gaS5wdXQoSmkoZS5pbmRleElkLCB0aGlzLnVzZXIsIHQsIG4pKSkpKSkpKTtcbiAgICB9XG4gICAgdXBkYXRlSW5kZXhFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgLy8gUG9ydGluZyBOb3RlOiBgZ2V0RmllbGRJbmRleGVzKClgIG9uIFdlYiBkb2VzIG5vdCBjYWNoZSBpbmRleCBsb29rdXBzIGFzXG4gICAgICAgIC8vIGl0IGNvdWxkIGJlIHVzZWQgYWNyb3NzIGRpZmZlcmVudCBJbmRleGVkREIgdHJhbnNhY3Rpb25zLiBBcyBhbnkgY2FjaGVkXG4gICAgICAgIC8vIGRhdGEgbWlnaHQgYmUgaW52YWxpZGF0ZWQgYnkgb3RoZXIgbXVsdGktdGFiIGNsaWVudHMsIHdlIGNhbiBvbmx5IHRydXN0XG4gICAgICAgIC8vIGRhdGEgd2l0aGluIGEgc2luZ2xlIEluZGV4ZWREQiB0cmFuc2FjdGlvbi4gV2UgdGhlcmVmb3JlIGFkZCBhIGNhY2hlXG4gICAgICAgIC8vIGhlcmUuXG4gICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaChlLCAoKGUsIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLmdldChlLmNvbGxlY3Rpb25Hcm91cCk7XG4gICAgICAgICAgICByZXR1cm4gKGkgPyBBdC5yZXNvbHZlKGkpIDogdGhpcy5nZXRGaWVsZEluZGV4ZXModCwgZS5jb2xsZWN0aW9uR3JvdXApKS5uZXh0KChpID0+IChuLnNldChlLmNvbGxlY3Rpb25Hcm91cCwgaSksIFxuICAgICAgICAgICAgQXQuZm9yRWFjaChpLCAobiA9PiB0aGlzLnduKHQsIGUsIG4pLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLm1uKHMsIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBlLmlzRXF1YWwoaSkgPyBBdC5yZXNvbHZlKCkgOiB0aGlzLmduKHQsIHMsIG4sIGUsIGkpO1xuICAgICAgICAgICAgfSkpKSkpKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgeW4odCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4geXIodCkucHV0KHtcbiAgICAgICAgICAgIGluZGV4SWQ6IHMuaW5kZXhJZCxcbiAgICAgICAgICAgIHVpZDogdGhpcy51aWQsXG4gICAgICAgICAgICBhcnJheVZhbHVlOiBzLmFycmF5VmFsdWUsXG4gICAgICAgICAgICBkaXJlY3Rpb25hbFZhbHVlOiBzLmRpcmVjdGlvbmFsVmFsdWUsXG4gICAgICAgICAgICBvcmRlcmVkRG9jdW1lbnRLZXk6IHRoaXMuaG4obiwgZS5rZXkpLFxuICAgICAgICAgICAgZG9jdW1lbnRLZXk6IGUua2V5LnBhdGgudG9BcnJheSgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiB5cih0KS5kZWxldGUoWyBzLmluZGV4SWQsIHRoaXMudWlkLCBzLmFycmF5VmFsdWUsIHMuZGlyZWN0aW9uYWxWYWx1ZSwgdGhpcy5obihuLCBlLmtleSksIGUua2V5LnBhdGgudG9BcnJheSgpIF0pO1xuICAgIH1cbiAgICB3bih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB5cih0KTtcbiAgICAgICAgbGV0IGkgPSBuZXcgcXQoaHIpO1xuICAgICAgICByZXR1cm4gcy5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5vbmx5KFsgbi5pbmRleElkLCB0aGlzLnVpZCwgdGhpcy5obihuLCBlKSBdKVxuICAgICAgICB9LCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIGkgPSBpLmFkZChuZXcgYXIobi5pbmRleElkLCBlLCBzLmFycmF5VmFsdWUsIHMuZGlyZWN0aW9uYWxWYWx1ZSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyB0aGUgaW5kZXggZW50cmllcyBmb3IgdGhlIGdpdmVuIGRvY3VtZW50LiAqLyAgICBtbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IHF0KGhyKTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMuYW4oZSwgdCk7XG4gICAgICAgIGlmIChudWxsID09IHMpIHJldHVybiBuO1xuICAgICAgICBjb25zdCBpID0gaHQoZSk7XG4gICAgICAgIGlmIChudWxsICE9IGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LmRhdGEuZmllbGQoaS5maWVsZFBhdGgpO1xuICAgICAgICAgICAgaWYgKGdlKHIpKSBmb3IgKGNvbnN0IGkgb2Ygci5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSkgbiA9IG4uYWRkKG5ldyBhcihlLmluZGV4SWQsIHQua2V5LCB0aGlzLm9uKGkpLCBzKSk7XG4gICAgICAgIH0gZWxzZSBuID0gbi5hZGQobmV3IGFyKGUuaW5kZXhJZCwgdC5rZXksIHdyLCBzKSk7XG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBpbmRleCBlbnRyaWVzIGZvciB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgYnkgZGVsZXRpbmcgZW50cmllc1xuICAgICAqIHRoYXQgYXJlIG5vIGxvbmdlciByZWZlcmVuY2VkIGluIGBuZXdFbnRyaWVzYCBhbmQgYWRkaW5nIGFsbCBuZXdseSBhZGRlZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGduKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgQyhcIkluZGV4ZWREYkluZGV4TWFuYWdlclwiLCBcIlVwZGF0aW5nIGluZGV4IGVudHJpZXMgZm9yIGRvY3VtZW50ICclcydcIiwgZS5rZXkpO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgICAgICBjb25zdCByID0gdC5nZXRJdGVyYXRvcigpLCBvID0gZS5nZXRJdGVyYXRvcigpO1xuICAgICAgICAgICAgbGV0IHUgPSBHdChyKSwgYyA9IEd0KG8pO1xuICAgICAgICAgICAgLy8gV2FsayB0aHJvdWdoIHRoZSB0d28gc2V0cyBhdCB0aGUgc2FtZSB0aW1lLCB1c2luZyB0aGUgb3JkZXJpbmcgZGVmaW5lZCBieVxuICAgICAgICAgICAgLy8gYGNvbXBhcmF0b3JgLlxuICAgICAgICAgICAgZm9yICg7dSB8fCBjOyApIHtcbiAgICAgICAgICAgICAgICBsZXQgdCA9ICExLCBlID0gITE7XG4gICAgICAgICAgICAgICAgaWYgKHUgJiYgYykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbih1LCBjKTtcbiAgICAgICAgICAgICAgICAgICAgcyA8IDAgPyBcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGVsZW1lbnQgd2FzIHJlbW92ZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZFxuICAgICAgICAgICAgICAgICAgICAvLyB3YWxrdGhyb3VnaCBpcyBvbmx5IGluIGBiZWZvcmVgLlxuICAgICAgICAgICAgICAgICAgICBlID0gITAgOiBzID4gMCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBlbGVtZW50IHdhcyBhZGRlZCBpZiB0aGUgbmV4dCBlbGVtZW50IGluIG91ciBvcmRlcmVkIHdhbGt0aHJvdWdoXG4gICAgICAgICAgICAgICAgICAgIC8vIGlzIG9ubHkgaW4gYGFmdGVyYC5cbiAgICAgICAgICAgICAgICAgICAgdCA9ICEwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgbnVsbCAhPSB1ID8gZSA9ICEwIDogdCA9ICEwO1xuICAgICAgICAgICAgICAgIHQgPyAocyhjKSwgYyA9IEd0KG8pKSA6IGUgPyAoaSh1KSwgdSA9IEd0KHIpKSA6ICh1ID0gR3QociksIGMgPSBHdChvKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0ocywgaSwgaHIsIChcbiAgICAgICAgLyogb25BZGQ9ICovIHMgPT4ge1xuICAgICAgICAgICAgci5wdXNoKHRoaXMueW4odCwgZSwgbiwgcykpO1xuICAgICAgICB9KSwgKFxuICAgICAgICAvKiBvblJlbW92ZT0gKi8gcyA9PiB7XG4gICAgICAgICAgICByLnB1c2godGhpcy5wbih0LCBlLCBuLCBzKSk7XG4gICAgICAgIH0pKSwgQXQud2FpdEZvcihyKTtcbiAgICB9XG4gICAgX24odCkge1xuICAgICAgICBsZXQgZSA9IDE7XG4gICAgICAgIHJldHVybiBJcih0KS5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcInNlcXVlbmNlTnVtYmVySW5kZXhcIixcbiAgICAgICAgICAgIHJldmVyc2U6ICEwLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLnVwcGVyQm91bmQoWyB0aGlzLnVpZCwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgXSlcbiAgICAgICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgICAgICBzLmRvbmUoKSwgZSA9IG4uc2VxdWVuY2VOdW1iZXIgKyAxO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHNldCBvZiBJREIgcmFuZ2VzIHRoYXQgc3BsaXRzIHRoZSBleGlzdGluZyByYW5nZSBhbmQgZXhjbHVkZXNcbiAgICAgKiBhbnkgdmFsdWVzIHRoYXQgbWF0Y2ggdGhlIGBub3RJblZhbHVlYCBmcm9tIHRoZXNlIHJhbmdlcy4gQXMgYW4gZXhhbXBsZSxcbiAgICAgKiAnW2ZvbyA+IDIgJiYgZm9vICE9IDNdYCBiZWNvbWVzICBgW2ZvbyA+IDIgJiYgPCAzLCBmb28gPiAzXWAuXG4gICAgICovICAgIGNyZWF0ZVJhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVGhlIG5vdEluIHZhbHVlcyBuZWVkIHRvIGJlIHNvcnRlZCBhbmQgdW5pcXVlIHNvIHRoYXQgd2UgY2FuIHJldHVybiBhXG4gICAgICAgIC8vIHNvcnRlZCBzZXQgb2Ygbm9uLW92ZXJsYXBwaW5nIHJhbmdlcy5cbiAgICAgICAgbiA9IG4uc29ydCgoKHQsIGUpID0+IGhyKHQsIGUpKSkuZmlsdGVyKCgodCwgZSwgbikgPT4gIWUgfHwgMCAhPT0gaHIodCwgbltlIC0gMV0pKSk7XG4gICAgICAgIGNvbnN0IHMgPSBbXTtcbiAgICAgICAgcy5wdXNoKHQpO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2Ygbikge1xuICAgICAgICAgICAgY29uc3QgbiA9IGhyKGksIHQpLCByID0gaHIoaSwgZSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gbikgXG4gICAgICAgICAgICAvLyBgbm90SW5WYWx1ZWAgaXMgdGhlIGxvd2VyIGJvdW5kLiBXZSB0aGVyZWZvcmUgbmVlZCB0byByYWlzZSB0aGUgYm91bmRcbiAgICAgICAgICAgIC8vIHRvIHRoZSBuZXh0IHZhbHVlLlxuICAgICAgICAgICAgc1swXSA9IHQuS2UoKTsgZWxzZSBpZiAobiA+IDAgJiYgciA8IDApIFxuICAgICAgICAgICAgLy8gYG5vdEluVmFsdWVgIGlzIGluIHRoZSBtaWRkbGUgb2YgdGhlIHJhbmdlXG4gICAgICAgICAgICBzLnB1c2goaSksIHMucHVzaChpLktlKCkpOyBlbHNlIGlmIChyID4gMCkgXG4gICAgICAgICAgICAvLyBgbm90SW5WYWx1ZWAgKGFuZCBhbGwgZm9sbG93aW5nIHZhbHVlcykgYXJlIG91dCBvZiB0aGUgcmFuZ2VcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHMucHVzaChlKTtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHMubGVuZ3RoOyB0ICs9IDIpIGkucHVzaChJREJLZXlSYW5nZS5ib3VuZChbIHNbdF0uaW5kZXhJZCwgdGhpcy51aWQsIHNbdF0uYXJyYXlWYWx1ZSwgc1t0XS5kaXJlY3Rpb25hbFZhbHVlLCB3ciwgW10gXSwgWyBzW3QgKyAxXS5pbmRleElkLCB0aGlzLnVpZCwgc1t0ICsgMV0uYXJyYXlWYWx1ZSwgc1t0ICsgMV0uZGlyZWN0aW9uYWxWYWx1ZSwgd3IsIFtdIF0pKTtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICAgIGdldE1pbk9mZnNldEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZEluZGV4ZXModCwgZSkubmV4dChUcik7XG4gICAgfVxuICAgIGdldE1pbk9mZnNldCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBBdC5tYXBBcnJheSh0aGlzLnRuKGUpLCAoZSA9PiB0aGlzLmVuKHQsIGUpLm5leHQoKHQgPT4gdCB8fCBPKCkpKSkpLm5leHQoVHIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGNvbGxlY3Rpb25QYXJlbnRzXG4gKiBkb2N1bWVudCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBncih0KSB7XG4gICAgcmV0dXJuIE5pKHQsIFwiY29sbGVjdGlvblBhcmVudHNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBpbmRleCBlbnRyeSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24geXIodCkge1xuICAgIHJldHVybiBOaSh0LCBcImluZGV4RW50cmllc1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IGNvbmZpZ3VyYXRpb24gb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIHByKHQpIHtcbiAgICByZXR1cm4gTmkodCwgXCJpbmRleENvbmZpZ3VyYXRpb25cIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBpbmRleCBzdGF0ZSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gSXIodCkge1xuICAgIHJldHVybiBOaSh0LCBcImluZGV4U3RhdGVcIik7XG59XG5cbmZ1bmN0aW9uIFRyKHQpIHtcbiAgICBNKDAgIT09IHQubGVuZ3RoKTtcbiAgICBsZXQgZSA9IHRbMF0uaW5kZXhTdGF0ZS5vZmZzZXQsIG4gPSBlLmxhcmdlc3RCYXRjaElkO1xuICAgIGZvciAobGV0IHMgPSAxOyBzIDwgdC5sZW5ndGg7IHMrKykge1xuICAgICAgICBjb25zdCBpID0gdFtzXS5pbmRleFN0YXRlLm9mZnNldDtcbiAgICAgICAgcHQoaSwgZSkgPCAwICYmIChlID0gaSksIG4gPCBpLmxhcmdlc3RCYXRjaElkICYmIChuID0gaS5sYXJnZXN0QmF0Y2hJZCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgeXQoZS5yZWFkVGltZSwgZS5kb2N1bWVudEtleSwgbik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IEVyID0ge1xuICAgIGRpZFJ1bjogITEsXG4gICAgc2VxdWVuY2VOdW1iZXJzQ29sbGVjdGVkOiAwLFxuICAgIHRhcmdldHNSZW1vdmVkOiAwLFxuICAgIGRvY3VtZW50c1JlbW92ZWQ6IDBcbn07XG5cbmNsYXNzIEFyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvLyBXaGVuIHdlIGF0dGVtcHQgdG8gY29sbGVjdCwgd2Ugd2lsbCBvbmx5IGRvIHNvIGlmIHRoZSBjYWNoZSBzaXplIGlzIGdyZWF0ZXIgdGhhbiB0aGlzXG4gICAgLy8gdGhyZXNob2xkLiBQYXNzaW5nIGBDT0xMRUNUSU9OX0RJU0FCTEVEYCBoZXJlIHdpbGwgY2F1c2UgY29sbGVjdGlvbiB0byBhbHdheXMgYmUgc2tpcHBlZC5cbiAgICB0LCBcbiAgICAvLyBUaGUgcGVyY2VudGFnZSBvZiBzZXF1ZW5jZSBudW1iZXJzIHRoYXQgd2Ugd2lsbCBhdHRlbXB0IHRvIGNvbGxlY3RcbiAgICBlLCBcbiAgICAvLyBBIGNhcCBvbiB0aGUgdG90YWwgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3aWxsIGJlIGNvbGxlY3RlZC4gVGhpcyBwcmV2ZW50c1xuICAgIC8vIHVzIGZyb20gY29sbGVjdGluZyBhIGh1Z2UgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgaWYgdGhlIGNhY2hlIGhhcyBncm93biB2ZXJ5IGxhcmdlLlxuICAgIG4pIHtcbiAgICAgICAgdGhpcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID0gdCwgdGhpcy5wZXJjZW50aWxlVG9Db2xsZWN0ID0gZSwgdGhpcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID0gbjtcbiAgICB9XG4gICAgc3RhdGljIHdpdGhDYWNoZVNpemUodCkge1xuICAgICAgICByZXR1cm4gbmV3IEFyKHQsIEFyLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFLCBBci5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGVsZXRlIGEgbXV0YXRpb24gYmF0Y2ggYW5kIHRoZSBhc3NvY2lhdGVkIGRvY3VtZW50IG11dGF0aW9ucy5cbiAqIEByZXR1cm5zIEEgUGVyc2lzdGVuY2VQcm9taXNlIG9mIHRoZSBkb2N1bWVudCBtdXRhdGlvbnMgdGhhdCB3ZXJlIHJlbW92ZWQuXG4gKi9cbmZ1bmN0aW9uIFJyKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gdC5zdG9yZShcIm11dGF0aW9uc1wiKSwgaSA9IHQuc3RvcmUoXCJkb2N1bWVudE11dGF0aW9uc1wiKSwgciA9IFtdLCBvID0gSURCS2V5UmFuZ2Uub25seShuLmJhdGNoSWQpO1xuICAgIGxldCB1ID0gMDtcbiAgICBjb25zdCBjID0gcy5aKHtcbiAgICAgICAgcmFuZ2U6IG9cbiAgICB9LCAoKHQsIGUsIG4pID0+ICh1KyssIG4uZGVsZXRlKCkpKSk7XG4gICAgci5wdXNoKGMubmV4dCgoKCkgPT4ge1xuICAgICAgICBNKDEgPT09IHUpO1xuICAgIH0pKSk7XG4gICAgY29uc3QgYSA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBuLm11dGF0aW9ucykge1xuICAgICAgICBjb25zdCBzID0gbGkoZSwgdC5rZXkucGF0aCwgbi5iYXRjaElkKTtcbiAgICAgICAgci5wdXNoKGkuZGVsZXRlKHMpKSwgYS5wdXNoKHQua2V5KTtcbiAgICB9XG4gICAgcmV0dXJuIEF0LndhaXRGb3IocikubmV4dCgoKCkgPT4gYSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gYXBwcm94aW1hdGUgc2l6ZSBmb3IgdGhlIGdpdmVuIGRvY3VtZW50LlxuICovIGZ1bmN0aW9uIGJyKHQpIHtcbiAgICBpZiAoIXQpIHJldHVybiAwO1xuICAgIGxldCBlO1xuICAgIGlmICh0LmRvY3VtZW50KSBlID0gdC5kb2N1bWVudDsgZWxzZSBpZiAodC51bmtub3duRG9jdW1lbnQpIGUgPSB0LnVua25vd25Eb2N1bWVudDsgZWxzZSB7XG4gICAgICAgIGlmICghdC5ub0RvY3VtZW50KSB0aHJvdyBPKCk7XG4gICAgICAgIGUgPSB0Lm5vRG9jdW1lbnQ7XG4gICAgfVxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShlKS5sZW5ndGg7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQSBtdXRhdGlvbiBxdWV1ZSBmb3IgYSBzcGVjaWZpYyB1c2VyLCBiYWNrZWQgYnkgSW5kZXhlZERCLiAqLyBBci5ERUZBVUxUX0NPTExFQ1RJT05fUEVSQ0VOVElMRSA9IDEwLCBcbkFyLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCA9IDFlMywgQXIuREVGQVVMVCA9IG5ldyBBcig0MTk0MzA0MCwgQXIuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIEFyLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCksIFxuQXIuRElTQUJMRUQgPSBuZXcgQXIoLTEsIDAsIDApO1xuXG5jbGFzcyBQciB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIG5vcm1hbGl6ZWQgdXNlcklkIChlLmcuIG51bGwgVUlEID0+IFwiXCIgdXNlcklkKSB1c2VkIHRvIHN0b3JlIC9cbiAgICAgKiByZXRyaWV2ZSBtdXRhdGlvbnMuXG4gICAgICovXG4gICAgdCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnVzZXJJZCA9IHQsIHRoaXMuSXQgPSBlLCB0aGlzLmluZGV4TWFuYWdlciA9IG4sIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBzLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhY2hlcyB0aGUgZG9jdW1lbnQga2V5cyBmb3IgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzLiBJZiB0aGUgbXV0YXRpb25cbiAgICAgICAgICogaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIEluZGV4ZWREYiwgdGhlIGNhY2hlZCB2YWx1ZSBtYXkgY29udGludWUgdG9cbiAgICAgICAgICogYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgYmF0Y2gncyBkb2N1bWVudCBrZXlzLiBUbyByZW1vdmUgYSBjYWNoZWQgdmFsdWVcbiAgICAgICAgICogbG9jYWxseSwgYHJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cygpYCBzaG91bGQgYmUgaW52b2tlZCBlaXRoZXIgZGlyZWN0bHlcbiAgICAgICAgICogb3IgdGhyb3VnaCBgcmVtb3ZlTXV0YXRpb25CYXRjaGVzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaXRoIG11bHRpLXRhYiwgd2hlbiB0aGUgcHJpbWFyeSBjbGllbnQgYWNrbm93bGVkZ2VzIG9yIHJlamVjdHMgYSBtdXRhdGlvbixcbiAgICAgICAgICogdGhpcyBjYWNoZSBpcyB1c2VkIGJ5IHNlY29uZGFyeSBjbGllbnRzIHRvIGludmFsaWRhdGUgdGhlIGxvY2FsXG4gICAgICAgICAqIHZpZXcgb2YgdGhlIGRvY3VtZW50cyB0aGF0IHdlcmUgcHJldmlvdXNseSBhZmZlY3RlZCBieSB0aGUgbXV0YXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgICAgICB0aGlzLkluID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbXV0YXRpb24gcXVldWUgZm9yIHRoZSBnaXZlbiB1c2VyLlxuICAgICAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIgZm9yIHdoaWNoIHRvIGNyZWF0ZSBhIG11dGF0aW9uIHF1ZXVlLlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIHNlcmlhbGl6ZXIgdG8gdXNlIHdoZW4gcGVyc2lzdGluZyB0byBJbmRleGVkRGIuXG4gICAgICovICAgIHN0YXRpYyBvZSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFRPRE8obWNnKTogRmlndXJlIG91dCB3aGF0IGNvbnN0cmFpbnRzIHRoZXJlIGFyZSBvbiB1c2VySURzXG4gICAgICAgIC8vIEluIHBhcnRpY3VsYXIsIGFyZSB0aGVyZSBhbnkgcmVzZXJ2ZWQgY2hhcmFjdGVycz8gYXJlIGVtcHR5IGlkcyBhbGxvd2VkP1xuICAgICAgICAvLyBGb3IgdGhlIG1vbWVudCBzdG9yZSB0aGVzZSB0b2dldGhlciBpbiB0aGUgc2FtZSBtdXRhdGlvbnMgdGFibGUgYXNzdW1pbmdcbiAgICAgICAgLy8gdGhhdCBlbXB0eSB1c2VySURzIGFyZW4ndCBhbGxvd2VkLlxuICAgICAgICBNKFwiXCIgIT09IHQudWlkKTtcbiAgICAgICAgY29uc3QgaSA9IHQuaXNBdXRoZW50aWNhdGVkKCkgPyB0LnVpZCA6IFwiXCI7XG4gICAgICAgIHJldHVybiBuZXcgUHIoaSwgZSwgbiwgcyk7XG4gICAgfVxuICAgIGNoZWNrRW1wdHkodCkge1xuICAgICAgICBsZXQgZSA9ICEwO1xuICAgICAgICBjb25zdCBuID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZIF0sIFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgcmV0dXJuIFZyKHQpLlooe1xuICAgICAgICAgICAgaW5kZXg6IFwidXNlck11dGF0aW9uc0luZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogblxuICAgICAgICB9LCAoKHQsIG4sIHMpID0+IHtcbiAgICAgICAgICAgIGUgPSAhMSwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgfVxuICAgIGFkZE11dGF0aW9uQmF0Y2godCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gU3IodCksIHIgPSBWcih0KTtcbiAgICAgICAgLy8gVGhlIEluZGV4ZWREYiBpbXBsZW1lbnRhdGlvbiBpbiBDaHJvbWUgKGFuZCBGaXJlZm94KSBkb2VzIG5vdCBoYW5kbGVcbiAgICAgICAgLy8gY29tcG91bmQgaW5kaWNlcyB0aGF0IGluY2x1ZGUgYXV0by1nZW5lcmF0ZWQga2V5cyBjb3JyZWN0bHkuIFRvIGVuc3VyZVxuICAgICAgICAvLyB0aGF0IHRoZSBpbmRleCBlbnRyeSBpcyBhZGRlZCBjb3JyZWN0bHkgaW4gYWxsIGJyb3dzZXJzLCB3ZSBwZXJmb3JtIHR3b1xuICAgICAgICAvLyB3cml0ZXM6IFRoZSBmaXJzdCB3cml0ZSBpcyB1c2VkIHRvIHJldHJpZXZlIHRoZSBuZXh0IGF1dG8tZ2VuZXJhdGVkIEJhdGNoXG4gICAgICAgIC8vIElELCBhbmQgdGhlIHNlY29uZCB3cml0ZSBwb3B1bGF0ZXMgdGhlIGluZGV4IGFuZCBzdG9yZXMgdGhlIGFjdHVhbFxuICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgICAgLy8gU2VlOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD03MDE5NzJcbiAgICAgICAgLy8gV2Ugd3JpdGUgYW4gZW1wdHkgb2JqZWN0IHRvIG9idGFpbiBrZXlcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgcmV0dXJuIHIuYWRkKHt9KS5uZXh0KChvID0+IHtcbiAgICAgICAgICAgIE0oXCJudW1iZXJcIiA9PSB0eXBlb2Ygbyk7XG4gICAgICAgICAgICBjb25zdCB1ID0gbmV3IGtpKG8sIGUsIG4sIHMpLCBjID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLmJhc2VNdXRhdGlvbnMubWFwKChlID0+IEtzKHQucmUsIGUpKSksIGkgPSBuLm11dGF0aW9ucy5tYXAoKGUgPT4gS3ModC5yZSwgZSkpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGUsXG4gICAgICAgICAgICAgICAgICAgIGJhdGNoSWQ6IG4uYmF0Y2hJZCxcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxXcml0ZVRpbWVNczogbi5sb2NhbFdyaXRlVGltZS50b01pbGxpcygpLFxuICAgICAgICAgICAgICAgICAgICBiYXNlTXV0YXRpb25zOiBzLFxuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnM6IGlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSh0aGlzLkl0LCB0aGlzLnVzZXJJZCwgdSksIGEgPSBbXTtcbiAgICAgICAgICAgIGxldCBoID0gbmV3IHF0KCgodCwgZSkgPT4gWih0LmNhbm9uaWNhbFN0cmluZygpLCBlLmNhbm9uaWNhbFN0cmluZygpKSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbGkodGhpcy51c2VySWQsIHQua2V5LnBhdGgsIG8pO1xuICAgICAgICAgICAgICAgIGggPSBoLmFkZCh0LmtleS5wYXRoLnBvcExhc3QoKSksIGEucHVzaChyLnB1dChjKSksIGEucHVzaChpLnB1dChlLCBmaSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGguZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgYS5wdXNoKHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpKTtcbiAgICAgICAgICAgIH0pKSwgdC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5JbltvXSA9IHUua2V5cygpO1xuICAgICAgICAgICAgfSkpLCBBdC53YWl0Rm9yKGEpLm5leHQoKCgpID0+IHUpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFZyKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyAoTSh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBHaSh0aGlzLkl0LCB0KSkgOiBudWxsKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHRoZSBtdXRhdGlvbiBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLlxuICAgICAqIEZvciBwcmltYXJ5IGNsaWVudHMsIHRoaXMgbWV0aG9kIHJldHVybnMgYG51bGxgIGFmdGVyXG4gICAgICogYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYCBoYXMgYmVlbiBjYWxsZWQuIFNlY29uZGFyeSBjbGllbnRzIHJldHVybiBhXG4gICAgICogY2FjaGVkIHJlc3VsdCB1bnRpbCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIGlzIGludm9rZWQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBUbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkluW2VdID8gQXQucmVzb2x2ZSh0aGlzLkluW2VdKSA6IHRoaXMubG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQua2V5cygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkluW2VdID0gbiwgbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgKyAxLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChbIHRoaXMudXNlcklkLCBuIF0pO1xuICAgICAgICBsZXQgaSA9IG51bGw7XG4gICAgICAgIHJldHVybiBWcih0KS5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcInVzZXJNdXRhdGlvbnNJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBlLnVzZXJJZCA9PT0gdGhpcy51c2VySWQgJiYgKE0oZS5iYXRjaElkID49IG4pLCBpID0gR2kodGhpcy5JdCwgZSkpLCBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBJREJLZXlSYW5nZS51cHBlckJvdW5kKFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgbGV0IG4gPSAtMTtcbiAgICAgICAgcmV0dXJuIFZyKHQpLlooe1xuICAgICAgICAgICAgaW5kZXg6IFwidXNlck11dGF0aW9uc0luZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogZSxcbiAgICAgICAgICAgIHJldmVyc2U6ICEwXG4gICAgICAgIH0sICgodCwgZSwgcykgPT4ge1xuICAgICAgICAgICAgbiA9IGUuYmF0Y2hJZCwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCAtMSBdLCBbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIHJldHVybiBWcih0KS5XKFwidXNlck11dGF0aW9uc0luZGV4XCIsIGUpLm5leHQoKHQgPT4gdC5tYXAoKHQgPT4gR2kodGhpcy5JdCwgdCkpKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKSB7XG4gICAgICAgIC8vIFNjYW4gdGhlIGRvY3VtZW50LW11dGF0aW9uIGluZGV4IHN0YXJ0aW5nIHdpdGggYSBwcmVmaXggc3RhcnRpbmcgd2l0aFxuICAgICAgICAvLyB0aGUgZ2l2ZW4gZG9jdW1lbnRLZXkuXG4gICAgICAgIGNvbnN0IG4gPSBoaSh0aGlzLnVzZXJJZCwgZS5wYXRoKSwgcyA9IElEQktleVJhbmdlLmxvd2VyQm91bmQobiksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIFNyKHQpLlooe1xuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKChuLCBzLCByKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbbywgdSwgY10gPSBuLCBhID0gY2kodSk7XG4gICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXG4gICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXG4gICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcbiAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcbiAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbChhKSkgXG4gICAgICAgICAgICAvLyBMb29rIHVwIHRoZSBtdXRhdGlvbiBiYXRjaCBpbiB0aGUgc3RvcmUuXG4gICAgICAgICAgICByZXR1cm4gVnIodCkuZ2V0KGMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdCkgdGhyb3cgTygpO1xuICAgICAgICAgICAgICAgIE0odC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgaS5wdXNoKEdpKHRoaXMuSXQsIHQpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHIuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5ldyBxdChaKTtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBoaSh0aGlzLnVzZXJJZCwgZS5wYXRoKSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaSksIG8gPSBTcih0KS5aKHtcbiAgICAgICAgICAgICAgICByYW5nZTogclxuICAgICAgICAgICAgfSwgKCh0LCBzLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgW3IsIG8sIHVdID0gdCwgYyA9IGNpKG8pO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXG4gICAgICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbChjKSA/IG4gPSBuLmFkZCh1KSA6IGkuZG9uZSgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcy5wdXNoKG8pO1xuICAgICAgICB9KSksIEF0LndhaXRGb3IocykubmV4dCgoKCkgPT4gdGhpcy5Fbih0LCBuKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDEsIGkgPSBoaSh0aGlzLnVzZXJJZCwgbiksIHIgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGkpO1xuICAgICAgICAvLyBDb2xsZWN0IHVwIHVuaXF1ZSBiYXRjaElEcyBlbmNvdW50ZXJlZCBkdXJpbmcgYSBzY2FuIG9mIHRoZSBpbmRleC4gVXNlIGFcbiAgICAgICAgLy8gU29ydGVkU2V0IHRvIGFjY3VtdWxhdGUgYmF0Y2ggSURzIHNvIHRoZXkgY2FuIGJlIHRyYXZlcnNlZCBpbiBvcmRlciBpbiBhXG4gICAgICAgIC8vIHNjYW4gb2YgdGhlIG1haW4gdGFibGUuXG4gICAgICAgIGxldCBvID0gbmV3IHF0KFopO1xuICAgICAgICByZXR1cm4gU3IodCkuWih7XG4gICAgICAgICAgICByYW5nZTogclxuICAgICAgICB9LCAoKHQsIGUsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IFtyLCB1LCBjXSA9IHQsIGEgPSBjaSh1KTtcbiAgICAgICAgICAgIHIgPT09IHRoaXMudXNlcklkICYmIG4uaXNQcmVmaXhPZihhKSA/IFxuICAgICAgICAgICAgLy8gUm93cyB3aXRoIGRvY3VtZW50IGtleXMgbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZVxuICAgICAgICAgICAgLy8gcXVlcnkgcGF0aCBjYW4ndCBiZSBtYXRjaGVzLiBGb3IgZXhhbXBsZSwgYSBxdWVyeSBvbiAncm9vbXMnXG4gICAgICAgICAgICAvLyBjYW4ndCBtYXRjaCB0aGUgZG9jdW1lbnQgL3Jvb21zL2FiYy9tZXNzYWdlcy94eXguXG4gICAgICAgICAgICAvLyBUT0RPKG1jZyk6IHdlJ2xsIG5lZWQgYSBkaWZmZXJlbnQgc2Nhbm5lciB3aGVuIHdlIGltcGxlbWVudFxuICAgICAgICAgICAgLy8gYW5jZXN0b3IgcXVlcmllcy5cbiAgICAgICAgICAgIGEubGVuZ3RoID09PSBzICYmIChvID0gby5hZGQoYykpIDogaS5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0aGlzLkVuKHQsIG8pKSk7XG4gICAgfVxuICAgIEVuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFtdLCBzID0gW107XG4gICAgICAgIC8vIFRPRE8ocm9ja3dvb2QpOiBJbXBsZW1lbnQgdGhpcyB1c2luZyBpdGVyYXRlLlxuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHMucHVzaChWcih0KS5nZXQoZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHRocm93IE8oKTtcbiAgICAgICAgICAgICAgICBNKHQudXNlcklkID09PSB0aGlzLnVzZXJJZCksIG4ucHVzaChHaSh0aGlzLkl0LCB0KSk7XG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSksIEF0LndhaXRGb3IocykubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFJyKHQuaWUsIHRoaXMudXNlcklkLCBlKS5uZXh0KChuID0+ICh0LmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuQW4oZS5iYXRjaElkKTtcbiAgICAgICAgfSkpLCBBdC5mb3JFYWNoKG4sIChlID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUubWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBjYWNoZWQga2V5cyBmb3IgYSBtdXRhdGlvbiBiYXRjaC4gVGhpcyBtZXRob2Qgc2hvdWxkIGJlXG4gICAgICogY2FsbGVkIGJ5IHNlY29uZGFyeSBjbGllbnRzIGFmdGVyIHRoZXkgcHJvY2VzcyBtdXRhdGlvbiB1cGRhdGVzLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGRvZXMgbm90IGhhdmUgdG8gYmUgY2FsbGVkIGZyb20gcHJpbWFyeSBjbGllbnRzIGFzXG4gICAgICogdGhlIGNvcnJlc3BvbmRpbmcgY2FjaGUgZW50cmllcyBhcmUgY2xlYXJlZCB3aGVuIGFuIGFja25vd2xlZGdlZCBvclxuICAgICAqIHJlamVjdGVkIGJhdGNoIGlzIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIEFuKHQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuSW5bdF07XG4gICAgfVxuICAgIHBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tFbXB0eSh0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgcmV0dXJuIEF0LnJlc29sdmUoKTtcbiAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGFyZSBubyBlbnRyaWVzIGluIHRoZSBkb2N1bWVudE11dGF0aW9ucyBpbmRleCBpZlxuICAgICAgICAgICAgLy8gdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoWyB0aGlzLnVzZXJJZCBdKTtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiBTcih0KS5aKHtcbiAgICAgICAgICAgICAgICByYW5nZTogblxuICAgICAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRbMF0gPT09IHRoaXMudXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBjaSh0WzFdKTtcbiAgICAgICAgICAgICAgICAgICAgcy5wdXNoKGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBuLmRvbmUoKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgTSgwID09PSBzLmxlbmd0aCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY29udGFpbnNLZXkodCwgZSkge1xuICAgICAgICByZXR1cm4gdnIodCwgdGhpcy51c2VySWQsIGUpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5IChzdGF0ZSBpcyBoZWxkIGluIG1lbW9yeSBpbiBvdGhlciBjbGllbnRzKS5cbiAgICAvKiogUmV0dXJucyB0aGUgbXV0YXRpb24gcXVldWUncyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi4gKi9cbiAgICBSbih0KSB7XG4gICAgICAgIHJldHVybiBEcih0KS5nZXQodGhpcy51c2VySWQpLm5leHQoKHQgPT4gdCB8fCB7XG4gICAgICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLFxuICAgICAgICAgICAgbGFzdEFja25vd2xlZGdlZEJhdGNoSWQ6IC0xLFxuICAgICAgICAgICAgbGFzdFN0cmVhbVRva2VuOiBcIlwiXG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgbXV0YXRpb24gcXVldWUgZm9yIHRoZSBnaXZlbiB1c2VyIGNvbnRhaW5zIGEgcGVuZGluZ1xuICogICAgICAgICBtdXRhdGlvbiBmb3IgdGhlIGdpdmVuIGtleS5cbiAqLyBmdW5jdGlvbiB2cih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IGhpKGUsIG4ucGF0aCksIGkgPSBzWzFdLCByID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChzKTtcbiAgICBsZXQgbyA9ICExO1xuICAgIHJldHVybiBTcih0KS5aKHtcbiAgICAgICAgcmFuZ2U6IHIsXG4gICAgICAgIFg6ICEwXG4gICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IFtyLCB1LCAvKmJhdGNoSUQqLyBjXSA9IHQ7XG4gICAgICAgIHIgPT09IGUgJiYgdSA9PT0gaSAmJiAobyA9ICEwKSwgcy5kb25lKCk7XG4gICAgfSkpLm5leHQoKCgpID0+IG8pKTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBhbnkgbXV0YXRpb24gcXVldWUgY29udGFpbnMgdGhlIGdpdmVuIGRvY3VtZW50LiAqL1xuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9ucyBvYmplY3Qgc3RvcmUuXG4gKi9cbmZ1bmN0aW9uIFZyKHQpIHtcbiAgICByZXR1cm4gTmkodCwgXCJtdXRhdGlvbnNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvblF1ZXVlcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gU3IodCkge1xuICAgIHJldHVybiBOaSh0LCBcImRvY3VtZW50TXV0YXRpb25zXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIERyKHQpIHtcbiAgICByZXR1cm4gTmkodCwgXCJtdXRhdGlvblF1ZXVlc1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBPZmZzZXQgdG8gZW5zdXJlIG5vbi1vdmVybGFwcGluZyB0YXJnZXQgaWRzLiAqL1xuLyoqXG4gKiBHZW5lcmF0ZXMgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nIHRhcmdldCBJRHMgZm9yIHNlbmRpbmcgdGFyZ2V0cyB0byB0aGVcbiAqIHdhdGNoIHN0cmVhbS5cbiAqXG4gKiBUaGUgY2xpZW50IGNvbnN0cnVjdHMgdHdvIGdlbmVyYXRvcnMsIG9uZSBmb3IgdGhlIHRhcmdldCBjYWNoZSwgYW5kIG9uZSBmb3JcbiAqIGZvciB0aGUgc3luYyBlbmdpbmUgKHRvIGdlbmVyYXRlIGxpbWJvIGRvY3VtZW50cyB0YXJnZXRzKS4gVGhlc2VcbiAqIGdlbmVyYXRvcnMgcHJvZHVjZSBub24tb3ZlcmxhcHBpbmcgSURzIChieSB1c2luZyBldmVuIGFuZCBvZGQgSURzXG4gKiByZXNwZWN0aXZlbHkpLlxuICpcbiAqIEJ5IHNlcGFyYXRpbmcgdGhlIHRhcmdldCBJRCBzcGFjZSwgdGhlIHF1ZXJ5IGNhY2hlIGNhbiBnZW5lcmF0ZSB0YXJnZXQgSURzXG4gKiB0aGF0IHBlcnNpc3QgYWNyb3NzIGNsaWVudCByZXN0YXJ0cywgd2hpbGUgc3luYyBlbmdpbmUgY2FuIGluZGVwZW5kZW50bHlcbiAqIGdlbmVyYXRlIGluLW1lbW9yeSB0YXJnZXQgSURzIHRoYXQgYXJlIHRyYW5zaWVudCBhbmQgY2FuIGJlIHJldXNlZCBhZnRlciBhXG4gKiByZXN0YXJ0LlxuICovXG5jbGFzcyBDciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmJuID0gdDtcbiAgICB9XG4gICAgbmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm4gKz0gMiwgdGhpcy5ibjtcbiAgICB9XG4gICAgc3RhdGljIFBuKCkge1xuICAgICAgICAvLyBUaGUgdGFyZ2V0IGNhY2hlIGdlbmVyYXRvciBtdXN0IHJldHVybiAnMicgaW4gaXRzIGZpcnN0IGNhbGwgdG8gYG5leHQoKWBcbiAgICAgICAgLy8gYXMgdGhlcmUgaXMgbm8gZGlmZmVyZW50aWF0aW9uIGluIHRoZSBwcm90b2NvbCBsYXllciBiZXR3ZWVuIGFuIHVuc2V0XG4gICAgICAgIC8vIG51bWJlciBhbmQgdGhlIG51bWJlciAnMCcuIElmIHdlIHdlcmUgdG8gc2VudCBhIHRhcmdldCB3aXRoIHRhcmdldCBJRFxuICAgICAgICAvLyAnMCcsIHRoZSBiYWNrZW5kIHdvdWxkIGNvbnNpZGVyIGl0IHVuc2V0IGFuZCByZXBsYWNlIGl0IHdpdGggaXRzIG93biBJRC5cbiAgICAgICAgcmV0dXJuIG5ldyBDcigwKTtcbiAgICB9XG4gICAgc3RhdGljIHZuKCkge1xuICAgICAgICAvLyBTeW5jIGVuZ2luZSBhc3NpZ25zIHRhcmdldCBJRHMgZm9yIGxpbWJvIGRvY3VtZW50IGRldGVjdGlvbi5cbiAgICAgICAgcmV0dXJuIG5ldyBDcigtMSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyB4ciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gdCwgdGhpcy5JdCA9IGU7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogV2UgZG9uJ3QgY2FjaGUgZ2xvYmFsIG1ldGFkYXRhIGZvciB0aGUgdGFyZ2V0IGNhY2hlLCBzaW5jZVxuICAgIC8vIHNvbWUgb2YgaXQgKGluIHBhcnRpY3VsYXIgYGhpZ2hlc3RUYXJnZXRJZGApIGNhbiBiZSBtb2RpZmllZCBieSBzZWNvbmRhcnlcbiAgICAvLyB0YWJzLiBXZSBjb3VsZCBwZXJoYXBzIGJlIG1vcmUgZ3JhbnVsYXIgKGFuZCBlLmcuIHN0aWxsIGNhY2hlXG4gICAgLy8gYGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb25gIGluIG1lbW9yeSkgYnV0IGZvciBzaW1wbGljaXR5IHdlIGN1cnJlbnRseSBnb1xuICAgIC8vIHRvIEluZGV4ZWREYiB3aGVuZXZlciB3ZSBuZWVkIHRvIHJlYWQgbWV0YWRhdGEuIFdlIGNhbiByZXZpc2l0IGlmIGl0IHR1cm5zXG4gICAgLy8gb3V0IHRvIGhhdmUgYSBtZWFuaW5nZnVsIHBlcmZvcm1hbmNlIGltcGFjdC5cbiAgICBhbGxvY2F0ZVRhcmdldElkKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVm4odCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IENyKGUuaGlnaGVzdFRhcmdldElkKTtcbiAgICAgICAgICAgIHJldHVybiBlLmhpZ2hlc3RUYXJnZXRJZCA9IG4ubmV4dCgpLCB0aGlzLlNuKHQsIGUpLm5leHQoKCgpID0+IGUuaGlnaGVzdFRhcmdldElkKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlZuKHQpLm5leHQoKHQgPT4gc3QuZnJvbVRpbWVzdGFtcChuZXcgbnQodC5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLnNlY29uZHMsIHQubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5uYW5vc2Vjb25kcykpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlZuKHQpLm5leHQoKHQgPT4gdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpKTtcbiAgICB9XG4gICAgc2V0VGFyZ2V0c01ldGFkYXRhKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVm4odCkubmV4dCgocyA9PiAocy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLCBuICYmIChzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuLnRvVGltZXN0YW1wKCkpLCBcbiAgICAgICAgZSA+IHMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGUpLCB0aGlzLlNuKHQsIHMpKSkpO1xuICAgIH1cbiAgICBhZGRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRG4odCwgZSkubmV4dCgoKCkgPT4gdGhpcy5Wbih0KS5uZXh0KChuID0+IChuLnRhcmdldENvdW50ICs9IDEsIHRoaXMuQ24oZSwgbiksIFxuICAgICAgICB0aGlzLlNuKHQsIG4pKSkpKSk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ebih0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKCgpID0+IE5yKHQpLmRlbGV0ZShlLnRhcmdldElkKSkpLm5leHQoKCgpID0+IHRoaXMuVm4odCkpKS5uZXh0KChlID0+IChNKGUudGFyZ2V0Q291bnQgPiAwKSwgXG4gICAgICAgIGUudGFyZ2V0Q291bnQgLT0gMSwgdGhpcy5Tbih0LCBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRHJvcHMgYW55IHRhcmdldHMgd2l0aCBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCwgZXhjZXB0aW5nIHRob3NlXG4gICAgICogcHJlc2VudCBpbiBgYWN0aXZlVGFyZ2V0SWRzYC4gRG9jdW1lbnQgYXNzb2NpYXRpb25zIGZvciB0aGUgcmVtb3ZlZCB0YXJnZXRzIGFyZSBhbHNvIHJlbW92ZWQuXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRhcmdldHMgcmVtb3ZlZC5cbiAgICAgKi8gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gTnIodCkuWigoKHIsIG8pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBRaShvKTtcbiAgICAgICAgICAgIHUuc2VxdWVuY2VOdW1iZXIgPD0gZSAmJiBudWxsID09PSBuLmdldCh1LnRhcmdldElkKSAmJiAocysrLCBpLnB1c2godGhpcy5yZW1vdmVUYXJnZXREYXRhKHQsIHUpKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBBdC53YWl0Rm9yKGkpKSkubmV4dCgoKCkgPT4gcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIHdpdGggZWFjaCBgVGFyZ2V0RGF0YWAgdGhhdCB3ZSBoYXZlIGNhY2hlZC5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBOcih0KS5aKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IFFpKG4pO1xuICAgICAgICAgICAgZShzKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBWbih0KSB7XG4gICAgICAgIHJldHVybiBrcih0KS5nZXQoXCJ0YXJnZXRHbG9iYWxLZXlcIikubmV4dCgodCA9PiAoTShudWxsICE9PSB0KSwgdCkpKTtcbiAgICB9XG4gICAgU24odCwgZSkge1xuICAgICAgICByZXR1cm4ga3IodCkucHV0KFwidGFyZ2V0R2xvYmFsS2V5XCIsIGUpO1xuICAgIH1cbiAgICBEbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBOcih0KS5wdXQoamkodGhpcy5JdCwgZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbi1wbGFjZSB1cGRhdGVzIHRoZSBwcm92aWRlZCBtZXRhZGF0YSB0byBhY2NvdW50IGZvciB2YWx1ZXMgaW4gdGhlIGdpdmVuXG4gICAgICogVGFyZ2V0RGF0YS4gU2F2aW5nIGlzIGRvbmUgc2VwYXJhdGVseS4gUmV0dXJucyB0cnVlIGlmIHRoZXJlIHdlcmUgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgbWV0YWRhdGEuXG4gICAgICovICAgIENuKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSAhMTtcbiAgICAgICAgcmV0dXJuIHQudGFyZ2V0SWQgPiBlLmhpZ2hlc3RUYXJnZXRJZCAmJiAoZS5oaWdoZXN0VGFyZ2V0SWQgPSB0LnRhcmdldElkLCBuID0gITApLCBcbiAgICAgICAgdC5zZXF1ZW5jZU51bWJlciA+IGUuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChlLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IHQuc2VxdWVuY2VOdW1iZXIsIFxuICAgICAgICBuID0gITApLCBuO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDb3VudCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlZuKHQpLm5leHQoKHQgPT4gdC50YXJnZXRDb3VudCkpO1xuICAgIH1cbiAgICBnZXRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgLy8gSXRlcmF0aW5nIGJ5IHRoZSBjYW5vbmljYWxJZCBtYXkgeWllbGQgbW9yZSB0aGFuIG9uZSByZXN1bHQgYmVjYXVzZVxuICAgICAgICAvLyBjYW5vbmljYWxJZCB2YWx1ZXMgYXJlIG5vdCByZXF1aXJlZCB0byBiZSB1bmlxdWUgcGVyIHRhcmdldC4gVGhpcyBxdWVyeVxuICAgICAgICAvLyBkZXBlbmRzIG9uIHRoZSBxdWVyeVRhcmdldHMgaW5kZXggdG8gYmUgZWZmaWNpZW50LlxuICAgICAgICBjb25zdCBuID0geGUoZSksIHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIG4sIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSBdLCBbIG4sIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgbGV0IGkgPSBudWxsO1xuICAgICAgICByZXR1cm4gTnIodCkuWih7XG4gICAgICAgICAgICByYW5nZTogcyxcbiAgICAgICAgICAgIGluZGV4OiBcInF1ZXJ5VGFyZ2V0c0luZGV4XCJcbiAgICAgICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gUWkobik7XG4gICAgICAgICAgICAvLyBBZnRlciBmaW5kaW5nIGEgcG90ZW50aWFsIG1hdGNoLCBjaGVjayB0aGF0IHRoZSB0YXJnZXQgaXNcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IGVxdWFsIHRvIHRoZSByZXF1ZXN0ZWQgdGFyZ2V0LlxuICAgICAgICAgICAgICAgICAgICAgICAga2UoZSwgci50YXJnZXQpICYmIChpID0gciwgcy5kb25lKCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBhZGRNYXRjaGluZ0tleXModCwgZSwgbikge1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSByZXZlcnNlIGluZGV4IChkb2N1bWVudHNUYXJnZXRzKSBpcyBtYWludGFpbmVkIGJ5XG4gICAgICAgIC8vIEluZGV4ZWREYi5cbiAgICAgICAgY29uc3QgcyA9IFtdLCBpID0gT3IodCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHJpKGUucGF0aCk7XG4gICAgICAgICAgICBzLnB1c2goaS5wdXQoe1xuICAgICAgICAgICAgICAgIHRhcmdldElkOiBuLFxuICAgICAgICAgICAgICAgIHBhdGg6IHJcbiAgICAgICAgICAgIH0pKSwgcy5wdXNoKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKHQsIG4sIGUpKTtcbiAgICAgICAgfSkpLCBBdC53YWl0Rm9yKHMpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXModCwgZSwgbikge1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSByZXZlcnNlIGluZGV4IChkb2N1bWVudHNUYXJnZXRzKSBpcyBtYWludGFpbmVkIGJ5XG4gICAgICAgIC8vIEluZGV4ZWREYi5cbiAgICAgICAgY29uc3QgcyA9IE9yKHQpO1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaChlLCAoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gcmkoZS5wYXRoKTtcbiAgICAgICAgICAgIHJldHVybiBBdC53YWl0Rm9yKFsgcy5kZWxldGUoWyBuLCBpIF0pLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0LCBuLCBlKSBdKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBPcih0KSwgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZSBdLCBbIGUgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIG4uZGVsZXRlKHMpO1xuICAgIH1cbiAgICBnZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5ib3VuZChbIGUgXSwgWyBlICsgMSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCksIHMgPSBPcih0KTtcbiAgICAgICAgbGV0IGkgPSBmcygpO1xuICAgICAgICByZXR1cm4gcy5aKHtcbiAgICAgICAgICAgIHJhbmdlOiBuLFxuICAgICAgICAgICAgWDogITBcbiAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gY2kodFsxXSksIHIgPSBuZXcgY3Qocyk7XG4gICAgICAgICAgICBpID0gaS5hZGQocik7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHJpKGUucGF0aCksIHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIG4gXSwgWyBldChuKSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCk7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgcmV0dXJuIE9yKHQpLlooe1xuICAgICAgICAgICAgaW5kZXg6IFwiZG9jdW1lbnRUYXJnZXRzSW5kZXhcIixcbiAgICAgICAgICAgIFg6ICEwLFxuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKChbdCwgZV0sIG4sIHMpID0+IHtcbiAgICAgICAgICAgIC8vIEhhdmluZyBhIHNlbnRpbmVsIHJvdyBmb3IgYSBkb2N1bWVudCBkb2VzIG5vdCBjb3VudCBhcyBjb250YWluaW5nIHRoYXQgZG9jdW1lbnQ7XG4gICAgICAgICAgICAvLyBGb3IgdGhlIHRhcmdldCBjYWNoZSwgY29udGFpbmluZyB0aGUgZG9jdW1lbnQgbWVhbnMgdGhlIGRvY3VtZW50IGlzIHBhcnQgb2Ygc29tZVxuICAgICAgICAgICAgLy8gdGFyZ2V0LlxuICAgICAgICAgICAgMCAhPT0gdCAmJiAoaSsrLCBzLmRvbmUoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpID4gMCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhIFRhcmdldERhdGEgZW50cnkgYnkgdGFyZ2V0IElELlxuICAgICAqXG4gICAgICogQHBhcmFtIHRhcmdldElkIC0gVGhlIHRhcmdldCBJRCBvZiB0aGUgVGFyZ2V0RGF0YSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgVGFyZ2V0RGF0YSBlbnRyeSwgb3IgbnVsbCBpZiB0aGUgY2FjaGUgaGFzIG5vIGVudHJ5IGZvclxuICAgICAqIHRoZSB0YXJnZXQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBzZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBOcih0KS5nZXQoZSkubmV4dCgodCA9PiB0ID8gUWkodCkgOiBudWxsKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcXVlcmllcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gTnIodCkge1xuICAgIHJldHVybiBOaSh0LCBcInRhcmdldHNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSB0YXJnZXQgZ2xvYmFscyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24ga3IodCkge1xuICAgIHJldHVybiBOaSh0LCBcInRhcmdldEdsb2JhbFwiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gT3IodCkge1xuICAgIHJldHVybiBOaSh0LCBcInRhcmdldERvY3VtZW50c1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gTXIoW3QsIGVdLCBbbiwgc10pIHtcbiAgICBjb25zdCBpID0gWih0LCBuKTtcbiAgICByZXR1cm4gMCA9PT0gaSA/IFooZSwgcykgOiBpO1xufVxuXG4vKipcbiAqIFVzZWQgdG8gY2FsY3VsYXRlIHRoZSBudGggc2VxdWVuY2UgbnVtYmVyLiBLZWVwcyBhIHJvbGxpbmcgYnVmZmVyIG9mIHRoZVxuICogbG93ZXN0IG4gdmFsdWVzIHBhc3NlZCB0byBgYWRkRWxlbWVudGAsIGFuZCBmaW5hbGx5IHJlcG9ydHMgdGhlIGxhcmdlc3Qgb2ZcbiAqIHRoZW0gaW4gYG1heFZhbHVlYC5cbiAqLyBjbGFzcyBGciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnhuID0gdCwgdGhpcy5idWZmZXIgPSBuZXcgcXQoTXIpLCB0aGlzLk5uID0gMDtcbiAgICB9XG4gICAga24oKSB7XG4gICAgICAgIHJldHVybiArK3RoaXMuTm47XG4gICAgfVxuICAgIE9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFsgdCwgdGhpcy5rbigpIF07XG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlci5zaXplIDwgdGhpcy54bikgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5hZGQoZSk7IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuYnVmZmVyLmxhc3QoKTtcbiAgICAgICAgICAgIE1yKGUsIHQpIDwgMCAmJiAodGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5kZWxldGUodCkuYWRkKGUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbWF4VmFsdWUoKSB7XG4gICAgICAgIC8vIEd1YXJhbnRlZWQgdG8gYmUgbm9uLWVtcHR5LiBJZiB3ZSBkZWNpZGUgd2UgYXJlIG5vdCBjb2xsZWN0aW5nIGFueVxuICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXJzLCBudGhTZXF1ZW5jZU51bWJlciBiZWxvdyBzaG9ydC1jaXJjdWl0cy4gSWYgd2UgaGF2ZVxuICAgICAgICAvLyBkZWNpZGVkIHRoYXQgd2UgYXJlIGNvbGxlY3RpbmcgbiBzZXF1ZW5jZSBudW1iZXJzLCBpdCdzIGJlY2F1c2UgbiBpcyBzb21lXG4gICAgICAgIC8vIHBlcmNlbnRhZ2Ugb2YgdGhlIGV4aXN0aW5nIHNlcXVlbmNlIG51bWJlcnMuIFRoYXQgbWVhbnMgd2Ugc2hvdWxkIG5ldmVyXG4gICAgICAgIC8vIGJlIGluIGEgc2l0dWF0aW9uIHdoZXJlIHdlIGFyZSBjb2xsZWN0aW5nIHNlcXVlbmNlIG51bWJlcnMgYnV0IGRvbid0XG4gICAgICAgIC8vIGFjdHVhbGx5IGhhdmUgYW55LlxuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGFzdCgpWzBdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciB0aGUgc2NoZWR1bGluZyBvZiBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiBJdCBoYW5kbGVzIGNoZWNraW5nXG4gKiB3aGV0aGVyIG9yIG5vdCBHQyBpcyBlbmFibGVkLCBhcyB3ZWxsIGFzIHdoaWNoIGRlbGF5IHRvIHVzZSBiZWZvcmUgdGhlIG5leHQgcnVuLlxuICovIGNsYXNzICRyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IHQsIHRoaXMuYXN5bmNRdWV1ZSA9IGUsIHRoaXMubG9jYWxTdG9yZSA9IG4sIHRoaXMuTW4gPSBudWxsO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgLTEgIT09IHRoaXMuZ2FyYmFnZUNvbGxlY3Rvci5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCAmJiB0aGlzLkZuKDZlNCk7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuTW4gJiYgKHRoaXMuTW4uY2FuY2VsKCksIHRoaXMuTW4gPSBudWxsKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLk1uO1xuICAgIH1cbiAgICBGbih0KSB7XG4gICAgICAgIEMoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBHYXJiYWdlIGNvbGxlY3Rpb24gc2NoZWR1bGVkIGluICR7dH1tc2ApLCB0aGlzLk1uID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwibHJ1X2dhcmJhZ2VfY29sbGVjdGlvblwiIC8qIExydUdhcmJhZ2VDb2xsZWN0aW9uICovICwgdCwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuTW4gPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvY2FsU3RvcmUuY29sbGVjdEdhcmJhZ2UodGhpcy5nYXJiYWdlQ29sbGVjdG9yKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBWdCh0KSA/IEMoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBnYXJiYWdlIGNvbGxlY3Rpb246IFwiLCB0KSA6IGF3YWl0IEV0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5GbigzZTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKiogSW1wbGVtZW50cyB0aGUgc3RlcHMgZm9yIExSVSBnYXJiYWdlIGNvbGxlY3Rpb24uICovIGNsYXNzIEJyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuJG4gPSB0LCB0aGlzLnBhcmFtcyA9IGU7XG4gICAgfVxuICAgIGNhbGN1bGF0ZVRhcmdldENvdW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJG4uQm4odCkubmV4dCgodCA9PiBNYXRoLmZsb29yKGUgLyAxMDAgKiB0KSkpO1xuICAgIH1cbiAgICBudGhTZXF1ZW5jZU51bWJlcih0LCBlKSB7XG4gICAgICAgIGlmICgwID09PSBlKSByZXR1cm4gQXQucmVzb2x2ZShPdC5hdCk7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgRnIoZSk7XG4gICAgICAgIHJldHVybiB0aGlzLiRuLmZvckVhY2hUYXJnZXQodCwgKHQgPT4gbi5Pbih0LnNlcXVlbmNlTnVtYmVyKSkpLm5leHQoKCgpID0+IHRoaXMuJG4uTG4odCwgKHQgPT4gbi5Pbih0KSkpKSkubmV4dCgoKCkgPT4gbi5tYXhWYWx1ZSkpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJG4ucmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy4kbi5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKTtcbiAgICB9XG4gICAgY29sbGVjdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiAtMSA9PT0gdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChDKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBcIkdhcmJhZ2UgY29sbGVjdGlvbiBza2lwcGVkOyBkaXNhYmxlZFwiKSwgXG4gICAgICAgIEF0LnJlc29sdmUoRXIpKSA6IHRoaXMuZ2V0Q2FjaGVTaXplKHQpLm5leHQoKG4gPT4gbiA8IHRoaXMucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgPyAoQyhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYEdhcmJhZ2UgY29sbGVjdGlvbiBza2lwcGVkOyBDYWNoZSBzaXplICR7bn0gaXMgbG93ZXIgdGhhbiB0aHJlc2hvbGQgJHt0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkfWApLCBcbiAgICAgICAgRXIpIDogdGhpcy5Vbih0LCBlKSkpO1xuICAgIH1cbiAgICBnZXRDYWNoZVNpemUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kbi5nZXRDYWNoZVNpemUodCk7XG4gICAgfVxuICAgIFVuKHQsIGUpIHtcbiAgICAgICAgbGV0IG4sIHMsIGksIHIsIG8sIGMsIGE7XG4gICAgICAgIGNvbnN0IGggPSBEYXRlLm5vdygpO1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxjdWxhdGVUYXJnZXRDb3VudCh0LCB0aGlzLnBhcmFtcy5wZXJjZW50aWxlVG9Db2xsZWN0KS5uZXh0KChlID0+IChcbiAgICAgICAgLy8gQ2FwIGF0IHRoZSBjb25maWd1cmVkIG1heFxuICAgICAgICBlID4gdGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCA/IChDKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgQ2FwcGluZyBzZXF1ZW5jZSBudW1iZXJzIHRvIGNvbGxlY3QgZG93biB0byB0aGUgbWF4aW11bSBvZiAke3RoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3R9IGZyb20gJHtlfWApLCBcbiAgICAgICAgcyA9IHRoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QpIDogcyA9IGUsIHIgPSBEYXRlLm5vdygpLCB0aGlzLm50aFNlcXVlbmNlTnVtYmVyKHQsIHMpKSkpLm5leHQoKHMgPT4gKG4gPSBzLCBcbiAgICAgICAgbyA9IERhdGUubm93KCksIHRoaXMucmVtb3ZlVGFyZ2V0cyh0LCBuLCBlKSkpKS5uZXh0KChlID0+IChpID0gZSwgYyA9IERhdGUubm93KCksIFxuICAgICAgICB0aGlzLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIG4pKSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKGEgPSBEYXRlLm5vdygpLCBTKCkgPD0gTG9nTGV2ZWwuREVCVUcpIHtcbiAgICAgICAgICAgICAgICBDKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgTFJVIEdhcmJhZ2UgQ29sbGVjdGlvblxcblxcdENvdW50ZWQgdGFyZ2V0cyBpbiAke3IgLSBofW1zXFxuXFx0RGV0ZXJtaW5lZCBsZWFzdCByZWNlbnRseSB1c2VkICR7c30gaW4gYCArIChvIC0gcikgKyBcIm1zXFxuXCIgKyBgXFx0UmVtb3ZlZCAke2l9IHRhcmdldHMgaW4gYCArIChjIC0gbykgKyBcIm1zXFxuXCIgKyBgXFx0UmVtb3ZlZCAke3R9IGRvY3VtZW50cyBpbiBgICsgKGEgLSBjKSArIFwibXNcXG5cIiArIGBUb3RhbCBEdXJhdGlvbjogJHthIC0gaH1tc2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIGRpZFJ1bjogITAsXG4gICAgICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXJzQ29sbGVjdGVkOiBzLFxuICAgICAgICAgICAgICAgIHRhcmdldHNSZW1vdmVkOiBpLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50c1JlbW92ZWQ6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFByb3ZpZGVzIExSVSBmdW5jdGlvbmFsaXR5IGZvciBJbmRleGVkREIgcGVyc2lzdGVuY2UuICovXG5jbGFzcyBMciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmRiID0gdCwgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBCcih0LCBlKTtcbiAgICAgICAgfSh0aGlzLCBlKTtcbiAgICB9XG4gICAgQm4odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5xbih0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5nZXRUYXJnZXRDb3VudCh0KS5uZXh0KCh0ID0+IGUubmV4dCgoZSA9PiB0ICsgZSkpKSk7XG4gICAgfVxuICAgIHFuKHQpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5Mbih0LCAodCA9PiB7XG4gICAgICAgICAgICBlKys7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgfVxuICAgIGZvckVhY2hUYXJnZXQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRUYXJnZXRDYWNoZSgpLmZvckVhY2hUYXJnZXQodCwgZSk7XG4gICAgfVxuICAgIExuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuS24odCwgKCh0LCBuKSA9PiBlKG4pKSk7XG4gICAgfVxuICAgIGFkZFJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBVcih0LCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIFVyKHQsIG4pO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5yZW1vdmVUYXJnZXRzKHQsIGUsIG4pO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBVcih0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGFueXRoaW5nIHdvdWxkIHByZXZlbnQgdGhpcyBkb2N1bWVudCBmcm9tIGJlaW5nIGdhcmJhZ2VcbiAgICAgKiBjb2xsZWN0ZWQsIGdpdmVuIHRoYXQgdGhlIGRvY3VtZW50IGluIHF1ZXN0aW9uIGlzIG5vdCBwcmVzZW50IGluIGFueVxuICAgICAqIHRhcmdldHMgYW5kIGhhcyBhIHNlcXVlbmNlIG51bWJlciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHVwcGVyIGJvdW5kIGZvclxuICAgICAqIHRoZSBjb2xsZWN0aW9uIHJ1bi5cbiAgICAgKi8gICAgR24odCwgZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgbGV0IG4gPSAhMTtcbiAgICAgICAgICAgIHJldHVybiBEcih0KS50dCgocyA9PiB2cih0LCBzLCBlKS5uZXh0KCh0ID0+ICh0ICYmIChuID0gITApLCBBdC5yZXNvbHZlKCF0KSkpKSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICAgICAgfSh0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkubmV3Q2hhbmdlQnVmZmVyKCksIHMgPSBbXTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5Lbih0LCAoKHIsIG8pID0+IHtcbiAgICAgICAgICAgIGlmIChvIDw9IGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5Hbih0LCByKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSBcbiAgICAgICAgICAgICAgICAgICAgLy8gT3VyIHNpemUgYWNjb3VudGluZyByZXF1aXJlcyB1cyB0byByZWFkIGFsbCBkb2N1bWVudHMgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIHRoZW0uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpKyssIG4uZ2V0RW50cnkodCwgcikubmV4dCgoKCkgPT4gKG4ucmVtb3ZlRW50cnkociwgc3QubWluKCkpLCBPcih0KS5kZWxldGUoWyAwLCByaShyLnBhdGgpIF0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBBdC53YWl0Rm9yKHMpKSkubmV4dCgoKCkgPT4gbi5hcHBseSh0KSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUud2l0aFNlcXVlbmNlTnVtYmVyKHQuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKHQsIG4pO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFVyKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXG4gICAgICovICAgIEtuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IE9yKHQpO1xuICAgICAgICBsZXQgcywgaSA9IE90LmF0O1xuICAgICAgICByZXR1cm4gbi5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50VGFyZ2V0c0luZGV4XCJcbiAgICAgICAgfSwgKChbdCwgbl0sIHtwYXRoOiByLCBzZXF1ZW5jZU51bWJlcjogb30pID0+IHtcbiAgICAgICAgICAgIDAgPT09IHQgPyAoXG4gICAgICAgICAgICAvLyBpZiBuZXh0VG9SZXBvcnQgaXMgdmFsaWQsIHJlcG9ydCBpdCwgdGhpcyBpcyBhIG5ldyBrZXkgc28gdGhlXG4gICAgICAgICAgICAvLyBsYXN0IG9uZSBtdXN0IG5vdCBiZSBhIG1lbWJlciBvZiBhbnkgdGFyZ2V0cy5cbiAgICAgICAgICAgIGkgIT09IE90LmF0ICYmIGUobmV3IGN0KGNpKHMpKSwgaSksIFxuICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSB0aGlzIHNlcXVlbmNlIG51bWJlci4gSXQncyB0aGUgbmV4dCBvbmUgd2VcbiAgICAgICAgICAgIC8vIG1pZ2h0IHJlcG9ydCwgaWYgd2UgZG9uJ3QgZmluZCBhbnkgdGFyZ2V0cyBmb3IgdGhpcyBkb2N1bWVudC5cbiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgc2VxdWVuY2UgbnVtYmVyIG11c3QgYmUgZGVmaW5lZCB3aGVuIHRoZSB0YXJnZXRJZFxuICAgICAgICAgICAgLy8gaXMgMC5cbiAgICAgICAgICAgIGkgPSBvLCBzID0gcikgOiBcbiAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgaW52YWxpZCwgd2Uga25vdyB3ZSBkb24ndCBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgLy8gdGhpcyBvbmUgc2luY2Ugd2UgZm91bmQgYSB0YXJnZXQgZm9yIGl0LlxuICAgICAgICAgICAgaSA9IE90LmF0O1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cbiAgICAgICAgICAgIGkgIT09IE90LmF0ICYmIGUobmV3IGN0KGNpKHMpKSwgaSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0Q2FjaGVTaXplKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLmdldFNpemUodCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBVcih0LCBlKSB7XG4gICAgcmV0dXJuIE9yKHQpLnB1dChcbiAgICAvKipcbiAqIEByZXR1cm5zIEEgdmFsdWUgc3VpdGFibGUgZm9yIHdyaXRpbmcgYSBzZW50aW5lbCByb3cgaW4gdGhlIHRhcmdldC1kb2N1bWVudFxuICogc3RvcmUuXG4gKi9cbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0YXJnZXRJZDogMCxcbiAgICAgICAgICAgIHBhdGg6IHJpKHQucGF0aCksXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogZVxuICAgICAgICB9O1xuICAgIH0oZSwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGJ1ZmZlciBvZiBlbnRyaWVzIHRvIGJlIHdyaXR0ZW4gdG8gYSBSZW1vdGVEb2N1bWVudENhY2hlLlxuICogSXQgY2FuIGJlIHVzZWQgdG8gYmF0Y2ggdXAgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSB3cml0dGVuIHRvIHRoZSBjYWNoZSwgYnV0XG4gKiBhZGRpdGlvbmFsbHkgc3VwcG9ydHMgcmVhZGluZyBlbnRyaWVzIGJhY2sgd2l0aCB0aGUgYGdldEVudHJ5KClgIG1ldGhvZCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlIGlmIG5vIGVudHJ5IGlzXG4gKiBidWZmZXJlZC5cbiAqXG4gKiBFbnRyaWVzIGFkZGVkIHRvIHRoZSBjYWNoZSAqbXVzdCogYmUgcmVhZCBmaXJzdC4gVGhpcyBpcyB0byBmYWNpbGl0YXRlXG4gKiBjYWxjdWxhdGluZyB0aGUgc2l6ZSBkZWx0YSBvZiB0aGUgcGVuZGluZyBjaGFuZ2VzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBjbGFzcyB3YXMgaW1wbGVtZW50ZWQgdGhlbiByZW1vdmVkIGZyb20gb3RoZXIgcGxhdGZvcm1zLlxuICogSWYgYnl0ZS1jb3VudGluZyBlbmRzIHVwIGJlaW5nIG5lZWRlZCBvbiB0aGUgb3RoZXIgcGxhdGZvcm1zLCBjb25zaWRlclxuICogcG9ydGluZyB0aGlzIGNsYXNzIGFzIHBhcnQgb2YgdGhhdCBpbXBsZW1lbnRhdGlvbiB3b3JrLlxuICovIGNsYXNzIHFyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleSB0byB0aGUgbmV3IGNhY2hlIGVudHJ5IHRoYXQgc2hvdWxkIGJlIHdyaXR0ZW4uXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IG5ldyBlcygodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IG1vZGlmeSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgYWRkRW50cnkodCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LmtleSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5yZW1vdmVFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IHJlbW92ZSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LCBTZS5uZXdJbnZhbGlkRG9jdW1lbnQodCkuc2V0UmVhZFRpbWUoZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuIFRoZSBidWZmZXJlZCBjaGFuZ2VzIHdpbGwgZmlyc3QgYmUgY2hlY2tlZCxcbiAgICAgKiBhbmQgaWYgbm8gYnVmZmVyZWQgY2hhbmdlIGFwcGxpZXMsIHRoaXMgd2lsbCBmb3J3YXJkIHRvXG4gICAgICogYFJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgdHJhbnNhY3Rpb24gaW4gd2hpY2ggdG8gcGVyZm9ybSBhbnkgcGVyc2lzdGVuY2VcbiAgICAgKiAgICAgb3BlcmF0aW9ucy5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgLSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgZG9jdW1lbnQgb3IgYW4gaW52YWxpZCBkb2N1bWVudCBpZiB3ZSBoYXZlIG5vdGhpbmdcbiAgICAgKiBjYWNoZWQuXG4gICAgICovICAgIGdldEVudHJ5KHQsIGUpIHtcbiAgICAgICAgdGhpcy5hc3NlcnROb3RBcHBsaWVkKCk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmNoYW5nZXMuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBuID8gQXQucmVzb2x2ZShuKSA6IHRoaXMuZ2V0RnJvbUNhY2hlKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBzZXZlcmFsIGVudHJpZXMgaW4gdGhlIGNhY2hlLCBmb3J3YXJkaW5nIHRvXG4gICAgICogYFJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgdHJhbnNhY3Rpb24gaW4gd2hpY2ggdG8gcGVyZm9ybSBhbnkgcGVyc2lzdGVuY2VcbiAgICAgKiAgICAgb3BlcmF0aW9ucy5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXlzIC0gVGhlIGtleXMgb2YgdGhlIGVudHJpZXMgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBIG1hcCBvZiBjYWNoZWQgZG9jdW1lbnRzLCBpbmRleGVkIGJ5IGtleS4gSWYgYW4gZW50cnkgY2Fubm90IGJlXG4gICAgICogICAgIGZvdW5kLCB0aGUgY29ycmVzcG9uZGluZyBrZXkgd2lsbCBiZSBtYXBwZWQgdG8gYW4gaW52YWxpZCBkb2N1bWVudC5cbiAgICAgKi8gICAgZ2V0RW50cmllcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbEZyb21DYWNoZSh0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBidWZmZXJlZCBjaGFuZ2VzIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUsIHVzaW5nXG4gICAgICogdGhlIHByb3ZpZGVkIHRyYW5zYWN0aW9uLlxuICAgICAqLyAgICBhcHBseSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzQXBwbGllZCA9ICEwLCB0aGlzLmFwcGx5Q2hhbmdlcyh0KTtcbiAgICB9XG4gICAgLyoqIEhlbHBlciB0byBhc3NlcnQgdGhpcy5jaGFuZ2VzIGlzIG5vdCBudWxsICAqLyAgICBhc3NlcnROb3RBcHBsaWVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIFJlbW90ZURvY3VtZW50Q2FjaGUgZm9yIEluZGV4ZWREYi4gVG8gY29uc3RydWN0LCBpbnZva2VcbiAqIGBuZXdJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlKClgLlxuICovIGNsYXNzIEtyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuSXQgPSB0O1xuICAgIH1cbiAgICBzZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJpZXMgdG8gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGBhZGRFbnRyeWAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYCB0byBlbnN1cmUgcHJvcGVyIGFjY291bnRpbmcgb2YgbWV0YWRhdGEuXG4gICAgICovICAgIGFkZEVudHJ5KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIFdyKHQpLnB1dChuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIGRvY3VtZW50IGZyb20gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGByZW1vdmVFbnRyeWAgIGFyZSByZXF1aXJlZCB0byBnbyB0aHJvdWdoIHRoZSBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlclxuICAgICAqIHJldHVybmVkIGJ5IGBuZXdDaGFuZ2VCdWZmZXIoKWAgdG8gZW5zdXJlIHByb3BlciBhY2NvdW50aW5nIG9mIG1ldGFkYXRhLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBXcih0KS5kZWxldGUoXG4gICAgICAgIC8qKlxuICogUmV0dXJucyBhIGtleSB0aGF0IGNhbiBiZSB1c2VkIGZvciBkb2N1bWVudCBsb29rdXBzIHZpYSB0aGUgcHJpbWFyeSBrZXkgb2ZcbiAqIHRoZSBEYlJlbW90ZURvY3VtZW50IG9iamVjdCBzdG9yZS5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5wYXRoLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIHJldHVybiBbIFxuICAgICAgICAgICAgLyogcHJlZml4IHBhdGggKi8gbi5zbGljZSgwLCBuLmxlbmd0aCAtIDIpLCBcbiAgICAgICAgICAgIC8qIGNvbGxlY3Rpb24gaWQgKi8gbltuLmxlbmd0aCAtIDJdLCBVaShlKSwgXG4gICAgICAgICAgICAvKiBkb2N1bWVudCBpZCAqLyBuW24ubGVuZ3RoIC0gMV0gXTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJldHVybnMgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZG9jdW1lbnQgbG9va3VwcyBvbiB0aGVcbiAqIGBEYlJlbW90ZURvY3VtZW50RG9jdW1lbnRDb2xsZWN0aW9uR3JvdXBJbmRleGAgaW5kZXguXG4gKi8gKGUsIG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgY3VycmVudCBjYWNoZSBzaXplLlxuICAgICAqXG4gICAgICogQ2FsbGVycyB0byBgYWRkRW50cnkoKWAgYW5kIGByZW1vdmVFbnRyeSgpYCAqbXVzdCogY2FsbCB0aGlzIGFmdGVyd2FyZHMgdG8gdXBkYXRlIHRoZVxuICAgICAqIGNhY2hlJ3MgbWV0YWRhdGEuXG4gICAgICovICAgIHVwZGF0ZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWV0YWRhdGEodCkubmV4dCgobiA9PiAobi5ieXRlU2l6ZSArPSBlLCB0aGlzLlFuKHQsIG4pKSkpO1xuICAgIH1cbiAgICBnZXRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gU2UubmV3SW52YWxpZERvY3VtZW50KGUpO1xuICAgICAgICByZXR1cm4gV3IodCkuWih7XG4gICAgICAgICAgICBpbmRleDogXCJkb2N1bWVudEtleUluZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2Uub25seSh6cihlKSlcbiAgICAgICAgfSwgKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBuID0gdGhpcy5qbihlLCBzKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9va3MgdXAgYW4gZW50cnkgaW4gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IC0gVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBUaGUgY2FjaGVkIGRvY3VtZW50IGVudHJ5IGFuZCBpdHMgc2l6ZS5cbiAgICAgKi8gICAgV24odCwgZSkge1xuICAgICAgICBsZXQgbiA9IHtcbiAgICAgICAgICAgIHNpemU6IDAsXG4gICAgICAgICAgICBkb2N1bWVudDogU2UubmV3SW52YWxpZERvY3VtZW50KGUpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBXcih0KS5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5vbmx5KHpyKGUpKVxuICAgICAgICB9LCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMuam4oZSwgcyksXG4gICAgICAgICAgICAgICAgc2l6ZTogYnIocylcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIGdldEVudHJpZXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IHNzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnpuKHQsIGUsICgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuam4odCwgZSk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgcyk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXlzIC0gVGhlIHNldCBvZiBrZXlzIGVudHJpZXMgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBIG1hcCBvZiBkb2N1bWVudHMgaW5kZXhlZCBieSBrZXkgYW5kIGEgbWFwIG9mIHNpemVzIGluZGV4ZWQgYnlcbiAgICAgKiAgICAga2V5ICh6ZXJvIGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCkuXG4gICAgICovICAgIEhuKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBzcygpLCBzID0gbmV3IEJ0KGN0LmNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gdGhpcy56bih0LCBlLCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmpuKHQsIGUpO1xuICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KHQsIGkpLCBzID0gcy5pbnNlcnQodCwgYnIoZSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHtcbiAgICAgICAgICAgIGRvY3VtZW50czogbixcbiAgICAgICAgICAgIEpuOiBzXG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIHpuKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKGUuaXNFbXB0eSgpKSByZXR1cm4gQXQucmVzb2x2ZSgpO1xuICAgICAgICBsZXQgcyA9IG5ldyBxdChKcik7XG4gICAgICAgIGUuZm9yRWFjaCgodCA9PiBzID0gcy5hZGQodCkpKTtcbiAgICAgICAgY29uc3QgaSA9IElEQktleVJhbmdlLmJvdW5kKHpyKHMuZmlyc3QoKSksIHpyKHMubGFzdCgpKSksIHIgPSBzLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGxldCBvID0gci5nZXROZXh0KCk7XG4gICAgICAgIHJldHVybiBXcih0KS5aKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBpXG4gICAgICAgIH0sICgodCwgZSwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGN0LmZyb21TZWdtZW50cyhbIC4uLmUucHJlZml4UGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIGUuZG9jdW1lbnRJZCBdKTtcbiAgICAgICAgICAgIC8vIEdvIHRocm91Z2gga2V5cyBub3QgZm91bmQgaW4gY2FjaGUuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKDtvICYmIEpyKG8sIGkpIDwgMDsgKSBuKG8sIG51bGwpLCBvID0gci5nZXROZXh0KCk7XG4gICAgICAgICAgICBvICYmIG8uaXNFcXVhbChpKSAmJiAoXG4gICAgICAgICAgICAvLyBLZXkgZm91bmQgaW4gY2FjaGUuXG4gICAgICAgICAgICBuKG8sIGUpLCBvID0gci5oYXNOZXh0KCkgPyByLmdldE5leHQoKSA6IG51bGwpLCBcbiAgICAgICAgICAgIC8vIFNraXAgdG8gdGhlIG5leHQga2V5IChpZiB0aGVyZSBpcyBvbmUpLlxuICAgICAgICAgICAgbyA/IHMuaih6cihvKSkgOiBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIFRoZSByZXN0IG9mIHRoZSBrZXlzIGFyZSBub3QgaW4gdGhlIGNhY2hlLiBPbmUgY2FzZSB3aGVyZSBgaXRlcmF0ZWBcbiAgICAgICAgICAgIC8vIGFib3ZlIHdvbid0IGdvIHRocm91Z2ggdGhlbSBpcyB3aGVuIHRoZSBjYWNoZSBpcyBlbXB0eS5cbiAgICAgICAgICAgIGZvciAoO287ICkgbihvLCBudWxsKSwgbyA9IHIuaGFzTmV4dCgpID8gci5nZXROZXh0KCkgOiBudWxsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21Db2xsZWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFsgZS5wb3BMYXN0KCkudG9BcnJheSgpLCBlLmxhc3RTZWdtZW50KCksIFVpKG4ucmVhZFRpbWUpLCBuLmRvY3VtZW50S2V5LnBhdGguaXNFbXB0eSgpID8gXCJcIiA6IG4uZG9jdW1lbnRLZXkucGF0aC5sYXN0U2VnbWVudCgpIF0sIGkgPSBbIGUucG9wTGFzdCgpLnRvQXJyYXkoKSwgZS5sYXN0U2VnbWVudCgpLCBbIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSLCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiBdLCBcIlwiIF07XG4gICAgICAgIHJldHVybiBXcih0KS5XKElEQktleVJhbmdlLmJvdW5kKHMsIGksICEwKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IHNzKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmpuKGN0LmZyb21TZWdtZW50cyhuLnByZWZpeFBhdGguY29uY2F0KG4uY29sbGVjdGlvbkdyb3VwLCBuLmRvY3VtZW50SWQpKSwgbik7XG4gICAgICAgICAgICAgICAgZSA9IGUuaW5zZXJ0KHQua2V5LCB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICBsZXQgaSA9IHNzKCk7XG4gICAgICAgIGNvbnN0IHIgPSBIcihlLCBuKSwgbyA9IEhyKGUsIHl0Lm1heCgpKTtcbiAgICAgICAgcmV0dXJuIFdyKHQpLlooe1xuICAgICAgICAgICAgaW5kZXg6IFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5ib3VuZChyLCBvLCAhMClcbiAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gdGhpcy5qbihjdC5mcm9tU2VnbWVudHMoZS5wcmVmaXhQYXRoLmNvbmNhdChlLmNvbGxlY3Rpb25Hcm91cCwgZS5kb2N1bWVudElkKSksIGUpO1xuICAgICAgICAgICAgaSA9IGkuaW5zZXJ0KHIua2V5LCByKSwgaS5zaXplID09PSBzICYmIG4uZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBuZXdDaGFuZ2VCdWZmZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IFFyKHRoaXMsICEhdCAmJiB0LnRyYWNrUmVtb3ZhbHMpO1xuICAgIH1cbiAgICBnZXRTaXplKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWV0YWRhdGEodCkubmV4dCgodCA9PiB0LmJ5dGVTaXplKSk7XG4gICAgfVxuICAgIGdldE1ldGFkYXRhKHQpIHtcbiAgICAgICAgcmV0dXJuIGpyKHQpLmdldChcInJlbW90ZURvY3VtZW50R2xvYmFsS2V5XCIpLm5leHQoKHQgPT4gKE0oISF0KSwgdCkpKTtcbiAgICB9XG4gICAgUW4odCwgZSkge1xuICAgICAgICByZXR1cm4ganIodCkucHV0KFwicmVtb3RlRG9jdW1lbnRHbG9iYWxLZXlcIiwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlY29kZXMgYGRiUmVtb3RlRG9jYCBhbmQgcmV0dXJucyB0aGUgZG9jdW1lbnQgKG9yIGFuIGludmFsaWQgZG9jdW1lbnQgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgY29ycmVzcG9uZHMgdG8gdGhlIGZvcm1hdCB1c2VkIGZvciBzZW50aW5lbCBkZWxldGVzKS5cbiAgICAgKi8gICAgam4odCwgZSkge1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IEJpKHRoaXMuSXQsIGUpO1xuICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgYSBzZW50aW5lbCByZW1vdmFsIGFuZCBzaG91bGQgb25seSBiZSB1c2VkIGluIHRoZVxuICAgICAgICAgICAgLy8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodC5pc05vRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChzdC5taW4oKSkpKSByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU2UubmV3SW52YWxpZERvY3VtZW50KHQpO1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS4gKi8gZnVuY3Rpb24gR3IodCkge1xuICAgIHJldHVybiBuZXcgS3IodCk7XG59XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBVbmxpa2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLCB0aGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGNvbXB1dGVzIHRoZSBzaXplXG4gKiBkZWx0YSBmb3IgYWxsIHN1Ym1pdHRlZCBjaGFuZ2VzLiBUaGlzIGF2b2lkcyBoYXZpbmcgdG8gcmUtcmVhZCBhbGwgZG9jdW1lbnRzIGZyb20gSW5kZXhlZERiXG4gKiB3aGVuIHdlIGFwcGx5IHRoZSBjaGFuZ2VzLlxuICovIGNsYXNzIFFyIGV4dGVuZHMgcXIge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudENhY2hlIC0gVGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgdG8gYXBwbHkgdGhlIGNoYW5nZXMgdG8uXG4gICAgICogQHBhcmFtIHRyYWNrUmVtb3ZhbHMgLSBXaGV0aGVyIHRvIGNyZWF0ZSBzZW50aW5lbCBkZWxldGVzIHRoYXQgY2FuIGJlIHRyYWNrZWQgYnlcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5ZbiA9IHQsIHRoaXMudHJhY2tSZW1vdmFscyA9IGUsIFxuICAgICAgICAvLyBBIG1hcCBvZiBkb2N1bWVudCBzaXplcyBhbmQgcmVhZCB0aW1lcyBwcmlvciB0byBhcHBseWluZyB0aGUgY2hhbmdlcyBpblxuICAgICAgICAvLyB0aGlzIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5YbiA9IG5ldyBlcygodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xuICAgIH1cbiAgICBhcHBseUNoYW5nZXModCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGxldCBuID0gMCwgcyA9IG5ldyBxdCgoKHQsIGUpID0+IFoodC5jYW5vbmljYWxTdHJpbmcoKSwgZS5jYW5vbmljYWxTdHJpbmcoKSkpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgoaSwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuWG4uZ2V0KGkpO1xuICAgICAgICAgICAgaWYgKGUucHVzaCh0aGlzLlluLnJlbW92ZUVudHJ5KHQsIGksIG8ucmVhZFRpbWUpKSwgci5pc1ZhbGlkRG9jdW1lbnQoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBMaSh0aGlzLlluLkl0LCByKTtcbiAgICAgICAgICAgICAgICBzID0gcy5hZGQoaS5wYXRoLnBvcExhc3QoKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGJyKHUpO1xuICAgICAgICAgICAgICAgIG4gKz0gYyAtIG8uc2l6ZSwgZS5wdXNoKHRoaXMuWW4uYWRkRW50cnkodCwgaSwgdSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuIC09IG8uc2l6ZSwgdGhpcy50cmFja1JlbW92YWxzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gdHJhY2sgcmVtb3ZhbHMsIHdlIHN0b3JlIGEgXCJzZW50aW5lbCBkZWxldGVcIiBpbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBSZW1vdGVEb2N1bWVudENhY2hlLiBUaGlzIGVudHJ5IGlzIHJlcHJlc2VudGVkIGJ5IGEgTm9Eb2N1bWVudFxuICAgICAgICAgICAgICAgIC8vIHdpdGggYSB2ZXJzaW9uIG9mIDAgYW5kIGlnbm9yZWQgYnkgYG1heWJlRGVjb2RlRG9jdW1lbnQoKWAgYnV0XG4gICAgICAgICAgICAgICAgLy8gcHJlc2VydmVkIGluIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IExpKHRoaXMuWW4uSXQsIHIuY29udmVydFRvTm9Eb2N1bWVudChzdC5taW4oKSkpO1xuICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLlluLmFkZEVudHJ5KHQsIGksIG4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCBzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHRoaXMuWW4uaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4pKTtcbiAgICAgICAgfSkpLCBlLnB1c2godGhpcy5Zbi51cGRhdGVNZXRhZGF0YSh0LCBuKSksIEF0LndhaXRGb3IoZSk7XG4gICAgfVxuICAgIGdldEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGUgYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuWW4uV24odCwgZSkubmV4dCgodCA9PiAodGhpcy5Ybi5zZXQoZSwge1xuICAgICAgICAgICAgc2l6ZTogdC5zaXplLFxuICAgICAgICAgICAgcmVhZFRpbWU6IHQuZG9jdW1lbnQucmVhZFRpbWVcbiAgICAgICAgfSksIHQuZG9jdW1lbnQpKSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGVcbiAgICAgICAgLy8gYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuWW4uSG4odCwgZSkubmV4dCgoKHtkb2N1bWVudHM6IHQsIEpuOiBlfSkgPT4gKFxuICAgICAgICAvLyBOb3RlOiBgZ2V0QWxsRnJvbUNhY2hlYCByZXR1cm5zIHR3byBtYXBzIGluc3RlYWQgb2YgYSBzaW5nbGUgbWFwIGZyb21cbiAgICAgICAgLy8ga2V5cyB0byBgRG9jdW1lbnRTaXplRW50cnlgcy4gVGhpcyBpcyB0byBhbGxvdyByZXR1cm5pbmcgdGhlXG4gICAgICAgIC8vIGBNdXRhYmxlRG9jdW1lbnRNYXBgIGRpcmVjdGx5LCB3aXRob3V0IGEgY29udmVyc2lvbi5cbiAgICAgICAgZS5mb3JFYWNoKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5Ybi5zZXQoZSwge1xuICAgICAgICAgICAgICAgIHNpemU6IG4sXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IHQuZ2V0KGUpLnJlYWRUaW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpLCB0KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24ganIodCkge1xuICAgIHJldHVybiBOaSh0LCBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcmVtb3RlRG9jdW1lbnRzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBXcih0KSB7XG4gICAgcmV0dXJuIE5pKHQsIFwicmVtb3RlRG9jdW1lbnRzVjE0XCIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZG9jdW1lbnQgbG9va3VwcyBvbiB0aGVcbiAqIGBEYlJlbW90ZURvY3VtZW50RG9jdW1lbnRLZXlJbmRleGAgaW5kZXguXG4gKi8gZnVuY3Rpb24genIodCkge1xuICAgIGNvbnN0IGUgPSB0LnBhdGgudG9BcnJheSgpO1xuICAgIHJldHVybiBbIFxuICAgIC8qIHByZWZpeCBwYXRoICovIGUuc2xpY2UoMCwgZS5sZW5ndGggLSAyKSwgXG4gICAgLyogY29sbGVjdGlvbiBpZCAqLyBlW2UubGVuZ3RoIC0gMl0sIFxuICAgIC8qIGRvY3VtZW50IGlkICovIGVbZS5sZW5ndGggLSAxXSBdO1xufVxuXG5mdW5jdGlvbiBIcih0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUuZG9jdW1lbnRLZXkucGF0aC50b0FycmF5KCk7XG4gICAgcmV0dXJuIFsgXG4gICAgLyogY29sbGVjdGlvbiBpZCAqLyB0LCBVaShlLnJlYWRUaW1lKSwgXG4gICAgLyogcHJlZml4IHBhdGggKi8gbi5zbGljZSgwLCBuLmxlbmd0aCAtIDIpLCBcbiAgICAvKiBkb2N1bWVudCBpZCAqLyBuLmxlbmd0aCA+IDAgPyBuW24ubGVuZ3RoIC0gMV0gOiBcIlwiIF07XG59XG5cbi8qKlxuICogQ29tcGFyYXRvciB0aGF0IGNvbXBhcmVzIGRvY3VtZW50IGtleXMgYWNjb3JkaW5nIHRvIHRoZSBwcmltYXJ5IGtleSBzb3J0aW5nXG4gKiB1c2VkIGJ5IHRoZSBgRGJSZW1vdGVEb2N1bWVudERvY3VtZW50YCBzdG9yZSAoYnkgcHJlZml4IHBhdGgsIGNvbGxlY3Rpb24gaWRcbiAqIGFuZCB0aGVuIGRvY3VtZW50IElEKS5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovIGZ1bmN0aW9uIEpyKHQsIGUpIHtcbiAgICBjb25zdCBuID0gdC5wYXRoLnRvQXJyYXkoKSwgcyA9IGUucGF0aC50b0FycmF5KCk7XG4gICAgLy8gVGhlIG9yZGVyaW5nIGlzIGJhc2VkIG9uIGh0dHBzOi8vY2hyb21pdW0uZ29vZ2xlc291cmNlLmNvbS9jaHJvbWl1bS9ibGluay8rL2ZlNWMyMWZlZjk0ZGFlNzFjMWMzMzQ0Nzc1YjhkOGE3ZjdlNmQ5ZWMvU291cmNlL21vZHVsZXMvaW5kZXhlZGRiL0lEQktleS5jcHAjNzRcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCBuLmxlbmd0aCAtIDIgJiYgdCA8IHMubGVuZ3RoIC0gMjsgKyt0KSBpZiAoaSA9IFooblt0XSwgc1t0XSksIFxuICAgIGkpIHJldHVybiBpO1xuICAgIHJldHVybiBpID0gWihuLmxlbmd0aCwgcy5sZW5ndGgpLCBpIHx8IChpID0gWihuW24ubGVuZ3RoIC0gMl0sIHNbcy5sZW5ndGggLSAyXSksIFxuICAgIGkgfHwgWihuW24ubGVuZ3RoIC0gMV0sIHNbcy5sZW5ndGggLSAxXSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTY2hlbWEgVmVyc2lvbiBmb3IgdGhlIFdlYiBjbGllbnQ6XG4gKiAxLiAgSW5pdGlhbCB2ZXJzaW9uIGluY2x1ZGluZyBNdXRhdGlvbiBRdWV1ZSwgUXVlcnkgQ2FjaGUsIGFuZCBSZW1vdGVcbiAqICAgICBEb2N1bWVudCBDYWNoZVxuICogMi4gIFVzZWQgdG8gZW5zdXJlIGEgdGFyZ2V0R2xvYmFsIG9iamVjdCBleGlzdHMgYW5kIGFkZCB0YXJnZXRDb3VudCB0byBpdC4gTm9cbiAqICAgICBsb25nZXIgcmVxdWlyZWQgYmVjYXVzZSBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxuICogMy4gIERyb3BwZWQgYW5kIHJlLWNyZWF0ZWQgUXVlcnkgQ2FjaGUgdG8gZGVhbCB3aXRoIGNhY2hlIGNvcnJ1cHRpb24gcmVsYXRlZFxuICogICAgIHRvIGxpbWJvIHJlc29sdXRpb24uIEFkZHJlc3Nlc1xuICogICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1pb3Mtc2RrL2lzc3Vlcy8xNTQ4XG4gKiA0LiAgTXVsdGktVGFiIFN1cHBvcnQuXG4gKiA1LiAgUmVtb3ZhbCBvZiBoZWxkIHdyaXRlIGFja3MuXG4gKiA2LiAgQ3JlYXRlIGRvY3VtZW50IGdsb2JhbCBmb3IgdHJhY2tpbmcgZG9jdW1lbnQgY2FjaGUgc2l6ZS5cbiAqIDcuICBFbnN1cmUgZXZlcnkgY2FjaGVkIGRvY3VtZW50IGhhcyBhIHNlbnRpbmVsIHJvdyB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLlxuICogOC4gIEFkZCBjb2xsZWN0aW9uLXBhcmVudCBpbmRleCBmb3IgQ29sbGVjdGlvbiBHcm91cCBxdWVyaWVzLlxuICogOS4gIENoYW5nZSBSZW1vdGVEb2N1bWVudENoYW5nZXMgc3RvcmUgdG8gYmUga2V5ZWQgYnkgcmVhZFRpbWUgcmF0aGVyIHRoYW5cbiAqICAgICBhbiBhdXRvLWluY3JlbWVudGluZyBJRC4gVGhpcyBpcyByZXF1aXJlZCBmb3IgSW5kZXgtRnJlZSBxdWVyaWVzLlxuICogMTAuIFJld3JpdGUgdGhlIGNhbm9uaWNhbCBJRHMgdG8gdGhlIGV4cGxpY2l0IFByb3RvYnVmLWJhc2VkIGZvcm1hdC5cbiAqIDExLiBBZGQgYnVuZGxlcyBhbmQgbmFtZWRfcXVlcmllcyBmb3IgYnVuZGxlIHN1cHBvcnQuXG4gKiAxMi4gQWRkIGRvY3VtZW50IG92ZXJsYXlzLlxuICogMTMuIFJld3JpdGUgdGhlIGtleXMgb2YgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSB0byBhbGxvdyBmb3IgZWZmaWNpZW50XG4gKiAgICAgZG9jdW1lbnQgbG9va3VwIHZpYSBgZ2V0QWxsKClgLlxuICogMTQuIEFkZCBvdmVybGF5cy5cbiAqIDE1LiBBZGQgaW5kZXhpbmcgc3VwcG9ydC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsIHZpZXcgKG92ZXJsYXkpIG9mIGEgZG9jdW1lbnQsIGFuZCB0aGUgZmllbGRzIHRoYXQgYXJlXG4gKiBsb2NhbGx5IG11dGF0ZWQuXG4gKi9cbmNsYXNzIFlyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgZmllbGRzIHRoYXQgYXJlIGxvY2FsbHkgbXV0YXRlZCBieSBwYXRjaCBtdXRhdGlvbnMuIElmIHRoZSBvdmVybGF5ZWRcbiAgICAgKiBkb2N1bWVudCBpcyBmcm9tIHNldCBvciBkZWxldGUgbXV0YXRpb25zLCB0aGlzIHJldHVybnMgbnVsbC5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMub3ZlcmxheWVkRG9jdW1lbnQgPSB0LCB0aGlzLm11dGF0ZWRGaWVsZHMgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWFkb25seSB2aWV3IG9mIHRoZSBsb2NhbCBzdGF0ZSBvZiBhbGwgZG9jdW1lbnRzIHdlJ3JlIHRyYWNraW5nIChpLmUuIHdlXG4gKiBoYXZlIGEgY2FjaGVkIHZlcnNpb24gaW4gcmVtb3RlRG9jdW1lbnRDYWNoZSBvciBsb2NhbCBtdXRhdGlvbnMgZm9yIHRoZVxuICogZG9jdW1lbnQpLiBUaGUgdmlldyBpcyBjb21wdXRlZCBieSBhcHBseWluZyB0aGUgbXV0YXRpb25zIGluIHRoZVxuICogTXV0YXRpb25RdWV1ZSB0byB0aGUgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqLyBjbGFzcyBYciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSB0LCB0aGlzLm11dGF0aW9uUXVldWUgPSBlLCB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlID0gbiwgXG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBpZGVudGlmaWVkIGJ5IGBrZXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgTG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnQgb3IgbnVsbCBpZiB3ZSBkb24ndCBoYXZlIGFueSBjYWNoZWRcbiAgICAgKiBzdGF0ZSBmb3IgaXQuXG4gICAgICovICAgIGdldERvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBudWxsO1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZS5nZXRPdmVybGF5KHQsIGUpLm5leHQoKHMgPT4gKG4gPSBzLCB0aGlzLmdldEJhc2VEb2N1bWVudCh0LCBlLCBuKSkpKS5uZXh0KCh0ID0+IChudWxsICE9PSBuICYmIExuKG4ubXV0YXRpb24sIHQsIFF0LmVtcHR5KCksIG50Lm5vdygpKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50cyBpZGVudGlmaWVkIGJ5IGBrZXlzYC5cbiAgICAgKlxuICAgICAqIElmIHdlIGRvbid0IGhhdmUgY2FjaGVkIHN0YXRlIGZvciBhIGRvY3VtZW50IGluIGBrZXlzYCwgYSBOb0RvY3VtZW50IHdpbGxcbiAgICAgKiBiZSBzdG9yZWQgZm9yIHRoYXQga2V5IGluIHRoZSByZXN1bHRpbmcgc2V0LlxuICAgICAqLyAgICBnZXREb2N1bWVudHModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldEVudHJpZXModCwgZSkubmV4dCgoZSA9PiB0aGlzLmdldExvY2FsVmlld09mRG9jdW1lbnRzKHQsIGUsIGZzKCkpLm5leHQoKCgpID0+IGUpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTaW1pbGFyIHRvIGBnZXREb2N1bWVudHNgLCBidXQgY3JlYXRlcyB0aGUgbG9jYWwgdmlldyBmcm9tIHRoZSBnaXZlblxuICAgICAqIGBiYXNlRG9jc2Agd2l0aG91dCByZXRyaWV2aW5nIGRvY3VtZW50cyBmcm9tIHRoZSBsb2NhbCBzdG9yZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiB0aGlzIG9wZXJhdGlvbiBpcyBzY29wZWQgdG8uXG4gICAgICogQHBhcmFtIGRvY3MgLSBUaGUgZG9jdW1lbnRzIHRvIGFwcGx5IGxvY2FsIG11dGF0aW9ucyB0byBnZXQgdGhlIGxvY2FsIHZpZXdzLlxuICAgICAqIEBwYXJhbSBleGlzdGVuY2VTdGF0ZUNoYW5nZWQgLSBUaGUgc2V0IG9mIGRvY3VtZW50IGtleXMgd2hvc2UgZXhpc3RlbmNlIHN0YXRlXG4gICAgICogICBpcyBjaGFuZ2VkLiBUaGlzIGlzIHVzZWZ1bCB0byBkZXRlcm1pbmUgaWYgc29tZSBkb2N1bWVudHMgb3ZlcmxheSBuZWVkc1xuICAgICAqICAgdG8gYmUgcmVjYWxjdWxhdGVkLlxuICAgICAqLyAgICBnZXRMb2NhbFZpZXdPZkRvY3VtZW50cyh0LCBlLCBuID0gZnMoKSkge1xuICAgICAgICBjb25zdCBzID0gdXMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGVPdmVybGF5cyh0LCBzLCBlKS5uZXh0KCgoKSA9PiB0aGlzLmNvbXB1dGVWaWV3cyh0LCBlLCBzLCBuKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGxldCBlID0gcnMoKTtcbiAgICAgICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZSA9IGUuaW5zZXJ0KHQsIG4ub3ZlcmxheWVkRG9jdW1lbnQpO1xuICAgICAgICAgICAgfSkpLCBlO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb3ZlcmxheWVkIGRvY3VtZW50cyBmb3IgdGhlIGdpdmVuIGRvY3VtZW50IG1hcCwgd2hpY2ggd2lsbCBpbmNsdWRlXG4gICAgICogdGhlIGxvY2FsIHZpZXcgb2YgdGhvc2UgZG9jdW1lbnRzIGFuZCBhIGBGaWVsZE1hc2tgIGluZGljYXRpbmcgd2hpY2ggZmllbGRzXG4gICAgICogYXJlIG11dGF0ZWQgbG9jYWxseSwgYG51bGxgIGlmIG92ZXJsYXkgaXMgYSBTZXQgb3IgRGVsZXRlIG11dGF0aW9uLlxuICAgICAqLyAgICBnZXRPdmVybGF5ZWREb2N1bWVudHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdXMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGVPdmVybGF5cyh0LCBuLCBlKS5uZXh0KCgoKSA9PiB0aGlzLmNvbXB1dGVWaWV3cyh0LCBlLCBuLCBmcygpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGZXRjaGVzIHRoZSBvdmVybGF5cyBmb3Ige0Bjb2RlIGRvY3N9IGFuZCBhZGRzIHRoZW0gdG8gcHJvdmlkZWQgb3ZlcmxheSBtYXBcbiAgICAgKiBpZiB0aGUgbWFwIGRvZXMgbm90IGFscmVhZHkgY29udGFpbiBhbiBlbnRyeSBmb3IgdGhlIGdpdmVuIGRvY3VtZW50IGtleS5cbiAgICAgKi8gICAgcG9wdWxhdGVPdmVybGF5cyh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBlLmhhcyh0KSB8fCBzLnB1c2godCk7XG4gICAgICAgIH0pKSwgdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZS5nZXRPdmVybGF5cyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHQuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBlLnNldCh0LCBuKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBmb3IgdGhlIGdpdmVuIGRvY3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2NzIC0gVGhlIGRvY3VtZW50cyB0byBjb21wdXRlIHZpZXdzIGZvci4gSXQgYWxzbyBoYXMgdGhlIGJhc2VcbiAgICAgKiAgIHZlcnNpb24gb2YgdGhlIGRvY3VtZW50cy5cbiAgICAgKiBAcGFyYW0gb3ZlcmxheXMgLSBUaGUgb3ZlcmxheXMgdGhhdCBuZWVkIHRvIGJlIGFwcGxpZWQgdG8gdGhlIGdpdmVuIGJhc2VcbiAgICAgKiAgIHZlcnNpb24gb2YgdGhlIGRvY3VtZW50cy5cbiAgICAgKiBAcGFyYW0gZXhpc3RlbmNlU3RhdGVDaGFuZ2VkIC0gQSBzZXQgb2YgZG9jdW1lbnRzIHdob3NlIGV4aXN0ZW5jZSBzdGF0ZXNcbiAgICAgKiAgIG1pZ2h0IGhhdmUgY2hhbmdlZC4gVGhpcyBpcyB1c2VkIHRvIGRldGVybWluZSBpZiB3ZSBuZWVkIHRvIHJlLWNhbGN1bGF0ZVxuICAgICAqICAgb3ZlcmxheXMgZnJvbSBtdXRhdGlvbiBxdWV1ZXMuXG4gICAgICogQHJldHVybiBBIG1hcCByZXByZXNlbnRzIHRoZSBsb2NhbCBkb2N1bWVudHMgdmlldy5cbiAgICAgKi8gICAgY29tcHV0ZVZpZXdzKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgbGV0IGkgPSBzcygpO1xuICAgICAgICBjb25zdCByID0gYXMoKSwgbyA9IGFzKCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvID0gbi5nZXQoZS5rZXkpO1xuICAgICAgICAgICAgLy8gUmVjYWxjdWxhdGUgYW4gb3ZlcmxheSBpZiB0aGUgZG9jdW1lbnQncyBleGlzdGVuY2Ugc3RhdGUgY2hhbmdlZCBkdWUgdG9cbiAgICAgICAgICAgIC8vIGEgcmVtb3RlIGV2ZW50ICphbmQqIHRoZSBvdmVybGF5IGlzIGEgUGF0Y2hNdXRhdGlvbi4gVGhpcyBpcyBiZWNhdXNlXG4gICAgICAgICAgICAvLyBkb2N1bWVudCBleGlzdGVuY2Ugc3RhdGUgY2FuIGNoYW5nZSBpZiBzb21lIHBhdGNoIG11dGF0aW9uJ3NcbiAgICAgICAgICAgIC8vIHByZWNvbmRpdGlvbnMgYXJlIG1ldC5cbiAgICAgICAgICAgIC8vIE5PVEU6IHdlIHJlY2FsY3VsYXRlIHdoZW4gYG92ZXJsYXlgIGlzIHVuZGVmaW5lZCBhcyB3ZWxsLCBiZWNhdXNlIHRoZXJlXG4gICAgICAgICAgICAvLyBtaWdodCBiZSBhIHBhdGNoIG11dGF0aW9uIHdob3NlIHByZWNvbmRpdGlvbiBkb2VzIG5vdCBtYXRjaCBiZWZvcmUgdGhlXG4gICAgICAgICAgICAvLyBjaGFuZ2UgKGhlbmNlIG92ZXJsYXkgaXMgdW5kZWZpbmVkKSwgYnV0IHdvdWxkIG5vdyBtYXRjaC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHMuaGFzKGUua2V5KSAmJiAodm9pZCAwID09PSBvIHx8IG8ubXV0YXRpb24gaW5zdGFuY2VvZiBHbikgPyBpID0gaS5pbnNlcnQoZS5rZXksIGUpIDogdm9pZCAwICE9PSBvICYmIChyLnNldChlLmtleSwgby5tdXRhdGlvbi5nZXRGaWVsZE1hc2soKSksIFxuICAgICAgICAgICAgTG4oby5tdXRhdGlvbiwgZSwgby5tdXRhdGlvbi5nZXRGaWVsZE1hc2soKSwgbnQubm93KCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnJlY2FsY3VsYXRlQW5kU2F2ZU92ZXJsYXlzKHQsIGkpLm5leHQoKHQgPT4gKHQuZm9yRWFjaCgoKHQsIGUpID0+IHIuc2V0KHQsIGUpKSksIFxuICAgICAgICBlLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB2YXIgbjtcbiAgICAgICAgICAgIHJldHVybiBvLnNldCh0LCBuZXcgWXIoZSwgbnVsbCAhPT0gKG4gPSByLmdldCh0KSkgJiYgdm9pZCAwICE9PSBuID8gbiA6IG51bGwpKTtcbiAgICAgICAgfSkpLCBvKSkpO1xuICAgIH1cbiAgICByZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBhcygpO1xuICAgICAgICAvLyBBIHJldmVyc2UgbG9va3VwIG1hcCBmcm9tIGJhdGNoIGlkIHRvIHRoZSBkb2N1bWVudHMgd2l0aGluIHRoYXQgYmF0Y2guXG4gICAgICAgICAgICAgICAgbGV0IHMgPSBuZXcgQnQoKCh0LCBlKSA9PiB0IC0gZSkpLCBpID0gZnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkgaS5rZXlzKCkuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGUuZ2V0KHQpO1xuICAgICAgICAgICAgICAgIGlmIChudWxsID09PSByKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbGV0IG8gPSBuLmdldCh0KSB8fCBRdC5lbXB0eSgpO1xuICAgICAgICAgICAgICAgIG8gPSBpLmFwcGx5VG9Mb2NhbFZpZXcociwgbyksIG4uc2V0KHQsIG8pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSAocy5nZXQoaS5iYXRjaElkKSB8fCBmcygpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KGkuYmF0Y2hJZCwgdSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gW10sIG8gPSBzLmdldFJldmVyc2VJdGVyYXRvcigpO1xuICAgICAgICAgICAgLy8gSXRlcmF0ZSBpbiBkZXNjZW5kaW5nIG9yZGVyIG9mIGJhdGNoIElEcywgYW5kIHNraXAgZG9jdW1lbnRzIHRoYXQgYXJlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IHNhdmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7by5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLmdldE5leHQoKSwgdSA9IHMua2V5LCBjID0gcy52YWx1ZSwgYSA9IGNzKCk7XG4gICAgICAgICAgICAgICAgYy5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9ICRuKGUuZ2V0KHQpLCBuLmdldCh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9PSBzICYmIGEuc2V0KHQsIHMpLCBpID0gaS5hZGQodCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSksIHIucHVzaCh0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLnNhdmVPdmVybGF5cyh0LCB1LCBhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gQXQud2FpdEZvcihyKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjYWxjdWxhdGVzIG92ZXJsYXlzIGJ5IHJlYWRpbmcgdGhlIGRvY3VtZW50cyBmcm9tIHJlbW90ZSBkb2N1bWVudCBjYWNoZVxuICAgICAqIGZpcnN0LCBhbmQgc2F2ZXMgdGhlbSBhZnRlciB0aGV5IGFyZSBjYWxjdWxhdGVkLlxuICAgICAqLyAgICByZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cmllcyh0LCBlKS5uZXh0KChlID0+IHRoaXMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXModCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCB2aWV3IG9mIGFsbCBkb2N1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24uXG4gICAgICogQHBhcmFtIHF1ZXJ5IC0gVGhlIHF1ZXJ5IHRvIG1hdGNoIGRvY3VtZW50cyBhZ2FpbnN0LlxuICAgICAqIEBwYXJhbSBvZmZzZXQgLSBSZWFkIHRpbWUgYW5kIGtleSB0byBzdGFydCBzY2FubmluZyBieSAoZXhjbHVzaXZlKS5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuKSB7XG4gICAgICAgIC8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgc2luZ2xlIGRvY3VtZW50IGJ5IHBhdGggKHJhdGhlciB0aGFuIGFcbiAqIGNvbGxlY3Rpb24pLlxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gY3QuaXNEb2N1bWVudEtleSh0LnBhdGgpICYmIG51bGwgPT09IHQuY29sbGVjdGlvbkdyb3VwICYmIDAgPT09IHQuZmlsdGVycy5sZW5ndGg7XG4gICAgICAgIH0oZSkgPyB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nRG9jdW1lbnRRdWVyeSh0LCBlLnBhdGgpIDogb24oZSkgPyB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvbkdyb3VwUXVlcnkodCwgZSwgbikgOiB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KHQsIGUsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGNvbGxlY3Rpb24gZ3JvdXAsIHJldHVybnMgdGhlIG5leHQgZG9jdW1lbnRzIHRoYXQgZm9sbG93IHRoZSBwcm92aWRlZCBvZmZzZXQsIGFsb25nXG4gICAgICogd2l0aCBhbiB1cGRhdGVkIGJhdGNoIElELlxuICAgICAqXG4gICAgICogPHA+VGhlIGRvY3VtZW50cyByZXR1cm5lZCBieSB0aGlzIG1ldGhvZCBhcmUgb3JkZXJlZCBieSByZW1vdGUgdmVyc2lvbiBmcm9tIHRoZSBwcm92aWRlZFxuICAgICAqIG9mZnNldC4gSWYgdGhlcmUgYXJlIG5vIG1vcmUgcmVtb3RlIGRvY3VtZW50cyBhZnRlciB0aGUgcHJvdmlkZWQgb2Zmc2V0LCBkb2N1bWVudHMgd2l0aFxuICAgICAqIG11dGF0aW9ucyBpbiBvcmRlciBvZiBiYXRjaCBpZCBmcm9tIHRoZSBvZmZzZXQgYXJlIHJldHVybmVkLiBTaW5jZSBhbGwgZG9jdW1lbnRzIGluIGEgYmF0Y2ggYXJlXG4gICAgICogcmV0dXJuZWQgdG9nZXRoZXIsIHRoZSB0b3RhbCBudW1iZXIgb2YgZG9jdW1lbnRzIHJldHVybmVkIGNhbiBleGNlZWQge0Bjb2RlIGNvdW50fS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvblxuICAgICAqIEBwYXJhbSBjb2xsZWN0aW9uR3JvdXAgVGhlIGNvbGxlY3Rpb24gZ3JvdXAgZm9yIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIG9mZnNldCBUaGUgb2Zmc2V0IHRvIGluZGV4IGludG8uXG4gICAgICogQHBhcmFtIGNvdW50IFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRvIHJldHVyblxuICAgICAqIEByZXR1cm4gQSBMb2NhbFdyaXRlUmVzdWx0IHdpdGggdGhlIGRvY3VtZW50cyB0aGF0IGZvbGxvdyB0aGUgcHJvdmlkZWQgb2Zmc2V0IGFuZCB0aGUgbGFzdCBwcm9jZXNzZWQgYmF0Y2ggaWQuXG4gICAgICovICAgIGdldE5leHREb2N1bWVudHModCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykubmV4dCgoaSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gcyAtIGkuc2l6ZSA+IDAgPyB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLmdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4ubGFyZ2VzdEJhdGNoSWQsIHMgLSBpLnNpemUpIDogQXQucmVzb2x2ZSh1cygpKTtcbiAgICAgICAgICAgIC8vIFRoZSBjYWxsc2l0ZSB3aWxsIHVzZSB0aGUgbGFyZ2VzdCBiYXRjaCBJRCB0b2dldGhlciB3aXRoIHRoZSBsYXRlc3QgcmVhZCB0aW1lIHRvIGNyZWF0ZVxuICAgICAgICAgICAgLy8gYSBuZXcgaW5kZXggb2Zmc2V0LiBTaW5jZSB3ZSBvbmx5IHByb2Nlc3MgYmF0Y2ggSURzIGlmIGFsbCByZW1vdGUgZG9jdW1lbnRzIGhhdmUgYmVlbiByZWFkLFxuICAgICAgICAgICAgLy8gbm8gb3ZlcmxheSB3aWxsIGluY3JlYXNlIHRoZSBvdmVyYWxsIHJlYWQgdGltZS4gVGhpcyBpcyB3aHkgd2Ugb25seSBuZWVkIHRvIHNwZWNpYWwgY2FzZVxuICAgICAgICAgICAgLy8gdGhlIGJhdGNoIGlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG8gPSAtMSwgdSA9IGk7XG4gICAgICAgICAgICByZXR1cm4gci5uZXh0KChlID0+IEF0LmZvckVhY2goZSwgKChlLCBuKSA9PiAobyA8IG4ubGFyZ2VzdEJhdGNoSWQgJiYgKG8gPSBuLmxhcmdlc3RCYXRjaElkKSwgXG4gICAgICAgICAgICBpLmdldChlKSA/IEF0LnJlc29sdmUoKSA6IHRoaXMuZ2V0QmFzZURvY3VtZW50KHQsIGUsIG4pLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHUgPSB1Lmluc2VydChlLCB0KTtcbiAgICAgICAgICAgIH0pKSkpKS5uZXh0KCgoKSA9PiB0aGlzLnBvcHVsYXRlT3ZlcmxheXModCwgZSwgaSkpKS5uZXh0KCgoKSA9PiB0aGlzLmNvbXB1dGVWaWV3cyh0LCB1LCBlLCBmcygpKSkpLm5leHQoKHQgPT4gKHtcbiAgICAgICAgICAgICAgICBiYXRjaElkOiBvLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IG9zKHQpXG4gICAgICAgICAgICB9KSkpKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdEb2N1bWVudFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgLy8gSnVzdCBkbyBhIHNpbXBsZSBkb2N1bWVudCBsb29rdXAuXG4gICAgICAgIHJldHVybiB0aGlzLmdldERvY3VtZW50KHQsIG5ldyBjdChlKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IHJzKCk7XG4gICAgICAgICAgICByZXR1cm4gdC5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoZSA9IGUuaW5zZXJ0KHQua2V5LCB0KSksIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uR3JvdXBRdWVyeSh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBlLmNvbGxlY3Rpb25Hcm91cDtcbiAgICAgICAgbGV0IGkgPSBycygpO1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleE1hbmFnZXIuZ2V0Q29sbGVjdGlvblBhcmVudHModCwgcykubmV4dCgociA9PiBBdC5mb3JFYWNoKHIsIChyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBaZShlLCBcbiAgICAgICAgICAgICAgICAvKmNvbGxlY3Rpb25Hcm91cD0qLyBudWxsLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG4gICAgICAgICAgICB9KGUsIHIuY2hpbGQocykpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uUXVlcnkodCwgbywgbikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpID0gaS5pbnNlcnQodCwgZSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpKSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgLy8gUXVlcnkgdGhlIHJlbW90ZSBkb2N1bWVudHMgYW5kIG92ZXJsYXkgbXV0YXRpb25zLlxuICAgICAgICBsZXQgcztcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRBbGxGcm9tQ29sbGVjdGlvbih0LCBlLnBhdGgsIG4pLm5leHQoKGkgPT4gKHMgPSBpLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZS5nZXRPdmVybGF5c0ZvckNvbGxlY3Rpb24odCwgZS5wYXRoLCBuLmxhcmdlc3RCYXRjaElkKSkpKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIC8vIEFzIGRvY3VtZW50cyBtaWdodCBtYXRjaCB0aGUgcXVlcnkgYmVjYXVzZSBvZiB0aGVpciBvdmVybGF5IHdlIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIGluY2x1ZGUgZG9jdW1lbnRzIGZvciBhbGwgb3ZlcmxheXMgaW4gdGhlIGluaXRpYWwgZG9jdW1lbnQgc2V0LlxuICAgICAgICAgICAgdC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmdldEtleSgpO1xuICAgICAgICAgICAgICAgIG51bGwgPT09IHMuZ2V0KG4pICYmIChzID0gcy5pbnNlcnQobiwgU2UubmV3SW52YWxpZERvY3VtZW50KG4pKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAvLyBBcHBseSB0aGUgb3ZlcmxheXMgYW5kIG1hdGNoIGFnYWluc3QgdGhlIHF1ZXJ5LlxuICAgICAgICAgICAgbGV0IG4gPSBycygpO1xuICAgICAgICAgICAgcmV0dXJuIHMuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdC5nZXQocyk7XG4gICAgICAgICAgICAgICAgdm9pZCAwICE9PSByICYmIExuKHIubXV0YXRpb24sIGksIFF0LmVtcHR5KCksIG50Lm5vdygpKSwgXG4gICAgICAgICAgICAgICAgLy8gRmluYWxseSwgaW5zZXJ0IHRoZSBkb2N1bWVudHMgdGhhdCBzdGlsbCBtYXRjaCB0aGUgcXVlcnlcbiAgICAgICAgICAgICAgICBkbihlLCBpKSAmJiAobiA9IG4uaW5zZXJ0KHMsIGkpKTtcbiAgICAgICAgICAgIH0pKSwgbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIGJhc2UgZG9jdW1lbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBgb3ZlcmxheWAuICovICAgIGdldEJhc2VEb2N1bWVudCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBudWxsID09PSBuIHx8IDEgLyogUGF0Y2ggKi8gPT09IG4ubXV0YXRpb24udHlwZSA/IHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSh0LCBlKSA6IEF0LnJlc29sdmUoU2UubmV3SW52YWxpZERvY3VtZW50KGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFpyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuSXQgPSB0LCB0aGlzLlpuID0gbmV3IE1hcCwgdGhpcy50cyA9IG5ldyBNYXA7XG4gICAgfVxuICAgIGdldEJ1bmRsZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUodGhpcy5abi5nZXQoZSkpO1xuICAgIH1cbiAgICBzYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICAvKiogRGVjb2RlcyBhIEJ1bmRsZU1ldGFkYXRhIHByb3RvIGludG8gYSBCdW5kbGVNZXRhZGF0YSBvYmplY3QuICovXG4gICAgICAgIHZhciBuO1xuICAgICAgICByZXR1cm4gdGhpcy5abi5zZXQoZS5pZCwge1xuICAgICAgICAgICAgaWQ6IChuID0gZSkuaWQsXG4gICAgICAgICAgICB2ZXJzaW9uOiBuLnZlcnNpb24sXG4gICAgICAgICAgICBjcmVhdGVUaW1lOiBEcyhuLmNyZWF0ZVRpbWUpXG4gICAgICAgIH0pLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh0aGlzLnRzLmdldChlKSk7XG4gICAgfVxuICAgIHNhdmVOYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHMuc2V0KGUubmFtZSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiB0Lm5hbWUsXG4gICAgICAgICAgICAgICAgcXVlcnk6IFdpKHQuYnVuZGxlZFF1ZXJ5KSxcbiAgICAgICAgICAgICAgICByZWFkVGltZTogRHModC5yZWFkVGltZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0oZSkpLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbi1tZW1vcnkgaW1wbGVtZW50YXRpb24gb2YgRG9jdW1lbnRPdmVybGF5Q2FjaGUuXG4gKi8gY2xhc3MgdG8ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIG1hcCBzb3J0ZWQgYnkgRG9jdW1lbnRLZXksIHdob3NlIHZhbHVlIGlzIGEgcGFpciBvZiB0aGUgbGFyZ2VzdCBiYXRjaCBpZFxuICAgICAgICAvLyBmb3IgdGhlIG92ZXJsYXkgYW5kIHRoZSBvdmVybGF5IGl0c2VsZi5cbiAgICAgICAgdGhpcy5vdmVybGF5cyA9IG5ldyBCdChjdC5jb21wYXJhdG9yKSwgdGhpcy5lcyA9IG5ldyBNYXA7XG4gICAgfVxuICAgIGdldE92ZXJsYXkodCwgZSkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh0aGlzLm92ZXJsYXlzLmdldChlKSk7XG4gICAgfVxuICAgIGdldE92ZXJsYXlzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHVzKCk7XG4gICAgICAgIHJldHVybiBBdC5mb3JFYWNoKGUsIChlID0+IHRoaXMuZ2V0T3ZlcmxheSh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIG51bGwgIT09IHQgJiYgbi5zZXQoZSwgdCk7XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgc2F2ZU92ZXJsYXlzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHRoaXMudWUodCwgZSwgcyk7XG4gICAgICAgIH0pKSwgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVPdmVybGF5c0ZvckJhdGNoSWQodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdGhpcy5lcy5nZXQobik7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHMgJiYgKHMuZm9yRWFjaCgodCA9PiB0aGlzLm92ZXJsYXlzID0gdGhpcy5vdmVybGF5cy5yZW1vdmUodCkpKSwgXG4gICAgICAgIHRoaXMuZXMuZGVsZXRlKG4pKSwgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdXMoKSwgaSA9IGUubGVuZ3RoICsgMSwgciA9IG5ldyBjdChlLmNoaWxkKFwiXCIpKSwgbyA9IHRoaXMub3ZlcmxheXMuZ2V0SXRlcmF0b3JGcm9tKHIpO1xuICAgICAgICBmb3IgKDtvLmhhc05leHQoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gby5nZXROZXh0KCkudmFsdWUsIHIgPSB0LmdldEtleSgpO1xuICAgICAgICAgICAgaWYgKCFlLmlzUHJlZml4T2Yoci5wYXRoKSkgYnJlYWs7XG4gICAgICAgICAgICAvLyBEb2N1bWVudHMgZnJvbSBzdWItY29sbGVjdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucGF0aC5sZW5ndGggPT09IGkgJiYgKHQubGFyZ2VzdEJhdGNoSWQgPiBuICYmIHMuc2V0KHQuZ2V0S2V5KCksIHQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZShzKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICBsZXQgaSA9IG5ldyBCdCgoKHQsIGUpID0+IHQgLSBlKSk7XG4gICAgICAgIGNvbnN0IHIgPSB0aGlzLm92ZXJsYXlzLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO3IuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSByLmdldE5leHQoKS52YWx1ZTtcbiAgICAgICAgICAgIGlmICh0LmdldEtleSgpLmdldENvbGxlY3Rpb25Hcm91cCgpID09PSBlICYmIHQubGFyZ2VzdEJhdGNoSWQgPiBuKSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSBpLmdldCh0Lmxhcmdlc3RCYXRjaElkKTtcbiAgICAgICAgICAgICAgICBudWxsID09PSBlICYmIChlID0gdXMoKSwgaSA9IGkuaW5zZXJ0KHQubGFyZ2VzdEJhdGNoSWQsIGUpKSwgZS5zZXQodC5nZXRLZXkoKSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbyA9IHVzKCksIHUgPSBpLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO3UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGlmICh1LmdldE5leHQoKS52YWx1ZS5mb3JFYWNoKCgodCwgZSkgPT4gby5zZXQodCwgZSkpKSwgby5zaXplKCkgPj0gcykgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUobyk7XG4gICAgfVxuICAgIHVlKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBhc3NvY2lhdGlvbiBvZiB0aGUgb3ZlcmxheSB0byBpdHMgYmF0Y2ggaWQuXG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLm92ZXJsYXlzLmdldChuLmtleSk7XG4gICAgICAgIGlmIChudWxsICE9PSBzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lcy5nZXQocy5sYXJnZXN0QmF0Y2hJZCkuZGVsZXRlKG4ua2V5KTtcbiAgICAgICAgICAgIHRoaXMuZXMuc2V0KHMubGFyZ2VzdEJhdGNoSWQsIHQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3ZlcmxheXMgPSB0aGlzLm92ZXJsYXlzLmluc2VydChuLmtleSwgbmV3IE1pKGUsIG4pKTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBhc3NvY2lhdGlvbiBvZiB0aGlzIG92ZXJsYXkgdG8gdGhlIGdpdmVuIGxhcmdlc3RCYXRjaElkLlxuICAgICAgICBsZXQgaSA9IHRoaXMuZXMuZ2V0KGUpO1xuICAgICAgICB2b2lkIDAgPT09IGkgJiYgKGkgPSBmcygpLCB0aGlzLmVzLnNldChlLCBpKSksIHRoaXMuZXMuc2V0KGUsIGkuYWRkKG4ua2V5KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNvbGxlY3Rpb24gb2YgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IGZyb20gc29tZSBraW5kIG9mIG51bWJlcmVkIGVudGl0eVxuICogKGVpdGhlciBhIHRhcmdldCBJRCBvciBiYXRjaCBJRCkuIEFzIHJlZmVyZW5jZXMgYXJlIGFkZGVkIHRvIG9yIHJlbW92ZWQgZnJvbVxuICogdGhlIHNldCBjb3JyZXNwb25kaW5nIGV2ZW50cyBhcmUgZW1pdHRlZCB0byBhIHJlZ2lzdGVyZWQgZ2FyYmFnZSBjb2xsZWN0b3IuXG4gKlxuICogRWFjaCByZWZlcmVuY2UgaXMgcmVwcmVzZW50ZWQgYnkgYSBEb2N1bWVudFJlZmVyZW5jZSBvYmplY3QuIEVhY2ggb2YgdGhlbVxuICogY29udGFpbnMgZW5vdWdoIGluZm9ybWF0aW9uIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IHRoZSByZWZlcmVuY2UuIFRoZXkgYXJlIGFsbFxuICogc3RvcmVkIHByaW1hcmlseSBpbiBhIHNldCBzb3J0ZWQgYnkga2V5LiBBIGRvY3VtZW50IGlzIGNvbnNpZGVyZWQgZ2FyYmFnZSBpZlxuICogdGhlcmUncyBubyByZWZlcmVuY2VzIGluIHRoYXQgc2V0ICh0aGlzIGNhbiBiZSBlZmZpY2llbnRseSBjaGVja2VkIHRoYW5rcyB0b1xuICogc29ydGluZyBieSBrZXkpLlxuICpcbiAqIFJlZmVyZW5jZVNldCBhbHNvIGtlZXBzIGEgc2Vjb25kYXJ5IHNldCB0aGF0IGNvbnRhaW5zIHJlZmVyZW5jZXMgc29ydGVkIGJ5XG4gKiBJRHMuIFRoaXMgb25lIGlzIHVzZWQgdG8gZWZmaWNpZW50bHkgaW1wbGVtZW50IHJlbW92YWwgb2YgYWxsIHJlZmVyZW5jZXMgYnlcbiAqIHNvbWUgdGFyZ2V0IElELlxuICovIGNsYXNzIGVvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBzZXQgb2Ygb3V0c3RhbmRpbmcgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IHNvcnRlZCBieSBrZXkuXG4gICAgICAgIHRoaXMubnMgPSBuZXcgcXQobm8uc3MpLCBcbiAgICAgICAgLy8gQSBzZXQgb2Ygb3V0c3RhbmRpbmcgcmVmZXJlbmNlcyB0byBhIGRvY3VtZW50IHNvcnRlZCBieSB0YXJnZXQgaWQuXG4gICAgICAgIHRoaXMucnMgPSBuZXcgcXQobm8ub3MpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2Ugc2V0IGNvbnRhaW5zIG5vIHJlZmVyZW5jZXMuICovICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5zLmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLyoqIEFkZHMgYSByZWZlcmVuY2UgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleSBmb3IgdGhlIGdpdmVuIElELiAqLyAgICBhZGRSZWZlcmVuY2UodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IG5vKHQsIGUpO1xuICAgICAgICB0aGlzLm5zID0gdGhpcy5ucy5hZGQobiksIHRoaXMucnMgPSB0aGlzLnJzLmFkZChuKTtcbiAgICB9XG4gICAgLyoqIEFkZCByZWZlcmVuY2VzIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXlzIGZvciB0aGUgZ2l2ZW4gSUQuICovICAgIHVzKHQsIGUpIHtcbiAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMuYWRkUmVmZXJlbmNlKHQsIGUpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSByZWZlcmVuY2UgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleSBmb3IgdGhlIGdpdmVuXG4gICAgICogSUQuXG4gICAgICovICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlKSB7XG4gICAgICAgIHRoaXMuY3MobmV3IG5vKHQsIGUpKTtcbiAgICB9XG4gICAgaHModCwgZSkge1xuICAgICAgICB0LmZvckVhY2goKHQgPT4gdGhpcy5yZW1vdmVSZWZlcmVuY2UodCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGFsbCByZWZlcmVuY2VzIHdpdGggYSBnaXZlbiBJRC4gQ2FsbHMgcmVtb3ZlUmVmKCkgZm9yIGVhY2gga2V5XG4gICAgICogcmVtb3ZlZC5cbiAgICAgKi8gICAgbHModCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IGN0KG5ldyBydChbXSkpLCBuID0gbmV3IG5vKGUsIHQpLCBzID0gbmV3IG5vKGUsIHQgKyAxKSwgaSA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5ycy5mb3JFYWNoSW5SYW5nZShbIG4sIHMgXSwgKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5jcyh0KSwgaS5wdXNoKHQua2V5KTtcbiAgICAgICAgfSkpLCBpO1xuICAgIH1cbiAgICBmcygpIHtcbiAgICAgICAgdGhpcy5ucy5mb3JFYWNoKCh0ID0+IHRoaXMuY3ModCkpKTtcbiAgICB9XG4gICAgY3ModCkge1xuICAgICAgICB0aGlzLm5zID0gdGhpcy5ucy5kZWxldGUodCksIHRoaXMucnMgPSB0aGlzLnJzLmRlbGV0ZSh0KTtcbiAgICB9XG4gICAgZHModCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IGN0KG5ldyBydChbXSkpLCBuID0gbmV3IG5vKGUsIHQpLCBzID0gbmV3IG5vKGUsIHQgKyAxKTtcbiAgICAgICAgbGV0IGkgPSBmcygpO1xuICAgICAgICByZXR1cm4gdGhpcy5ycy5mb3JFYWNoSW5SYW5nZShbIG4sIHMgXSwgKHQgPT4ge1xuICAgICAgICAgICAgaSA9IGkuYWRkKHQua2V5KTtcbiAgICAgICAgfSkpLCBpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgbm8odCwgMCksIG4gPSB0aGlzLm5zLmZpcnN0QWZ0ZXJPckVxdWFsKGUpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gbiAmJiB0LmlzRXF1YWwobi5rZXkpO1xuICAgIH1cbn1cblxuY2xhc3Mgbm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0LCB0aGlzLl9zID0gZTtcbiAgICB9XG4gICAgLyoqIENvbXBhcmUgYnkga2V5IHRoZW4gYnkgSUQgKi8gICAgc3RhdGljIHNzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGN0LmNvbXBhcmF0b3IodC5rZXksIGUua2V5KSB8fCBaKHQuX3MsIGUuX3MpO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqLyAgICBzdGF0aWMgb3ModCwgZSkge1xuICAgICAgICByZXR1cm4gWih0Ll9zLCBlLl9zKSB8fCBjdC5jb21wYXJhdG9yKHQua2V5LCBlLmtleSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBzbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzZXQgb2YgYWxsIG11dGF0aW9ucyB0aGF0IGhhdmUgYmVlbiBzZW50IGJ1dCBub3QgeWV0IGJlZW4gYXBwbGllZCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IFtdLCBcbiAgICAgICAgLyoqIE5leHQgdmFsdWUgdG8gdXNlIHdoZW4gYXNzaWduaW5nIHNlcXVlbnRpYWwgSURzIHRvIGVhY2ggbXV0YXRpb24gYmF0Y2guICovXG4gICAgICAgIHRoaXMud3MgPSAxLCBcbiAgICAgICAgLyoqIEFuIG9yZGVyZWQgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIG11dGF0aW9ucyBiYXRjaCBJRHMuICovXG4gICAgICAgIHRoaXMuZ3MgPSBuZXcgcXQobm8uc3MpO1xuICAgIH1cbiAgICBjaGVja0VtcHR5KHQpIHtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUoMCA9PT0gdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCk7XG4gICAgfVxuICAgIGFkZE11dGF0aW9uQmF0Y2godCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gdGhpcy53cztcbiAgICAgICAgdGhpcy53cysrLCB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID4gMCAmJiB0aGlzLm11dGF0aW9uUXVldWVbdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCAtIDFdO1xuICAgICAgICBjb25zdCByID0gbmV3IGtpKGksIGUsIG4sIHMpO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUucHVzaChyKTtcbiAgICAgICAgLy8gVHJhY2sgcmVmZXJlbmNlcyBieSBkb2N1bWVudCBrZXkgYW5kIGluZGV4IGNvbGxlY3Rpb24gcGFyZW50cy5cbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHRoaXMuZ3MgPSB0aGlzLmdzLmFkZChuZXcgbm8oZS5rZXksIGkpKSwgdGhpcy5pbmRleE1hbmFnZXIuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgZS5rZXkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZShyKTtcbiAgICB9XG4gICAgbG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKHRoaXMueXMoZSkpO1xuICAgIH1cbiAgICBnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlICsgMSwgcyA9IHRoaXMucHMobiksIGkgPSBzIDwgMCA/IDAgOiBzO1xuICAgICAgICAvLyBUaGUgcmVxdWVzdGVkIGJhdGNoSWQgbWF5IHN0aWxsIGJlIG91dCBvZiByYW5nZSBzbyBub3JtYWxpemUgaXQgdG8gdGhlXG4gICAgICAgIC8vIHN0YXJ0IG9mIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID4gaSA/IHRoaXMubXV0YXRpb25RdWV1ZVtpXSA6IG51bGwpO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKCkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSgwID09PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID8gLTEgOiB0aGlzLndzIC0gMSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKHRoaXMubXV0YXRpb25RdWV1ZS5zbGljZSgpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IG5vKGUsIDApLCBzID0gbmV3IG5vKGUsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3MuZm9yRWFjaEluUmFuZ2UoWyBuLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnlzKHQuX3MpO1xuICAgICAgICAgICAgaS5wdXNoKGUpO1xuICAgICAgICB9KSksIEF0LnJlc29sdmUoaSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IHF0KFopO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgbm8odCwgMCksIHMgPSBuZXcgbm8odCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtcbiAgICAgICAgICAgIHRoaXMuZ3MuZm9yRWFjaEluUmFuZ2UoWyBlLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgICAgICBuID0gbi5hZGQodC5fcyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKSwgQXQucmVzb2x2ZSh0aGlzLklzKG4pKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkodCwgZSkge1xuICAgICAgICAvLyBVc2UgdGhlIHF1ZXJ5IHBhdGggYXMgYSBwcmVmaXggZm9yIHRlc3RpbmcgaWYgYSBkb2N1bWVudCBtYXRjaGVzIHRoZVxuICAgICAgICAvLyBxdWVyeS5cbiAgICAgICAgY29uc3QgbiA9IGUucGF0aCwgcyA9IG4ubGVuZ3RoICsgMTtcbiAgICAgICAgLy8gQ29uc3RydWN0IGEgZG9jdW1lbnQgcmVmZXJlbmNlIGZvciBhY3R1YWxseSBzY2FubmluZyB0aGUgaW5kZXguIFVubGlrZVxuICAgICAgICAvLyB0aGUgcHJlZml4IHRoZSBkb2N1bWVudCBrZXkgaW4gdGhpcyByZWZlcmVuY2UgbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mXG4gICAgICAgIC8vIHNlZ21lbnRzLiBUaGUgZW1wdHkgc2VnbWVudCBjYW4gYmUgdXNlZCBhIHN1ZmZpeCBvZiB0aGUgcXVlcnkgcGF0aFxuICAgICAgICAvLyBiZWNhdXNlIGl0IHByZWNlZGVzIGFsbCBvdGhlciBzZWdtZW50cyBpbiBhbiBvcmRlcmVkIHRyYXZlcnNhbC5cbiAgICAgICAgbGV0IGkgPSBuO1xuICAgICAgICBjdC5pc0RvY3VtZW50S2V5KGkpIHx8IChpID0gaS5jaGlsZChcIlwiKSk7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgbm8obmV3IGN0KGkpLCAwKTtcbiAgICAgICAgLy8gRmluZCB1bmlxdWUgYmF0Y2hJRHMgcmVmZXJlbmNlZCBieSBhbGwgZG9jdW1lbnRzIHBvdGVudGlhbGx5IG1hdGNoaW5nIHRoZVxuICAgICAgICAvLyBxdWVyeS5cbiAgICAgICAgICAgICAgICBsZXQgbyA9IG5ldyBxdChaKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3MuZm9yRWFjaFdoaWxlKCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmtleS5wYXRoO1xuICAgICAgICAgICAgcmV0dXJuICEhbi5pc1ByZWZpeE9mKGUpICYmIChcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJyBjYW4ndCBtYXRjaFxuICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICBlLmxlbmd0aCA9PT0gcyAmJiAobyA9IG8uYWRkKHQuX3MpKSwgITApO1xuICAgICAgICB9KSwgciksIEF0LnJlc29sdmUodGhpcy5JcyhvKSk7XG4gICAgfVxuICAgIElzKHQpIHtcbiAgICAgICAgLy8gQ29uc3RydWN0IGFuIGFycmF5IG9mIG1hdGNoaW5nIGJhdGNoZXMsIHNvcnRlZCBieSBiYXRjaElEIHRvIGVuc3VyZSB0aGF0XG4gICAgICAgIC8vIG11bHRpcGxlIG11dGF0aW9ucyBhZmZlY3RpbmcgdGhlIHNhbWUgZG9jdW1lbnQga2V5IGFyZSBhcHBsaWVkIGluIG9yZGVyLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMueXModCk7XG4gICAgICAgICAgICBudWxsICE9PSBuICYmIGUucHVzaChuKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgTSgwID09PSB0aGlzLlRzKGUuYmF0Y2hJZCwgXCJyZW1vdmVkXCIpKSwgdGhpcy5tdXRhdGlvblF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIGxldCBuID0gdGhpcy5ncztcbiAgICAgICAgcmV0dXJuIEF0LmZvckVhY2goZS5tdXRhdGlvbnMsIChzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgbm8ocy5rZXksIGUuYmF0Y2hJZCk7XG4gICAgICAgICAgICByZXR1cm4gbiA9IG4uZGVsZXRlKGkpLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIHMua2V5KTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZ3MgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEFuKHQpIHtcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgbm8oZSwgMCksIHMgPSB0aGlzLmdzLmZpcnN0QWZ0ZXJPckVxdWFsKG4pO1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZShlLmlzRXF1YWwocyAmJiBzLmtleSkpO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWUgYW5kIGFzc2VydHMgdGhhdFxuICAgICAqIHRoZSByZXN1bHRpbmcgaW5kZXggaXMgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIHF1ZXVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgYmF0Y2hJZCB0byBzZWFyY2ggZm9yXG4gICAgICogQHBhcmFtIGFjdGlvbiAtIEEgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGUgY2FsbGVyIGlzIGRvaW5nLCBwaHJhc2VkIGluIHBhc3NpdmVcbiAgICAgKiBmb3JtIChlLmcuIFwiYWNrbm93bGVkZ2VkXCIgaW4gYSByb3V0aW5lIHRoYXQgYWNrbm93bGVkZ2VzIGJhdGNoZXMpLlxuICAgICAqLyAgICBUcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBzKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlLiBUaGlzIG9wZXJhdGlvblxuICAgICAqIGlzIE8oMSkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgY29tcHV0ZWQgaW5kZXggb2YgdGhlIGJhdGNoIHdpdGggdGhlIGdpdmVuIGJhdGNoSWQsIGJhc2VkIG9uXG4gICAgICogdGhlIHN0YXRlIG9mIHRoZSBxdWV1ZS4gTm90ZSB0aGlzIGluZGV4IGNhbiBiZSBuZWdhdGl2ZSBpZiB0aGUgcmVxdWVzdGVkXG4gICAgICogYmF0Y2hJZCBoYXMgYWxyZWFkeSBiZWVuIHJlbXZvZWQgZnJvbSB0aGUgcXVldWUgb3IgcGFzdCB0aGUgZW5kIG9mIHRoZVxuICAgICAqIHF1ZXVlIGlmIHRoZSBiYXRjaElkIGlzIGxhcmdlciB0aGFuIHRoZSBsYXN0IGFkZGVkIGJhdGNoLlxuICAgICAqLyAgICBwcyh0KSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKSBcbiAgICAgICAgLy8gQXMgYW4gaW5kZXggdGhpcyBpcyBwYXN0IHRoZSBlbmQgb2YgdGhlIHF1ZXVlXG4gICAgICAgIHJldHVybiAwO1xuICAgICAgICAvLyBFeGFtaW5lIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgdG8gZmlndXJlIG91dCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZVxuICAgICAgICAvLyBiYXRjaElkIGFuZCBpbmRleGVzIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHNpbmNlIHRoZSBxdWV1ZSBpcyBvcmRlcmVkXG4gICAgICAgIC8vIGJ5IGJhdGNoSWQsIGlmIHRoZSBmaXJzdCBiYXRjaCBoYXMgYSBsYXJnZXIgYmF0Y2hJZCB0aGVuIHRoZSByZXF1ZXN0ZWRcbiAgICAgICAgLy8gYmF0Y2hJZCBkb2Vzbid0IGV4aXN0IGluIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gdCAtIHRoaXMubXV0YXRpb25RdWV1ZVswXS5iYXRjaElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHZlcnNpb24gb2YgbG9va3VwTXV0YXRpb25CYXRjaCB0aGF0IGRvZXNuJ3QgcmV0dXJuIGEgcHJvbWlzZSwgdGhpcyBtYWtlc1xuICAgICAqIG90aGVyIGZ1bmN0aW9ucyB0aGF0IHVzZXMgdGhpcyBjb2RlIGVhc2llciB0byByZWFkIGFuZCBtb3JlIGVmZmljZW50LlxuICAgICAqLyAgICB5cyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnBzKHQpO1xuICAgICAgICBpZiAoZSA8IDAgfHwgZSA+PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZVtlXTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBtZW1vcnktb25seSBSZW1vdGVEb2N1bWVudENhY2hlIGZvciBJbmRleGVkRGIuIFRvIGNvbnN0cnVjdCwgaW52b2tlXG4gKiBgbmV3TWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSgpYC5cbiAqL1xuY2xhc3MgaW8ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzaXplciAtIFVzZWQgdG8gYXNzZXNzIHRoZSBzaXplIG9mIGEgZG9jdW1lbnQuIEZvciBlYWdlciBHQywgdGhpcyBpc1xuICAgICAqIGV4cGVjdGVkIHRvIGp1c3QgcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZlxuICAgICAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5FcyA9IHQsIFxuICAgICAgICAvKiogVW5kZXJseWluZyBjYWNoZSBvZiBkb2N1bWVudHMgYW5kIHRoZWlyIHJlYWQgdGltZXMuICovXG4gICAgICAgIHRoaXMuZG9jcyA9IG5ldyBCdChjdC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBTaXplIG9mIGFsbCBjYWNoZWQgZG9jdW1lbnRzLiAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBzZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJ5IHRvIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgY2FjaGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgYWRkRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICBhZGRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IHRoaXMuZG9jcy5nZXQobiksIGkgPSBzID8gcy5zaXplIDogMCwgciA9IHRoaXMuRXMoZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3MgPSB0aGlzLmRvY3MuaW5zZXJ0KG4sIHtcbiAgICAgICAgICAgIGRvY3VtZW50OiBlLm11dGFibGVDb3B5KCksXG4gICAgICAgICAgICBzaXplOiByXG4gICAgICAgIH0pLCB0aGlzLnNpemUgKz0gciAtIGksIHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4ucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgZW50cnkgZnJvbSB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYHJlbW92ZUVudHJ5YCBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvY3MuZ2V0KHQpO1xuICAgICAgICBlICYmICh0aGlzLmRvY3MgPSB0aGlzLmRvY3MucmVtb3ZlKHQpLCB0aGlzLnNpemUgLT0gZS5zaXplKTtcbiAgICB9XG4gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kb2NzLmdldChlKTtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUobiA/IG4uZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IFNlLm5ld0ludmFsaWREb2N1bWVudChlKSk7XG4gICAgfVxuICAgIGdldEVudHJpZXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IHNzKCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgZSA/IGUuZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IFNlLm5ld0ludmFsaWREb2N1bWVudCh0KSk7XG4gICAgICAgIH0pKSwgQXQucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNvbGxlY3Rpb24odCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IHNzKCk7XG4gICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3cgZG93blxuICAgICAgICAvLyB0aGUgZG9jdW1lbnRzIHdlIG5lZWQgdG8gbWF0Y2ggdGhlIHF1ZXJ5IGFnYWluc3QuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBjdChlLmNoaWxkKFwiXCIpKSwgciA9IHRoaXMuZG9jcy5nZXRJdGVyYXRvckZyb20oaSk7XG4gICAgICAgIGZvciAoO3IuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHtrZXk6IHQsIHZhbHVlOiB7ZG9jdW1lbnQ6IGl9fSA9IHIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgaWYgKCFlLmlzUHJlZml4T2YodC5wYXRoKSkgYnJlYWs7XG4gICAgICAgICAgICB0LnBhdGgubGVuZ3RoID4gZS5sZW5ndGggKyAxIHx8IChwdChndChpKSwgbikgPD0gMCB8fCAocyA9IHMuaW5zZXJ0KGkua2V5LCBpLm11dGFibGVDb3B5KCkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUocyk7XG4gICAgfVxuICAgIGdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICAvLyBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBjYWxsZWQgZnJvbSB0aGUgSW5kZXhCYWNrZmlsbGVyIGlmIHBlcnNpc3RlbmNlXG4gICAgICAgIC8vIGlzIGVuYWJsZWQuXG4gICAgICAgIE8oKTtcbiAgICB9XG4gICAgQXModCwgZSkge1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaCh0aGlzLmRvY3MsICh0ID0+IGUodCkpKTtcbiAgICB9XG4gICAgbmV3Q2hhbmdlQnVmZmVyKHQpIHtcbiAgICAgICAgLy8gYHRyYWNrUmVtb3ZhbHNgIGlzIGlnbm9yZXMgc2luY2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUga2VlcHNcbiAgICAgICAgLy8gYSBzZXBhcmF0ZSBjaGFuZ2Vsb2cgYW5kIGRvZXMgbm90IG5lZWQgc3BlY2lhbCBoYW5kbGluZyBmb3IgcmVtb3ZhbHMuXG4gICAgICAgIHJldHVybiBuZXcgcm8odGhpcyk7XG4gICAgfVxuICAgIGdldFNpemUodCkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh0aGlzLnNpemUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IG1lbW9yeS1vbmx5IFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKlxuICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gKiBleHBlY3RlZCB0byBqdXN0IHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2ZcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICovXG4vKipcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi9cbmNsYXNzIHJvIGV4dGVuZHMgcXIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5ZbiA9IHQ7XG4gICAgfVxuICAgIGFwcGx5Q2hhbmdlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgcy5pc1ZhbGlkRG9jdW1lbnQoKSA/IGUucHVzaCh0aGlzLlluLmFkZEVudHJ5KHQsIHMpKSA6IHRoaXMuWW4ucmVtb3ZlRW50cnkobik7XG4gICAgICAgIH0pKSwgQXQud2FpdEZvcihlKTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWW4uZ2V0RW50cnkodCwgZSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlluLmdldEVudHJpZXModCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBvbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIGEgdGFyZ2V0IHRvIHRoZSBkYXRhIGFib3V0IHRoYXQgdGFyZ2V0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlJzID0gbmV3IGVzKCh0ID0+IHhlKHQpKSwga2UpLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IHN0Lm1pbigpLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBJRCBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSAwLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IHNlcXVlbmNlIG51bWJlciBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5icyA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBvcmRlcmVkIGJpZGlyZWN0aW9uYWwgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIHJlbW90ZSB0YXJnZXRcbiAgICAgICAgICogSURzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5QcyA9IG5ldyBlbywgdGhpcy50YXJnZXRDb3VudCA9IDAsIHRoaXMudnMgPSBDci5QbigpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUnMuZm9yRWFjaCgoKHQsIG4pID0+IGUobikpKSwgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUodGhpcy5icyk7XG4gICAgfVxuICAgIGFsbG9jYXRlVGFyZ2V0SWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSB0aGlzLnZzLm5leHQoKSwgQXQucmVzb2x2ZSh0aGlzLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuICYmICh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuKSwgZSA+IHRoaXMuYnMgJiYgKHRoaXMuYnMgPSBlKSwgXG4gICAgICAgIEF0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgRG4odCkge1xuICAgICAgICB0aGlzLlJzLnNldCh0LnRhcmdldCwgdCk7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICBlID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgJiYgKHRoaXMudnMgPSBuZXcgQ3IoZSksIHRoaXMuaGlnaGVzdFRhcmdldElkID0gZSksIHQuc2VxdWVuY2VOdW1iZXIgPiB0aGlzLmJzICYmICh0aGlzLmJzID0gdC5zZXF1ZW5jZU51bWJlcik7XG4gICAgfVxuICAgIGFkZFRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5EbihlKSwgdGhpcy50YXJnZXRDb3VudCArPSAxLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5EbihlKSwgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUnMuZGVsZXRlKGUudGFyZ2V0KSwgdGhpcy5Qcy5scyhlLnRhcmdldElkKSwgdGhpcy50YXJnZXRDb3VudCAtPSAxLCBcbiAgICAgICAgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLlJzLmZvckVhY2goKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBvLnNlcXVlbmNlTnVtYmVyIDw9IGUgJiYgbnVsbCA9PT0gbi5nZXQoby50YXJnZXRJZCkgJiYgKHRoaXMuUnMuZGVsZXRlKHIpLCBpLnB1c2godGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBvLnRhcmdldElkKSksIFxuICAgICAgICAgICAgcysrKTtcbiAgICAgICAgfSkpLCBBdC53YWl0Rm9yKGkpLm5leHQoKCgpID0+IHMpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQodCkge1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLlJzLmdldChlKSB8fCBudWxsO1xuICAgICAgICByZXR1cm4gQXQucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUHMudXMoZSwgbiksIEF0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5Qcy5ocyhlLCBuKTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUsIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHMgJiYgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKTtcbiAgICAgICAgfSkpLCBBdC53YWl0Rm9yKGkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlBzLmxzKGUpLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuUHMuZHMoZSk7XG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBBdC5yZXNvbHZlKHRoaXMuUHMuY29udGFpbnNLZXkoZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtZW1vcnktYmFja2VkIGluc3RhbmNlIG9mIFBlcnNpc3RlbmNlLiBEYXRhIGlzIHN0b3JlZCBvbmx5IGluIFJBTSBhbmRcbiAqIG5vdCBwZXJzaXN0ZWQgYWNyb3NzIHNlc3Npb25zLlxuICovXG5jbGFzcyB1byB7XG4gICAgLyoqXG4gICAgICogVGhlIGNvbnN0cnVjdG9yIGFjY2VwdHMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBhIHJlZmVyZW5jZSBkZWxlZ2F0ZS4gVGhpc1xuICAgICAqIGFsbG93cyBib3RoIHRoZSBkZWxlZ2F0ZSBhbmQgdGhpcyBpbnN0YW5jZSB0byBoYXZlIHN0cm9uZyByZWZlcmVuY2VzIHRvXG4gICAgICogZWFjaCBvdGhlciB3aXRob3V0IGhhdmluZyBudWxsYWJsZSBmaWVsZHMgdGhhdCB3b3VsZCB0aGVuIG5lZWQgdG8gYmVcbiAgICAgKiBjaGVja2VkIG9yIGFzc2VydGVkIG9uIGV2ZXJ5IGFjY2Vzcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuVnMgPSB7fSwgdGhpcy5vdmVybGF5cyA9IHt9LCB0aGlzLlNzID0gbmV3IE90KDApLCB0aGlzLkRzID0gITEsIHRoaXMuRHMgPSAhMCwgXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSB0KHRoaXMpLCB0aGlzLkNzID0gbmV3IG9vKHRoaXMpO1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IG5ldyBkciwgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBpbyh0KTtcbiAgICAgICAgfSgodCA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLnhzKHQpKSksIHRoaXMuSXQgPSBuZXcgJGkoZSksIHRoaXMuTnMgPSBuZXcgWnIodGhpcy5JdCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICAvLyBObyBkdXJhYmxlIHN0YXRlIHRvIGVuc3VyZSBpcyBjbG9zZWQgb24gc2h1dGRvd24uXG4gICAgICAgIHJldHVybiB0aGlzLkRzID0gITEsIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRHM7XG4gICAgfVxuICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgc2V0TmV0d29ya0VuYWJsZWQoKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICAvLyBXZSBkbyBub3QgY3VycmVudGx5IHN1cHBvcnQgaW5kaWNlcyBmb3IgbWVtb3J5IHBlcnNpc3RlbmNlLCBzbyB3ZSBjYW5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzYW1lIHNoYXJlZCBpbnN0YW5jZSBvZiB0aGUgbWVtb3J5IGluZGV4IG1hbmFnZXIuXG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlcjtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMub3ZlcmxheXNbdC50b0tleSgpXTtcbiAgICAgICAgcmV0dXJuIGUgfHwgKGUgPSBuZXcgdG8sIHRoaXMub3ZlcmxheXNbdC50b0tleSgpXSA9IGUpLCBlO1xuICAgIH1cbiAgICBnZXRNdXRhdGlvblF1ZXVlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSB0aGlzLlZzW3QudG9LZXkoKV07XG4gICAgICAgIHJldHVybiBuIHx8IChuID0gbmV3IHNvKGUsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpLCB0aGlzLlZzW3QudG9LZXkoKV0gPSBuKSwgbjtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkNzO1xuICAgIH1cbiAgICBnZXRSZW1vdGVEb2N1bWVudENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTnM7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgQyhcIk1lbW9yeVBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gbmV3IGNvKHRoaXMuU3MubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUua3MoKSwgbihzKS5uZXh0KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuT3MocykubmV4dCgoKCkgPT4gdCkpKSkudG9Qcm9taXNlKCkudGhlbigodCA9PiAocy5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIE1zKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEF0Lm9yKE9iamVjdC52YWx1ZXModGhpcy5WcykubWFwKChuID0+ICgpID0+IG4uY29udGFpbnNLZXkodCwgZSkpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cbiAqLyBjbGFzcyBjbyBleHRlbmRzIFR0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIGFvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyBhbGwgZG9jdW1lbnRzIHRoYXQgYXJlIGFjdGl2ZSBpbiBRdWVyeSB2aWV3cy4gKi9cbiAgICAgICAgdGhpcy5GcyA9IG5ldyBlbywgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLiRzID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIEJzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhbyh0KTtcbiAgICB9XG4gICAgZ2V0IExzKCkge1xuICAgICAgICBpZiAodGhpcy4kcykgcmV0dXJuIHRoaXMuJHM7XG4gICAgICAgIHRocm93IE8oKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRnMuYWRkUmVmZXJlbmNlKG4sIGUpLCB0aGlzLkxzLmRlbGV0ZShuLnRvU3RyaW5nKCkpLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkZzLnJlbW92ZVJlZmVyZW5jZShuLCBlKSwgdGhpcy5Mcy5hZGQobi50b1N0cmluZygpKSwgQXQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkxzLmFkZChlLnRvU3RyaW5nKCkpLCBBdC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuRnMubHMoZS50YXJnZXRJZCkuZm9yRWFjaCgodCA9PiB0aGlzLkxzLmFkZCh0LnRvU3RyaW5nKCkpKSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCk7XG4gICAgICAgIHJldHVybiBuLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMuTHMuYWRkKHQudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ucmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSkpO1xuICAgIH1cbiAgICBrcygpIHtcbiAgICAgICAgdGhpcy4kcyA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIE9zKHQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIG5ld2x5IG9ycGhhbmVkIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4gQXQuZm9yRWFjaCh0aGlzLkxzLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gY3QuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5Vcyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8IGUucmVtb3ZlRW50cnkocywgc3QubWluKCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHRoaXMuJHMgPSBudWxsLCBlLmFwcGx5KHQpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXModCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0ID8gdGhpcy5Mcy5kZWxldGUoZS50b1N0cmluZygpKSA6IHRoaXMuTHMuYWRkKGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgeHModCkge1xuICAgICAgICAvLyBGb3IgZWFnZXIgR0MsIHdlIGRvbid0IGNhcmUgYWJvdXQgdGhlIGRvY3VtZW50IHNpemUsIHRoZXJlIGFyZSBubyBzaXplIHRocmVzaG9sZHMuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBVcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiBBdC5vcihbICgpID0+IEF0LnJlc29sdmUodGhpcy5Gcy5jb250YWluc0tleShlKSksICgpID0+IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5jb250YWluc0tleSh0LCBlKSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS5Ncyh0LCBlKSBdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy4gKi8gY2xhc3MgaG8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5JdCA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGRhdGFiYXNlIGNyZWF0aW9uIGFuZCBzY2hlbWEgdXBncmFkZXMuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgaW4gcHJvZHVjdGlvbiwgdGhpcyBtZXRob2QgaXMgb25seSBldmVyIHVzZWQgdG8gdXBncmFkZSB0aGUgc2NoZW1hXG4gICAgICogdG8gU0NIRU1BX1ZFUlNJT04uIERpZmZlcmVudCB2YWx1ZXMgb2YgdG9WZXJzaW9uIGFyZSBvbmx5IHVzZWQgZm9yIHRlc3RpbmdcbiAgICAgKiBhbmQgbG9jYWwgZmVhdHVyZSBkZXZlbG9wbWVudC5cbiAgICAgKi8gICAgJCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgUnQoXCJjcmVhdGVPclVwZ3JhZGVcIiwgZSk7XG4gICAgICAgIG4gPCAxICYmIHMgPj0gMSAmJiAoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm93bmVyXCIpO1xuICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwibXV0YXRpb25RdWV1ZXNcIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IFwidXNlcklkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm11dGF0aW9uc1wiLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogXCJiYXRjaElkXCIsXG4gICAgICAgICAgICAgICAgYXV0b0luY3JlbWVudDogITBcbiAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KFwidXNlck11dGF0aW9uc0luZGV4XCIsIGFpLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgfSksIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJkb2N1bWVudE11dGF0aW9uc1wiKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cbiAqLyAodCksIGxvKHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpO1xuICAgICAgICB9KHQpKTtcbiAgICAgICAgLy8gTWlncmF0aW9uIDIgdG8gcG9wdWxhdGUgdGhlIHRhcmdldEdsb2JhbCBvYmplY3Qgbm8gbG9uZ2VyIG5lZWRlZCBzaW5jZVxuICAgICAgICAvLyBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxuICAgICAgICAgICAgICAgIGxldCByID0gQXQucmVzb2x2ZSgpO1xuICAgICAgICByZXR1cm4gbiA8IDMgJiYgcyA+PSAzICYmIChcbiAgICAgICAgLy8gQnJhbmQgbmV3IGNsaWVudHMgZG9uJ3QgbmVlZCB0byBkcm9wIGFuZCByZWNyZWF0ZS0tb25seSBjbGllbnRzIHRoYXRcbiAgICAgICAgLy8gcG90ZW50aWFsbHkgaGF2ZSBjb3JydXB0IGRhdGEuXG4gICAgICAgIDAgIT09IG4gJiYgKCFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmRlbGV0ZU9iamVjdFN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIpLCB0LmRlbGV0ZU9iamVjdFN0b3JlKFwidGFyZ2V0c1wiKSwgdC5kZWxldGVPYmplY3RTdG9yZShcInRhcmdldEdsb2JhbFwiKTtcbiAgICAgICAgfSh0KSwgbG8odCkpLCByID0gci5uZXh0KCgoKSA9PiBcbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIHRoZSB0YXJnZXQgZ2xvYmFsIHNpbmdsZXRvbiByb3cuXG4gKlxuICogQHBhcmFtIHR4biAtIFRoZSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZm9yIGluZGV4ZWRkYlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKFwidGFyZ2V0R2xvYmFsXCIpLCBuID0ge1xuICAgICAgICAgICAgICAgIGhpZ2hlc3RUYXJnZXRJZDogMCxcbiAgICAgICAgICAgICAgICBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI6IDAsXG4gICAgICAgICAgICAgICAgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbjogc3QubWluKCkudG9UaW1lc3RhbXAoKSxcbiAgICAgICAgICAgICAgICB0YXJnZXRDb3VudDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBlLnB1dChcInRhcmdldEdsb2JhbEtleVwiLCBuKTtcbiAgICAgICAgfShpKSkpKSwgbiA8IDQgJiYgcyA+PSA0ICYmICgwICE9PSBuICYmIChcbiAgICAgICAgLy8gU2NoZW1hIHZlcnNpb24gMyB1c2VzIGF1dG8tZ2VuZXJhdGVkIGtleXMgdG8gZ2VuZXJhdGUgZ2xvYmFsbHkgdW5pcXVlXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoIElEcyAodGhpcyB3YXMgcHJldmlvdXNseSBlbnN1cmVkIGludGVybmFsbHkgYnkgdGhlXG4gICAgICAgIC8vIGNsaWVudCkuIFRvIG1pZ3JhdGUgdG8gdGhlIG5ldyBzY2hlbWEsIHdlIGhhdmUgdG8gcmVhZCBhbGwgbXV0YXRpb25zXG4gICAgICAgIC8vIGFuZCB3cml0ZSB0aGVtIGJhY2sgb3V0LiBXZSBwcmVzZXJ2ZSB0aGUgZXhpc3RpbmcgYmF0Y2ggSURzIHRvIGd1YXJhbnRlZVxuICAgICAgICAvLyBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIG9iamVjdCBzdG9yZXMuIEFueSBmdXJ0aGVyIG11dGF0aW9uIGJhdGNoIElEcyB3aWxsXG4gICAgICAgIC8vIGJlIGF1dG8tZ2VuZXJhdGVkLlxuICAgICAgICByID0gci5uZXh0KCgoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gZS5zdG9yZShcIm11dGF0aW9uc1wiKS5XKCkubmV4dCgobiA9PiB7XG4gICAgICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZShcIm11dGF0aW9uc1wiKTtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwibXV0YXRpb25zXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogXCJiYXRjaElkXCIsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6ICEwXG4gICAgICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgoXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgYWksIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlLnN0b3JlKFwibXV0YXRpb25zXCIpLCBpID0gbi5tYXAoKHQgPT4gcy5wdXQodCkpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXQud2FpdEZvcihpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSh0LCBpKSkpKSwgciA9IHIubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiY2xpZW50TWV0YWRhdGFcIiwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBcImNsaWVudElkXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0odCk7XG4gICAgICAgIH0pKSksIG4gPCA1ICYmIHMgPj0gNSAmJiAociA9IHIubmV4dCgoKCkgPT4gdGhpcy5xcyhpKSkpKSwgbiA8IDYgJiYgcyA+PSA2ICYmIChyID0gci5uZXh0KCgoKSA9PiAoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcInJlbW90ZURvY3VtZW50R2xvYmFsXCIpO1xuICAgICAgICB9KHQpLCB0aGlzLktzKGkpKSkpKSwgbiA8IDcgJiYgcyA+PSA3ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLkdzKGkpKSkpLCBuIDwgOCAmJiBzID49IDggJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuUXModCwgaSkpKSksIFxuICAgICAgICBuIDwgOSAmJiBzID49IDkgJiYgKHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIE11bHRpLVRhYiB1c2VkIHRvIG1hbmFnZSBpdHMgb3duIGNoYW5nZWxvZywgYnV0IHRoaXMgaGFzIGJlZW4gbW92ZWRcbiAgICAgICAgICAgIC8vIHRvIHRoZSBEYlJlbW90ZURvY3VtZW50IG9iamVjdCBzdG9yZSBpdHNlbGYuIFNpbmNlIHRoZSBwcmV2aW91cyBjaGFuZ2VcbiAgICAgICAgICAgIC8vIGxvZyBvbmx5IGNvbnRhaW5lZCB0cmFuc2llbnQgZGF0YSwgd2UgY2FuIGRyb3AgaXRzIG9iamVjdCBzdG9yZS5cbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpICYmIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudENoYW5nZXNcIik7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICAgICAgLy8gTm90ZTogU2NoZW1hIHZlcnNpb24gOSB1c2VkIHRvIGNyZWF0ZSBhIHJlYWQgdGltZSBpbmRleCBmb3IgdGhlXG4gICAgICAgICAgICAvLyBSZW1vdGVEb2N1bWVudENhY2hlLiBUaGlzIGlzIG5vdyBkb25lIHdpdGggc2NoZW1hIHZlcnNpb24gMTMuXG4gICAgICAgICAgICAgICAgfSkpKSwgbiA8IDEwICYmIHMgPj0gMTAgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuanMoaSkpKSksIG4gPCAxMSAmJiBzID49IDExICYmIChyID0gci5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJidW5kbGVzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogXCJidW5kbGVJZFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm5hbWVkUXVlcmllc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFwibmFtZVwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICB9KSkpLCBuIDwgMTIgJiYgcyA+PSAxMiAmJiAociA9IHIubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jcmVhdGVPYmplY3RTdG9yZShcImRvY3VtZW50T3ZlcmxheXNcIiwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBSaVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlSW5kZXgoXCJjb2xsZWN0aW9uUGF0aE92ZXJsYXlJbmRleFwiLCBiaSwge1xuICAgICAgICAgICAgICAgICAgICB1bmlxdWU6ICExXG4gICAgICAgICAgICAgICAgfSksIGUuY3JlYXRlSW5kZXgoXCJjb2xsZWN0aW9uR3JvdXBPdmVybGF5SW5kZXhcIiwgUGksIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgfSkpKSwgbiA8IDEzICYmIHMgPj0gMTMgJiYgKHIgPSByLm5leHQoKCgpID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNyZWF0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRzVjE0XCIsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBkaVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlLmNyZWF0ZUluZGV4KFwiZG9jdW1lbnRLZXlJbmRleFwiLCBfaSksIGUuY3JlYXRlSW5kZXgoXCJjb2xsZWN0aW9uR3JvdXBJbmRleFwiLCB3aSk7XG4gICAgICAgIH0odCkpKS5uZXh0KCgoKSA9PiB0aGlzLldzKHQsIGkpKSkubmV4dCgoKCkgPT4gdC5kZWxldGVPYmplY3RTdG9yZShcInJlbW90ZURvY3VtZW50c1wiKSkpKSwgXG4gICAgICAgIG4gPCAxNCAmJiBzID49IDE0ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLnpzKHQsIGkpKSkpLCBuIDwgMTUgJiYgcyA+PSAxNSAmJiAociA9IHIubmV4dCgoKCkgPT4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImluZGV4Q29uZmlndXJhdGlvblwiLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogXCJpbmRleElkXCIsXG4gICAgICAgICAgICAgICAgYXV0b0luY3JlbWVudDogITBcbiAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgXCJjb2xsZWN0aW9uR3JvdXBcIiwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogITFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImluZGV4U3RhdGVcIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IElpXG4gICAgICAgICAgICB9KS5jcmVhdGVJbmRleChcInNlcXVlbmNlTnVtYmVySW5kZXhcIiwgVGksIHtcbiAgICAgICAgICAgICAgICB1bmlxdWU6ICExXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJpbmRleEVudHJpZXNcIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IEVpXG4gICAgICAgICAgICB9KS5jcmVhdGVJbmRleChcImRvY3VtZW50S2V5SW5kZXhcIiwgQWksIHtcbiAgICAgICAgICAgICAgICB1bmlxdWU6ICExXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSh0KSkpKSwgcjtcbiAgICB9XG4gICAgS3ModCkge1xuICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLlooKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBlICs9IGJyKG4pO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHtcbiAgICAgICAgICAgICAgICBieXRlU2l6ZTogZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB0LnN0b3JlKFwicmVtb3RlRG9jdW1lbnRHbG9iYWxcIikucHV0KFwicmVtb3RlRG9jdW1lbnRHbG9iYWxLZXlcIiwgbik7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgcXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5zdG9yZShcIm11dGF0aW9uUXVldWVzXCIpLCBuID0gdC5zdG9yZShcIm11dGF0aW9uc1wiKTtcbiAgICAgICAgcmV0dXJuIGUuVygpLm5leHQoKGUgPT4gQXQuZm9yRWFjaChlLCAoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlLnVzZXJJZCwgLTEgXSwgWyBlLnVzZXJJZCwgZS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCBdKTtcbiAgICAgICAgICAgIHJldHVybiBuLlcoXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgcykubmV4dCgobiA9PiBBdC5mb3JFYWNoKG4sIChuID0+IHtcbiAgICAgICAgICAgICAgICBNKG4udXNlcklkID09PSBlLnVzZXJJZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IEdpKHRoaXMuSXQsIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBScih0LCBlLnVzZXJJZCwgcykubmV4dCgoKCkgPT4ge30pKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlcyB0aGF0IGV2ZXJ5IGRvY3VtZW50IGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgaGFzIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3dcbiAgICAgKiB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLiBNaXNzaW5nIHJvd3MgYXJlIGdpdmVuIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgc2VxdWVuY2UgbnVtYmVyLlxuICAgICAqLyAgICBHcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIpLCBuID0gdC5zdG9yZShcInJlbW90ZURvY3VtZW50c1wiKTtcbiAgICAgICAgcmV0dXJuIHQuc3RvcmUoXCJ0YXJnZXRHbG9iYWxcIikuZ2V0KFwidGFyZ2V0R2xvYmFsS2V5XCIpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIG4uWigoKG4sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHJ0KG4pLCBvID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCByaSh0KSBdO1xuICAgICAgICAgICAgICAgIH0ocik7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuZ2V0KG8pLm5leHQoKG4gPT4gbiA/IEF0LnJlc29sdmUoKSA6IChuID0+IGUucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHJpKG4pLFxuICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXJcbiAgICAgICAgICAgICAgICB9KSkocikpKSk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gQXQud2FpdEZvcihzKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFFzKHQsIGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIsIHtcbiAgICAgICAgICAgIGtleVBhdGg6IHBpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBuID0gZS5zdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIpLCBzID0gbmV3IF9yLCBpID0gdCA9PiB7XG4gICAgICAgICAgICBpZiAocy5hZGQodCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBzID0gdC5wb3BMYXN0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHJpKHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiBlLnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLlooe1xuICAgICAgICAgICAgWDogITBcbiAgICAgICAgfSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IHJ0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIGkobi5wb3BMYXN0KCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZS5zdG9yZShcImRvY3VtZW50TXV0YXRpb25zXCIpLlooe1xuICAgICAgICAgICAgWDogITBcbiAgICAgICAgfSwgKChbdCwgZSwgbl0sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBjaShlKTtcbiAgICAgICAgICAgIHJldHVybiBpKHIucG9wTGFzdCgpKTtcbiAgICAgICAgfSkpKSk7XG4gICAgfVxuICAgIGpzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuc3RvcmUoXCJ0YXJnZXRzXCIpO1xuICAgICAgICByZXR1cm4gZS5aKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IFFpKG4pLCBpID0gamkodGhpcy5JdCwgcyk7XG4gICAgICAgICAgICByZXR1cm4gZS5wdXQoaSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgV3ModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS5zdG9yZShcInJlbW90ZURvY3VtZW50c1wiKSwgcyA9IFtdO1xuICAgICAgICByZXR1cm4gbi5aKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGUuc3RvcmUoXCJyZW1vdGVEb2N1bWVudHNWMTRcIiksIHIgPSAobyA9IG4sIG8uZG9jdW1lbnQgPyBuZXcgY3QocnQuZnJvbVN0cmluZyhvLmRvY3VtZW50Lm5hbWUpLnBvcEZpcnN0KDUpKSA6IG8ubm9Eb2N1bWVudCA/IGN0LmZyb21TZWdtZW50cyhvLm5vRG9jdW1lbnQucGF0aCkgOiBvLnVua25vd25Eb2N1bWVudCA/IGN0LmZyb21TZWdtZW50cyhvLnVua25vd25Eb2N1bWVudC5wYXRoKSA6IE8oKSkucGF0aC50b0FycmF5KCk7XG4gICAgICAgICAgICB2YXIgbztcbiAgICAgICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICAgICAgICAgICAgY29uc3QgdSA9IHtcbiAgICAgICAgICAgICAgICBwcmVmaXhQYXRoOiByLnNsaWNlKDAsIHIubGVuZ3RoIC0gMiksXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbkdyb3VwOiByW3IubGVuZ3RoIC0gMl0sXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRJZDogcltyLmxlbmd0aCAtIDFdLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBuLnJlYWRUaW1lIHx8IFsgMCwgMCBdLFxuICAgICAgICAgICAgICAgIHVua25vd25Eb2N1bWVudDogbi51bmtub3duRG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgbm9Eb2N1bWVudDogbi5ub0RvY3VtZW50LFxuICAgICAgICAgICAgICAgIGRvY3VtZW50OiBuLmRvY3VtZW50LFxuICAgICAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogISFuLmhhc0NvbW1pdHRlZE11dGF0aW9uc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHMucHVzaChpLnB1dCh1KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBBdC53YWl0Rm9yKHMpKSk7XG4gICAgfVxuICAgIHpzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUuc3RvcmUoXCJtdXRhdGlvbnNcIiksIHMgPSBHcih0aGlzLkl0KSwgaSA9IG5ldyB1byhhby5CcywgdGhpcy5JdC5yZSk7XG4gICAgICAgIHJldHVybiBuLlcoKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAgICAgbGV0IHMgPSBudWxsICE9PSAoZSA9IG4uZ2V0KHQudXNlcklkKSkgJiYgdm9pZCAwICE9PSBlID8gZSA6IGZzKCk7XG4gICAgICAgICAgICAgICAgR2kodGhpcy5JdCwgdCkua2V5cygpLmZvckVhY2goKHQgPT4gcyA9IHMuYWRkKHQpKSksIG4uc2V0KHQudXNlcklkLCBzKTtcbiAgICAgICAgICAgIH0pKSwgQXQuZm9yRWFjaChuLCAoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFAobiksIG8gPSB0ci5vZSh0aGlzLkl0LCByKSwgdSA9IGkuZ2V0SW5kZXhNYW5hZ2VyKHIpLCBjID0gUHIub2UociwgdGhpcy5JdCwgdSwgaS5yZWZlcmVuY2VEZWxlZ2F0ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBYcihzLCBjLCBvLCB1KS5yZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyhuZXcgeGkoZSwgT3QuYXQpLCB0KS5uZXh0KCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxvKHQpIHtcbiAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIsIHtcbiAgICAgICAga2V5UGF0aDogZ2lcbiAgICB9KS5jcmVhdGVJbmRleChcImRvY3VtZW50VGFyZ2V0c0luZGV4XCIsIHlpLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KTtcbiAgICAvLyBOT1RFOiBUaGlzIGlzIHVuaXF1ZSBvbmx5IGJlY2F1c2UgdGhlIFRhcmdldElkIGlzIHRoZSBzdWZmaXguXG4gICAgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldHNcIiwge1xuICAgICAgICBrZXlQYXRoOiBcInRhcmdldElkXCJcbiAgICB9KS5jcmVhdGVJbmRleChcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIG1pLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KSwgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldEdsb2JhbFwiKTtcbn1cblxuY29uc3QgZm8gPSBcIkZhaWxlZCB0byBvYnRhaW4gZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuIFRvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24gaGFzIHRvIGJlIGVuYWJsZWQgaW4gYWxsIHRhYnMuIElmIHlvdSBhcmUgdXNpbmcgYGV4cGVyaW1lbnRhbEZvcmNlT3duaW5nVGFiOnRydWVgLCBtYWtlIHN1cmUgdGhhdCBvbmx5IG9uZSB0YWIgaGFzIHBlcnNpc3RlbmNlIGVuYWJsZWQgYXQgYW55IGdpdmVuIHRpbWUuXCI7XG5cbi8qKlxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxuICovXG4vKipcbiAqIEFuIEluZGV4ZWREQi1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIHBlcnNpc3RlbnRseVxuICogYWNyb3NzIHNlc3Npb25zLlxuICpcbiAqIE9uIFdlYiBvbmx5LCB0aGUgRmlyZXN0b3JlIFNES3Mgc3VwcG9ydCBzaGFyZWQgYWNjZXNzIHRvIGl0cyBwZXJzaXN0ZW5jZVxuICogbGF5ZXIuIFRoaXMgYWxsb3dzIG11bHRpcGxlIGJyb3dzZXIgdGFicyB0byByZWFkIGFuZCB3cml0ZSB0byBJbmRleGVkRGIgYW5kXG4gKiB0byBzeW5jaHJvbml6ZSBzdGF0ZSBldmVuIHdpdGhvdXQgbmV0d29yayBjb25uZWN0aXZpdHkuIFNoYXJlZCBhY2Nlc3MgaXNcbiAqIGN1cnJlbnRseSBvcHRpb25hbCBhbmQgbm90IGVuYWJsZWQgdW5sZXNzIGFsbCBjbGllbnRzIGludm9rZVxuICogYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYHtzeW5jaHJvbml6ZVRhYnM6dHJ1ZX1gLlxuICpcbiAqIEluIG11bHRpLXRhYiBtb2RlLCBpZiBtdWx0aXBsZSBjbGllbnRzIGFyZSBhY3RpdmUgYXQgdGhlIHNhbWUgdGltZSwgdGhlIFNES1xuICogd2lsbCBkZXNpZ25hdGUgb25lIGNsaWVudCBhcyB0aGUg4oCccHJpbWFyeSBjbGllbnTigJ0uIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyDigJxvd25lcuKAnSBzdG9yZSBldmVyeSA0IHNlY29uZHMuIElmIHRoZSBwcmltYXJ5IGNsaWVudCBmYWlscyB0b1xuICogdXBkYXRlIHRoaXMgZW50cnksIGFub3RoZXIgY2xpZW50IGNhbiBhY3F1aXJlIHRoZSBsZWFzZSBhbmQgdGFrZSBvdmVyIGFzXG4gKiBwcmltYXJ5LlxuICpcbiAqIFNvbWUgcGVyc2lzdGVuY2Ugb3BlcmF0aW9ucyBpbiB0aGUgU0RLIGFyZSBkZXNpZ25hdGVkIGFzIHByaW1hcnktY2xpZW50IG9ubHlcbiAqIG9wZXJhdGlvbnMuIFRoaXMgaW5jbHVkZXMgdGhlIGFja25vd2xlZGdtZW50IG9mIG11dGF0aW9ucyBhbmQgYWxsIHVwZGF0ZXMgb2ZcbiAqIHJlbW90ZSBkb2N1bWVudHMuIFRoZSBlZmZlY3RzIG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHdyaXR0ZW4gdG8gcGVyc2lzdGVuY2VcbiAqIGFuZCB0aGVuIGJyb2FkY2FzdCB0byBvdGhlciB0YWJzIHZpYSBMb2NhbFN0b3JhZ2UgKHNlZVxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWApLCB3aGljaCB0aGVuIHJlZnJlc2ggdGhlaXIgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogU2ltaWxhcmx5LCB0aGUgcHJpbWFyeSBjbGllbnQgbGlzdGVucyB0byBub3RpZmljYXRpb25zIHNlbnQgYnkgc2Vjb25kYXJ5XG4gKiBjbGllbnRzIHRvIGRpc2NvdmVyIHBlcnNpc3RlbmNlIGNoYW5nZXMgd3JpdHRlbiBieSBzZWNvbmRhcnkgY2xpZW50cywgc3VjaCBhc1xuICogdGhlIGFkZGl0aW9uIG9mIG5ldyBtdXRhdGlvbnMgYW5kIHF1ZXJ5IHRhcmdldHMuXG4gKlxuICogSWYgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkIGFuZCBhbm90aGVyIHRhYiBhbHJlYWR5IG9idGFpbmVkIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSwgSW5kZXhlZERiUGVyc2lzdGVuY2UgZW50ZXJzIGEgZmFpbGVkIHN0YXRlIGFuZCBhbGwgc3Vic2VxdWVudFxuICogb3BlcmF0aW9ucyB3aWxsIGF1dG9tYXRpY2FsbHkgZmFpbC5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGFuIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gYSB0YWIgaXMgY2xvc2VkLCB0aGVcbiAqIHByaW1hcnkgbGVhc2UgaXMgcmVsZWFzZWQgaW1tZWRpYXRlbHkgKHRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbWFrZVxuICogc3VyZSB0aGF0IGEgcmVmcmVzaGVkIHRhYiBpcyBhYmxlIHRvIGltbWVkaWF0ZWx5IHJlLWFjcXVpcmUgdGhlIHByaW1hcnlcbiAqIGxlYXNlKS4gVW5mb3J0dW5hdGVseSwgSW5kZXhlZERCIGNhbm5vdCBiZSByZWxpYWJseSB1c2VkIGluIHdpbmRvdy51bmxvYWRcbiAqIHNpbmNlIGl0IGlzIGFuIGFzeW5jaHJvbm91cyBBUEkuIFNvIGluIGFkZGl0aW9uIHRvIGF0dGVtcHRpbmcgdG8gZ2l2ZSB1cCB0aGVcbiAqIGxlYXNlLCB0aGUgbGVhc2Vob2xkZXIgd3JpdGVzIGl0cyBjbGllbnQgSUQgdG8gYSBcInpvbWJpZWRDbGllbnRcIiBlbnRyeSBpblxuICogTG9jYWxTdG9yYWdlIHdoaWNoIGFjdHMgYXMgYW4gaW5kaWNhdG9yIHRoYXQgYW5vdGhlciB0YWIgc2hvdWxkIGdvIGFoZWFkIGFuZFxuICogdGFrZSB0aGUgcHJpbWFyeSBsZWFzZSBpbW1lZGlhdGVseSByZWdhcmRsZXNzIG9mIHRoZSBjdXJyZW50IGxlYXNlIHRpbWVzdGFtcC5cbiAqXG4gKiBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIGBzeW5jaHJvbml6ZVRhYnNgIHNlY3Rpb24gd2hlbiBtdWx0aS10YWIgaXMgbm9cbiAqIGxvbmdlciBvcHRpb25hbC5cbiAqL1xuY2xhc3MgX28ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gc3luY2hyb25pemUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiBtdWx0aXBsZSB0YWJzIGFuZCBzaGFyZVxuICAgICAqIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzLCBpLCByLCBvLCB1LCBjLCBcbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgZm9yY2VmdWxseSBvYnRhaW5zIGRhdGFiYXNlIGFjY2Vzcy4gRXhpc3RpbmcgdGFicyB3aWxsXG4gICAgICogbm8gbG9uZ2VyIGJlIGFibGUgdG8gYWNjZXNzIEluZGV4ZWREQi5cbiAgICAgKi9cbiAgICBhLCBoID0gMTUpIHtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSB0LCB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gZSwgdGhpcy5jbGllbnRJZCA9IG4sIFxuICAgICAgICB0aGlzLkhzID0gaSwgdGhpcy53aW5kb3cgPSByLCB0aGlzLmRvY3VtZW50ID0gbywgdGhpcy5KcyA9IGMsIHRoaXMuWXMgPSBhLCB0aGlzLlhzID0gaCwgXG4gICAgICAgIHRoaXMuU3MgPSBudWxsLCB0aGlzLkRzID0gITEsIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMubmV0d29ya0VuYWJsZWQgPSAhMCwgXG4gICAgICAgIC8qKiBPdXIgd2luZG93LnVubG9hZCBoYW5kbGVyLCBpZiByZWdpc3RlcmVkLiAqL1xuICAgICAgICB0aGlzLlpzID0gbnVsbCwgdGhpcy5pbkZvcmVncm91bmQgPSAhMSwgXG4gICAgICAgIC8qKiBPdXIgJ3Zpc2liaWxpdHljaGFuZ2UnIGxpc3RlbmVyIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMudGkgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBjbGllbnQgbWV0YWRhdGEgcmVmcmVzaCB0YXNrLiAqL1xuICAgICAgICB0aGlzLmVpID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLiAqL1xuICAgICAgICB0aGlzLm5pID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cbiAgICAgICAgdGhpcy5zaSA9IHQgPT4gUHJvbWlzZS5yZXNvbHZlKCksICFfby5DKCkpIHRocm93IG5ldyBMKEIuVU5JTVBMRU1FTlRFRCwgXCJUaGlzIHBsYXRmb3JtIGlzIGVpdGhlciBtaXNzaW5nIEluZGV4ZWREQiBvciBpcyBrbm93biB0byBoYXZlIGFuIGluY29tcGxldGUgaW1wbGVtZW50YXRpb24uIE9mZmxpbmUgcGVyc2lzdGVuY2UgaGFzIGJlZW4gZGlzYWJsZWQuXCIpO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gbmV3IExyKHRoaXMsIHMpLCB0aGlzLmlpID0gZSArIFwibWFpblwiLCB0aGlzLkl0ID0gbmV3ICRpKHUpLCBcbiAgICAgICAgdGhpcy5yaSA9IG5ldyBidCh0aGlzLmlpLCB0aGlzLlhzLCBuZXcgaG8odGhpcy5JdCkpLCB0aGlzLkNzID0gbmV3IHhyKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUsIHRoaXMuSXQpLCBcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gR3IodGhpcy5JdCksIHRoaXMuTnMgPSBuZXcgWWksIHRoaXMud2luZG93ICYmIHRoaXMud2luZG93LmxvY2FsU3RvcmFnZSA/IHRoaXMub2kgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UgOiAodGhpcy5vaSA9IG51bGwsIFxuICAgICAgICAhMSA9PT0gYSAmJiB4KFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJMb2NhbFN0b3JhZ2UgaXMgdW5hdmFpbGFibGUuIEFzIGEgcmVzdWx0LCBwZXJzaXN0ZW5jZSBtYXkgbm90IHdvcmsgcmVsaWFibHkuIEluIHBhcnRpY3VsYXIgZW5hYmxlUGVyc2lzdGVuY2UoKSBjb3VsZCBmYWlsIGltbWVkaWF0ZWx5IGFmdGVyIHJlZnJlc2hpbmcgdGhlIHBhZ2UuXCIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXR0ZW1wdCB0byBzdGFydCBJbmRleGVkRGIgcGVyc2lzdGVuY2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBXaGV0aGVyIHBlcnNpc3RlbmNlIHdhcyBlbmFibGVkLlxuICAgICAqLyAgICBzdGFydCgpIHtcbiAgICAgICAgLy8gTk9URTogVGhpcyBpcyBleHBlY3RlZCB0byBmYWlsIHNvbWV0aW1lcyAoaW4gdGhlIGNhc2Ugb2YgYW5vdGhlciB0YWJcbiAgICAgICAgLy8gYWxyZWFkeSBoYXZpbmcgdGhlIHBlcnNpc3RlbmNlIGxvY2spLCBzbyBpdCdzIHRoZSBmaXJzdCB0aGluZyB3ZSBzaG91bGRcbiAgICAgICAgLy8gZG8uXG4gICAgICAgIHJldHVybiB0aGlzLnVpKCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzUHJpbWFyeSAmJiAhdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgXG4gICAgICAgICAgICAvLyBGYWlsIGBzdGFydCgpYCBpZiBgc3luY2hyb25pemVUYWJzYCBpcyBkaXNhYmxlZCBhbmQgd2UgY2Fubm90XG4gICAgICAgICAgICAvLyBvYnRhaW4gdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICAgICAgICB0aHJvdyBuZXcgTChCLkZBSUxFRF9QUkVDT05ESVRJT04sIGZvKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNpKCksIHRoaXMuYWkoKSwgdGhpcy5oaSgpLCB0aGlzLnJ1blRyYW5zYWN0aW9uKFwiZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gdGhpcy5Dcy5nZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIodCkpKTtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5TcyA9IG5ldyBPdCh0LCB0aGlzLkpzKTtcbiAgICAgICAgfSkpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuRHMgPSAhMDtcbiAgICAgICAgfSkpLmNhdGNoKCh0ID0+ICh0aGlzLnJpICYmIHRoaXMucmkuY2xvc2UoKSwgUHJvbWlzZS5yZWplY3QodCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgcHJpbWFyeSBzdGF0ZSBvZiB0aGVcbiAgICAgKiBpbnN0YW5jZSBjaGFuZ2VzLiBVcG9uIHJlZ2lzdGVyaW5nLCB0aGlzIGxpc3RlbmVyIGlzIGludm9rZWQgaW1tZWRpYXRlbHlcbiAgICAgKiB3aXRoIHRoZSBjdXJyZW50IHByaW1hcnkgc3RhdGUuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBsaSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpID0gYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSByZXR1cm4gdChlKTtcbiAgICAgICAgfSwgdCh0aGlzLmlzUHJpbWFyeSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgZGF0YWJhc2UgcmVjZWl2ZXMgYVxuICAgICAqIHZlcnNpb24gY2hhbmdlIGV2ZW50IGluZGljYXRpbmcgdGhhdCBpdCBoYXMgZGVsZXRlZC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5yaS5MKChhc3luYyBlID0+IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGFuIGF0dGVtcHQgaXMgbWFkZSB0byBkZWxldGUgSW5kZXhlZERCLlxuICAgICAgICAgICAgbnVsbCA9PT0gZS5uZXdWZXJzaW9uICYmIGF3YWl0IHQoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGp1c3RzIHRoZSBjdXJyZW50IG5ldHdvcmsgc3RhdGUgaW4gdGhlIGNsaWVudCdzIG1ldGFkYXRhLCBwb3RlbnRpYWxseVxuICAgICAqIGFmZmVjdGluZyB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHNldE5ldHdvcmtFbmFibGVkKHQpIHtcbiAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCAhPT0gdCAmJiAodGhpcy5uZXR3b3JrRW5hYmxlZCA9IHQsIFxuICAgICAgICAvLyBTY2hlZHVsZSBhIHByaW1hcnkgbGVhc2UgcmVmcmVzaCBmb3IgaW1tZWRpYXRlIGV4ZWN1dGlvbi4gVGhlIGV2ZW50dWFsXG4gICAgICAgIC8vIGxlYXNlIHVwZGF0ZSB3aWxsIGJlIHByb3BhZ2F0ZWQgdmlhIGBwcmltYXJ5U3RhdGVMaXN0ZW5lcmAuXG4gICAgICAgIHRoaXMuSHMuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGFydGVkICYmIGF3YWl0IHRoaXMudWkoKTtcbiAgICAgICAgfSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgY2xpZW50IG1ldGFkYXRhIGluIEluZGV4ZWREYiBhbmQgYXR0ZW1wdHMgdG8gZWl0aGVyIG9idGFpbiBvclxuICAgICAqIGV4dGVuZCB0aGUgcHJpbWFyeSBsZWFzZSBmb3IgdGhlIGxvY2FsIGNsaWVudC4gQXN5bmNocm9ub3VzbHkgbm90aWZpZXMgdGhlXG4gICAgICogcHJpbWFyeSBzdGF0ZSBsaXN0ZW5lciBpZiB0aGUgY2xpZW50IGVpdGhlciBuZXdseSBvYnRhaW5lZCBvciByZWxlYXNlZCBpdHNcbiAgICAgKiBwcmltYXJ5IGxlYXNlLlxuICAgICAqLyAgICB1aSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucnVuVHJhbnNhY3Rpb24oXCJ1cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnlcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gbW8odCkucHV0KHtcbiAgICAgICAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgbmV0d29ya0VuYWJsZWQ6IHRoaXMubmV0d29ya0VuYWJsZWQsXG4gICAgICAgICAgICBpbkZvcmVncm91bmQ6IHRoaXMuaW5Gb3JlZ3JvdW5kXG4gICAgICAgIH0pLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkgcmV0dXJuIHRoaXMuZmkodCkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdCB8fCAodGhpcy5pc1ByaW1hcnkgPSAhMSwgdGhpcy5Icy5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0aGlzLnNpKCExKSkpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHRoaXMuZGkodCkpKS5uZXh0KChlID0+IHRoaXMuaXNQcmltYXJ5ICYmICFlID8gdGhpcy5faSh0KS5uZXh0KCgoKSA9PiAhMSkpIDogISFlICYmIHRoaXMud2kodCkubmV4dCgoKCkgPT4gITApKSkpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgaWYgKFZ0KHQpKSBcbiAgICAgICAgICAgIC8vIFByb2NlZWQgd2l0aCB0aGUgZXhpc3Rpbmcgc3RhdGUuIEFueSBzdWJzZXF1ZW50IGFjY2VzcyB0b1xuICAgICAgICAgICAgLy8gSW5kZXhlZERCIHdpbGwgdmVyaWZ5IHRoZSBsZWFzZS5cbiAgICAgICAgICAgIHJldHVybiBDKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJGYWlsZWQgdG8gZXh0ZW5kIG93bmVyIGxlYXNlOiBcIiwgdCksIHRoaXMuaXNQcmltYXJ5O1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSB0aHJvdyB0O1xuICAgICAgICAgICAgcmV0dXJuIEMoXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIlJlbGVhc2luZyBvd25lciBsZWFzZSBhZnRlciBlcnJvciBkdXJpbmcgbGVhc2UgcmVmcmVzaFwiLCB0KSwgXG4gICAgICAgICAgICAvKiBpc1ByaW1hcnk9ICovICExO1xuICAgICAgICB9KSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzUHJpbWFyeSAhPT0gdCAmJiB0aGlzLkhzLmVucXVldWVSZXRyeWFibGUoKCgpID0+IHRoaXMuc2kodCkpKSwgdGhpcy5pc1ByaW1hcnkgPSB0O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGZpKHQpIHtcbiAgICAgICAgcmV0dXJuIHdvKHQpLmdldChcIm93bmVyXCIpLm5leHQoKHQgPT4gQXQucmVzb2x2ZSh0aGlzLm1pKHQpKSkpO1xuICAgIH1cbiAgICBnaSh0KSB7XG4gICAgICAgIHJldHVybiBtbyh0KS5kZWxldGUodGhpcy5jbGllbnRJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHRoZSBnYXJiYWdlIGNvbGxlY3Rpb24gdGhyZXNob2xkIGhhcyBwYXNzZWQsIHBydW5lcyB0aGVcbiAgICAgKiBSZW1vdGVEb2N1bWVudENoYW5nZXMgYW5kIHRoZSBDbGllbnRNZXRhZGF0YSBzdG9yZSBiYXNlZCBvbiB0aGUgbGFzdCB1cGRhdGVcbiAgICAgKiB0aW1lIG9mIGFsbCBjbGllbnRzLlxuICAgICAqLyAgICBhc3luYyB5aSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5ICYmICF0aGlzLnBpKHRoaXMubmksIDE4ZTUpKSB7XG4gICAgICAgICAgICB0aGlzLm5pID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBhd2FpdCB0aGlzLnJ1blRyYW5zYWN0aW9uKFwibWF5YmVHYXJiYWdlQ29sbGVjdE11bHRpQ2xpZW50U3RhdGVcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IE5pKHQsIFwiY2xpZW50TWV0YWRhdGFcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuVygpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5JaSh0LCAxOGU1KSwgcyA9IHQuZmlsdGVyKCh0ID0+IC0xID09PSBuLmluZGV4T2YodCkpKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIG1ldGFkYXRhIGZvciBjbGllbnRzIHRoYXQgYXJlIG5vIGxvbmdlciBjb25zaWRlcmVkIGFjdGl2ZS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEF0LmZvckVhY2gocywgKHQgPT4gZS5kZWxldGUodC5jbGllbnRJZCkpKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLmNhdGNoKCgoKSA9PiBbXSkpO1xuICAgICAgICAgICAgLy8gRGVsZXRlIHBvdGVudGlhbCBsZWZ0b3ZlciBlbnRyaWVzIHRoYXQgbWF5IGNvbnRpbnVlIHRvIG1hcmsgdGhlXG4gICAgICAgICAgICAvLyBpbmFjdGl2ZSBjbGllbnRzIGFzIHpvbWJpZWQgaW4gTG9jYWxTdG9yYWdlLlxuICAgICAgICAgICAgLy8gSWRlYWxseSB3ZSdkIGRlbGV0ZSB0aGUgSW5kZXhlZERiIGFuZCBMb2NhbFN0b3JhZ2Ugem9tYmllIGVudHJpZXMgZm9yXG4gICAgICAgICAgICAvLyB0aGUgY2xpZW50IGF0b21pY2FsbHksIGJ1dCB3ZSBjYW4ndC4gU28gd2Ugb3B0IHRvIGRlbGV0ZSB0aGUgSW5kZXhlZERiXG4gICAgICAgICAgICAvLyBlbnRyaWVzIGZpcnN0IHRvIGF2b2lkIHBvdGVudGlhbGx5IHJldml2aW5nIGEgem9tYmllZCBjbGllbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vaSkgZm9yIChjb25zdCBlIG9mIHQpIHRoaXMub2kucmVtb3ZlSXRlbSh0aGlzLlRpKGUuY2xpZW50SWQpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTY2hlZHVsZXMgYSByZWN1cnJpbmcgdGltZXIgdG8gdXBkYXRlIHRoZSBjbGllbnQgbWV0YWRhdGEgYW5kIHRvIGVpdGhlclxuICAgICAqIGV4dGVuZCBvciBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIGlmIHRoZSBjbGllbnQgaXMgZWxpZ2libGUuXG4gICAgICovICAgIGhpKCkge1xuICAgICAgICB0aGlzLmVpID0gdGhpcy5Icy5lbnF1ZXVlQWZ0ZXJEZWxheShcImNsaWVudF9tZXRhZGF0YV9yZWZyZXNoXCIgLyogQ2xpZW50TWV0YWRhdGFSZWZyZXNoICovICwgNGUzLCAoKCkgPT4gdGhpcy51aSgpLnRoZW4oKCgpID0+IHRoaXMueWkoKSkpLnRoZW4oKCgpID0+IHRoaXMuaGkoKSkpKSk7XG4gICAgfVxuICAgIC8qKiBDaGVja3Mgd2hldGhlciBgY2xpZW50YCBpcyB0aGUgbG9jYWwgY2xpZW50LiAqLyAgICBtaSh0KSB7XG4gICAgICAgIHJldHVybiAhIXQgJiYgdC5vd25lcklkID09PSB0aGlzLmNsaWVudElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFdmFsdWF0ZSB0aGUgc3RhdGUgb2YgYWxsIGFjdGl2ZSBjbGllbnRzIGFuZCBkZXRlcm1pbmUgd2hldGhlciB0aGUgbG9jYWxcbiAgICAgKiBjbGllbnQgaXMgb3IgY2FuIGFjdCBhcyB0aGUgaG9sZGVyIG9mIHRoZSBwcmltYXJ5IGxlYXNlLiBSZXR1cm5zIHdoZXRoZXJcbiAgICAgKiB0aGUgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGUgbGVhc2UsIGJ1dCBkb2VzIG5vdCBhY3R1YWxseSBhY3F1aXJlIGl0LlxuICAgICAqIE1heSByZXR1cm4gJ2ZhbHNlJyBldmVuIGlmIHRoZXJlIGlzIG5vIGFjdGl2ZSBsZWFzZWhvbGRlciBhbmQgYW5vdGhlclxuICAgICAqIChmb3JlZ3JvdW5kKSBjbGllbnQgc2hvdWxkIGJlY29tZSBsZWFzZWhvbGRlciBpbnN0ZWFkLlxuICAgICAqLyAgICBkaSh0KSB7XG4gICAgICAgIGlmICh0aGlzLllzKSByZXR1cm4gQXQucmVzb2x2ZSghMCk7XG4gICAgICAgIHJldHVybiB3byh0KS5nZXQoXCJvd25lclwiKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIC8vIEEgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGUgcHJpbWFyeSBsZWFzZSBpZjpcbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgdGhlIGNsaWVudCdzIHRhYiBpcyBpbiB0aGUgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlXG4gICAgICAgICAgICAvLyAgIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGV2ZXJ5IGNsaWVudHMgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgbm8gb3RoZXIgY2xpZW50J3MgdGFiIGlzIGluXG4gICAgICAgICAgICAvLyAgIHRoZSBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSB0aGUgYGZvcmNlT3duaW5nVGFiYCBzZXR0aW5nIHdhcyBwYXNzZWQgaW4uXG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gZSAmJiB0aGlzLnBpKGUubGVhc2VUaW1lc3RhbXBNcywgNWUzKSAmJiAhdGhpcy5FaShlLm93bmVySWQpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubWkoZSkgJiYgdGhpcy5uZXR3b3JrRW5hYmxlZCkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5taShlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWUuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIFxuICAgICAgICAgICAgICAgICAgICAvLyBGYWlsIHRoZSBgY2FuQWN0QXNQcmltYXJ5YCBjaGVjayBpZiB0aGUgY3VycmVudCBsZWFzZWhvbGRlciBoYXNcbiAgICAgICAgICAgICAgICAgICAgLy8gbm90IG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi4gSWYgdGhpcyBoYXBwZW5zIGF0XG4gICAgICAgICAgICAgICAgICAgIC8vIGNsaWVudCBzdGFydHVwLCB3ZSByZWplY3QgdGhlIFByb21pc2UgcmV0dXJuZWQgYnlcbiAgICAgICAgICAgICAgICAgICAgLy8gYGVuYWJsZVBlcnNpc3RlbmNlKClgIGFuZCB0aGUgdXNlciBjYW4gY29udGludWUgdG8gdXNlIEZpcmVzdG9yZVxuICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIGluLW1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBmYWlscyBkdXJpbmcgYSBsZWFzZSByZWZyZXNoLCB3ZSB3aWxsIGluc3RlYWQgYmxvY2sgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgZnJvbSBleGVjdXRpbmcgZnVydGhlciBvcGVyYXRpb25zLiBOb3RlIHRoYXQgdGhpcyBpc1xuICAgICAgICAgICAgICAgICAgICAvLyBhY2NlcHRhYmxlIHNpbmNlIG1peGluZyAmIG1hdGNoaW5nIGRpZmZlcmVudCBgc3luY2hyb25pemVUYWJzYFxuICAgICAgICAgICAgICAgICAgICAvLyBzZXR0aW5ncyBpcyBub3Qgc3VwcG9ydGVkLlxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW5cbiAgICAgICAgICAgICAgICAgICAgLy8gbm8gbG9uZ2VyIGJlIHR1cm5lZCBvZmYuXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBMKEIuRkFJTEVEX1BSRUNPTkRJVElPTiwgZm8pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICEoIXRoaXMubmV0d29ya0VuYWJsZWQgfHwgIXRoaXMuaW5Gb3JlZ3JvdW5kKSB8fCBtbyh0KS5XKCkubmV4dCgodCA9PiB2b2lkIDAgPT09IHRoaXMuSWkodCwgNWUzKS5maW5kKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGllbnRJZCAhPT0gdC5jbGllbnRJZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gIXRoaXMubmV0d29ya0VuYWJsZWQgJiYgdC5uZXR3b3JrRW5hYmxlZCwgbiA9ICF0aGlzLmluRm9yZWdyb3VuZCAmJiB0LmluRm9yZWdyb3VuZCwgcyA9IHRoaXMubmV0d29ya0VuYWJsZWQgPT09IHQubmV0d29ya0VuYWJsZWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlIHx8IG4gJiYgcykgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgfSkpLm5leHQoKHQgPT4gKHRoaXMuaXNQcmltYXJ5ICE9PSB0ICYmIEMoXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBgQ2xpZW50ICR7dCA/IFwiaXNcIiA6IFwiaXMgbm90XCJ9IGVsaWdpYmxlIGZvciBhIHByaW1hcnkgbGVhc2UuYCksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICBhc3luYyBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gVGhlIHNodXRkb3duKCkgb3BlcmF0aW9ucyBhcmUgaWRlbXBvdGVudCBhbmQgY2FuIGJlIGNhbGxlZCBldmVuIHdoZW5cbiAgICAgICAgLy8gc3RhcnQoKSBhYm9ydGVkIChlLmcuIGJlY2F1c2UgaXQgY291bGRuJ3QgYWNxdWlyZSB0aGUgcGVyc2lzdGVuY2UgbGVhc2UpLlxuICAgICAgICB0aGlzLkRzID0gITEsIHRoaXMuQWkoKSwgdGhpcy5laSAmJiAodGhpcy5laS5jYW5jZWwoKSwgdGhpcy5laSA9IG51bGwpLCB0aGlzLlJpKCksIFxuICAgICAgICB0aGlzLmJpKCksIFxuICAgICAgICAvLyBVc2UgYFNpbXBsZURiLnJ1blRyYW5zYWN0aW9uYCBkaXJlY3RseSB0byBhdm9pZCBmYWlsaW5nIGlmIGFub3RoZXIgdGFiXG4gICAgICAgIC8vIGhhcyBvYnRhaW5lZCB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgICAgYXdhaXQgdGhpcy5yaS5ydW5UcmFuc2FjdGlvbihcInNodXRkb3duXCIsIFwicmVhZHdyaXRlXCIsIFsgXCJvd25lclwiLCBcImNsaWVudE1ldGFkYXRhXCIgXSwgKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyB4aSh0LCBPdC5hdCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faShlKS5uZXh0KCgoKSA9PiB0aGlzLmdpKGUpKSk7XG4gICAgICAgIH0pKSwgdGhpcy5yaS5jbG9zZSgpLCBcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBlbnRyeSBtYXJraW5nIHRoZSBjbGllbnQgYXMgem9tYmllZCBmcm9tIExvY2FsU3RvcmFnZSBzaW5jZVxuICAgICAgICAvLyB3ZSBzdWNjZXNzZnVsbHkgZGVsZXRlZCBpdHMgbWV0YWRhdGEgZnJvbSBJbmRleGVkRGIuXG4gICAgICAgIHRoaXMuUGkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBjbGllbnRzIHRoYXQgYXJlIG5vdCB6b21iaWVkIGFuZCBoYXZlIGFuIHVwZGF0ZVRpbWUgd2l0aGluIHRoZVxuICAgICAqIHByb3ZpZGVkIHRocmVzaG9sZC5cbiAgICAgKi8gICAgSWkodCwgZSkge1xuICAgICAgICByZXR1cm4gdC5maWx0ZXIoKHQgPT4gdGhpcy5waSh0LnVwZGF0ZVRpbWVNcywgZSkgJiYgIXRoaXMuRWkodC5jbGllbnRJZCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgSURzIG9mIHRoZSBjbGllbnRzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUuIElmIG11bHRpLXRhYlxuICAgICAqIGlzIG5vdCBzdXBwb3J0ZWQsIHJldHVybnMgYW4gYXJyYXkgdGhhdCBvbmx5IGNvbnRhaW5zIHRoZSBsb2NhbCBjbGllbnQnc1xuICAgICAqIElELlxuICAgICAqXG4gICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgV2ViIG11bHRpLXRhYi5cbiAgICAgKi8gICAgdmkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJ1blRyYW5zYWN0aW9uKFwiZ2V0QWN0aXZlQ2xpZW50c1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IG1vKHQpLlcoKS5uZXh0KCh0ID0+IHRoaXMuSWkodCwgMThlNSkubWFwKCh0ID0+IHQuY2xpZW50SWQpKSkpKSk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5EcztcbiAgICB9XG4gICAgZ2V0TXV0YXRpb25RdWV1ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBQci5vZSh0LCB0aGlzLkl0LCBlLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkNzO1xuICAgIH1cbiAgICBnZXRSZW1vdGVEb2N1bWVudENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IG1yKHQsIHRoaXMuSXQucmUuZGF0YWJhc2VJZCk7XG4gICAgfVxuICAgIGdldERvY3VtZW50T3ZlcmxheUNhY2hlKHQpIHtcbiAgICAgICAgcmV0dXJuIHRyLm9lKHRoaXMuSXQsIHQpO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTnM7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgQyhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gXCJyZWFkb25seVwiID09PSBlID8gXCJyZWFkb25seVwiIDogXCJyZWFkd3JpdGVcIiwgaSA9IDE1ID09PSAociA9IHRoaXMuWHMpID8gQ2kgOiAxNCA9PT0gciA/IERpIDogMTMgPT09IHIgPyBTaSA6IDEyID09PSByID8gVmkgOiAxMSA9PT0gciA/IHZpIDogdm9pZCBPKCk7XG4gICAgICAgIC8qKiBSZXR1cm5zIHRoZSBvYmplY3Qgc3RvcmVzIGZvciB0aGUgcHJvdmlkZWQgc2NoZW1hLiAqL1xuICAgICAgICB2YXIgcjtcbiAgICAgICAgbGV0IG87XG4gICAgICAgIC8vIERvIGFsbCB0cmFuc2FjdGlvbnMgYXMgcmVhZHdyaXRlIGFnYWluc3QgYWxsIG9iamVjdCBzdG9yZXMsIHNpbmNlIHdlXG4gICAgICAgIC8vIGFyZSB0aGUgb25seSByZWFkZXIvd3JpdGVyLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJpLnJ1blRyYW5zYWN0aW9uKHQsIHMsIGksIChzID0+IChvID0gbmV3IHhpKHMsIHRoaXMuU3MgPyB0aGlzLlNzLm5leHQoKSA6IE90LmF0KSwgXG4gICAgICAgIFwicmVhZHdyaXRlLXByaW1hcnlcIiA9PT0gZSA/IHRoaXMuZmkobykubmV4dCgodCA9PiAhIXQgfHwgdGhpcy5kaShvKSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgaWYgKCFlKSB0aHJvdyB4KGBGYWlsZWQgdG8gb2J0YWluIHByaW1hcnkgbGVhc2UgZm9yIGFjdGlvbiAnJHt0fScuYCksIHRoaXMuaXNQcmltYXJ5ID0gITEsIFxuICAgICAgICAgICAgdGhpcy5Icy5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0aGlzLnNpKCExKSkpLCBuZXcgTChCLkZBSUxFRF9QUkVDT05ESVRJT04sIEl0KTtcbiAgICAgICAgICAgIHJldHVybiBuKG8pO1xuICAgICAgICB9KSkubmV4dCgodCA9PiB0aGlzLndpKG8pLm5leHQoKCgpID0+IHQpKSkpIDogdGhpcy5WaShvKS5uZXh0KCgoKSA9PiBuKG8pKSkpKSkudGhlbigodCA9PiAoby5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgdGhlIGN1cnJlbnQgdGFiIGlzIHRoZSBwcmltYXJ5IGxlYXNlaG9sZGVyIG9yIGFsdGVybmF0aXZlbHlcbiAgICAgKiB0aGF0IHRoZSBsZWFzZWhvbGRlciBoYXMgb3B0ZWQgaW50byBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgICAqL1xuICAgIC8vIFRPRE8oYi8xMTQyMjYyMzQpOiBSZW1vdmUgdGhpcyBjaGVjayB3aGVuIGBzeW5jaHJvbml6ZVRhYnNgIGNhbiBubyBsb25nZXJcbiAgICAvLyBiZSB0dXJuZWQgb2ZmLlxuICAgIFZpKHQpIHtcbiAgICAgICAgcmV0dXJuIHdvKHQpLmdldChcIm93bmVyXCIpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQgJiYgdGhpcy5waSh0LmxlYXNlVGltZXN0YW1wTXMsIDVlMykgJiYgIXRoaXMuRWkodC5vd25lcklkKSAmJiAhdGhpcy5taSh0KSAmJiAhKHRoaXMuWXMgfHwgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiAmJiB0LmFsbG93VGFiU3luY2hyb25pemF0aW9uKSkgdGhyb3cgbmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBmbyk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT2J0YWlucyBvciBleHRlbmRzIHRoZSBuZXcgcHJpbWFyeSBsZWFzZSBmb3IgdGhlIGxvY2FsIGNsaWVudC4gVGhpc1xuICAgICAqIG1ldGhvZCBkb2VzIG5vdCB2ZXJpZnkgdGhhdCB0aGUgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGlzIGxlYXNlLlxuICAgICAqLyAgICB3aSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBvd25lcklkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgYWxsb3dUYWJTeW5jaHJvbml6YXRpb246IHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24sXG4gICAgICAgICAgICBsZWFzZVRpbWVzdGFtcE1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB3byh0KS5wdXQoXCJvd25lclwiLCBlKTtcbiAgICB9XG4gICAgc3RhdGljIEMoKSB7XG4gICAgICAgIHJldHVybiBidC5DKCk7XG4gICAgfVxuICAgIC8qKiBDaGVja3MgdGhlIHByaW1hcnkgbGVhc2UgYW5kIHJlbW92ZXMgaXQgaWYgd2UgYXJlIHRoZSBjdXJyZW50IHByaW1hcnkuICovICAgIF9pKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHdvKHQpO1xuICAgICAgICByZXR1cm4gZS5nZXQoXCJvd25lclwiKS5uZXh0KCh0ID0+IHRoaXMubWkodCkgPyAoQyhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiUmVsZWFzaW5nIHByaW1hcnkgbGVhc2UuXCIpLCBcbiAgICAgICAgZS5kZWxldGUoXCJvd25lclwiKSkgOiBBdC5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgLyoqIFZlcmlmaWVzIHRoYXQgYHVwZGF0ZVRpbWVNc2AgaXMgd2l0aGluIGBtYXhBZ2VNc2AuICovICAgIHBpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiAhKHQgPCBuIC0gZSkgJiYgKCEodCA+IG4pIHx8ICh4KGBEZXRlY3RlZCBhbiB1cGRhdGUgdGltZSB0aGF0IGlzIGluIHRoZSBmdXR1cmU6ICR7dH0gPiAke259YCksIFxuICAgICAgICAhMSkpO1xuICAgIH1cbiAgICBjaSgpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5kb2N1bWVudCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAmJiAodGhpcy50aSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuSHMuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlLCBcbiAgICAgICAgICAgIHRoaXMudWkoKSkpKTtcbiAgICAgICAgfSwgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnRpKSwgdGhpcy5pbkZvcmVncm91bmQgPSBcInZpc2libGVcIiA9PT0gdGhpcy5kb2N1bWVudC52aXNpYmlsaXR5U3RhdGUpO1xuICAgIH1cbiAgICBSaSgpIHtcbiAgICAgICAgdGhpcy50aSAmJiAodGhpcy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnRpKSwgdGhpcy50aSA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdHRhY2hlcyBhIHdpbmRvdy51bmxvYWQgaGFuZGxlciB0aGF0IHdpbGwgc3luY2hyb25vdXNseSB3cml0ZSBvdXJcbiAgICAgKiBjbGllbnRJZCB0byBhIFwiem9tYmllIGNsaWVudCBpZFwiIGxvY2F0aW9uIGluIExvY2FsU3RvcmFnZS4gVGhpcyBjYW4gYmUgdXNlZFxuICAgICAqIGJ5IHRhYnMgdHJ5aW5nIHRvIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgdG8gZGV0ZXJtaW5lIHRoYXQgdGhlIGxlYXNlXG4gICAgICogaXMgbm8gbG9uZ2VyIHZhbGlkIGV2ZW4gaWYgdGhlIHRpbWVzdGFtcCBpcyByZWNlbnQuIFRoaXMgaXMgcGFydGljdWxhcmx5XG4gICAgICogaW1wb3J0YW50IGZvciB0aGUgcmVmcmVzaCBjYXNlIChzbyB0aGUgdGFiIGNvcnJlY3RseSByZS1hY3F1aXJlcyB0aGVcbiAgICAgKiBwcmltYXJ5IGxlYXNlKS4gTG9jYWxTdG9yYWdlIGlzIHVzZWQgZm9yIHRoaXMgcmF0aGVyIHRoYW4gSW5kZXhlZERiIGJlY2F1c2VcbiAgICAgKiBpdCBpcyBhIHN5bmNocm9ub3VzIEFQSSBhbmQgc28gY2FuIGJlIHVzZWQgcmVsaWFibHkgZnJvbSAgYW4gdW5sb2FkXG4gICAgICogaGFuZGxlci5cbiAgICAgKi8gICAgYWkoKSB7XG4gICAgICAgIHZhciB0O1xuICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIChudWxsID09PSAodCA9IHRoaXMud2luZG93KSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0LmFkZEV2ZW50TGlzdGVuZXIpICYmICh0aGlzLlpzID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gTm90ZTogSW4gdGhlb3J5LCB0aGlzIHNob3VsZCBiZSBzY2hlZHVsZWQgb24gdGhlIEFzeW5jUXVldWUgc2luY2UgaXRcbiAgICAgICAgICAgIC8vIGFjY2Vzc2VzIGludGVybmFsIHN0YXRlLiBXZSBleGVjdXRlIHRoaXMgY29kZSBkaXJlY3RseSBkdXJpbmcgc2h1dGRvd25cbiAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSBpdCBnZXRzIGEgY2hhbmNlIHRvIHJ1bi5cbiAgICAgICAgICAgIHRoaXMuQWkoKSwgaXNTYWZhcmkoKSAmJiBuYXZpZ2F0b3IuYXBwVmVyc2lvbi5tYXRjaCgvVmVyc2lvblxcLzFbNDVdLykgJiYgXG4gICAgICAgICAgICAvLyBPbiBTYWZhcmkgMTQgYW5kIDE1LCB3ZSBkbyBub3QgcnVuIGFueSBjbGVhbnVwIGFjdGlvbnMgYXMgaXQgbWlnaHRcbiAgICAgICAgICAgIC8vIHRyaWdnZXIgYSBidWcgdGhhdCBwcmV2ZW50cyBTYWZhcmkgZnJvbSByZS1vcGVuaW5nIEluZGV4ZWREQiBkdXJpbmdcbiAgICAgICAgICAgIC8vIHRoZSBuZXh0IHBhZ2UgbG9hZC5cbiAgICAgICAgICAgIC8vIFNlZSBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjI2NTQ3XG4gICAgICAgICAgICB0aGlzLkhzLmVudGVyUmVzdHJpY3RlZE1vZGUoLyogcHVyZ2VFeGlzdGluZ1Rhc2tzPSAqLyAhMCksIHRoaXMuSHMuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gdGhpcy5zaHV0ZG93bigpKSk7XG4gICAgICAgIH0sIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCB0aGlzLlpzKSk7XG4gICAgfVxuICAgIGJpKCkge1xuICAgICAgICB0aGlzLlpzICYmICh0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5acyksIHRoaXMuWnMgPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIGEgY2xpZW50IGlzIFwiem9tYmllZFwiIGJhc2VkIG9uIGl0cyBMb2NhbFN0b3JhZ2UgZW50cnkuXG4gICAgICogQ2xpZW50cyBiZWNvbWUgem9tYmllZCB3aGVuIHRoZWlyIHRhYiBjbG9zZXMgd2l0aG91dCBydW5uaW5nIGFsbCBvZiB0aGVcbiAgICAgKiBjbGVhbnVwIGxvZ2ljIGluIGBzaHV0ZG93bigpYC5cbiAgICAgKi8gICAgRWkodCkge1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBudWxsICE9PSAobnVsbCA9PT0gKGUgPSB0aGlzLm9pKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmdldEl0ZW0odGhpcy5UaSh0KSkpO1xuICAgICAgICAgICAgcmV0dXJuIEMoXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBgQ2xpZW50ICcke3R9JyAke24gPyBcImlzXCIgOiBcImlzIG5vdFwifSB6b21iaWVkIGluIExvY2FsU3RvcmFnZWApLCBcbiAgICAgICAgICAgIG47XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGlmIExvY2FsU3RvcmFnZSBpc24ndCB3b3JraW5nLlxuICAgICAgICAgICAgcmV0dXJuIHgoXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIkZhaWxlZCB0byBnZXQgem9tYmllZCBjbGllbnQgaWQuXCIsIHQpLCAhMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWNvcmQgY2xpZW50IGFzIHpvbWJpZWQgKGEgY2xpZW50IHRoYXQgaGFkIGl0cyB0YWIgY2xvc2VkKS4gWm9tYmllZFxuICAgICAqIGNsaWVudHMgYXJlIGlnbm9yZWQgZHVyaW5nIHByaW1hcnkgdGFiIHNlbGVjdGlvbi5cbiAgICAgKi8gICAgQWkoKSB7XG4gICAgICAgIGlmICh0aGlzLm9pKSB0cnkge1xuICAgICAgICAgICAgdGhpcy5vaS5zZXRJdGVtKHRoaXMuVGkodGhpcy5jbGllbnRJZCksIFN0cmluZyhEYXRlLm5vdygpKSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGlmIExvY2FsU3RvcmFnZSBpc24ndCBhdmFpbGFibGUgLyB3b3JraW5nLlxuICAgICAgICAgICAgeChcIkZhaWxlZCB0byBzZXQgem9tYmllIGNsaWVudCBpZC5cIiwgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIFJlbW92ZXMgdGhlIHpvbWJpZWQgY2xpZW50IGVudHJ5IGlmIGl0IGV4aXN0cy4gKi8gICAgUGkoKSB7XG4gICAgICAgIGlmICh0aGlzLm9pKSB0cnkge1xuICAgICAgICAgICAgdGhpcy5vaS5yZW1vdmVJdGVtKHRoaXMuVGkodGhpcy5jbGllbnRJZCkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBJZ25vcmVcbiAgICAgICAgfVxuICAgIH1cbiAgICBUaSh0KSB7XG4gICAgICAgIHJldHVybiBgZmlyZXN0b3JlX3pvbWJpZV8ke3RoaXMucGVyc2lzdGVuY2VLZXl9XyR7dH1gO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHByaW1hcnkgY2xpZW50IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiB3byh0KSB7XG4gICAgcmV0dXJuIE5pKHQsIFwib3duZXJcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIG1vKHQpIHtcbiAgICByZXR1cm4gTmkodCwgXCJjbGllbnRNZXRhZGF0YVwiKTtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgYSBzdHJpbmcgdXNlZCBhcyBhIHByZWZpeCB3aGVuIHN0b3JpbmcgZGF0YSBpbiBJbmRleGVkREIgYW5kXG4gKiBMb2NhbFN0b3JhZ2UuXG4gKi8gZnVuY3Rpb24gZ28odCwgZSkge1xuICAgIC8vIFVzZSB0d28gZGlmZmVyZW50IHByZWZpeCBmb3JtYXRzOlxuICAgIC8vICAgKiBmaXJlc3RvcmUgLyBwZXJzaXN0ZW5jZUtleSAvIHByb2plY3RJRCAuIGRhdGFiYXNlSUQgLyAuLi5cbiAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLyAuLi5cbiAgICAvLyBwcm9qZWN0SURzIGFyZSBETlMtY29tcGF0aWJsZSBuYW1lcyBhbmQgY2Fubm90IGNvbnRhaW4gZG90c1xuICAgIC8vIHNvIHRoZXJlJ3Mgbm8gZGFuZ2VyIG9mIGNvbGxpc2lvbnMuXG4gICAgbGV0IG4gPSB0LnByb2plY3RJZDtcbiAgICByZXR1cm4gdC5pc0RlZmF1bHREYXRhYmFzZSB8fCAobiArPSBcIi5cIiArIHQuZGF0YWJhc2UpLCBcImZpcmVzdG9yZS9cIiArIGUgKyBcIi9cIiArIG4gKyBcIi9cIjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBzZXQgb2YgY2hhbmdlcyB0byB3aGF0IGRvY3VtZW50cyBhcmUgY3VycmVudGx5IGluIHZpZXcgYW5kIG91dCBvZiB2aWV3IGZvclxuICogYSBnaXZlbiBxdWVyeS4gVGhlc2UgY2hhbmdlcyBhcmUgc2VudCB0byB0aGUgTG9jYWxTdG9yZSBieSB0aGUgVmlldyAodmlhXG4gKiB0aGUgU3luY0VuZ2luZSkgYW5kIGFyZSB1c2VkIHRvIHBpbiAvIHVucGluIGRvY3VtZW50cyBhcyBhcHByb3ByaWF0ZS5cbiAqL1xuY2xhc3MgeW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMuZnJvbUNhY2hlID0gZSwgdGhpcy5TaSA9IG4sIHRoaXMuRGkgPSBzO1xuICAgIH1cbiAgICBzdGF0aWMgQ2kodCwgZSkge1xuICAgICAgICBsZXQgbiA9IGZzKCksIHMgPSBmcygpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZS5kb2NDaGFuZ2VzKSBzd2l0Y2ggKHQudHlwZSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgICAgICBuID0gbi5hZGQodC5kb2Mua2V5KTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIFJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgcyA9IHMuYWRkKHQuZG9jLmtleSk7XG4gLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB5byh0LCBlLmZyb21DYWNoZSwgbiwgcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgRmlyZXN0b3JlIHF1ZXJ5IGVuZ2luZS5cbiAqXG4gKiBGaXJlc3RvcmUgcXVlcmllcyBjYW4gYmUgZXhlY3V0ZWQgaW4gdGhyZWUgbW9kZXMuIFRoZSBRdWVyeSBFbmdpbmUgZGV0ZXJtaW5lc1xuICogd2hhdCBtb2RlIHRvIHVzZSBiYXNlZCBvbiB3aGF0IGRhdGEgaXMgcGVyc2lzdGVkLiBUaGUgbW9kZSBvbmx5IGRldGVybWluZXNcbiAqIHRoZSBydW50aW1lIGNvbXBsZXhpdHkgb2YgdGhlIHF1ZXJ5IC0gdGhlIHJlc3VsdCBzZXQgaXMgZXF1aXZhbGVudCBhY3Jvc3MgYWxsXG4gKiBpbXBsZW1lbnRhdGlvbnMuXG4gKlxuICogVGhlIFF1ZXJ5IGVuZ2luZSB3aWxsIHVzZSBpbmRleGVkLWJhc2VkIGV4ZWN1dGlvbiBpZiBhIHVzZXIgaGFzIGNvbmZpZ3VyZWRcbiAqIGFueSBpbmRleCB0aGF0IGNhbiBiZSB1c2VkIHRvIGV4ZWN1dGUgcXVlcnkgKHZpYSBgc2V0SW5kZXhDb25maWd1cmF0aW9uKClgKS5cbiAqIE90aGVyd2lzZSwgdGhlIGVuZ2luZSB3aWxsIHRyeSB0byBvcHRpbWl6ZSB0aGUgcXVlcnkgYnkgcmUtdXNpbmcgYSBwcmV2aW91c2x5XG4gKiBwZXJzaXN0ZWQgcXVlcnkgcmVzdWx0LiBJZiB0aGF0IGlzIG5vdCBwb3NzaWJsZSwgdGhlIHF1ZXJ5IHdpbGwgYmUgZXhlY3V0ZWRcbiAqIHZpYSBhIGZ1bGwgY29sbGVjdGlvbiBzY2FuLlxuICpcbiAqIEluZGV4LWJhc2VkIGV4ZWN1dGlvbiBpcyB0aGUgZGVmYXVsdCB3aGVuIGF2YWlsYWJsZS4gVGhlIHF1ZXJ5IGVuZ2luZVxuICogc3VwcG9ydHMgcGFydGlhbCBpbmRleGVkIGV4ZWN1dGlvbiBhbmQgbWVyZ2VzIHRoZSByZXN1bHQgZnJvbSB0aGUgaW5kZXhcbiAqIGxvb2t1cCB3aXRoIGRvY3VtZW50cyB0aGF0IGhhdmUgbm90IHlldCBiZWVuIGluZGV4ZWQuIFRoZSBpbmRleCBldmFsdWF0aW9uXG4gKiBtYXRjaGVzIHRoZSBiYWNrZW5kJ3MgZm9ybWF0IGFuZCBhcyBzdWNoLCB0aGUgU0RLIGNhbiB1c2UgaW5kZXhpbmcgZm9yIGFsbFxuICogcXVlcmllcyB0aGF0IHRoZSBiYWNrZW5kIHN1cHBvcnRzLlxuICpcbiAqIElmIG5vIGluZGV4IGV4aXN0cywgdGhlIHF1ZXJ5IGVuZ2luZSB0cmllcyB0byB0YWtlIGFkdmFudGFnZSBvZiB0aGUgdGFyZ2V0XG4gKiBkb2N1bWVudCBtYXBwaW5nIGluIHRoZSBUYXJnZXRDYWNoZS4gVGhlc2UgbWFwcGluZ3MgZXhpc3RzIGZvciBhbGwgcXVlcmllc1xuICogdGhhdCBoYXZlIGJlZW4gc3luY2VkIHdpdGggdGhlIGJhY2tlbmQgYXQgbGVhc3Qgb25jZSBhbmQgYWxsb3cgdGhlIHF1ZXJ5XG4gKiBlbmdpbmUgdG8gb25seSByZWFkIGRvY3VtZW50cyB0aGF0IHByZXZpb3VzbHkgbWF0Y2hlZCBhIHF1ZXJ5IHBsdXMgYW55XG4gKiBkb2N1bWVudHMgdGhhdCB3ZXJlIGVkaXRlZCBhZnRlciB0aGUgcXVlcnkgd2FzIGxhc3QgbGlzdGVuZWQgdG8uXG4gKlxuICogVGhlcmUgYXJlIHNvbWUgY2FzZXMgd2hlbiB0aGlzIG9wdGltaXphdGlvbiBpcyBub3QgZ3VhcmFudGVlZCB0byBwcm9kdWNlXG4gKiB0aGUgc2FtZSByZXN1bHRzIGFzIGZ1bGwgY29sbGVjdGlvbiBzY2Fucy4gSW4gdGhlc2UgY2FzZXMsIHF1ZXJ5XG4gKiBwcm9jZXNzaW5nIGZhbGxzIGJhY2sgdG8gZnVsbCBzY2Fucy4gVGhlc2UgY2FzZXMgYXJlOlxuICpcbiAqIC0gTGltaXQgcXVlcmllcyB3aGVyZSBhIGRvY3VtZW50IHRoYXQgbWF0Y2hlZCB0aGUgcXVlcnkgcHJldmlvdXNseSBubyBsb25nZXJcbiAqICAgbWF0Y2hlcyB0aGUgcXVlcnkuXG4gKlxuICogLSBMaW1pdCBxdWVyaWVzIHdoZXJlIGEgZG9jdW1lbnQgZWRpdCBtYXkgY2F1c2UgdGhlIGRvY3VtZW50IHRvIHNvcnQgYmVsb3dcbiAqICAgYW5vdGhlciBkb2N1bWVudCB0aGF0IGlzIGluIHRoZSBsb2NhbCBjYWNoZS5cbiAqXG4gKiAtIFF1ZXJpZXMgdGhhdCBoYXZlIG5ldmVyIGJlZW4gQ1VSUkVOVCBvciBmcmVlIG9mIGxpbWJvIGRvY3VtZW50cy5cbiAqLyBjbGFzcyBwbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMueGkgPSAhMTtcbiAgICB9XG4gICAgLyoqIFNldHMgdGhlIGRvY3VtZW50IHZpZXcgdG8gcXVlcnkgYWdhaW5zdC4gKi8gICAgaW5pdGlhbGl6ZSh0LCBlKSB7XG4gICAgICAgIHRoaXMuTmkgPSB0LCB0aGlzLmluZGV4TWFuYWdlciA9IGUsIHRoaXMueGkgPSAhMDtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYWxsIGxvY2FsIGRvY3VtZW50cyBtYXRjaGluZyB0aGUgc3BlY2lmaWVkIHF1ZXJ5LiAqLyAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2kodCwgZSkubmV4dCgoaSA9PiBpIHx8IHRoaXMuT2kodCwgZSwgcywgbikpKS5uZXh0KChuID0+IG4gfHwgdGhpcy5NaSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhbiBpbmRleGVkIHF1ZXJ5IHRoYXQgZXZhbHVhdGVzIHRoZSBxdWVyeSBiYXNlZCBvbiBhIGNvbGxlY3Rpb24nc1xuICAgICAqIHBlcnNpc3RlZCBpbmRleCB2YWx1ZXMuIFJldHVybnMgYG51bGxgIGlmIGFuIGluZGV4IGlzIG5vdCBhdmFpbGFibGUuXG4gICAgICovICAgIGtpKHQsIGUpIHtcbiAgICAgICAgaWYgKG5uKGUpKSBcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IG1hdGNoIGFsbCBkb2N1bWVudHMgZG9uJ3QgYmVuZWZpdCBmcm9tIHVzaW5nXG4gICAgICAgIC8vIGtleS1iYXNlZCBsb29rdXBzLiBJdCBpcyBtb3JlIGVmZmljaWVudCB0byBzY2FuIGFsbCBkb2N1bWVudHMgaW4gYVxuICAgICAgICAvLyBjb2xsZWN0aW9uLCByYXRoZXIgdGhhbiB0byBwZXJmb3JtIGluZGl2aWR1YWwgbG9va3Vwcy5cbiAgICAgICAgcmV0dXJuIEF0LnJlc29sdmUobnVsbCk7XG4gICAgICAgIGxldCBuID0gY24oZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlci5nZXRJbmRleFR5cGUodCwgbikubmV4dCgocyA9PiAwIC8qIE5PTkUgKi8gPT09IHMgPyBudWxsIDogKG51bGwgIT09IGUubGltaXQgJiYgMSAvKiBQQVJUSUFMICovID09PSBzICYmIChcbiAgICAgICAgLy8gV2UgY2Fubm90IGFwcGx5IGEgbGltaXQgZm9yIHRhcmdldHMgdGhhdCBhcmUgc2VydmVkIHVzaW5nIGEgcGFydGlhbFxuICAgICAgICAvLyBpbmRleC4gSWYgYSBwYXJ0aWFsIGluZGV4IHdpbGwgYmUgdXNlZCB0byBzZXJ2ZSB0aGUgdGFyZ2V0LCB0aGVcbiAgICAgICAgLy8gcXVlcnkgbWF5IHJldHVybiBhIHN1cGVyc2V0IG9mIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSB0YXJnZXRcbiAgICAgICAgLy8gKGUuZy4gaWYgdGhlIGluZGV4IGRvZXNuJ3QgaW5jbHVkZSBhbGwgdGhlIHRhcmdldCdzIGZpbHRlcnMpLCBvclxuICAgICAgICAvLyBtYXkgcmV0dXJuIHRoZSBjb3JyZWN0IHNldCBvZiBkb2N1bWVudHMgaW4gdGhlIHdyb25nIG9yZGVyIChlLmcuIGlmXG4gICAgICAgIC8vIHRoZSBpbmRleCBkb2Vzbid0IGluY2x1ZGUgYSBzZWdtZW50IGZvciBvbmUgb2YgdGhlIG9yZGVyQnlzKS5cbiAgICAgICAgLy8gVGhlcmVmb3JlLCBhIGxpbWl0IHNob3VsZCBub3QgYmUgYXBwbGllZCBpbiBzdWNoIGNhc2VzLlxuICAgICAgICBlID0gYW4oZSwgbnVsbCwgXCJGXCIgLyogRmlyc3QgKi8pLCBuID0gY24oZSkpLCB0aGlzLmluZGV4TWFuYWdlci5nZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCh0LCBuKS5uZXh0KChzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBmcyguLi5zKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLk5pLmdldERvY3VtZW50cyh0LCBpKS5uZXh0KChzID0+IHRoaXMuaW5kZXhNYW5hZ2VyLmdldE1pbk9mZnNldCh0LCBuKS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5GaShlLCBzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaShlLCByLCBpLCBuLnJlYWRUaW1lKSA/IHRoaXMua2kodCwgYW4oZSwgbnVsbCwgXCJGXCIgLyogRmlyc3QgKi8pKSA6IHRoaXMuQmkodCwgciwgZSwgbik7XG4gICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgfSkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIHF1ZXJ5IGJhc2VkIG9uIHRoZSB0YXJnZXQncyBwZXJzaXN0ZWQgcXVlcnkgbWFwcGluZy4gUmV0dXJuc1xuICAgICAqIGBudWxsYCBpZiB0aGUgbWFwcGluZyBpcyBub3QgYXZhaWxhYmxlIG9yIGNhbm5vdCBiZSB1c2VkLlxuICAgICAqLyAgICBPaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBubihlKSB8fCBzLmlzRXF1YWwoc3QubWluKCkpID8gdGhpcy5NaSh0LCBlKSA6IHRoaXMuTmkuZ2V0RG9jdW1lbnRzKHQsIG4pLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuRmkoZSwgaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaShlLCByLCBuLCBzKSA/IHRoaXMuTWkodCwgZSkgOiAoUygpIDw9IExvZ0xldmVsLkRFQlVHICYmIEMoXCJRdWVyeUVuZ2luZVwiLCBcIlJlLXVzaW5nIHByZXZpb3VzIHJlc3VsdCBmcm9tICVzIHRvIGV4ZWN1dGUgcXVlcnk6ICVzXCIsIHMudG9TdHJpbmcoKSwgZm4oZSkpLCBcbiAgICAgICAgICAgIHRoaXMuQmkodCwgciwgZSwgbXQocywgLTEpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBGaSh0LCBlKSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyBxdCh3bih0KSk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBzKSA9PiB7XG4gICAgICAgICAgICBkbih0LCBzKSAmJiAobiA9IG4uYWRkKHMpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgbGltaXQgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgZnJvbSBjYWNoZSwgbWFraW5nIGl0XG4gICAgICogaW5lbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkuXG4gICAgICogQHBhcmFtIHNvcnRlZFByZXZpb3VzUmVzdWx0cyAtIFRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSB3aGVuIGl0XG4gICAgICogd2FzIGxhc3Qgc3luY2hyb25pemVkLCBzb3J0ZWQgYnkgdGhlIHF1ZXJ5J3MgY29tcGFyYXRvci5cbiAgICAgKiBAcGFyYW0gcmVtb3RlS2V5cyAtIFRoZSBkb2N1bWVudCBrZXlzIHRoYXQgbWF0Y2hlZCB0aGUgcXVlcnkgYXQgdGhlIGxhc3RcbiAgICAgKiBzbmFwc2hvdC5cbiAgICAgKiBAcGFyYW0gbGltYm9GcmVlU25hcHNob3RWZXJzaW9uIC0gVGhlIHZlcnNpb24gb2YgdGhlIHNuYXBzaG90IHdoZW4gdGhlXG4gICAgICogcXVlcnkgd2FzIGxhc3Qgc3luY2hyb25pemVkLlxuICAgICAqLyAgICAkaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGlmIChudWxsID09PSB0LmxpbWl0KSBcbiAgICAgICAgLy8gUXVlcmllcyB3aXRob3V0IGxpbWl0cyBkbyBub3QgbmVlZCB0byBiZSByZWZpbGxlZC5cbiAgICAgICAgcmV0dXJuICExO1xuICAgICAgICBpZiAobi5zaXplICE9PSBlLnNpemUpIFxuICAgICAgICAvLyBUaGUgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgaWYgYSBwcmV2aW91c2x5IG1hdGNoaW5nIGRvY3VtZW50IG5vXG4gICAgICAgIC8vIGxvbmdlciBtYXRjaGVzLlxuICAgICAgICByZXR1cm4gITA7XG4gICAgICAgIC8vIExpbWl0IHF1ZXJpZXMgYXJlIG5vdCBlbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBxdWVyeSBleGVjdXRpb24gaWYgdGhlcmUgaXNcbiAgICAgICAgLy8gYSBwb3RlbnRpYWwgdGhhdCBhbiBvbGRlciBkb2N1bWVudCBmcm9tIGNhY2hlIG5vdyBzb3J0cyBiZWZvcmUgYSBkb2N1bWVudFxuICAgICAgICAvLyB0aGF0IHdhcyBwcmV2aW91c2x5IHBhcnQgb2YgdGhlIGxpbWl0LiBUaGlzLCBob3dldmVyLCBjYW4gb25seSBoYXBwZW4gaWZcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50IGF0IHRoZSBlZGdlIG9mIHRoZSBsaW1pdCBnb2VzIG91dCBvZiBsaW1pdC5cbiAgICAgICAgLy8gSWYgYSBkb2N1bWVudCB0aGF0IGlzIG5vdCB0aGUgbGltaXQgYm91bmRhcnkgc29ydHMgZGlmZmVyZW50bHksXG4gICAgICAgIC8vIHRoZSBib3VuZGFyeSBvZiB0aGUgbGltaXQgaXRzZWxmIGRpZCBub3QgY2hhbmdlIGFuZCBkb2N1bWVudHMgZnJvbSBjYWNoZVxuICAgICAgICAvLyB3aWxsIGNvbnRpbnVlIHRvIGJlIFwicmVqZWN0ZWRcIiBieSB0aGlzIGJvdW5kYXJ5LiBUaGVyZWZvcmUsIHdlIGNhbiBpZ25vcmVcbiAgICAgICAgLy8gYW55IG1vZGlmaWNhdGlvbnMgdGhhdCBkb24ndCBhZmZlY3QgdGhlIGxhc3QgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFwiRlwiIC8qIEZpcnN0ICovID09PSB0LmxpbWl0VHlwZSA/IGUubGFzdCgpIDogZS5maXJzdCgpO1xuICAgICAgICByZXR1cm4gISFpICYmIChpLmhhc1BlbmRpbmdXcml0ZXMgfHwgaS52ZXJzaW9uLmNvbXBhcmVUbyhzKSA+IDApO1xuICAgIH1cbiAgICBNaSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBTKCkgPD0gTG9nTGV2ZWwuREVCVUcgJiYgQyhcIlF1ZXJ5RW5naW5lXCIsIFwiVXNpbmcgZnVsbCBjb2xsZWN0aW9uIHNjYW4gdG8gZXhlY3V0ZSBxdWVyeTpcIiwgZm4oZSkpLCBcbiAgICAgICAgdGhpcy5OaS5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIHl0Lm1pbigpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tYmluZXMgdGhlIHJlc3VsdHMgZnJvbSBhbiBpbmRleGVkIGV4ZWN1dGlvbiB3aXRoIHRoZSByZW1haW5pbmcgZG9jdW1lbnRzXG4gICAgICogdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBpbmRleGVkLlxuICAgICAqLyAgICBCaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFJldHJpZXZlIGFsbCByZXN1bHRzIGZvciBkb2N1bWVudHMgdGhhdCB3ZXJlIHVwZGF0ZWQgc2luY2UgdGhlIG9mZnNldC5cbiAgICAgICAgcmV0dXJuIHRoaXMuTmkuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBuLCBzKS5uZXh0KCh0ID0+IChcbiAgICAgICAgLy8gTWVyZ2Ugd2l0aCBleGlzdGluZyByZXN1bHRzXG4gICAgICAgIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0ID0gdC5pbnNlcnQoZS5rZXksIGUpO1xuICAgICAgICB9KSksIHQpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbXBsZW1lbnRzIGBMb2NhbFN0b3JlYCBpbnRlcmZhY2UuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi9cbmNsYXNzIElvIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG4gICAgdCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgdGhpcy5MaSA9IGUsIHRoaXMuSXQgPSBzLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgYSB0YXJnZXRJRCB0byBkYXRhIGFib3V0IGl0cyB0YXJnZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogV2UgYXJlIHVzaW5nIGFuIGltbXV0YWJsZSBkYXRhIHN0cnVjdHVyZSBvbiBXZWIgdG8gbWFrZSByZS1ydW5zXG4gICAgICAgICAqIG9mIGBhcHBseVJlbW90ZUV2ZW50KClgIGlkZW1wb3RlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlVpID0gbmV3IEJ0KFopLCBcbiAgICAgICAgLyoqIE1hcHMgYSB0YXJnZXQgdG8gaXRzIHRhcmdldElELiAqL1xuICAgICAgICAvLyBUT0RPKHd1YW5keSk6IEV2YWx1YXRlIGlmIFRhcmdldElkIGNhbiBiZSBwYXJ0IG9mIFRhcmdldC5cbiAgICAgICAgdGhpcy5xaSA9IG5ldyBlcygodCA9PiB4ZSh0KSksIGtlKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHBlciBjb2xsZWN0aW9uIGdyb3VwIGluZGV4IG9mIHRoZSBsYXN0IHJlYWQgdGltZSBwcm9jZXNzZWQgYnlcbiAgICAgICAgICogYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuS2kgPSBuZXcgTWFwLCB0aGlzLkdpID0gdC5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCksIHRoaXMuQ3MgPSB0LmdldFRhcmdldENhY2hlKCksIFxuICAgICAgICB0aGlzLk5zID0gdC5nZXRCdW5kbGVDYWNoZSgpLCB0aGlzLlFpKG4pO1xuICAgIH1cbiAgICBRaSh0KSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBBZGQgc3BlYyB0ZXN0cyB0aGF0IHRlc3QgdGhlc2UgY29tcG9uZW50cyBjaGFuZ2UgYWZ0ZXIgYVxuICAgICAgICAvLyB1c2VyIGNoYW5nZVxuICAgICAgICB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXREb2N1bWVudE92ZXJsYXlDYWNoZSh0KSwgdGhpcy5pbmRleE1hbmFnZXIgPSB0aGlzLnBlcnNpc3RlbmNlLmdldEluZGV4TWFuYWdlcih0KSwgXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0TXV0YXRpb25RdWV1ZSh0LCB0aGlzLmluZGV4TWFuYWdlciksIHRoaXMubG9jYWxEb2N1bWVudHMgPSBuZXcgWHIodGhpcy5HaSwgdGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLCB0aGlzLmluZGV4TWFuYWdlciksIFxuICAgICAgICB0aGlzLkdpLnNldEluZGV4TWFuYWdlcih0aGlzLmluZGV4TWFuYWdlciksIHRoaXMuTGkuaW5pdGlhbGl6ZSh0aGlzLmxvY2FsRG9jdW1lbnRzLCB0aGlzLmluZGV4TWFuYWdlcik7XG4gICAgfVxuICAgIGNvbGxlY3RHYXJiYWdlKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJDb2xsZWN0IGdhcmJhZ2VcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAoZSA9PiB0LmNvbGxlY3QoZSwgdGhpcy5VaSkpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFRvKFxuLyoqIE1hbmFnZXMgb3VyIGluLW1lbW9yeSBvciBkdXJhYmxlIHBlcnNpc3RlbmNlLiAqL1xudCwgZSwgbiwgcykge1xuICAgIHJldHVybiBuZXcgSW8odCwgZSwgbiwgcyk7XG59XG5cbi8qKlxuICogVGVsbHMgdGhlIExvY2FsU3RvcmUgdGhhdCB0aGUgY3VycmVudGx5IGF1dGhlbnRpY2F0ZWQgdXNlciBoYXMgY2hhbmdlZC5cbiAqXG4gKiBJbiByZXNwb25zZSB0aGUgbG9jYWwgc3RvcmUgc3dpdGNoZXMgdGhlIG11dGF0aW9uIHF1ZXVlIHRvIHRoZSBuZXcgdXNlciBhbmRcbiAqIHJldHVybnMgYW55IHJlc3VsdGluZyBkb2N1bWVudCBjaGFuZ2VzLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IEFuZHJvaWQgYW5kIGlPUyBvbmx5IHJldHVybiB0aGUgZG9jdW1lbnRzIGFmZmVjdGVkIGJ5IHRoZVxuLy8gY2hhbmdlLlxuYXN5bmMgZnVuY3Rpb24gRW8odCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIHJldHVybiBhd2FpdCBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiSGFuZGxlIHVzZXIgY2hhbmdlXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4ge1xuICAgICAgICAvLyBTd2FwIG91dCB0aGUgbXV0YXRpb24gcXVldWUsIGdyYWJiaW5nIHRoZSBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXNcbiAgICAgICAgLy8gYmVmb3JlIGFuZCBhZnRlci5cbiAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiBuLm11dGF0aW9uUXVldWUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpLm5leHQoKGkgPT4gKHMgPSBpLCBuLlFpKGUpLCBuLm11dGF0aW9uUXVldWUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpKSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IFtdLCByID0gW107XG4gICAgICAgICAgICAvLyBVbmlvbiB0aGUgb2xkL25ldyBjaGFuZ2VkIGtleXMuXG4gICAgICAgICAgICBsZXQgbyA9IGZzKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcykge1xuICAgICAgICAgICAgICAgIGkucHVzaCh0LmJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0Lm11dGF0aW9ucykgbyA9IG8uYWRkKGUua2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICAgICAgci5wdXNoKHQuYmF0Y2hJZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSBvID0gby5hZGQoZS5rZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBzZXQgb2YgYWxsIChwb3RlbnRpYWxseSkgY2hhbmdlZCBkb2N1bWVudHMgYW5kIHRoZSBsaXN0XG4gICAgICAgICAgICAvLyBvZiBtdXRhdGlvbiBiYXRjaCBJRHMgdGhhdCB3ZXJlIGFmZmVjdGVkIGJ5IGNoYW5nZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0LCBvKS5uZXh0KCh0ID0+ICh7XG4gICAgICAgICAgICAgICAgamk6IHQsXG4gICAgICAgICAgICAgICAgcmVtb3ZlZEJhdGNoSWRzOiBpLFxuICAgICAgICAgICAgICAgIGFkZGVkQmF0Y2hJZHM6IHJcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0pKTtcbiAgICB9KSk7XG59XG5cbi8qIEFjY2VwdHMgbG9jYWxseSBnZW5lcmF0ZWQgTXV0YXRpb25zIGFuZCBjb21taXQgdGhlbSB0byBzdG9yYWdlLiAqL1xuLyoqXG4gKiBBY2tub3dsZWRnZXMgdGhlIGdpdmVuIGJhdGNoLlxuICpcbiAqIE9uIHRoZSBoYXBweSBwYXRoIHdoZW4gYSBiYXRjaCBpcyBhY2tub3dsZWRnZWQsIHRoZSBsb2NhbCBzdG9yZSB3aWxsXG4gKlxuICogICsgcmVtb3ZlIHRoZSBiYXRjaCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZTtcbiAqICArIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGU7XG4gKiAgKyByZWNhbGN1bGF0ZSB0aGUgbGF0ZW5jeSBjb21wZW5zYXRlZCB2aWV3IGltcGxpZWQgYnkgdGhvc2UgY2hhbmdlcyAodGhlcmVcbiAqICAgIG1heSBiZSBtdXRhdGlvbnMgaW4gdGhlIHF1ZXVlIHRoYXQgYWZmZWN0IHRoZSBkb2N1bWVudHMgYnV0IGhhdmVuJ3QgYmVlblxuICogICAgYWNrbm93bGVkZ2VkIHlldCk7IGFuZFxuICogICsgZ2l2ZSB0aGUgY2hhbmdlZCBkb2N1bWVudHMgYmFjayB0aGUgc3luYyBlbmdpbmVcbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIChtb2RpZmllZCkgZG9jdW1lbnRzLlxuICovXG5mdW5jdGlvbiBBbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBY2tub3dsZWRnZSBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGUuYmF0Y2gua2V5cygpLCBpID0gbi5HaS5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICAgICAgdHJhY2tSZW1vdmFsczogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgICAgICBjb25zdCBpID0gbi5iYXRjaCwgciA9IGkua2V5cygpO1xuICAgICAgICAgICAgbGV0IG8gPSBBdC5yZXNvbHZlKCk7XG4gICAgICAgICAgICByZXR1cm4gci5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBvID0gby5uZXh0KCgoKSA9PiBzLmdldEVudHJ5KGUsIHQpKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmRvY1ZlcnNpb25zLmdldCh0KTtcbiAgICAgICAgICAgICAgICAgICAgTShudWxsICE9PSByKSwgZS52ZXJzaW9uLmNvbXBhcmVUbyhyKSA8IDAgJiYgKGkuYXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIG4pLCBlLmlzVmFsaWREb2N1bWVudCgpICYmIChcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgdXNlIHRoZSBjb21taXRWZXJzaW9uIGFzIHRoZSByZWFkVGltZSByYXRoZXIgdGhhbiB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQncyB1cGRhdGVUaW1lIHNpbmNlIHRoZSB1cGRhdGVUaW1lIGlzIG5vdCBhZHZhbmNlZFxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgdXBkYXRlcyB0aGF0IGRvIG5vdCBtb2RpZnkgdGhlIHVuZGVybHlpbmcgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgICAgIGUuc2V0UmVhZFRpbWUobi5jb21taXRWZXJzaW9uKSwgcy5hZGRFbnRyeShlKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKSwgby5uZXh0KCgoKSA9PiB0Lm11dGF0aW9uUXVldWUucmVtb3ZlTXV0YXRpb25CYXRjaChlLCBpKSkpO1xuICAgICAgICB9XG4gICAgICAgIC8qKiBSZXR1cm5zIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgYSBtdXRhdGlvbiBiYXRjaC4gKi9cbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbiAgICAgICAgKG4sIHQsIGUsIGkpLm5leHQoKCgpID0+IGkuYXBwbHkodCkpKS5uZXh0KCgoKSA9PiBuLm11dGF0aW9uUXVldWUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLmRvY3VtZW50T3ZlcmxheUNhY2hlLnJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBzLCBlLmJhdGNoLmJhdGNoSWQpKSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5yZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyh0LCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBsZXQgZSA9IGZzKCk7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubXV0YXRpb25SZXN1bHRzLmxlbmd0aDsgKytuKSB7XG4gICAgICAgICAgICAgICAgdC5tdXRhdGlvblJlc3VsdHNbbl0udHJhbnNmb3JtUmVzdWx0cy5sZW5ndGggPiAwICYmIChlID0gZS5hZGQodC5iYXRjaC5tdXRhdGlvbnNbbl0ua2V5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJlbW92ZXMgbXV0YXRpb25zIGZyb20gdGhlIE11dGF0aW9uUXVldWUgZm9yIHRoZSBzcGVjaWZpZWQgYmF0Y2g7XG4gKiBMb2NhbERvY3VtZW50cyB3aWxsIGJlIHJlY2FsY3VsYXRlZC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIG1vZGlmaWVkIGRvY3VtZW50cy5cbiAqLyAoZSkpKSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModCwgcykpKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbGFzdCBjb25zaXN0ZW50IHNuYXBzaG90IHByb2Nlc3NlZCAodXNlZCBieSB0aGUgUmVtb3RlU3RvcmUgdG9cbiAqIGRldGVybWluZSB3aGV0aGVyIHRvIGJ1ZmZlciBpbmNvbWluZyBzbmFwc2hvdHMgZnJvbSB0aGUgYmFja2VuZCkuXG4gKi9cbmZ1bmN0aW9uIFJvKHQpIHtcbiAgICBjb25zdCBlID0gJCh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBsYXN0IHJlbW90ZSBzbmFwc2hvdCB2ZXJzaW9uXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5Dcy5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpKSk7XG59XG5cbi8qKlxuICogVXBkYXRlcyB0aGUgXCJncm91bmQtc3RhdGVcIiAocmVtb3RlKSBkb2N1bWVudHMuIFdlIGFzc3VtZSB0aGF0IHRoZSByZW1vdGVcbiAqIGV2ZW50IHJlZmxlY3RzIGFueSB3cml0ZSBiYXRjaGVzIHRoYXQgaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBvciByZWplY3RlZFxuICogKGkuZS4gd2UgZG8gbm90IHJlLWFwcGx5IGxvY2FsIG11dGF0aW9ucyB0byB1cGRhdGVzIGZyb20gdGhpcyBldmVudCkuXG4gKlxuICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXG4gKiBxdWV1ZS5cbiAqLyBmdW5jdGlvbiBibyh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCksIHMgPSBlLnNuYXBzaG90VmVyc2lvbjtcbiAgICBsZXQgaSA9IG4uVWk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSByZW1vdGUgZXZlbnRcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAodCA9PiB7XG4gICAgICAgIGNvbnN0IHIgPSBuLkdpLm5ld0NoYW5nZUJ1ZmZlcih7XG4gICAgICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUmVzZXQgbmV3VGFyZ2V0RGF0YUJ5VGFyZ2V0TWFwIGluIGNhc2UgdGhpcyB0cmFuc2FjdGlvbiBnZXRzIHJlLXJ1bi5cbiAgICAgICAgICAgICAgICBpID0gbi5VaTtcbiAgICAgICAgY29uc3QgbyA9IFtdO1xuICAgICAgICBlLnRhcmdldENoYW5nZXMuZm9yRWFjaCgoKHIsIHUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBpLmdldCh1KTtcbiAgICAgICAgICAgIGlmICghYykgcmV0dXJuO1xuICAgICAgICAgICAgLy8gT25seSB1cGRhdGUgdGhlIHJlbW90ZSBrZXlzIGlmIHRoZSB0YXJnZXQgaXMgc3RpbGwgYWN0aXZlLiBUaGlzXG4gICAgICAgICAgICAvLyBlbnN1cmVzIHRoYXQgd2UgY2FuIHBlcnNpc3QgdGhlIHVwZGF0ZWQgdGFyZ2V0IGRhdGEgYWxvbmcgd2l0aFxuICAgICAgICAgICAgLy8gdGhlIHVwZGF0ZWQgYXNzaWdubWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaChuLkNzLnJlbW92ZU1hdGNoaW5nS2V5cyh0LCByLnJlbW92ZWREb2N1bWVudHMsIHUpLm5leHQoKCgpID0+IG4uQ3MuYWRkTWF0Y2hpbmdLZXlzKHQsIHIuYWRkZWREb2N1bWVudHMsIHUpKSkpO1xuICAgICAgICAgICAgbGV0IGEgPSBjLndpdGhTZXF1ZW5jZU51bWJlcih0LmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICBlLnRhcmdldE1pc21hdGNoZXMuaGFzKHUpID8gYSA9IGEud2l0aFJlc3VtZVRva2VuKFd0LkVNUFRZX0JZVEVfU1RSSU5HLCBzdC5taW4oKSkud2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24oc3QubWluKCkpIDogci5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwICYmIChhID0gYS53aXRoUmVzdW1lVG9rZW4oci5yZXN1bWVUb2tlbiwgcykpLCBcbiAgICAgICAgICAgIGkgPSBpLmluc2VydCh1LCBhKSwgXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHRhcmdldCBkYXRhIGlmIHRoZXJlIGFyZSB0YXJnZXQgY2hhbmdlcyAob3IgaWZcbiAgICAgICAgICAgIC8vIHN1ZmZpY2llbnQgdGltZSBoYXMgcGFzc2VkIHNpbmNlIHRoZSBsYXN0IHVwZGF0ZSkuXG4gICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmV3VGFyZ2V0RGF0YSBzaG91bGQgYmUgcGVyc2lzdGVkIGR1cmluZyBhbiB1cGRhdGUgb2ZcbiAqIGFuIGFjdGl2ZSB0YXJnZXQuIFRhcmdldERhdGEgc2hvdWxkIGFsd2F5cyBiZSBwZXJzaXN0ZWQgd2hlbiBhIHRhcmdldCBpc1xuICogYmVpbmcgcmVsZWFzZWQgYW5kIHNob3VsZCBub3QgY2FsbCB0aGlzIGZ1bmN0aW9uLlxuICpcbiAqIFdoaWxlIHRoZSB0YXJnZXQgaXMgYWN0aXZlLCBUYXJnZXREYXRhIHVwZGF0ZXMgY2FuIGJlIG9taXR0ZWQgd2hlbiBub3RoaW5nXG4gKiBhYm91dCB0aGUgdGFyZ2V0IGhhcyBjaGFuZ2VkIGV4Y2VwdCBtZXRhZGF0YSBsaWtlIHRoZSByZXN1bWUgdG9rZW4gb3JcbiAqIHNuYXBzaG90IHZlcnNpb24uIE9jY2FzaW9uYWxseSBpdCdzIHdvcnRoIHRoZSBleHRyYSB3cml0ZSB0byBwcmV2ZW50IHRoZXNlXG4gKiB2YWx1ZXMgZnJvbSBnZXR0aW5nIHRvbyBzdGFsZSBhZnRlciBhIGNyYXNoLCBidXQgdGhpcyBkb2Vzbid0IGhhdmUgdG8gYmVcbiAqIHRvbyBmcmVxdWVudC5cbiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBwZXJzaXN0IHRhcmdldCBkYXRhIGlmIHdlIGRvbid0IGFscmVhZHkgaGF2ZSBhIHJlc3VtZSB0b2tlbi5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdC5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICAvLyBEb24ndCBhbGxvdyByZXN1bWUgdG9rZW4gY2hhbmdlcyB0byBiZSBidWZmZXJlZCBpbmRlZmluaXRlbHkuIFRoaXNcbiAgICAgICAgICAgICAgICAvLyBhbGxvd3MgdXMgdG8gYmUgcmVhc29uYWJseSB1cC10by1kYXRlIGFmdGVyIGEgY3Jhc2ggYW5kIGF2b2lkcyBuZWVkaW5nXG4gICAgICAgICAgICAgICAgLy8gdG8gbG9vcCBvdmVyIGFsbCBhY3RpdmUgcXVlcmllcyBvbiBzaHV0ZG93bi4gRXNwZWNpYWxseSBpbiB0aGUgYnJvd3NlclxuICAgICAgICAgICAgICAgIC8vIHdlIG1heSBub3QgZ2V0IHRpbWUgdG8gZG8gYW55dGhpbmcgaW50ZXJlc3Rpbmcgd2hpbGUgdGhlIGN1cnJlbnQgdGFiIGlzXG4gICAgICAgICAgICAgICAgLy8gY2xvc2luZy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCkgLSB0LnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpID49IDNlOCkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBpZiB0aGUgb25seSB0aGluZyB0aGF0IGhhcyBjaGFuZ2VkIGFib3V0IGEgdGFyZ2V0IGlzIGl0cyByZXN1bWVcbiAgICAgICAgICAgICAgICAvLyB0b2tlbiBpdCdzIG5vdCB3b3J0aCBwZXJzaXN0aW5nLiBOb3RlIHRoYXQgdGhlIFJlbW90ZVN0b3JlIGtlZXBzIGFuXG4gICAgICAgICAgICAgICAgLy8gaW4tbWVtb3J5IHZpZXcgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFyZ2V0cyB3aGljaCBpbmNsdWRlcyB0aGUgY3VycmVudFxuICAgICAgICAgICAgICAgIC8vIHJlc3VtZSB0b2tlbiwgc28gc3RyZWFtIGZhaWx1cmUgb3IgdXNlciBjaGFuZ2VzIHdpbGwgc3RpbGwgdXNlIGFuXG4gICAgICAgICAgICAgICAgLy8gdXAtdG8tZGF0ZSByZXN1bWUgdG9rZW4gcmVnYXJkbGVzcyBvZiB3aGF0IHdlIGRvIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmFkZGVkRG9jdW1lbnRzLnNpemUgKyBuLm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgKyBuLnJlbW92ZWREb2N1bWVudHMuc2l6ZSA+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIE5vdGlmaWVzIGxvY2FsIHN0b3JlIG9mIHRoZSBjaGFuZ2VkIHZpZXdzIHRvIGxvY2FsbHkgcGluIGRvY3VtZW50cy5cbiAqLyAoYywgYSwgcikgJiYgby5wdXNoKG4uQ3MudXBkYXRlVGFyZ2V0RGF0YSh0LCBhKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IHUgPSBzcygpLCBjID0gZnMoKTtcbiAgICAgICAgLy8gSEFDSzogVGhlIG9ubHkgcmVhc29uIHdlIGFsbG93IGEgbnVsbCBzbmFwc2hvdCB2ZXJzaW9uIGlzIHNvIHRoYXQgd2VcbiAgICAgICAgLy8gY2FuIHN5bnRoZXNpemUgcmVtb3RlIGV2ZW50cyB3aGVuIHdlIGdldCBwZXJtaXNzaW9uIGRlbmllZCBlcnJvcnMgd2hpbGVcbiAgICAgICAgLy8gdHJ5aW5nIHRvIHJlc29sdmUgdGhlIHN0YXRlIG9mIGEgbG9jYWxseSBjYWNoZWQgZG9jdW1lbnQgdGhhdCBpcyBpblxuICAgICAgICAvLyBsaW1iby5cbiAgICAgICAgaWYgKGUuZG9jdW1lbnRVcGRhdGVzLmZvckVhY2goKHMgPT4ge1xuICAgICAgICAgICAgZS5yZXNvbHZlZExpbWJvRG9jdW1lbnRzLmhhcyhzKSAmJiBvLnB1c2gobi5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS51cGRhdGVMaW1ib0RvY3VtZW50KHQsIHMpKTtcbiAgICAgICAgfSkpLCBcbiAgICAgICAgLy8gRWFjaCBsb29wIGl0ZXJhdGlvbiBvbmx5IGFmZmVjdHMgaXRzIFwib3duXCIgZG9jLCBzbyBpdCdzIHNhZmUgdG8gZ2V0IGFsbFxuICAgICAgICAvLyB0aGUgcmVtb3RlIGRvY3VtZW50cyBpbiBhZHZhbmNlIGluIGEgc2luZ2xlIGNhbGwuXG4gICAgICAgIG8ucHVzaChQbyh0LCByLCBlLmRvY3VtZW50VXBkYXRlcykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB1ID0gdC5XaSwgYyA9IHQuemk7XG4gICAgICAgIH0pKSksICFzLmlzRXF1YWwoc3QubWluKCkpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbi5Dcy5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpLm5leHQoKGUgPT4gbi5Dcy5zZXRUYXJnZXRzTWV0YWRhdGEodCwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIsIHMpKSk7XG4gICAgICAgICAgICBvLnB1c2goZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEF0LndhaXRGb3IobykubmV4dCgoKCkgPT4gci5hcHBseSh0KSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0TG9jYWxWaWV3T2ZEb2N1bWVudHModCwgdSwgYykpKS5uZXh0KCgoKSA9PiB1KSk7XG4gICAgfSkpLnRoZW4oKHQgPT4gKG4uVWkgPSBpLCB0KSkpO1xufVxuXG4vKipcbiAqIFBvcHVsYXRlcyBkb2N1bWVudCBjaGFuZ2UgYnVmZmVyIHdpdGggZG9jdW1lbnRzIGZyb20gYmFja2VuZCBvciBhIGJ1bmRsZS5cbiAqIFJldHVybnMgdGhlIGRvY3VtZW50IGNoYW5nZXMgcmVzdWx0aW5nIGZyb20gYXBwbHlpbmcgdGhvc2UgZG9jdW1lbnRzLCBhbmRcbiAqIGFsc28gYSBzZXQgb2YgZG9jdW1lbnRzIHdob3NlIGV4aXN0ZW5jZSBzdGF0ZSBhcmUgY2hhbmdlZCBhcyBhIHJlc3VsdC5cbiAqXG4gKiBAcGFyYW0gdHhuIC0gVHJhbnNhY3Rpb24gdG8gdXNlIHRvIHJlYWQgZXhpc3RpbmcgZG9jdW1lbnRzIGZyb20gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudEJ1ZmZlciAtIERvY3VtZW50IGJ1ZmZlciB0byBjb2xsZWN0IHRoZSByZXN1bHRlZCBjaGFuZ2VzIHRvIGJlXG4gKiAgICAgICAgYXBwbGllZCB0byBzdG9yYWdlLlxuICogQHBhcmFtIGRvY3VtZW50cyAtIERvY3VtZW50cyB0byBiZSBhcHBsaWVkLlxuICovIGZ1bmN0aW9uIFBvKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IGZzKCksIGkgPSBmcygpO1xuICAgIHJldHVybiBuLmZvckVhY2goKHQgPT4gcyA9IHMuYWRkKHQpKSksIGUuZ2V0RW50cmllcyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgbGV0IHMgPSBzcygpO1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKCgobiwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgbyA9IHQuZ2V0KG4pO1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgc2VlIGlmIHRoZXJlIGlzIGEgZXhpc3RlbmNlIHN0YXRlIGNoYW5nZSBmb3IgdGhpcyBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHIuaXNGb3VuZERvY3VtZW50KCkgIT09IG8uaXNGb3VuZERvY3VtZW50KCkgJiYgKGkgPSBpLmFkZChuKSksIFxuICAgICAgICAgICAgLy8gTm90ZTogVGhlIG9yZGVyIG9mIHRoZSBzdGVwcyBiZWxvdyBpcyBpbXBvcnRhbnQsIHNpbmNlIHdlIHdhbnRcbiAgICAgICAgICAgIC8vIHRvIGVuc3VyZSB0aGF0IHJlamVjdGVkIGxpbWJvIHJlc29sdXRpb25zICh3aGljaCBmYWJyaWNhdGVcbiAgICAgICAgICAgIC8vIE5vRG9jdW1lbnRzIHdpdGggU25hcHNob3RWZXJzaW9uLm1pbigpKSBuZXZlciBhZGQgZG9jdW1lbnRzIHRvXG4gICAgICAgICAgICAvLyBjYWNoZS5cbiAgICAgICAgICAgIHIuaXNOb0RvY3VtZW50KCkgJiYgci52ZXJzaW9uLmlzRXF1YWwoc3QubWluKCkpID8gKFxuICAgICAgICAgICAgLy8gTm9Eb2N1bWVudHMgd2l0aCBTbmFwc2hvdFZlcnNpb24ubWluKCkgYXJlIHVzZWQgaW4gbWFudWZhY3R1cmVkXG4gICAgICAgICAgICAvLyBldmVudHMuIFdlIHJlbW92ZSB0aGVzZSBkb2N1bWVudHMgZnJvbSBjYWNoZSBzaW5jZSB3ZSBsb3N0XG4gICAgICAgICAgICAvLyBhY2Nlc3MuXG4gICAgICAgICAgICBlLnJlbW92ZUVudHJ5KG4sIHIucmVhZFRpbWUpLCBzID0gcy5pbnNlcnQobiwgcikpIDogIW8uaXNWYWxpZERvY3VtZW50KCkgfHwgci52ZXJzaW9uLmNvbXBhcmVUbyhvLnZlcnNpb24pID4gMCB8fCAwID09PSByLnZlcnNpb24uY29tcGFyZVRvKG8udmVyc2lvbikgJiYgby5oYXNQZW5kaW5nV3JpdGVzID8gKGUuYWRkRW50cnkociksIFxuICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KG4sIHIpKSA6IEMoXCJMb2NhbFN0b3JlXCIsIFwiSWdub3Jpbmcgb3V0ZGF0ZWQgd2F0Y2ggdXBkYXRlIGZvciBcIiwgbiwgXCIuIEN1cnJlbnQgdmVyc2lvbjpcIiwgby52ZXJzaW9uLCBcIiBXYXRjaCB2ZXJzaW9uOlwiLCByLnZlcnNpb24pO1xuICAgICAgICB9KSksIHtcbiAgICAgICAgICAgIFdpOiBzLFxuICAgICAgICAgICAgemk6IGlcbiAgICAgICAgfTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgbXV0YXRpb24gYmF0Y2ggYWZ0ZXIgdGhlIHBhc3NlZCBpbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZVxuICogb3IgbnVsbCBpZiBlbXB0eS5cbiAqIEBwYXJhbSBhZnRlckJhdGNoSWQgLSBJZiBwcm92aWRlZCwgdGhlIGJhdGNoIHRvIHNlYXJjaCBhZnRlci5cbiAqIEByZXR1cm5zIFRoZSBuZXh0IG11dGF0aW9uIG9yIG51bGwgaWYgdGhlcmUgd2Fzbid0IG9uZS5cbiAqL1xuZnVuY3Rpb24gdm8odCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5leHQgbXV0YXRpb24gYmF0Y2hcIiwgXCJyZWFkb25seVwiLCAodCA9PiAodm9pZCAwID09PSBlICYmIChlID0gLTEpLCBcbiAgICBuLm11dGF0aW9uUXVldWUuZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodCwgZSkpKSk7XG59XG5cbi8qKlxuICogUmVhZHMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgYSBEb2N1bWVudCB3aXRoIGEgZ2l2ZW4ga2V5IG9yIG51bGwgaWYgbm90XG4gKiBmb3VuZCAtIHVzZWQgZm9yIHRlc3RpbmcuXG4gKi9cbi8qKlxuICogQXNzaWducyB0aGUgZ2l2ZW4gdGFyZ2V0IGFuIGludGVybmFsIElEIHNvIHRoYXQgaXRzIHJlc3VsdHMgY2FuIGJlIHBpbm5lZCBzb1xuICogdGhleSBkb24ndCBnZXQgR0MnZC4gQSB0YXJnZXQgbXVzdCBiZSBhbGxvY2F0ZWQgaW4gdGhlIGxvY2FsIHN0b3JlIGJlZm9yZVxuICogdGhlIHN0b3JlIGNhbiBiZSB1c2VkIHRvIG1hbmFnZSBpdHMgdmlldy5cbiAqXG4gKiBBbGxvY2F0aW5nIGFuIGFscmVhZHkgYWxsb2NhdGVkIGBUYXJnZXRgIHdpbGwgcmV0dXJuIHRoZSBleGlzdGluZyBgVGFyZ2V0RGF0YWBcbiAqIGZvciB0aGF0IGBUYXJnZXRgLlxuICovXG5mdW5jdGlvbiBWbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBbGxvY2F0ZSB0YXJnZXRcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4ge1xuICAgICAgICBsZXQgcztcbiAgICAgICAgcmV0dXJuIG4uQ3MuZ2V0VGFyZ2V0RGF0YSh0LCBlKS5uZXh0KChpID0+IGkgPyAoXG4gICAgICAgIC8vIFRoaXMgdGFyZ2V0IGhhcyBiZWVuIGxpc3RlbmVkIHRvIHByZXZpb3VzbHksIHNvIHJldXNlIHRoZVxuICAgICAgICAvLyBwcmV2aW91cyB0YXJnZXRJRC5cbiAgICAgICAgLy8gVE9ETyhtY2cpOiBmcmVzaGVuIGxhc3QgYWNjZXNzZWQgZGF0ZT9cbiAgICAgICAgcyA9IGksIEF0LnJlc29sdmUocykpIDogbi5Dcy5hbGxvY2F0ZVRhcmdldElkKHQpLm5leHQoKGkgPT4gKHMgPSBuZXcgRmkoZSwgaSwgMCAvKiBMaXN0ZW4gKi8gLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIFxuICAgICAgICBuLkNzLmFkZFRhcmdldERhdGEodCwgcykubmV4dCgoKCkgPT4gcykpKSkpKSk7XG4gICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAvLyBJZiBNdWx0aS1UYWIgaXMgZW5hYmxlZCwgdGhlIGV4aXN0aW5nIHRhcmdldCBkYXRhIG1heSBiZSBuZXdlciB0aGFuXG4gICAgICAgIC8vIHRoZSBpbi1tZW1vcnkgZGF0YVxuICAgICAgICBjb25zdCBzID0gbi5VaS5nZXQodC50YXJnZXRJZCk7XG4gICAgICAgIHJldHVybiAobnVsbCA9PT0gcyB8fCB0LnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8ocy5zbmFwc2hvdFZlcnNpb24pID4gMCkgJiYgKG4uVWkgPSBuLlVpLmluc2VydCh0LnRhcmdldElkLCB0KSwgXG4gICAgICAgIG4ucWkuc2V0KGUsIHQudGFyZ2V0SWQpKSwgdDtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBhcyBzZWVuIGJ5IHRoZSBMb2NhbFN0b3JlLCBpbmNsdWRpbmcgdXBkYXRlcyB0aGF0IG1heVxuICogaGF2ZSBub3QgeWV0IGJlZW4gcGVyc2lzdGVkIHRvIHRoZSBUYXJnZXRDYWNoZS5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbi8qKlxuICogVW5waW5zIGFsbCB0aGUgZG9jdW1lbnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZlxuICogYGtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhYCBpcyBzZXQgdG8gZmFsc2UgYW5kIEVhZ2VyIEdDIGVuYWJsZWQsIHRoZSBtZXRob2RcbiAqIGRpcmVjdGx5IHJlbW92ZXMgdGhlIGFzc29jaWF0ZWQgdGFyZ2V0IGRhdGEgZnJvbSB0aGUgdGFyZ2V0IGNhY2hlLlxuICpcbiAqIFJlbGVhc2luZyBhIG5vbi1leGlzdGluZyBgVGFyZ2V0YCBpcyBhIG5vLW9wLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgbXVsdGktdGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBTbyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9ICQodCksIGkgPSBzLlVpLmdldChlKSwgciA9IG4gPyBcInJlYWR3cml0ZVwiIDogXCJyZWFkd3JpdGUtcHJpbWFyeVwiO1xuICAgIHRyeSB7XG4gICAgICAgIG4gfHwgYXdhaXQgcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlbGVhc2UgdGFyZ2V0XCIsIHIsICh0ID0+IHMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlVGFyZ2V0KHQsIGkpKSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBpZiAoIVZ0KHQpKSB0aHJvdyB0O1xuICAgICAgICAvLyBBbGwgYHJlbGVhc2VUYXJnZXRgIGRvZXMgaXMgcmVjb3JkIHRoZSBmaW5hbCBtZXRhZGF0YSBzdGF0ZSBmb3IgdGhlXG4gICAgICAgIC8vIHRhcmdldCwgYnV0IHdlJ3ZlIGJlZW4gcmVjb3JkaW5nIHRoaXMgcGVyaW9kaWNhbGx5IGR1cmluZyB0YXJnZXRcbiAgICAgICAgLy8gYWN0aXZpdHkuIElmIHdlIGxvc2UgdGhpcyB3cml0ZSB0aGlzIGNvdWxkIGNhdXNlIGEgdmVyeSBzbGlnaHRcbiAgICAgICAgLy8gZGlmZmVyZW5jZSBpbiB0aGUgb3JkZXIgb2YgdGFyZ2V0IGRlbGV0aW9uIGR1cmluZyBHQywgYnV0IHdlXG4gICAgICAgIC8vIGRvbid0IGRlZmluZSBleGFjdCBMUlUgc2VtYW50aWNzIHNvIHRoaXMgaXMgYWNjZXB0YWJsZS5cbiAgICAgICAgQyhcIkxvY2FsU3RvcmVcIiwgYEZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgbnVtYmVycyBmb3IgdGFyZ2V0ICR7ZX06ICR7dH1gKTtcbiAgICB9XG4gICAgcy5VaSA9IHMuVWkucmVtb3ZlKGUpLCBzLnFpLmRlbGV0ZShpLnRhcmdldCk7XG59XG5cbi8qKlxuICogUnVucyB0aGUgc3BlY2lmaWVkIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIGFuZCByZXR1cm5zIHRoZSByZXN1bHRzLFxuICogcG90ZW50aWFsbHkgdGFraW5nIGFkdmFudGFnZSBvZiBxdWVyeSBkYXRhIGZyb20gcHJldmlvdXMgZXhlY3V0aW9ucyAoc3VjaFxuICogYXMgdGhlIHNldCBvZiByZW1vdGUga2V5cykuXG4gKlxuICogQHBhcmFtIHVzZVByZXZpb3VzUmVzdWx0cyAtIFdoZXRoZXIgcmVzdWx0cyBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgY2FuXG4gKiBiZSB1c2VkIHRvIG9wdGltaXplIHRoaXMgcXVlcnkgZXhlY3V0aW9uLlxuICovIGZ1bmN0aW9uIERvKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gJCh0KTtcbiAgICBsZXQgaSA9IHN0Lm1pbigpLCByID0gZnMoKTtcbiAgICByZXR1cm4gcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkV4ZWN1dGUgcXVlcnlcIiwgXCJyZWFkb25seVwiLCAodCA9PiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSAkKHQpLCBpID0gcy5xaS5nZXQobik7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGkgPyBBdC5yZXNvbHZlKHMuVWkuZ2V0KGkpKSA6IHMuQ3MuZ2V0VGFyZ2V0RGF0YShlLCBuKTtcbiAgICB9KHMsIHQsIGNuKGUpKS5uZXh0KChlID0+IHtcbiAgICAgICAgaWYgKGUpIHJldHVybiBpID0gZS5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCBzLkNzLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgciA9IHQ7XG4gICAgICAgIH0pKTtcbiAgICB9KSkubmV4dCgoKCkgPT4gcy5MaS5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4gPyBpIDogc3QubWluKCksIG4gPyByIDogZnMoKSkpKS5uZXh0KCh0ID0+IChObyhzLCBfbihlKSwgdCksIFxuICAgIHtcbiAgICAgICAgZG9jdW1lbnRzOiB0LFxuICAgICAgICBIaTogclxuICAgIH0pKSkpKTtcbn1cblxuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIENvKHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KSwgcyA9ICQobi5DcyksIGkgPSBuLlVpLmdldChlKTtcbiAgICByZXR1cm4gaSA/IFByb21pc2UucmVzb2x2ZShpLnRhcmdldCkgOiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IHRhcmdldCBkYXRhXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gcy5zZSh0LCBlKS5uZXh0KCh0ID0+IHQgPyB0LnRhcmdldCA6IG51bGwpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBzaW5jZSB0aGUgbGFzdCBjYWxsLlxuICogSWYgdGhpcyBpcyB0aGUgZmlyc3QgY2FsbCwgcmV0dXJucyB0aGUgc2V0IG9mIGNoYW5nZXMgc2luY2UgY2xpZW50XG4gKiBpbml0aWFsaXphdGlvbi4gRnVydGhlciBpbnZvY2F0aW9ucyB3aWxsIHJldHVybiBkb2N1bWVudCB0aGF0IGhhdmUgY2hhbmdlZFxuICogc2luY2UgdGhlIHByaW9yIGNhbGwuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5mdW5jdGlvbiB4byh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCksIHMgPSBuLktpLmdldChlKSB8fCBzdC5taW4oKTtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgbWF4aW11bSByZWFkIHRpbWUgZm9yIHRoZSBjb2xsZWN0aW9uLiBUaGlzIHNob3VsZCBhbHdheXNcbiAgICAvLyBleGlzdCwgYnV0IHRvIHJlZHVjZSB0aGUgY2hhbmNlIGZvciByZWdyZXNzaW9ucyB3ZSBkZWZhdWx0IHRvXG4gICAgLy8gU25hcHNob3RWZXJzaW9uLk1pbigpXG4gICAgLy8gVE9ETyhpbmRleGluZyk6IENvbnNpZGVyIHJlbW92aW5nIHRoZSBkZWZhdWx0IHZhbHVlLlxuICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBuZXcgZG9jdW1lbnQgY2hhbmdlc1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IG4uR2kuZ2V0QWxsRnJvbUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBtdChzLCAtMSksIFxuICAgIC8qIGxpbWl0PSAqLyBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikpKS50aGVuKCh0ID0+IChObyhuLCBlLCB0KSwgdCkpKTtcbn1cblxuLyoqIFNldHMgdGhlIGNvbGxlY3Rpb24gZ3JvdXAncyBtYXhpbXVtIHJlYWQgdGltZSBmcm9tIHRoZSBnaXZlbiBkb2N1bWVudHMuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gTm8odCwgZSwgbikge1xuICAgIGxldCBzID0gdC5LaS5nZXQoZSkgfHwgc3QubWluKCk7XG4gICAgbi5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICBlLnJlYWRUaW1lLmNvbXBhcmVUbyhzKSA+IDAgJiYgKHMgPSBlLnJlYWRUaW1lKTtcbiAgICB9KSksIHQuS2kuc2V0KGUsIHMpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IHVzaW5nIHRoZSBnaXZlbiBidW5kbGUgbmFtZSwgd2hpY2ggd2lsbCBiZSB1c2VkIHRvXG4gKiBob2xkIHRoZSBrZXlzIG9mIGFsbCBkb2N1bWVudHMgZnJvbSB0aGUgYnVuZGxlIGluIHF1ZXJ5LWRvY3VtZW50IG1hcHBpbmdzLlxuICogVGhpcyBlbnN1cmVzIHRoYXQgdGhlIGxvYWRlZCBkb2N1bWVudHMgZG8gbm90IGdldCBnYXJiYWdlIGNvbGxlY3RlZFxuICogcmlnaHQgYXdheS5cbiAqL1xuLyoqXG4gKiBBcHBsaWVzIHRoZSBkb2N1bWVudHMgZnJvbSBhIGJ1bmRsZSB0byB0aGUgXCJncm91bmQtc3RhdGVcIiAocmVtb3RlKVxuICogZG9jdW1lbnRzLlxuICpcbiAqIExvY2FsRG9jdW1lbnRzIGFyZSByZS1jYWxjdWxhdGVkIGlmIHRoZXJlIGFyZSByZW1haW5pbmcgbXV0YXRpb25zIGluIHRoZVxuICogcXVldWUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGtvKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gJCh0KTtcbiAgICBsZXQgciA9IGZzKCksIG8gPSBzcygpO1xuICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLkppKHQubWV0YWRhdGEubmFtZSk7XG4gICAgICAgIHQuZG9jdW1lbnQgJiYgKHIgPSByLmFkZChuKSk7XG4gICAgICAgIGNvbnN0IHMgPSBlLllpKHQpO1xuICAgICAgICBzLnNldFJlYWRUaW1lKGUuWGkodC5tZXRhZGF0YS5yZWFkVGltZSkpLCBvID0gby5pbnNlcnQobiwgcyk7XG4gICAgfVxuICAgIGNvbnN0IHUgPSBpLkdpLm5ld0NoYW5nZUJ1ZmZlcih7XG4gICAgICAgIHRyYWNrUmVtb3ZhbHM6ICEwXG4gICAgfSksIGMgPSBhd2FpdCBWbyhpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIC8vIEl0IGlzIE9LIHRoYXQgdGhlIHBhdGggdXNlZCBmb3IgdGhlIHF1ZXJ5IGlzIG5vdCB2YWxpZCwgYmVjYXVzZSB0aGlzIHdpbGxcbiAgICAgICAgLy8gbm90IGJlIHJlYWQgYW5kIHF1ZXJpZWQuXG4gICAgICAgIHJldHVybiBjbihlbihydC5mcm9tU3RyaW5nKGBfX2J1bmRsZV9fL2RvY3MvJHt0fWApKSk7XG4gICAgfShzKSk7XG4gICAgLy8gQWxsb2NhdGVzIGEgdGFyZ2V0IHRvIGhvbGQgYWxsIGRvY3VtZW50IGtleXMgZnJvbSB0aGUgYnVuZGxlLCBzdWNoIHRoYXRcbiAgICAvLyB0aGV5IHdpbGwgbm90IGdldCBnYXJiYWdlIGNvbGxlY3RlZCByaWdodCBhd2F5LlxuICAgICAgICByZXR1cm4gaS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkFwcGx5IGJ1bmRsZSBkb2N1bWVudHNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gUG8odCwgdSwgbykubmV4dCgoZSA9PiAodS5hcHBseSh0KSwgXG4gICAgZSkpKS5uZXh0KChlID0+IGkuQ3MucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodCwgYy50YXJnZXRJZCkubmV4dCgoKCkgPT4gaS5Dcy5hZGRNYXRjaGluZ0tleXModCwgciwgYy50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiBpLmxvY2FsRG9jdW1lbnRzLmdldExvY2FsVmlld09mRG9jdW1lbnRzKHQsIGUuV2ksIGUuemkpKSkubmV4dCgoKCkgPT4gZS5XaSkpKSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBvZiBhIGJvb2xlYW4gdG8gaW5kaWNhdGUgaWYgdGhlIGdpdmVuIGJ1bmRsZSBoYXMgYWxyZWFkeVxuICogYmVlbiBsb2FkZWQgYW5kIHRoZSBjcmVhdGUgdGltZSBpcyBuZXdlciB0aGFuIHRoZSBjdXJyZW50IGxvYWRpbmcgYnVuZGxlLlxuICovXG4vKipcbiAqIFNhdmVzIHRoZSBnaXZlbiBgTmFtZWRRdWVyeWAgdG8gbG9jYWwgcGVyc2lzdGVuY2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIE9vKHQsIGUsIG4gPSBmcygpKSB7XG4gICAgLy8gQWxsb2NhdGUgYSB0YXJnZXQgZm9yIHRoZSBuYW1lZCBxdWVyeSBzdWNoIHRoYXQgaXQgY2FuIGJlIHJlc3VtZWRcbiAgICAvLyBmcm9tIGFzc29jaWF0ZWQgcmVhZCB0aW1lIGlmIHVzZXJzIHVzZSBpdCB0byBsaXN0ZW4uXG4gICAgLy8gTk9URTogdGhpcyBhbHNvIG1lYW5zIGlmIG5vIGNvcnJlc3BvbmRpbmcgdGFyZ2V0IGV4aXN0cywgdGhlIG5ldyB0YXJnZXRcbiAgICAvLyB3aWxsIHJlbWFpbiBhY3RpdmUgYW5kIHdpbGwgbm90IGdldCBjb2xsZWN0ZWQsIHVubGVzcyB1c2VycyBoYXBwZW4gdG9cbiAgICAvLyB1bmxpc3RlbiB0aGUgcXVlcnkgc29tZWhvdy5cbiAgICBjb25zdCBzID0gYXdhaXQgVm8odCwgY24oV2koZS5idW5kbGVkUXVlcnkpKSksIGkgPSAkKHQpO1xuICAgIHJldHVybiBpLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiU2F2ZSBuYW1lZCBxdWVyeVwiLCBcInJlYWR3cml0ZVwiLCAodCA9PiB7XG4gICAgICAgIGNvbnN0IHIgPSBEcyhlLnJlYWRUaW1lKTtcbiAgICAgICAgLy8gU2ltcGx5IHNhdmUgdGhlIHF1ZXJ5IGl0c2VsZiBpZiBpdCBpcyBvbGRlciB0aGFuIHdoYXQgdGhlIFNESyBhbHJlYWR5XG4gICAgICAgIC8vIGhhcy5cbiAgICAgICAgICAgICAgICBpZiAocy5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHIpID49IDApIHJldHVybiBpLk5zLnNhdmVOYW1lZFF1ZXJ5KHQsIGUpO1xuICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgdGFyZ2V0IGRhdGEgYmVjYXVzZSB0aGUgcXVlcnkgZnJvbSB0aGUgYnVuZGxlIGlzIG5ld2VyLlxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBzLndpdGhSZXN1bWVUb2tlbihXdC5FTVBUWV9CWVRFX1NUUklORywgcik7XG4gICAgICAgIHJldHVybiBpLlVpID0gaS5VaS5pbnNlcnQoby50YXJnZXRJZCwgbyksIGkuQ3MudXBkYXRlVGFyZ2V0RGF0YSh0LCBvKS5uZXh0KCgoKSA9PiBpLkNzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIHMudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5Dcy5hZGRNYXRjaGluZ0tleXModCwgbiwgcy50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiBpLk5zLnNhdmVOYW1lZFF1ZXJ5KHQsIGUpKSk7XG4gICAgfSkpO1xufVxuXG4vKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UgKi9cbmZ1bmN0aW9uIE1vKHQsIGUpIHtcbiAgICByZXR1cm4gYGZpcmVzdG9yZV9jbGllbnRzXyR7dH1fJHtlfWA7XG59XG5cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHRoZSBtdXRhdGlvbiBzdGF0ZSBpczpcbi8vICAgICBmaXJlc3RvcmVfbXV0YXRpb25zXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxiYXRjaF9pZD5cbi8vICAgICAoZm9yIHVuYXV0aGVudGljYXRlZCB1c2Vycylcbi8vIG9yOiBmaXJlc3RvcmVfbXV0YXRpb25zXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxiYXRjaF9pZD5fPHVzZXJfdWlkPlxuXG4vLyAndXNlcl91aWQnIGlzIGxhc3QgdG8gYXZvaWQgbmVlZGluZyB0byBlc2NhcGUgJ18nIGNoYXJhY3RlcnMgdGhhdCBpdCBtaWdodFxuLy8gY29udGFpbi5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBtdXRhdGlvbiBiYXRjaCBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiBGbyh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSBgZmlyZXN0b3JlX211dGF0aW9uc18ke3R9XyR7bn1gO1xuICAgIHJldHVybiBlLmlzQXV0aGVudGljYXRlZCgpICYmIChzICs9IGBfJHtlLnVpZH1gKSwgcztcbn1cblxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgV2ViU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgYSBxdWVyeSB0YXJnZXQncyBtZXRhZGF0YSBpczpcbi8vICAgICBmaXJlc3RvcmVfdGFyZ2V0c188cGVyc2lzdGVuY2VfcHJlZml4Pl88dGFyZ2V0X2lkPlxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIHF1ZXJ5IHN0YXRlIGluIFdlYlN0b3JhZ2UgKi9cbmZ1bmN0aW9uICRvKHQsIGUpIHtcbiAgICByZXR1cm4gYGZpcmVzdG9yZV90YXJnZXRzXyR7dH1fJHtlfWA7XG59XG5cbi8vIFRoZSBXZWJTdG9yYWdlIHByZWZpeCB0aGF0IHN0b3JlcyB0aGUgcHJpbWFyeSB0YWIncyBvbmxpbmUgc3RhdGUuIFRoZVxuLy8gZm9ybWF0IG9mIHRoZSBrZXkgaXM6XG4vLyAgICAgZmlyZXN0b3JlX29ubGluZV9zdGF0ZV88cGVyc2lzdGVuY2VfcHJlZml4PlxuLyoqXG4gKiBIb2xkcyB0aGUgc3RhdGUgb2YgYSBtdXRhdGlvbiBiYXRjaCwgaW5jbHVkaW5nIGl0cyB1c2VyIElELCBiYXRjaCBJRCBhbmRcbiAqIHdoZXRoZXIgdGhlIGJhdGNoIGlzICdwZW5kaW5nJywgJ2Fja25vd2xlZGdlZCcgb3IgJ3JlamVjdGVkJy5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuY2xhc3MgQm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy51c2VyID0gdCwgdGhpcy5iYXRjaElkID0gZSwgdGhpcy5zdGF0ZSA9IG4sIHRoaXMuZXJyb3IgPSBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBNdXRhdGlvbk1ldGFkYXRhIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgWmkodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gSlNPTi5wYXJzZShuKTtcbiAgICAgICAgbGV0IGksIHIgPSBcIm9iamVjdFwiID09IHR5cGVvZiBzICYmIC0xICE9PSBbIFwicGVuZGluZ1wiLCBcImFja25vd2xlZGdlZFwiLCBcInJlamVjdGVkXCIgXS5pbmRleE9mKHMuc3RhdGUpICYmICh2b2lkIDAgPT09IHMuZXJyb3IgfHwgXCJvYmplY3RcIiA9PSB0eXBlb2Ygcy5lcnJvcik7XG4gICAgICAgIHJldHVybiByICYmIHMuZXJyb3IgJiYgKHIgPSBcInN0cmluZ1wiID09IHR5cGVvZiBzLmVycm9yLm1lc3NhZ2UgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5lcnJvci5jb2RlLCBcbiAgICAgICAgciAmJiAoaSA9IG5ldyBMKHMuZXJyb3IuY29kZSwgcy5lcnJvci5tZXNzYWdlKSkpLCByID8gbmV3IEJvKHQsIGUsIHMuc3RhdGUsIGkpIDogKHgoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgRmFpbGVkIHRvIHBhcnNlIG11dGF0aW9uIHN0YXRlIGZvciBJRCAnJHtlfSc6ICR7bn1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbiAgICB0cigpIHtcbiAgICAgICAgY29uc3QgdCA9IHtcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yICYmICh0LmVycm9yID0ge1xuICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxuICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXG4gICAgICAgIH0pLCBKU09OLnN0cmluZ2lmeSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgcXVlcnkgdGFyZ2V0LCBpbmNsdWRpbmcgaXRzIHRhcmdldCBJRCBhbmQgd2hldGhlciB0aGVcbiAqIHRhcmdldCBpcyAnbm90LWN1cnJlbnQnLCAnY3VycmVudCcgb3IgJ3JlamVjdGVkJy5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuY2xhc3MgTG8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMuc3RhdGUgPSBlLCB0aGlzLmVycm9yID0gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgUXVlcnlUYXJnZXRNZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIFppKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UoZSk7XG4gICAgICAgIGxldCBzLCBpID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgbiAmJiAtMSAhPT0gWyBcIm5vdC1jdXJyZW50XCIsIFwiY3VycmVudFwiLCBcInJlamVjdGVkXCIgXS5pbmRleE9mKG4uc3RhdGUpICYmICh2b2lkIDAgPT09IG4uZXJyb3IgfHwgXCJvYmplY3RcIiA9PSB0eXBlb2Ygbi5lcnJvcik7XG4gICAgICAgIHJldHVybiBpICYmIG4uZXJyb3IgJiYgKGkgPSBcInN0cmluZ1wiID09IHR5cGVvZiBuLmVycm9yLm1lc3NhZ2UgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2Ygbi5lcnJvci5jb2RlLCBcbiAgICAgICAgaSAmJiAocyA9IG5ldyBMKG4uZXJyb3IuY29kZSwgbi5lcnJvci5tZXNzYWdlKSkpLCBpID8gbmV3IExvKHQsIG4uc3RhdGUsIHMpIDogKHgoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgRmFpbGVkIHRvIHBhcnNlIHRhcmdldCBzdGF0ZSBmb3IgSUQgJyR7dH0nOiAke2V9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG4gICAgdHIoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5lcnJvciAmJiAodC5lcnJvciA9IHtcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxuICAgICAgICB9KSwgSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoaXMgY2xhc3MgcmVwcmVzZW50cyB0aGUgaW1tdXRhYmxlIENsaWVudFN0YXRlIGZvciBhIGNsaWVudCByZWFkIGZyb21cbiAqIFdlYlN0b3JhZ2UsIGNvbnRhaW5pbmcgdGhlIGxpc3Qgb2YgYWN0aXZlIHF1ZXJ5IHRhcmdldHMuXG4gKi8gY2xhc3MgVW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IHQsIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgUmVtb3RlQ2xpZW50U3RhdGUgZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyBaaSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBKU09OLnBhcnNlKGUpO1xuICAgICAgICBsZXQgcyA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4gJiYgbi5hY3RpdmVUYXJnZXRJZHMgaW5zdGFuY2VvZiBBcnJheSwgaSA9IF9zKCk7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyBzICYmIHQgPCBuLmFjdGl2ZVRhcmdldElkcy5sZW5ndGg7ICsrdCkgcyA9IHJlKG4uYWN0aXZlVGFyZ2V0SWRzW3RdKSwgXG4gICAgICAgIGkgPSBpLmFkZChuLmFjdGl2ZVRhcmdldElkc1t0XSk7XG4gICAgICAgIHJldHVybiBzID8gbmV3IFVvKHQsIGkpIDogKHgoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgRmFpbGVkIHRvIHBhcnNlIGNsaWVudCBkYXRhIGZvciBpbnN0YW5jZSAnJHt0fSc6ICR7ZX1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIG9ubGluZSBzdGF0ZSBmb3IgYWxsIGNsaWVudHMgcGFydGljaXBhdGluZyBpblxuICogbXVsdGktdGFiLiBUaGUgb25saW5lIHN0YXRlIGlzIG9ubHkgd3JpdHRlbiB0byBieSB0aGUgcHJpbWFyeSBjbGllbnQsIGFuZFxuICogdXNlZCBpbiBzZWNvbmRhcnkgY2xpZW50cyB0byB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3MuXG4gKi8gY2xhc3MgcW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IHQsIHRoaXMub25saW5lU3RhdGUgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBTaGFyZWRPbmxpbmVTdGF0ZSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIFppKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEpTT04ucGFyc2UodCk7XG4gICAgICAgIHJldHVybiBcIm9iamVjdFwiID09IHR5cGVvZiBlICYmIC0xICE9PSBbIFwiVW5rbm93blwiLCBcIk9ubGluZVwiLCBcIk9mZmxpbmVcIiBdLmluZGV4T2YoZS5vbmxpbmVTdGF0ZSkgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS5jbGllbnRJZCA/IG5ldyBxbyhlLmNsaWVudElkLCBlLm9ubGluZVN0YXRlKSA6ICh4KFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBvbmxpbmUgc3RhdGU6ICR7dH1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBNZXRhZGF0YSBzdGF0ZSBvZiB0aGUgbG9jYWwgY2xpZW50LiBVbmxpa2UgYFJlbW90ZUNsaWVudFN0YXRlYCwgdGhpcyBjbGFzcyBpc1xuICogbXV0YWJsZSBhbmQga2VlcHMgdHJhY2sgb2YgYWxsIHBlbmRpbmcgbXV0YXRpb25zLCB3aGljaCBhbGxvd3MgdXMgdG9cbiAqIHVwZGF0ZSB0aGUgcmFuZ2Ugb2YgcGVuZGluZyBtdXRhdGlvbiBiYXRjaCBJRHMgYXMgbmV3IG11dGF0aW9ucyBhcmUgYWRkZWQgb3JcbiAqIHJlbW92ZWQuXG4gKlxuICogVGhlIGRhdGEgaW4gYExvY2FsQ2xpZW50U3RhdGVgIGlzIG5vdCByZWFkIGZyb20gV2ViU3RvcmFnZSBhbmQgaW5zdGVhZFxuICogdXBkYXRlZCB2aWEgaXRzIGluc3RhbmNlIG1ldGhvZHMuIFRoZSB1cGRhdGVkIHN0YXRlIGNhbiBiZSBzZXJpYWxpemVkIHZpYVxuICogYHRvV2ViU3RvcmFnZUpTT04oKWAuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG5jbGFzcyBLbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gX3MoKTtcbiAgICB9XG4gICAgZXIodCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmFkZCh0KTtcbiAgICB9XG4gICAgbnIodCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLmRlbGV0ZSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhpcyBlbnRyeSBpbnRvIGEgSlNPTi1lbmNvZGVkIGZvcm1hdCB3ZSBjYW4gdXNlIGZvciBXZWJTdG9yYWdlLlxuICAgICAqIERvZXMgbm90IGVuY29kZSBgY2xpZW50SWRgIGFzIGl0IGlzIHBhcnQgb2YgdGhlIGtleSBpbiBXZWJTdG9yYWdlLlxuICAgICAqLyAgICB0cigpIHtcbiAgICAgICAgY29uc3QgdCA9IHtcbiAgICAgICAgICAgIGFjdGl2ZVRhcmdldElkczogdGhpcy5hY3RpdmVUYXJnZXRJZHMudG9BcnJheSgpLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWAgdXNlcyBXZWJTdG9yYWdlICh3aW5kb3cubG9jYWxTdG9yYWdlKSBhcyB0aGVcbiAqIGJhY2tpbmcgc3RvcmUgZm9yIHRoZSBTaGFyZWRDbGllbnRTdGF0ZS4gSXQga2VlcHMgdHJhY2sgb2YgYWxsIGFjdGl2ZVxuICogY2xpZW50cyBhbmQgc3VwcG9ydHMgbW9kaWZpY2F0aW9ucyBvZiB0aGUgbG9jYWwgY2xpZW50J3MgZGF0YS5cbiAqLyBjbGFzcyBHbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLndpbmRvdyA9IHQsIHRoaXMuSHMgPSBlLCB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gbiwgdGhpcy5zciA9IHMsIHRoaXMuc3luY0VuZ2luZSA9IG51bGwsIFxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG51bGwsIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gbnVsbCwgdGhpcy5pciA9IHRoaXMucnIuYmluZCh0aGlzKSwgXG4gICAgICAgIHRoaXMudXIgPSBuZXcgQnQoWiksIHRoaXMuc3RhcnRlZCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhcHR1cmVzIFdlYlN0b3JhZ2UgZXZlbnRzIHRoYXQgb2NjdXIgYmVmb3JlIGBzdGFydCgpYCBpcyBjYWxsZWQuIFRoZXNlXG4gICAgICAgICAqIGV2ZW50cyBhcmUgcmVwbGF5ZWQgb25jZSBgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlYCBpcyBzdGFydGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jciA9IFtdO1xuICAgICAgICAvLyBFc2NhcGUgdGhlIHNwZWNpYWwgY2hhcmFjdGVycyBtZW50aW9uZWQgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9SZWd1bGFyX0V4cHJlc3Npb25zXG4gICAgICAgIGNvbnN0IHIgPSBuLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCBcIlxcXFwkJlwiKTtcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlLCB0aGlzLmN1cnJlbnRVc2VyID0gaSwgdGhpcy5hciA9IE1vKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuc3IpLCBcbiAgICAgICAgdGhpcy5ociA9IFxuICAgICAgICAvKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIHRoZSBjdXJyZW50IHNlcXVlbmNlIG51bWJlci4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0aGlzLnBlcnNpc3RlbmNlS2V5KSwgdGhpcy51ciA9IHRoaXMudXIuaW5zZXJ0KHRoaXMuc3IsIG5ldyBLbyksIHRoaXMubHIgPSBuZXcgUmVnRXhwKGBeZmlyZXN0b3JlX2NsaWVudHNfJHtyfV8oW15fXSopJGApLCBcbiAgICAgICAgdGhpcy5kciA9IG5ldyBSZWdFeHAoYF5maXJlc3RvcmVfbXV0YXRpb25zXyR7cn1fKFxcXFxkKykoPzpfKC4qKSk/JGApLCB0aGlzLl9yID0gbmV3IFJlZ0V4cChgXmZpcmVzdG9yZV90YXJnZXRzXyR7cn1fKFxcXFxkKykkYCksIFxuICAgICAgICB0aGlzLndyID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIG9ubGluZSBzdGF0ZSBvZiB0aGUgcHJpbWFyeSB0YWIuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBgZmlyZXN0b3JlX29ubGluZV9zdGF0ZV8ke3R9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBwbGF5cyBhcyBhIGV2ZW50IHRvIGluZGljYXRlIHRoZSByZW1vdGUgZG9jdW1lbnRzXG4gICAgICAgIC8vIG1pZ2h0IGhhdmUgY2hhbmdlZCBkdWUgdG8gc29tZSBzZWNvbmRhcnkgdGFicyBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAgICAvLyBmb3JtYXQgb2YgdGhlIGtleSBpczpcbiAgICAgICAgLy8gICAgIGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkX3YyXzxwZXJzaXN0ZW5jZUtleT5cbiAgICAgICAgLy8gVGhlIHZlcnNpb24gZW5kaW5nIHdpdGggXCJ2MlwiIHN0b3JlcyB0aGUgbGlzdCBvZiBtb2RpZmllZCBjb2xsZWN0aW9uIGdyb3Vwcy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLm1yID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfYnVuZGxlX2xvYWRlZF92Ml8ke3R9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgV2ViU3RvcmFnZSBrZXkgcHJlZml4IGZvciB0aGUga2V5IHRoYXQgc3RvcmVzIHRoZSBsYXN0IHNlcXVlbmNlIG51bWJlciBhbGxvY2F0ZWQuIFRoZSBrZXlcbiAgICAgICAgLy8gbG9va3MgbGlrZSAnZmlyZXN0b3JlX3NlcXVlbmNlX251bWJlcl88cGVyc2lzdGVuY2VfcHJlZml4PicuXG4gICAgICAgICh0aGlzLnBlcnNpc3RlbmNlS2V5KSwgXG4gICAgICAgIC8vIFJhdGhlciB0aGFuIGFkZGluZyB0aGUgc3RvcmFnZSBvYnNlcnZlciBkdXJpbmcgc3RhcnQoKSwgd2UgYWRkIHRoZVxuICAgICAgICAvLyBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBpbml0aWFsaXphdGlvbi4gVGhpcyBlbnN1cmVzIHRoYXQgd2UgY29sbGVjdFxuICAgICAgICAvLyBldmVudHMgYmVmb3JlIG90aGVyIGNvbXBvbmVudHMgcG9wdWxhdGUgdGhlaXIgaW5pdGlhbCBzdGF0ZSAoZHVyaW5nIHRoZWlyXG4gICAgICAgIC8vIHJlc3BlY3RpdmUgc3RhcnQoKSBjYWxscykuIE90aGVyd2lzZSwgd2UgbWlnaHQgZm9yIGV4YW1wbGUgbWlzcyBhXG4gICAgICAgIC8vIG11dGF0aW9uIHRoYXQgaXMgYWRkZWQgYWZ0ZXIgTG9jYWxTdG9yZSdzIHN0YXJ0KCkgcHJvY2Vzc2VkIHRoZSBleGlzdGluZ1xuICAgICAgICAvLyBtdXRhdGlvbnMgYnV0IGJlZm9yZSB3ZSBvYnNlcnZlIFdlYlN0b3JhZ2UgZXZlbnRzLlxuICAgICAgICB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLmlyKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgJ3RydWUnIGlmIFdlYlN0b3JhZ2UgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqLyAgICBzdGF0aWMgQyh0KSB7XG4gICAgICAgIHJldHVybiAhKCF0IHx8ICF0LmxvY2FsU3RvcmFnZSk7XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0KCkge1xuICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjbGllbnRzIHRvIGJhY2tmaWxsIHRoZSBkYXRhIGluXG4gICAgICAgIC8vIFNoYXJlZENsaWVudFN0YXRlLlxuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5zeW5jRW5naW5lLnZpKCk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBpZiAoZSA9PT0gdGhpcy5zcikgY29udGludWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRJdGVtKE1vKHRoaXMucGVyc2lzdGVuY2VLZXksIGUpKTtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFVvLlppKGUsIHQpO1xuICAgICAgICAgICAgICAgIG4gJiYgKHRoaXMudXIgPSB0aGlzLnVyLmluc2VydChuLmNsaWVudElkLCBuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ncigpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBleGlzdGluZyBvbmxpbmUgc3RhdGUgYW5kIGNhbGwgdGhlIGNhbGxiYWNrIGhhbmRsZXJcbiAgICAgICAgLy8gaWYgYXBwbGljYWJsZS5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMud3IpO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMueXIoZSk7XG4gICAgICAgICAgICB0ICYmIHRoaXMucHIodCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuY3IpIHRoaXMucnIodCk7XG4gICAgICAgIHRoaXMuY3IgPSBbXSwgXG4gICAgICAgIC8vIFJlZ2lzdGVyIGEgd2luZG93IHVubG9hZCBob29rIHRvIHJlbW92ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGVudHJ5IGZyb21cbiAgICAgICAgLy8gV2ViU3RvcmFnZSBldmVuIGlmIGBzaHV0ZG93bigpYCB3YXMgbm90IGNhbGxlZC5cbiAgICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsICgoKSA9PiB0aGlzLnNodXRkb3duKCkpKSwgdGhpcy5zdGFydGVkID0gITA7XG4gICAgfVxuICAgIHdyaXRlU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5ociwgSlNPTi5zdHJpbmdpZnkodCkpO1xuICAgIH1cbiAgICBnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLklyKHRoaXMudXIpO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMudXIuZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHMuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KSAmJiAoZSA9ICEwKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24odCkge1xuICAgICAgICB0aGlzLlRyKHQsIFwicGVuZGluZ1wiKTtcbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuVHIodCwgZSwgbiksIFxuICAgICAgICAvLyBPbmNlIGEgZmluYWwgbXV0YXRpb24gcmVzdWx0IGlzIG9ic2VydmVkIGJ5IG90aGVyIGNsaWVudHMsIHRoZXkgbm8gbG9uZ2VyXG4gICAgICAgIC8vIGFjY2VzcyB0aGUgbXV0YXRpb24ncyBtZXRhZGF0YSBlbnRyeS4gU2luY2UgV2ViU3RvcmFnZSByZXBsYXlzIGV2ZW50c1xuICAgICAgICAvLyBpbiBvcmRlciwgaXQgaXMgc2FmZSB0byBkZWxldGUgdGhlIGVudHJ5IHJpZ2h0IGFmdGVyIHVwZGF0aW5nIGl0LlxuICAgICAgICB0aGlzLkVyKHQpO1xuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5vdC1jdXJyZW50XCI7XG4gICAgICAgIC8vIExvb2t1cCBhbiBleGlzdGluZyBxdWVyeSBzdGF0ZSBpZiB0aGUgdGFyZ2V0IElEIHdhcyBhbHJlYWR5IHJlZ2lzdGVyZWRcbiAgICAgICAgLy8gYnkgYW5vdGhlciB0YWJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oJG8odGhpcy5wZXJzaXN0ZW5jZUtleSwgdCkpO1xuICAgICAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gTG8uWmkodCwgbik7XG4gICAgICAgICAgICAgICAgcyAmJiAoZSA9IHMuc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLkFyLmVyKHQpLCB0aGlzLmdyKCksIGU7XG4gICAgfVxuICAgIHJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICB0aGlzLkFyLm5yKHQpLCB0aGlzLmdyKCk7XG4gICAgfVxuICAgIGlzTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkFyLmFjdGl2ZVRhcmdldElkcy5oYXModCk7XG4gICAgfVxuICAgIGNsZWFyUXVlcnlTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbSgkbyh0aGlzLnBlcnNpc3RlbmNlS2V5LCB0KSk7XG4gICAgfVxuICAgIHVwZGF0ZVF1ZXJ5U3RhdGUodCwgZSwgbikge1xuICAgICAgICB0aGlzLlJyKHQsIGUsIG4pO1xuICAgIH1cbiAgICBoYW5kbGVVc2VyQ2hhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuRXIodCk7XG4gICAgICAgIH0pKSwgdGhpcy5jdXJyZW50VXNlciA9IHQsIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZFBlbmRpbmdNdXRhdGlvbih0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMuYnIodCk7XG4gICAgfVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZCh0KSB7XG4gICAgICAgIHRoaXMuUHIodCk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgJiYgKHRoaXMud2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuaXIpLCB0aGlzLnJlbW92ZUl0ZW0odGhpcy5hciksIFxuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSAhMSk7XG4gICAgfVxuICAgIGdldEl0ZW0odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0odCk7XG4gICAgICAgIHJldHVybiBDKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJSRUFEXCIsIHQsIGUpLCBlO1xuICAgIH1cbiAgICBzZXRJdGVtKHQsIGUpIHtcbiAgICAgICAgQyhcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiU0VUXCIsIHQsIGUpLCB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlSXRlbSh0KSB7XG4gICAgICAgIEMoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIlJFTU9WRVwiLCB0KSwgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0odCk7XG4gICAgfVxuICAgIHJyKHQpIHtcbiAgICAgICAgLy8gTm90ZTogVGhlIGZ1bmN0aW9uIGlzIHR5cGVkIHRvIHRha2UgRXZlbnQgdG8gYmUgaW50ZXJmYWNlLWNvbXBhdGlibGUgd2l0aFxuICAgICAgICAvLyBgV2luZG93LmFkZEV2ZW50TGlzdGVuZXJgLlxuICAgICAgICBjb25zdCBlID0gdDtcbiAgICAgICAgaWYgKGUuc3RvcmFnZUFyZWEgPT09IHRoaXMuc3RvcmFnZSkge1xuICAgICAgICAgICAgaWYgKEMoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIkVWRU5UXCIsIGUua2V5LCBlLm5ld1ZhbHVlKSwgZS5rZXkgPT09IHRoaXMuYXIpIHJldHVybiB2b2lkIHgoXCJSZWNlaXZlZCBXZWJTdG9yYWdlIG5vdGlmaWNhdGlvbiBmb3IgbG9jYWwgY2hhbmdlLiBBbm90aGVyIGNsaWVudCBtaWdodCBoYXZlIGdhcmJhZ2UtY29sbGVjdGVkIG91ciBzdGF0ZVwiKTtcbiAgICAgICAgICAgIHRoaXMuSHMuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUua2V5KSBpZiAodGhpcy5sci50ZXN0KGUua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnZyKGUua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5Wcih0LCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5TcihlLmtleSwgZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLlZyKHQuY2xpZW50SWQsIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZHIudGVzdChlLmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuRHIoZS5rZXksIGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5Dcih0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9yLnRlc3QoZS5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLk5yKGUua2V5LCBlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMua3IodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IHRoaXMud3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMueXIoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLnByKHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSB0aGlzLmhyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlID0gT3QuYXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdCkgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE0oXCJudW1iZXJcIiA9PSB0eXBlb2YgbiksIGUgPSBuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeChcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiRmFpbGVkIHRvIHJlYWQgc2VxdWVuY2UgbnVtYmVyIGZyb20gV2ViU3RvcmFnZVwiLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAqIGBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZWAgaXMgYSBzaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgU2hhcmVkQ2xpZW50U3RhdGUgZm9yXG4gKiBjbGllbnRzIHVzaW5nIG1lbW9yeSBwZXJzaXN0ZW5jZS4gVGhlIHN0YXRlIGluIHRoaXMgY2xhc3MgcmVtYWlucyBmdWxseVxuICogaXNvbGF0ZWQgYW5kIG5vIHN5bmNocm9uaXphdGlvbiBpcyBwZXJmb3JtZWQuXG4gKi8gKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdCAhPT0gT3QuYXQgJiYgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIodCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IHRoaXMubXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLk9yKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwodC5tYXAoKHQgPT4gdGhpcy5zeW5jRW5naW5lLk1yKHQpKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuY3IucHVzaChlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgQXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVyLmdldCh0aGlzLnNyKTtcbiAgICB9XG4gICAgZ3IoKSB7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLmFyLCB0aGlzLkFyLnRyKCkpO1xuICAgIH1cbiAgICBUcih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgQm8odGhpcy5jdXJyZW50VXNlciwgdCwgZSwgbiksIGkgPSBGbyh0aGlzLnBlcnNpc3RlbmNlS2V5LCB0aGlzLmN1cnJlbnRVc2VyLCB0KTtcbiAgICAgICAgdGhpcy5zZXRJdGVtKGksIHMudHIoKSk7XG4gICAgfVxuICAgIEVyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEZvKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuY3VycmVudFVzZXIsIHQpO1xuICAgICAgICB0aGlzLnJlbW92ZUl0ZW0oZSk7XG4gICAgfVxuICAgIGJyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGNsaWVudElkOiB0aGlzLnNyLFxuICAgICAgICAgICAgb25saW5lU3RhdGU6IHRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0odGhpcy53ciwgSlNPTi5zdHJpbmdpZnkoZSkpO1xuICAgIH1cbiAgICBScih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSAkbyh0aGlzLnBlcnNpc3RlbmNlS2V5LCB0KSwgaSA9IG5ldyBMbyh0LCBlLCBuKTtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHMsIGkudHIoKSk7XG4gICAgfVxuICAgIFByKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEpTT04uc3RyaW5naWZ5KEFycmF5LmZyb20odCkpO1xuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5tciwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIGNsaWVudCBzdGF0ZSBrZXkgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyBudWxsIGlmIHRoZSBrZXkgZG9lcyBub3RcbiAgICAgKiBtYXRjaCB0aGUgZXhwZWN0ZWQga2V5IGZvcm1hdC5cbiAgICAgKi8gICAgdnIodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5sci5leGVjKHQpO1xuICAgICAgICByZXR1cm4gZSA/IGVbMV0gOiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlIGNvdWxkIG5vdFxuICAgICAqIGJlIHBhcnNlZC5cbiAgICAgKi8gICAgU3IodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy52cih0KTtcbiAgICAgICAgcmV0dXJuIFVvLlppKG4sIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBtdXRhdGlvbiBiYXRjaCBzdGF0ZSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICAgICAqLyAgICBEcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmRyLmV4ZWModCksIHMgPSBOdW1iZXIoblsxXSksIGkgPSB2b2lkIDAgIT09IG5bMl0gPyBuWzJdIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIEJvLlppKG5ldyBQKGkpLCBzLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgcXVlcnkgdGFyZ2V0IHN0YXRlIGZyb20gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cbiAgICAgKi8gICAgTnIodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5fci5leGVjKHQpLCBzID0gTnVtYmVyKG5bMV0pO1xuICAgICAgICByZXR1cm4gTG8uWmkocywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhbiBvbmxpbmUgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICAgICAqLyAgICB5cih0KSB7XG4gICAgICAgIHJldHVybiBxby5aaSh0KTtcbiAgICB9XG4gICAgT3IodCkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh0KTtcbiAgICB9XG4gICAgYXN5bmMgQ3IodCkge1xuICAgICAgICBpZiAodC51c2VyLnVpZCA9PT0gdGhpcy5jdXJyZW50VXNlci51aWQpIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuRnIodC5iYXRjaElkLCB0LnN0YXRlLCB0LmVycm9yKTtcbiAgICAgICAgQyhcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBJZ25vcmluZyBtdXRhdGlvbiBmb3Igbm9uLWFjdGl2ZSB1c2VyICR7dC51c2VyLnVpZH1gKTtcbiAgICB9XG4gICAga3IodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLiRyKHQudGFyZ2V0SWQsIHQuc3RhdGUsIHQuZXJyb3IpO1xuICAgIH1cbiAgICBWcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlID8gdGhpcy51ci5pbnNlcnQodCwgZSkgOiB0aGlzLnVyLnJlbW92ZSh0KSwgcyA9IHRoaXMuSXIodGhpcy51ciksIGkgPSB0aGlzLklyKG4pLCByID0gW10sIG8gPSBbXTtcbiAgICAgICAgcmV0dXJuIGkuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBzLmhhcyh0KSB8fCByLnB1c2godCk7XG4gICAgICAgIH0pKSwgcy5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGkuaGFzKHQpIHx8IG8ucHVzaCh0KTtcbiAgICAgICAgfSkpLCB0aGlzLnN5bmNFbmdpbmUuQnIociwgbykudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy51ciA9IG47XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgcHIodCkge1xuICAgICAgICAvLyBXZSBjaGVjayB3aGV0aGVyIHRoZSBjbGllbnQgdGhhdCB3cm90ZSB0aGlzIG9ubGluZSBzdGF0ZSBpcyBzdGlsbCBhY3RpdmVcbiAgICAgICAgLy8gYnkgY29tcGFyaW5nIGl0cyBjbGllbnQgSUQgdG8gdGhlIGxpc3Qgb2YgY2xpZW50cyBrZXB0IGFjdGl2ZSBpblxuICAgICAgICAvLyBJbmRleGVkRGIuIElmIGEgY2xpZW50IGRvZXMgbm90IHVwZGF0ZSB0aGVpciBJbmRleGVkRGIgY2xpZW50IHN0YXRlXG4gICAgICAgIC8vIHdpdGhpbiA1IHNlY29uZHMsIGl0IGlzIGNvbnNpZGVyZWQgaW5hY3RpdmUgYW5kIHdlIGRvbid0IGVtaXQgYW4gb25saW5lXG4gICAgICAgIC8vIHN0YXRlIGV2ZW50LlxuICAgICAgICB0aGlzLnVyLmdldCh0LmNsaWVudElkKSAmJiB0aGlzLm9ubGluZVN0YXRlSGFuZGxlcih0Lm9ubGluZVN0YXRlKTtcbiAgICB9XG4gICAgSXIodCkge1xuICAgICAgICBsZXQgZSA9IF9zKCk7XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBlID0gZS51bmlvbldpdGgobi5hY3RpdmVUYXJnZXRJZHMpO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxufVxuXG5jbGFzcyBRbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuTHIgPSBuZXcgS28sIHRoaXMuVXIgPSB7fSwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsLCB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGw7XG4gICAgfVxuICAgIGFkZFBlbmRpbmdNdXRhdGlvbih0KSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICB1cGRhdGVNdXRhdGlvblN0YXRlKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIGFkZExvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Mci5lcih0KSwgdGhpcy5Vclt0XSB8fCBcIm5vdC1jdXJyZW50XCI7XG4gICAgfVxuICAgIHVwZGF0ZVF1ZXJ5U3RhdGUodCwgZSwgbikge1xuICAgICAgICB0aGlzLlVyW3RdID0gZTtcbiAgICB9XG4gICAgcmVtb3ZlTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHRoaXMuTHIubnIodCk7XG4gICAgfVxuICAgIGlzTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkxyLmFjdGl2ZVRhcmdldElkcy5oYXModCk7XG4gICAgfVxuICAgIGNsZWFyUXVlcnlTdGF0ZSh0KSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLlVyW3RdO1xuICAgIH1cbiAgICBnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkxyLmFjdGl2ZVRhcmdldElkcztcbiAgICB9XG4gICAgaXNBY3RpdmVRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkxyLmFjdGl2ZVRhcmdldElkcy5oYXModCk7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5MciA9IG5ldyBLbywgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGhhbmRsZVVzZXJDaGFuZ2UodCwgZSwgbikge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgc2V0T25saW5lU3RhdGUodCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgc2h1dGRvd24oKSB7fVxuICAgIHdyaXRlU2VxdWVuY2VOdW1iZXIodCkge31cbiAgICBub3RpZnlCdW5kbGVMb2FkZWQodCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIGpvIHtcbiAgICBxcih0KSB7XG4gICAgICAgIC8vIE5vLW9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBCcm93c2VyQ29ubmVjdGl2aXR5TW9uaXRvci5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qKlxuICogQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBDb25uZWN0aXZpdHlNb25pdG9yLlxuICovXG5jbGFzcyBXbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuS3IgPSAoKSA9PiB0aGlzLkdyKCksIHRoaXMuUXIgPSAoKSA9PiB0aGlzLmpyKCksIHRoaXMuV3IgPSBbXSwgdGhpcy56cigpO1xuICAgIH1cbiAgICBxcih0KSB7XG4gICAgICAgIHRoaXMuV3IucHVzaCh0KTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuS3IpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5Rcik7XG4gICAgfVxuICAgIHpyKCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubGluZVwiLCB0aGlzLktyKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsIHRoaXMuUXIpO1xuICAgIH1cbiAgICBHcigpIHtcbiAgICAgICAgQyhcIkNvbm5lY3Rpdml0eU1vbml0b3JcIiwgXCJOZXR3b3JrIGNvbm5lY3Rpdml0eSBjaGFuZ2VkOiBBVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLldyKSB0KDAgLyogQVZBSUxBQkxFICovKTtcbiAgICB9XG4gICAganIoKSB7XG4gICAgICAgIEMoXCJDb25uZWN0aXZpdHlNb25pdG9yXCIsIFwiTmV0d29yayBjb25uZWN0aXZpdHkgY2hhbmdlZDogVU5BVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLldyKSB0KDEgLyogVU5BVkFJTEFCTEUgKi8pO1xuICAgIH1cbiAgICAvLyBUT0RPKGNoZW5icmlhbik6IENvbnNpZGVyIHBhc3NpbmcgaW4gd2luZG93IGVpdGhlciBpbnRvIHRoaXMgY29tcG9uZW50IG9yXG4gICAgLy8gaGVyZSBmb3IgdGVzdGluZyB2aWEgRmFrZVdpbmRvdy5cbiAgICAvKiogQ2hlY2tzIHRoYXQgYWxsIHVzZWQgYXR0cmlidXRlcyBvZiB3aW5kb3cgYXJlIGF2YWlsYWJsZS4gKi9cbiAgICBzdGF0aWMgQygpIHtcbiAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB2b2lkIDAgIT09IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICYmIHZvaWQgMCAhPT0gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCB6byA9IHtcbiAgICBCYXRjaEdldERvY3VtZW50czogXCJiYXRjaEdldFwiLFxuICAgIENvbW1pdDogXCJjb21taXRcIixcbiAgICBSdW5RdWVyeTogXCJydW5RdWVyeVwiLFxuICAgIFJ1bkFnZ3JlZ2F0aW9uUXVlcnk6IFwicnVuQWdncmVnYXRpb25RdWVyeVwiXG59O1xuXG4vKipcbiAqIE1hcHMgUlBDIG5hbWVzIHRvIHRoZSBjb3JyZXNwb25kaW5nIFJFU1QgZW5kcG9pbnQgbmFtZS5cbiAqXG4gKiBXZSB1c2UgYXJyYXkgbm90YXRpb24gdG8gYXZvaWQgbWFuZ2xpbmcuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2ltcGxlIGhlbHBlciBjbGFzcyB0aGF0IGltcGxlbWVudHMgdGhlIFN0cmVhbSBpbnRlcmZhY2UgdG9cbiAqIGJyaWRnZSB0byBvdGhlciBpbXBsZW1lbnRhdGlvbnMgdGhhdCBhcmUgc3RyZWFtcyBidXQgZG8gbm90IGltcGxlbWVudCB0aGVcbiAqIGludGVyZmFjZS4gVGhlIHN0cmVhbSBjYWxsYmFja3MgYXJlIGludm9rZWQgd2l0aCB0aGUgY2FsbE9uLi4uIG1ldGhvZHMuXG4gKi9cbmNsYXNzIEhvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuSHIgPSB0LkhyLCB0aGlzLkpyID0gdC5KcjtcbiAgICB9XG4gICAgWXIodCkge1xuICAgICAgICB0aGlzLlhyID0gdDtcbiAgICB9XG4gICAgWnIodCkge1xuICAgICAgICB0aGlzLmVvID0gdDtcbiAgICB9XG4gICAgb25NZXNzYWdlKHQpIHtcbiAgICAgICAgdGhpcy5ubyA9IHQ7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLkpyKCk7XG4gICAgfVxuICAgIHNlbmQodCkge1xuICAgICAgICB0aGlzLkhyKHQpO1xuICAgIH1cbiAgICBzbygpIHtcbiAgICAgICAgdGhpcy5YcigpO1xuICAgIH1cbiAgICBpbyh0KSB7XG4gICAgICAgIHRoaXMuZW8odCk7XG4gICAgfVxuICAgIHJvKHQpIHtcbiAgICAgICAgdGhpcy5ubyh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEpvIGV4dGVuZHMgXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIGFsbCBSZXN0LWJhc2VkIGNvbm5lY3Rpb25zIHRvIHRoZSBiYWNrZW5kIChXZWJDaGFubmVsIGFuZFxuICogSFRUUCkuXG4gKi9cbmNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gdC5kYXRhYmFzZUlkO1xuICAgICAgICBjb25zdCBlID0gdC5zc2wgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgdGhpcy5vbyA9IGUgKyBcIjovL1wiICsgdC5ob3N0LCB0aGlzLnVvID0gXCJwcm9qZWN0cy9cIiArIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQgKyBcIi9kYXRhYmFzZXMvXCIgKyB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UgKyBcIi9kb2N1bWVudHNcIjtcbiAgICB9XG4gICAgZ2V0IGNvKCkge1xuICAgICAgICAvLyBCb3RoIGBpbnZva2VSUEMoKWAgYW5kIGBpbnZva2VTdHJlYW1pbmdSUEMoKWAgdXNlIHRoZWlyIGBwYXRoYCBhcmd1bWVudHMgdG8gZGV0ZXJtaW5lXG4gICAgICAgIC8vIHdoZXJlIHRvIHJ1biB0aGUgcXVlcnksIGFuZCBleHBlY3QgdGhlIGByZXF1ZXN0YCB0byBOT1Qgc3BlY2lmeSB0aGUgXCJwYXRoXCIuXG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgYW8odCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gdGhpcy5obyh0LCBlKTtcbiAgICAgICAgQyhcIlJlc3RDb25uZWN0aW9uXCIsIFwiU2VuZGluZzogXCIsIHIsIG4pO1xuICAgICAgICBjb25zdCBvID0ge307XG4gICAgICAgIHJldHVybiB0aGlzLmxvKG8sIHMsIGkpLCB0aGlzLmZvKHQsIHIsIG8sIG4pLnRoZW4oKHQgPT4gKEMoXCJSZXN0Q29ubmVjdGlvblwiLCBcIlJlY2VpdmVkOiBcIiwgdCksIFxuICAgICAgICB0KSksIChlID0+IHtcbiAgICAgICAgICAgIHRocm93IE4oXCJSZXN0Q29ubmVjdGlvblwiLCBgJHt0fSBmYWlsZWQgd2l0aCBlcnJvcjogYCwgZSwgXCJ1cmw6IFwiLCByLCBcInJlcXVlc3Q6XCIsIG4pLCBcbiAgICAgICAgICAgIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgX28odCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICAvLyBUaGUgUkVTVCBBUEkgYXV0b21hdGljYWxseSBhZ2dyZWdhdGVzIGFsbCBvZiB0aGUgc3RyZWFtZWQgcmVzdWx0cywgc28gd2VcbiAgICAgICAgLy8gY2FuIGp1c3QgdXNlIHRoZSBub3JtYWwgaW52b2tlKCkgbWV0aG9kLlxuICAgICAgICByZXR1cm4gdGhpcy5hbyh0LCBlLCBuLCBzLCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdCwgYWRkaW5nIGFueSBhdXRob3JpemF0aW9uIHRva2VuIGlmXG4gICAgICogcHJlc2VudCBhbmQgYW55IGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3QuXG4gICAgICovICAgIGxvKHQsIGUsIG4pIHtcbiAgICAgICAgdFtcIlgtR29vZy1BcGktQ2xpZW50XCJdID0gXCJnbC1qcy8gZmlyZS9cIiArIHYsIFxuICAgICAgICAvLyBDb250ZW50LVR5cGU6IHRleHQvcGxhaW4gd2lsbCBhdm9pZCBwcmVmbGlnaHQgcmVxdWVzdHMgd2hpY2ggbWlnaHRcbiAgICAgICAgLy8gbWVzcyB3aXRoIENPUlMgYW5kIHJlZGlyZWN0cyBieSBwcm94aWVzLiBJZiB3ZSBhZGQgY3VzdG9tIGhlYWRlcnNcbiAgICAgICAgLy8gd2Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB0aGlzIGNvZGUgdG8gcG90ZW50aWFsbHkgdXNlIHRoZSAkaHR0cE92ZXJ3cml0ZVxuICAgICAgICAvLyBwYXJhbWV0ZXIgc3VwcG9ydGVkIGJ5IEVTRiB0byBhdm9pZCB0cmlnZ2VyaW5nIHByZWZsaWdodCByZXF1ZXN0cy5cbiAgICAgICAgdFtcIkNvbnRlbnQtVHlwZVwiXSA9IFwidGV4dC9wbGFpblwiLCB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCAmJiAodFtcIlgtRmlyZWJhc2UtR01QSURcIl0gPSB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCksIFxuICAgICAgICBlICYmIGUuaGVhZGVycy5mb3JFYWNoKCgoZSwgbikgPT4gdFtuXSA9IGUpKSwgbiAmJiBuLmhlYWRlcnMuZm9yRWFjaCgoKGUsIG4pID0+IHRbbl0gPSBlKSk7XG4gICAgfVxuICAgIGhvKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHpvW3RdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5vb30vdjEvJHtlfToke259YDtcbiAgICB9XG59IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSB0LmZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gdC5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIFxuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBmbyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgWGhySW87XG4gICAgICAgICAgICBvLnNldFdpdGhDcmVkZW50aWFscyghMCksIG8ubGlzdGVuT25jZShFdmVudFR5cGUuQ09NUExFVEUsICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChvLmdldExhc3RFcnJvckNvZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRXJyb3JDb2RlLk5PX0VSUk9SOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG8uZ2V0UmVzcG9uc2VKc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBDKFwiQ29ubmVjdGlvblwiLCBcIlhIUiByZWNlaXZlZDpcIiwgSlNPTi5zdHJpbmdpZnkobikpLCBpKG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEVycm9yQ29kZS5USU1FT1VUOlxuICAgICAgICAgICAgICAgICAgICAgICAgQyhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIHRpbWVkIG91dCcpLCByKG5ldyBMKEIuREVBRExJTkVfRVhDRUVERUQsIFwiUmVxdWVzdCB0aW1lIG91dFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRXJyb3JDb2RlLkhUVFBfRVJST1I6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gby5nZXRTdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDKFwiQ29ubmVjdGlvblwiLCAnUlBDIFwiJyArIHQgKyAnXCIgZmFpbGVkIHdpdGggc3RhdHVzOicsIHMsIFwicmVzcG9uc2UgdGV4dDpcIiwgby5nZXRSZXNwb25zZVRleHQoKSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgcyA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IG8uZ2V0UmVzcG9uc2VKc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheSh0KSAmJiAodCA9IHRbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHQpIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gJiYgbi5zdGF0dXMgJiYgbi5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgXCItXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoQikuaW5kZXhPZihlKSA+PSAwID8gZSA6IEIuVU5LTk9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfShuLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIobmV3IEwodCwgbi5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIobmV3IEwoQi5VTktOT1dOLCBcIlNlcnZlciByZXNwb25kZWQgd2l0aCBzdGF0dXMgXCIgKyBvLmdldFN0YXR1cygpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlZCBhbiBIVFRQX0VSUk9SIGJ1dCB0aGVyZSdzIG5vIHN0YXR1cyBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBtb3N0IHByb2JhYmx5IGEgY29ubmVjdGlvbiBpc3N1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcihuZXcgTChCLlVOQVZBSUxBQkxFLCBcIkNvbm5lY3Rpb24gZmFpbGVkLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBPKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBDKFwiQ29ubmVjdGlvblwiLCAnUlBDIFwiJyArIHQgKyAnXCIgY29tcGxldGVkLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBKU09OLnN0cmluZ2lmeShzKTtcbiAgICAgICAgICAgIG8uc2VuZChlLCBcIlBPU1RcIiwgdSwgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHdvKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFsgdGhpcy5vbywgXCIvXCIsIFwiZ29vZ2xlLmZpcmVzdG9yZS52MS5GaXJlc3RvcmVcIiwgXCIvXCIsIHQsIFwiL2NoYW5uZWxcIiBdLCBpID0gY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCgpLCByID0gZ2V0U3RhdEV2ZW50VGFyZ2V0KCksIG8gPSB7XG4gICAgICAgICAgICAvLyBSZXF1aXJlZCBmb3IgYmFja2VuZCBzdGlja2luZXNzLCByb3V0aW5nIGJlaGF2aW9yIGlzIGJhc2VkIG9uIHRoaXNcbiAgICAgICAgICAgIC8vIHBhcmFtZXRlci5cbiAgICAgICAgICAgIGh0dHBTZXNzaW9uSWRQYXJhbTogXCJnc2Vzc2lvbmlkXCIsXG4gICAgICAgICAgICBpbml0TWVzc2FnZUhlYWRlcnM6IHt9LFxuICAgICAgICAgICAgbWVzc2FnZVVybFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW0gaXMgdXNlZCB0byBpbXByb3ZlIHJvdXRpbmcgYW5kIHByb2plY3QgaXNvbGF0aW9uIGJ5IHRoZVxuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgYW5kIG11c3QgYmUgaW5jbHVkZWQgaW4gZXZlcnkgcmVxdWVzdC5cbiAgICAgICAgICAgICAgICBkYXRhYmFzZTogYHByb2plY3RzLyR7dGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZH0vZGF0YWJhc2VzLyR7dGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlfWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZW5kUmF3SnNvbjogITAsXG4gICAgICAgICAgICBzdXBwb3J0c0Nyb3NzRG9tYWluWGhyOiAhMCxcbiAgICAgICAgICAgIGludGVybmFsQ2hhbm5lbFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIE92ZXJyaWRlIHRoZSBkZWZhdWx0IHRpbWVvdXQgKHJhbmRvbWl6ZWQgYmV0d2VlbiAxMC0yMCBzZWNvbmRzKSBzaW5jZVxuICAgICAgICAgICAgICAgIC8vIGEgbGFyZ2Ugd3JpdGUgYmF0Y2ggb24gYSBzbG93IGludGVybmV0IGNvbm5lY3Rpb24gbWF5IHRha2UgYSBsb25nXG4gICAgICAgICAgICAgICAgLy8gdGltZSB0byBzZW5kIHRvIHRoZSBiYWNrZW5kLiBSYXRoZXIgdGhhbiBoYXZlIFdlYkNoYW5uZWwgaW1wb3NlIGFcbiAgICAgICAgICAgICAgICAvLyB0aWdodCB0aW1lb3V0IHdoaWNoIGNvdWxkIGxlYWQgdG8gaW5maW5pdGUgdGltZW91dHMgYW5kIHJldHJpZXMsIHdlXG4gICAgICAgICAgICAgICAgLy8gc2V0IGl0IHZlcnkgbGFyZ2UgKDUtMTAgbWludXRlcykgYW5kIHJlbHkgb24gdGhlIGJyb3dzZXIncyBidWlsdGluXG4gICAgICAgICAgICAgICAgLy8gdGltZW91dHMgdG8ga2ljayBpbiBpZiB0aGUgcmVxdWVzdCBpc24ndCB3b3JraW5nLlxuICAgICAgICAgICAgICAgIGZvcndhcmRDaGFubmVsUmVxdWVzdFRpbWVvdXRNczogNmU1XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZm9yY2VMb25nUG9sbGluZzogdGhpcy5mb3JjZUxvbmdQb2xsaW5nLFxuICAgICAgICAgICAgZGV0ZWN0QnVmZmVyaW5nUHJveHk6IHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudXNlRmV0Y2hTdHJlYW1zICYmIChvLnhtbEh0dHBGYWN0b3J5ID0gbmV3IEZldGNoWG1sSHR0cEZhY3Rvcnkoe30pKSwgdGhpcy5sbyhvLmluaXRNZXNzYWdlSGVhZGVycywgZSwgbiksIFxuICAgICAgICAvLyBTZW5kaW5nIHRoZSBjdXN0b20gaGVhZGVycyB3ZSBqdXN0IGFkZGVkIHRvIHJlcXVlc3QuaW5pdE1lc3NhZ2VIZWFkZXJzXG4gICAgICAgIC8vIChBdXRob3JpemF0aW9uLCBldGMuKSB3aWxsIHRyaWdnZXIgdGhlIGJyb3dzZXIgdG8gbWFrZSBhIENPUlMgcHJlZmxpZ2h0XG4gICAgICAgIC8vIHJlcXVlc3QgYmVjYXVzZSB0aGUgWEhSIHdpbGwgbm8gbG9uZ2VyIG1lZXQgdGhlIGNyaXRlcmlhIGZvciBhIFwic2ltcGxlXCJcbiAgICAgICAgLy8gQ09SUyByZXF1ZXN0OlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVFRQL0NPUlMjU2ltcGxlX3JlcXVlc3RzXG4gICAgICAgIC8vIFRoZXJlZm9yZSB0byBhdm9pZCB0aGUgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdCAoYW4gZXh0cmEgbmV0d29ya1xuICAgICAgICAvLyByb3VuZHRyaXApLCB3ZSB1c2UgdGhlIGVuY29kZUluaXRNZXNzYWdlSGVhZGVycyBvcHRpb24gdG8gc3BlY2lmeSB0aGF0XG4gICAgICAgIC8vIHRoZSBoZWFkZXJzIHNob3VsZCBpbnN0ZWFkIGJlIGVuY29kZWQgaW4gdGhlIHJlcXVlc3QncyBQT1NUIHBheWxvYWQsXG4gICAgICAgIC8vIHdoaWNoIGlzIHJlY29nbml6ZWQgYnkgdGhlIHdlYmNoYW5uZWwgYmFja2VuZC5cbiAgICAgICAgby5lbmNvZGVJbml0TWVzc2FnZUhlYWRlcnMgPSAhMDtcbiAgICAgICAgY29uc3QgdSA9IHMuam9pbihcIlwiKTtcbiAgICAgICAgQyhcIkNvbm5lY3Rpb25cIiwgXCJDcmVhdGluZyBXZWJDaGFubmVsOiBcIiArIHUsIG8pO1xuICAgICAgICBjb25zdCBjID0gaS5jcmVhdGVXZWJDaGFubmVsKHUsIG8pO1xuICAgICAgICAvLyBXZWJDaGFubmVsIHN1cHBvcnRzIHNlbmRpbmcgdGhlIGZpcnN0IG1lc3NhZ2Ugd2l0aCB0aGUgaGFuZHNoYWtlIC0gc2F2aW5nXG4gICAgICAgIC8vIGEgbmV0d29yayByb3VuZCB0cmlwLiBIb3dldmVyLCBpdCB3aWxsIGhhdmUgdG8gY2FsbCBzZW5kIGluIHRoZSBzYW1lXG4gICAgICAgIC8vIEpTIGV2ZW50IGxvb3AgYXMgb3Blbi4gSW4gb3JkZXIgdG8gZW5mb3JjZSB0aGlzLCB3ZSBkZWxheSBhY3R1YWxseVxuICAgICAgICAvLyBvcGVuaW5nIHRoZSBXZWJDaGFubmVsIHVudGlsIHNlbmQgaXMgY2FsbGVkLiBXaGV0aGVyIHdlIGhhdmUgY2FsbGVkXG4gICAgICAgIC8vIG9wZW4gaXMgdHJhY2tlZCB3aXRoIHRoaXMgdmFyaWFibGUuXG4gICAgICAgICAgICAgICAgbGV0IGEgPSAhMSwgaCA9ICExO1xuICAgICAgICAvLyBBIGZsYWcgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHN0cmVhbSB3YXMgY2xvc2VkIChieSB1cyBvciB0aHJvdWdoIGFuXG4gICAgICAgIC8vIGVycm9yL2Nsb3NlIGV2ZW50KSB0byBhdm9pZCBkZWxpdmVyaW5nIG11bHRpcGxlIGNsb3NlIGV2ZW50cyBvciBzZW5kaW5nXG4gICAgICAgIC8vIG9uIGEgY2xvc2VkIHN0cmVhbVxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBuZXcgSG8oe1xuICAgICAgICAgICAgSHI6IHQgPT4ge1xuICAgICAgICAgICAgICAgIGggPyBDKFwiQ29ubmVjdGlvblwiLCBcIk5vdCBzZW5kaW5nIGJlY2F1c2UgV2ViQ2hhbm5lbCBpcyBjbG9zZWQ6XCIsIHQpIDogKGEgfHwgKEMoXCJDb25uZWN0aW9uXCIsIFwiT3BlbmluZyBXZWJDaGFubmVsIHRyYW5zcG9ydC5cIiksIFxuICAgICAgICAgICAgICAgIGMub3BlbigpLCBhID0gITApLCBDKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgc2VuZGluZzpcIiwgdCksIGMuc2VuZCh0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgSnI6ICgpID0+IGMuY2xvc2UoKVxuICAgICAgICB9KSwgZiA9ICh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IGNsb3N1cmUgdHlwaW5nIHNlZW1zIGJyb2tlbiBiZWNhdXNlIFdlYkNoYW5uZWwgZG9lc1xuICAgICAgICAgICAgLy8gbm90IGltcGxlbWVudCBnb29nLmV2ZW50cy5MaXN0ZW5hYmxlXG4gICAgICAgICAgICB0Lmxpc3RlbihlLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbih0KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgICAgICAgICAgICAgIH0pLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIC8vIENsb3N1cmUgZXZlbnRzIGFyZSBndWFyZGVkIGFuZCBleGNlcHRpb25zIGFyZSBzd2FsbG93ZWQsIHNvIGNhdGNoIGFueVxuICAgICAgICAvLyBleGNlcHRpb24gYW5kIHJldGhyb3cgdXNpbmcgYSBzZXRUaW1lb3V0IHNvIHRoZXkgYmVjb21lIHZpc2libGUgYWdhaW4uXG4gICAgICAgIC8vIE5vdGUgdGhhdCBldmVudHVhbGx5IHRoaXMgZnVuY3Rpb24gY291bGQgZ28gYXdheSBpZiB3ZSBhcmUgY29uZmlkZW50XG4gICAgICAgIC8vIGVub3VnaCB0aGUgY29kZSBpcyBleGNlcHRpb24gZnJlZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gZihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5PUEVOLCAoKCkgPT4ge1xuICAgICAgICAgICAgaCB8fCBDKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IG9wZW5lZC5cIik7XG4gICAgICAgIH0pKSwgZihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5DTE9TRSwgKCgpID0+IHtcbiAgICAgICAgICAgIGggfHwgKGggPSAhMCwgQyhcIkNvbm5lY3Rpb25cIiwgXCJXZWJDaGFubmVsIHRyYW5zcG9ydCBjbG9zZWRcIiksIGwuaW8oKSk7XG4gICAgICAgIH0pKSwgZihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5FUlJPUiwgKHQgPT4ge1xuICAgICAgICAgICAgaCB8fCAoaCA9ICEwLCBOKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IGVycm9yZWQ6XCIsIHQpLCBsLmlvKG5ldyBMKEIuVU5BVkFJTEFCTEUsIFwiVGhlIG9wZXJhdGlvbiBjb3VsZCBub3QgYmUgY29tcGxldGVkXCIpKSk7XG4gICAgICAgIH0pKSwgZihjLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5NRVNTQUdFLCAodCA9PiB7XG4gICAgICAgICAgICB2YXIgZTtcbiAgICAgICAgICAgIGlmICghaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmRhdGFbMF07XG4gICAgICAgICAgICAgICAgTSghIW4pO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8zNTE0Mzg5MSk6IFRoZXJlIGlzIGEgYnVnIGluIE9uZSBQbGF0Zm9ybSB0aGF0IGNhdXNlZCBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyAoYW5kIG9ubHkgZXJyb3JzKSB0byBiZSB3cmFwcGVkIGluIGFuIGV4dHJhIGFycmF5LiBUbyBiZSBmb3J3YXJkXG4gICAgICAgICAgICAgICAgLy8gY29tcGF0aWJsZSB3aXRoIHRoZSBidWcgd2UgbmVlZCB0byBjaGVjayBlaXRoZXIgY29uZGl0aW9uLiBUaGUgbGF0dGVyXG4gICAgICAgICAgICAgICAgLy8gY2FuIGJlIHJlbW92ZWQgb25jZSB0aGUgZml4IGhhcyBiZWVuIHJvbGxlZCBvdXQuXG4gICAgICAgICAgICAgICAgLy8gVXNlIGFueSBiZWNhdXNlIG1zZ0RhdGEuZXJyb3IgaXMgbm90IHR5cGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLCBpID0gcy5lcnJvciB8fCAobnVsbCA9PT0gKGUgPSBzWzBdKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmVycm9yKTtcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgICAgICBDKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgcmVjZWl2ZWQgZXJyb3I6XCIsIGkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvci5zdGF0dXMgd2lsbCBiZSBhIHN0cmluZyBsaWtlICdPSycgb3IgJ05PVF9GT1VORCcuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSBcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBhIEdSUEMgc3RhdHVzIGlkZW50aWZpZXIgbGlrZSAnTk9UX0ZPVU5EJy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBzdGF0dXMgc3RyaW5nIG9yIHVuZGVmaW5lZCBpZlxuICogICAgIHRoZXJlIGlzIG5vIG1hdGNoLlxuICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvb2t1cCBieSBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gWW5bdF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSBlKSByZXR1cm4gdHMoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0odCksIG4gPSBpLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IEIuSU5URVJOQUwsIG4gPSBcIlVua25vd24gZXJyb3Igc3RhdHVzOiBcIiArIHQgKyBcIiB3aXRoIG1lc3NhZ2UgXCIgKyBpLm1lc3NhZ2UpLCBcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBjbG9zZWQgc28gbm8gZnVydGhlciBldmVudHMgYXJlIHByb3BhZ2F0ZWRcbiAgICAgICAgICAgICAgICAgICAgaCA9ICEwLCBsLmlvKG5ldyBMKGUsIG4pKSwgYy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBDKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgcmVjZWl2ZWQ6XCIsIG4pLCBsLnJvKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIGYociwgRXZlbnQuU1RBVF9FVkVOVCwgKHQgPT4ge1xuICAgICAgICAgICAgdC5zdGF0ID09PSBTdGF0LlBST1hZID8gQyhcIkNvbm5lY3Rpb25cIiwgXCJEZXRlY3RlZCBidWZmZXJpbmcgcHJveHlcIikgOiB0LnN0YXQgPT09IFN0YXQuTk9QUk9YWSAmJiBDKFwiQ29ubmVjdGlvblwiLCBcIkRldGVjdGVkIG5vIGJ1ZmZlcmluZyBwcm94eVwiKTtcbiAgICAgICAgfSkpLCBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBUZWNobmljYWxseSB3ZSBjb3VsZC9zaG91bGQgd2FpdCBmb3IgdGhlIFdlYkNoYW5uZWwgb3BlbmVkIGV2ZW50LFxuICAgICAgICAgICAgLy8gYnV0IGJlY2F1c2Ugd2Ugd2FudCB0byBzZW5kIHRoZSBmaXJzdCBtZXNzYWdlIHdpdGggdGhlIFdlYkNoYW5uZWxcbiAgICAgICAgICAgIC8vIGhhbmRzaGFrZSB3ZSBwcmV0ZW5kIHRoZSBjaGFubmVsIG9wZW5lZCBoZXJlIChhc3luY2hyb25vdXNseSksIGFuZFxuICAgICAgICAgICAgLy8gdGhlbiBkZWxheSB0aGUgYWN0dWFsIG9wZW4gdW50aWwgdGhlIGZpcnN0IG1lc3NhZ2UgaXMgc2VudC5cbiAgICAgICAgICAgIGwuc28oKTtcbiAgICAgICAgfSksIDApLCBsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBJbml0aWFsaXplcyB0aGUgV2ViQ2hhbm5lbENvbm5lY3Rpb24gZm9yIHRoZSBicm93c2VyLiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBUaGUgUGxhdGZvcm0ncyAnd2luZG93JyBpbXBsZW1lbnRhdGlvbiBvciBudWxsIGlmIG5vdCBhdmFpbGFibGUuICovXG5mdW5jdGlvbiBZbygpIHtcbiAgICAvLyBgd2luZG93YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IG51bGw7XG59XG5cbi8qKiBUaGUgUGxhdGZvcm0ncyAnZG9jdW1lbnQnIGltcGxlbWVudGF0aW9uIG9yIG51bGwgaWYgbm90IGF2YWlsYWJsZS4gKi8gZnVuY3Rpb24gWG8oKSB7XG4gICAgLy8gYGRvY3VtZW50YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGRvY3VtZW50ID8gZG9jdW1lbnQgOiBudWxsO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBabyh0KSB7XG4gICAgcmV0dXJuIG5ldyBQcyh0LCAvKiB1c2VQcm90bzNKc29uPSAqLyAhMCk7XG59XG5cbi8qKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhlIFBsYXRmb3JtJ3MgJ1RleHRFbmNvZGVyJyBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuLyoqXG4gKiBBIGhlbHBlciBmb3IgcnVubmluZyBkZWxheWVkIHRhc2tzIGZvbGxvd2luZyBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIGN1cnZlXG4gKiBiZXR3ZWVuIGF0dGVtcHRzLlxuICpcbiAqIEVhY2ggZGVsYXkgaXMgbWFkZSB1cCBvZiBhIFwiYmFzZVwiIGRlbGF5IHdoaWNoIGZvbGxvd3MgdGhlIGV4cG9uZW50aWFsXG4gKiBiYWNrb2ZmIGN1cnZlLCBhbmQgYSArLy0gNTAlIFwiaml0dGVyXCIgdGhhdCBpcyBjYWxjdWxhdGVkIGFuZCBhZGRlZCB0byB0aGVcbiAqIGJhc2UgZGVsYXkuIFRoaXMgcHJldmVudHMgY2xpZW50cyBmcm9tIGFjY2lkZW50YWxseSBzeW5jaHJvbml6aW5nIHRoZWlyXG4gKiBkZWxheXMgY2F1c2luZyBzcGlrZXMgb2YgbG9hZCB0byB0aGUgYmFja2VuZC5cbiAqL1xuY2xhc3MgdHUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBBc3luY1F1ZXVlIHRvIHJ1biBiYWNrb2ZmIG9wZXJhdGlvbnMgb24uXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIElEIHRvIHVzZSB3aGVuIHNjaGVkdWxpbmcgYmFja29mZiBvcGVyYXRpb25zIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBpbml0aWFsIGRlbGF5ICh1c2VkIGFzIHRoZSBiYXNlIGRlbGF5IG9uIHRoZSBmaXJzdCByZXRyeSBhdHRlbXB0KS5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIGxpdHRsZSBhcyAwLjUqaW5pdGlhbERlbGF5TXMuXG4gICAgICovXG4gICAgbiA9IDFlM1xuICAgIC8qKlxuICAgICAqIFRoZSBtdWx0aXBsaWVyIHRvIHVzZSB0byBkZXRlcm1pbmUgdGhlIGV4dGVuZGVkIGJhc2UgZGVsYXkgYWZ0ZXIgZWFjaFxuICAgICAqIGF0dGVtcHQuXG4gICAgICovICwgcyA9IDEuNVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIGJhc2UgZGVsYXkgYWZ0ZXIgd2hpY2ggbm8gZnVydGhlciBiYWNrb2ZmIGlzIHBlcmZvcm1lZC5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIG11Y2ggYXMgMS41Km1heERlbGF5TXMuXG4gICAgICovICwgaSA9IDZlNCkge1xuICAgICAgICB0aGlzLkhzID0gdCwgdGhpcy50aW1lcklkID0gZSwgdGhpcy5tbyA9IG4sIHRoaXMueW8gPSBzLCB0aGlzLnBvID0gaSwgdGhpcy5JbyA9IDAsIFxuICAgICAgICB0aGlzLlRvID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCBiYWNrb2ZmIGF0dGVtcHQsIGFzIGVwb2NoIG1pbGxpc2Vjb25kcy4gKi9cbiAgICAgICAgdGhpcy5FbyA9IERhdGUubm93KCksIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5LlxuICAgICAqXG4gICAgICogVGhlIHZlcnkgbmV4dCBiYWNrb2ZmQW5kV2FpdCgpIHdpbGwgaGF2ZSBubyBkZWxheS4gSWYgaXQgaXMgY2FsbGVkIGFnYWluXG4gICAgICogKGkuZS4gZHVlIHRvIGFuIGVycm9yKSwgaW5pdGlhbERlbGF5TXMgKHBsdXMgaml0dGVyKSB3aWxsIGJlIHVzZWQsIGFuZFxuICAgICAqIHN1YnNlcXVlbnQgb25lcyB3aWxsIGluY3JlYXNlIGFjY29yZGluZyB0byB0aGUgYmFja29mZkZhY3Rvci5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuSW8gPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkgdG8gdGhlIG1heGltdW0gZGVsYXkgKGUuZy4gZm9yIHVzZSBhZnRlciBhXG4gICAgICogUkVTT1VSQ0VfRVhIQVVTVEVEIGVycm9yKS5cbiAgICAgKi8gICAgQW8oKSB7XG4gICAgICAgIHRoaXMuSW8gPSB0aGlzLnBvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGN1cnJlbnREZWxheU1zLCBhbmQgaW5jcmVhc2VzIHRoZVxuICAgICAqIGRlbGF5IGZvciBhbnkgc3Vic2VxdWVudCBhdHRlbXB0cy4gSWYgdGhlcmUgd2FzIGEgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvblxuICAgICAqIGFscmVhZHksIGl0IHdpbGwgYmUgY2FuY2VsZWQuXG4gICAgICovICAgIFJvKHQpIHtcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uLlxuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICAvLyBGaXJzdCBzY2hlZHVsZSB1c2luZyB0aGUgY3VycmVudCBiYXNlICh3aGljaCBtYXkgYmUgMCBhbmQgc2hvdWxkIGJlXG4gICAgICAgIC8vIGhvbm9yZWQgYXMgc3VjaCkuXG4gICAgICAgIGNvbnN0IGUgPSBNYXRoLmZsb29yKHRoaXMuSW8gKyB0aGlzLmJvKCkpLCBuID0gTWF0aC5tYXgoMCwgRGF0ZS5ub3coKSAtIHRoaXMuRW8pLCBzID0gTWF0aC5tYXgoMCwgZSAtIG4pO1xuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IGxhc3RBdHRlbXB0VGltZSBiZWluZyBpbiB0aGUgZnV0dXJlIGR1ZSB0byBhIGNsb2NrIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBzID4gMCAmJiBDKFwiRXhwb25lbnRpYWxCYWNrb2ZmXCIsIGBCYWNraW5nIG9mZiBmb3IgJHtzfSBtcyAoYmFzZSBkZWxheTogJHt0aGlzLklvfSBtcywgZGVsYXkgd2l0aCBqaXR0ZXI6ICR7ZX0gbXMsIGxhc3QgYXR0ZW1wdDogJHtufSBtcyBhZ28pYCksIFxuICAgICAgICB0aGlzLlRvID0gdGhpcy5Icy5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLnRpbWVySWQsIHMsICgoKSA9PiAodGhpcy5FbyA9IERhdGUubm93KCksIFxuICAgICAgICB0KCkpKSksIFxuICAgICAgICAvLyBBcHBseSBiYWNrb2ZmIGZhY3RvciB0byBkZXRlcm1pbmUgbmV4dCBkZWxheSBhbmQgZW5zdXJlIGl0IGlzIHdpdGhpblxuICAgICAgICAvLyBib3VuZHMuXG4gICAgICAgIHRoaXMuSW8gKj0gdGhpcy55bywgdGhpcy5JbyA8IHRoaXMubW8gJiYgKHRoaXMuSW8gPSB0aGlzLm1vKSwgdGhpcy5JbyA+IHRoaXMucG8gJiYgKHRoaXMuSW8gPSB0aGlzLnBvKTtcbiAgICB9XG4gICAgUG8oKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuVG8gJiYgKHRoaXMuVG8uc2tpcERlbGF5KCksIHRoaXMuVG8gPSBudWxsKTtcbiAgICB9XG4gICAgY2FuY2VsKCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLlRvICYmICh0aGlzLlRvLmNhbmNlbCgpLCB0aGlzLlRvID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgcmFuZG9tIHZhbHVlIGluIHRoZSByYW5nZSBbLWN1cnJlbnRCYXNlTXMvMiwgY3VycmVudEJhc2VNcy8yXSAqLyAgICBibygpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJhbmRvbSgpIC0gLjUpICogdGhpcy5JbztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBpcyBhbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIHN0cmVhbWluZyBSUENcbiAqIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZC4gSXQncyBidWlsdCBvbiB0b3Agb2YgdGhlIGNvbm5lY3Rpb25zIG93biBzdXBwb3J0XG4gKiBmb3Igc3RyZWFtaW5nIFJQQ3MsIGFuZCBhZGRzIHNldmVyYWwgY3JpdGljYWwgZmVhdHVyZXMgZm9yIG91ciBjbGllbnRzOlxuICpcbiAqICAgLSBFeHBvbmVudGlhbCBiYWNrb2ZmIG9uIGZhaWx1cmVcbiAqICAgLSBBdXRoZW50aWNhdGlvbiB2aWEgQ3JlZGVudGlhbHNQcm92aWRlclxuICogICAtIERpc3BhdGNoaW5nIGFsbCBjYWxsYmFja3MgaW50byB0aGUgc2hhcmVkIHdvcmtlciBxdWV1ZVxuICogICAtIENsb3NpbmcgaWRsZSBzdHJlYW1zIGFmdGVyIDYwIHNlY29uZHMgb2YgaW5hY3Rpdml0eVxuICpcbiAqIFN1YmNsYXNzZXMgb2YgUGVyc2lzdGVudFN0cmVhbSBpbXBsZW1lbnQgc2VyaWFsaXphdGlvbiBvZiBtb2RlbHMgdG8gYW5kXG4gKiBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm90b2NvbCBidWZmZXJzIGZvciBhIHNwZWNpZmljXG4gKiBzdHJlYW1pbmcgUlBDLlxuICpcbiAqICMjIFN0YXJ0aW5nIGFuZCBTdG9wcGluZ1xuICpcbiAqIFN0cmVhbWluZyBSUENzIGFyZSBzdGF0ZWZ1bCBhbmQgbmVlZCB0byBiZSBzdGFydCgpZWQgYmVmb3JlIG1lc3NhZ2VzIGNhblxuICogYmUgc2VudCBhbmQgcmVjZWl2ZWQuIFRoZSBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgb25PcGVuKCkgZnVuY3Rpb25cbiAqIG9mIHRoZSBsaXN0ZW5lciBvbmNlIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IHJlcXVlc3RzLlxuICpcbiAqIFNob3VsZCBhIHN0YXJ0KCkgZmFpbCwgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIHJlZ2lzdGVyZWQgb25DbG9zZSgpXG4gKiBsaXN0ZW5lciB3aXRoIGEgRmlyZXN0b3JlRXJyb3IgaW5kaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcuXG4gKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBzdGFydGVkIGFuZCBzdG9wcGVkIHJlcGVhdGVkbHkuXG4gKlxuICogR2VuZXJpYyB0eXBlczpcbiAqICBTZW5kVHlwZTogVGhlIHR5cGUgb2YgdGhlIG91dGdvaW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXG4gKiAgUmVjZWl2ZVR5cGU6IFRoZSB0eXBlIG9mIHRoZSBpbmNvbWluZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIExpc3RlbmVyVHlwZTogVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBjYWxsYmFja3NcbiAqL1xuY2xhc3MgZXUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpIHtcbiAgICAgICAgdGhpcy5IcyA9IHQsIHRoaXMudm8gPSBuLCB0aGlzLlZvID0gcywgdGhpcy5jb25uZWN0aW9uID0gaSwgdGhpcy5hdXRoQ3JlZGVudGlhbHNQcm92aWRlciA9IHIsIFxuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlciA9IG8sIHRoaXMubGlzdGVuZXIgPSB1LCB0aGlzLnN0YXRlID0gMCAvKiBJbml0aWFsICovICwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGNsb3NlIGNvdW50IHRoYXQncyBpbmNyZW1lbnRlZCBldmVyeSB0aW1lIHRoZSBzdHJlYW0gaXMgY2xvc2VkOyB1c2VkIGJ5XG4gICAgICAgICAqIGdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIoKSB0byBpbnZhbGlkYXRlIGNhbGxiYWNrcyB0aGF0IGhhcHBlbiBhZnRlclxuICAgICAgICAgKiBjbG9zZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuU28gPSAwLCB0aGlzLkRvID0gbnVsbCwgdGhpcy5DbyA9IG51bGwsIHRoaXMuc3RyZWFtID0gbnVsbCwgdGhpcy54byA9IG5ldyB0dSh0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHN0YXJ0KCkgaGFzIGJlZW4gY2FsbGVkIGFuZCBubyBlcnJvciBoYXMgb2NjdXJyZWQuIFRydWVcbiAgICAgKiBpbmRpY2F0ZXMgdGhlIHN0cmVhbSBpcyBvcGVuIG9yIGluIHRoZSBwcm9jZXNzIG9mIG9wZW5pbmcgKHdoaWNoXG4gICAgICogZW5jb21wYXNzZXMgcmVzcGVjdGluZyBiYWNrb2ZmLCBnZXR0aW5nIGF1dGggdG9rZW5zLCBhbmQgc3RhcnRpbmcgdGhlXG4gICAgICogYWN0dWFsIFJQQykuIFVzZSBpc09wZW4oKSB0byBkZXRlcm1pbmUgaWYgdGhlIHN0cmVhbSBpcyBvcGVuIGFuZCByZWFkeSBmb3JcbiAgICAgKiBvdXRib3VuZCByZXF1ZXN0cy5cbiAgICAgKi8gICAgTm8oKSB7XG4gICAgICAgIHJldHVybiAxIC8qIFN0YXJ0aW5nICovID09PSB0aGlzLnN0YXRlIHx8IDUgLyogQmFja29mZiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCB0aGlzLmtvKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdW5kZXJseWluZyBSUEMgaXMgb3BlbiAodGhlIG9uT3BlbigpIGxpc3RlbmVyIGhhcyBiZWVuXG4gICAgICogY2FsbGVkKSBhbmQgdGhlIHN0cmVhbSBpcyByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIGtvKCkge1xuICAgICAgICByZXR1cm4gMiAvKiBPcGVuICovID09PSB0aGlzLnN0YXRlIHx8IDMgLyogSGVhbHRoeSAqLyA9PT0gdGhpcy5zdGF0ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIHRoZSBSUEMuIE9ubHkgYWxsb3dlZCBpZiBpc1N0YXJ0ZWQoKSByZXR1cm5zIGZhbHNlLiBUaGUgc3RyZWFtIGlzXG4gICAgICogbm90IGltbWVkaWF0ZWx5IHJlYWR5IGZvciB1c2U6IG9uT3BlbigpIHdpbGwgYmUgaW52b2tlZCB3aGVuIHRoZSBSUEMgaXNcbiAgICAgKiByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMsIGF0IHdoaWNoIHBvaW50IGlzT3BlbigpIHdpbGwgcmV0dXJuIHRydWUuXG4gICAgICpcbiAgICAgKiBXaGVuIHN0YXJ0IHJldHVybnMsIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIHRydWUuXG4gICAgICovICAgIHN0YXJ0KCkge1xuICAgICAgICA0IC8qIEVycm9yICovICE9PSB0aGlzLnN0YXRlID8gdGhpcy5hdXRoKCkgOiB0aGlzLk9vKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIHRoZSBSUEMuIFRoaXMgY2FsbCBpcyBpZGVtcG90ZW50IGFuZCBhbGxvd2VkIHJlZ2FyZGxlc3Mgb2YgdGhlXG4gICAgICogY3VycmVudCBpc1N0YXJ0ZWQoKSBzdGF0ZS5cbiAgICAgKlxuICAgICAqIFdoZW4gc3RvcCByZXR1cm5zLCBpc1N0YXJ0ZWQoKSBhbmQgaXNPcGVuKCkgd2lsbCBib3RoIHJldHVybiBmYWxzZS5cbiAgICAgKi8gICAgYXN5bmMgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5ObygpICYmIGF3YWl0IHRoaXMuY2xvc2UoMCAvKiBJbml0aWFsICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWZ0ZXIgYW4gZXJyb3IgdGhlIHN0cmVhbSB3aWxsIHVzdWFsbHkgYmFjayBvZmYgb24gdGhlIG5leHQgYXR0ZW1wdCB0b1xuICAgICAqIHN0YXJ0IGl0LiBJZiB0aGUgZXJyb3Igd2FycmFudHMgYW4gaW1tZWRpYXRlIHJlc3RhcnQgb2YgdGhlIHN0cmVhbSwgdGhlXG4gICAgICogc2VuZGVyIGNhbiB1c2UgdGhpcyB0byBpbmRpY2F0ZSB0aGF0IHRoZSByZWNlaXZlciBzaG91bGQgbm90IGJhY2sgb2ZmLlxuICAgICAqXG4gICAgICogRWFjaCBlcnJvciB3aWxsIGNhbGwgdGhlIG9uQ2xvc2UoKSBsaXN0ZW5lci4gVGhhdCBmdW5jdGlvbiBjYW4gZGVjaWRlIHRvXG4gICAgICogaW5oaWJpdCBiYWNrb2ZmIGlmIHJlcXVpcmVkLlxuICAgICAqLyAgICBNbygpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDAgLyogSW5pdGlhbCAqLyAsIHRoaXMueG8ucmVzZXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWFya3MgdGhpcyBzdHJlYW0gYXMgaWRsZS4gSWYgbm8gZnVydGhlciBhY3Rpb25zIGFyZSBwZXJmb3JtZWQgb24gdGhlXG4gICAgICogc3RyZWFtIGZvciBvbmUgbWludXRlLCB0aGUgc3RyZWFtIHdpbGwgYXV0b21hdGljYWxseSBjbG9zZSBpdHNlbGYgYW5kXG4gICAgICogbm90aWZ5IHRoZSBzdHJlYW0ncyBvbkNsb3NlKCkgaGFuZGxlciB3aXRoIFN0YXR1cy5PSy4gVGhlIHN0cmVhbSB3aWxsIHRoZW5cbiAgICAgKiBiZSBpbiBhICFpc1N0YXJ0ZWQoKSBzdGF0ZSwgcmVxdWlyaW5nIHRoZSBjYWxsZXIgdG8gc3RhcnQgdGhlIHN0cmVhbSBhZ2FpblxuICAgICAqIGJlZm9yZSBmdXJ0aGVyIHVzZS5cbiAgICAgKlxuICAgICAqIE9ubHkgc3RyZWFtcyB0aGF0IGFyZSBpbiBzdGF0ZSAnT3BlbicgY2FuIGJlIG1hcmtlZCBpZGxlLCBhcyBhbGwgb3RoZXJcbiAgICAgKiBzdGF0ZXMgaW1wbHkgcGVuZGluZyBuZXR3b3JrIG9wZXJhdGlvbnMuXG4gICAgICovICAgIEZvKCkge1xuICAgICAgICAvLyBTdGFydHMgdGhlIGlkbGUgdGltZSBpZiB3ZSBhcmUgaW4gc3RhdGUgJ09wZW4nIGFuZCBhcmUgbm90IHlldCBhbHJlYWR5XG4gICAgICAgIC8vIHJ1bm5pbmcgYSB0aW1lciAoaW4gd2hpY2ggY2FzZSB0aGUgcHJldmlvdXMgaWRsZSB0aW1lb3V0IHN0aWxsIGFwcGxpZXMpLlxuICAgICAgICB0aGlzLmtvKCkgJiYgbnVsbCA9PT0gdGhpcy5EbyAmJiAodGhpcy5EbyA9IHRoaXMuSHMuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy52bywgNmU0LCAoKCkgPT4gdGhpcy4kbygpKSkpO1xuICAgIH1cbiAgICAvKiogU2VuZHMgYSBtZXNzYWdlIHRvIHRoZSB1bmRlcmx5aW5nIHN0cmVhbS4gKi8gICAgQm8odCkge1xuICAgICAgICB0aGlzLkxvKCksIHRoaXMuc3RyZWFtLnNlbmQodCk7XG4gICAgfVxuICAgIC8qKiBDYWxsZWQgYnkgdGhlIGlkbGUgdGltZXIgd2hlbiB0aGUgc3RyZWFtIHNob3VsZCBjbG9zZSBkdWUgdG8gaW5hY3Rpdml0eS4gKi8gICAgYXN5bmMgJG8oKSB7XG4gICAgICAgIGlmICh0aGlzLmtvKCkpIFxuICAgICAgICAvLyBXaGVuIHRpbWluZyBvdXQgYW4gaWRsZSBzdHJlYW0gdGhlcmUncyBubyByZWFzb24gdG8gZm9yY2UgdGhlIHN0cmVhbSBpbnRvIGJhY2tvZmYgd2hlblxuICAgICAgICAvLyBpdCByZXN0YXJ0cyBzbyBzZXQgdGhlIHN0cmVhbSBzdGF0ZSB0byBJbml0aWFsIGluc3RlYWQgb2YgRXJyb3IuXG4gICAgICAgIHJldHVybiB0aGlzLmNsb3NlKDAgLyogSW5pdGlhbCAqLyk7XG4gICAgfVxuICAgIC8qKiBNYXJrcyB0aGUgc3RyZWFtIGFzIGFjdGl2ZSBhZ2Fpbi4gKi8gICAgTG8oKSB7XG4gICAgICAgIHRoaXMuRG8gJiYgKHRoaXMuRG8uY2FuY2VsKCksIHRoaXMuRG8gPSBudWxsKTtcbiAgICB9XG4gICAgLyoqIENhbmNlbHMgdGhlIGhlYWx0aCBjaGVjayBkZWxheWVkIG9wZXJhdGlvbi4gKi8gICAgVW8oKSB7XG4gICAgICAgIHRoaXMuQ28gJiYgKHRoaXMuQ28uY2FuY2VsKCksIHRoaXMuQ28gPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBzdHJlYW0gYW5kIGNsZWFucyB1cCBhcyBuZWNlc3Nhcnk6XG4gICAgICpcbiAgICAgKiAqIGNsb3NlcyB0aGUgdW5kZXJseWluZyBHUlBDIHN0cmVhbTtcbiAgICAgKiAqIGNhbGxzIHRoZSBvbkNsb3NlIGhhbmRsZXIgd2l0aCB0aGUgZ2l2ZW4gJ2Vycm9yJztcbiAgICAgKiAqIHNldHMgaW50ZXJuYWwgc3RyZWFtIHN0YXRlIHRvICdmaW5hbFN0YXRlJztcbiAgICAgKiAqIGFkanVzdHMgdGhlIGJhY2tvZmYgdGltZXIgYmFzZWQgb24gdGhlIGVycm9yXG4gICAgICpcbiAgICAgKiBBIG5ldyBzdHJlYW0gY2FuIGJlIG9wZW5lZCBieSBjYWxsaW5nIHN0YXJ0KCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmluYWxTdGF0ZSAtIHRoZSBpbnRlbmRlZCBzdGF0ZSBvZiB0aGUgc3RyZWFtIGFmdGVyIGNsb3NpbmcuXG4gICAgICogQHBhcmFtIGVycm9yIC0gdGhlIGVycm9yIHRoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgd2l0aC5cbiAgICAgKi8gICAgYXN5bmMgY2xvc2UodCwgZSkge1xuICAgICAgICAvLyBDYW5jZWwgYW55IG91dHN0YW5kaW5nIHRpbWVycyAodGhleSdyZSBndWFyYW50ZWVkIG5vdCB0byBleGVjdXRlKS5cbiAgICAgICAgdGhpcy5MbygpLCB0aGlzLlVvKCksIHRoaXMueG8uY2FuY2VsKCksIFxuICAgICAgICAvLyBJbnZhbGlkYXRlcyBhbnkgc3RyZWFtLXJlbGF0ZWQgY2FsbGJhY2tzIChlLmcuIGZyb20gYXV0aCBvciB0aGVcbiAgICAgICAgLy8gdW5kZXJseWluZyBzdHJlYW0pLCBndWFyYW50ZWVpbmcgdGhleSB3b24ndCBleGVjdXRlLlxuICAgICAgICB0aGlzLlNvKyssIDQgLyogRXJyb3IgKi8gIT09IHQgPyBcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpbnRlbnRpb25hbCBjbG9zZSBlbnN1cmUgd2UgZG9uJ3QgZGVsYXkgb3VyIG5leHQgY29ubmVjdGlvbiBhdHRlbXB0LlxuICAgICAgICB0aGlzLnhvLnJlc2V0KCkgOiBlICYmIGUuY29kZSA9PT0gQi5SRVNPVVJDRV9FWEhBVVNURUQgPyAoXG4gICAgICAgIC8vIExvZyB0aGUgZXJyb3IuIChQcm9iYWJseSBlaXRoZXIgJ3F1b3RhIGV4Y2VlZGVkJyBvciAnbWF4IHF1ZXVlIGxlbmd0aCByZWFjaGVkJy4pXG4gICAgICAgIHgoZS50b1N0cmluZygpKSwgeChcIlVzaW5nIG1heGltdW0gYmFja29mZiBkZWxheSB0byBwcmV2ZW50IG92ZXJsb2FkaW5nIHRoZSBiYWNrZW5kLlwiKSwgXG4gICAgICAgIHRoaXMueG8uQW8oKSkgOiBlICYmIGUuY29kZSA9PT0gQi5VTkFVVEhFTlRJQ0FURUQgJiYgMyAvKiBIZWFsdGh5ICovICE9PSB0aGlzLnN0YXRlICYmIChcbiAgICAgICAgLy8gXCJ1bmF1dGhlbnRpY2F0ZWRcIiBlcnJvciBtZWFucyB0aGUgdG9rZW4gd2FzIHJlamVjdGVkLiBUaGlzIHNob3VsZCByYXJlbHlcbiAgICAgICAgLy8gaGFwcGVuIHNpbmNlIGJvdGggQXV0aCBhbmQgQXBwQ2hlY2sgZW5zdXJlIGEgc3VmZmljaWVudCBUVEwgd2hlbiB3ZVxuICAgICAgICAvLyByZXF1ZXN0IGEgdG9rZW4uIElmIGEgdXNlciBtYW51YWxseSByZXNldHMgdGhlaXIgc3lzdGVtIGNsb2NrIHRoaXMgY2FuXG4gICAgICAgIC8vIGZhaWwsIGhvd2V2ZXIuIEluIHRoaXMgY2FzZSwgd2Ugc2hvdWxkIGdldCBhIENvZGUuVU5BVVRIRU5USUNBVEVEIGVycm9yXG4gICAgICAgIC8vIGJlZm9yZSB3ZSByZWNlaXZlZCB0aGUgZmlyc3QgbWVzc2FnZSBhbmQgd2UgbmVlZCB0byBpbnZhbGlkYXRlIHRoZSB0b2tlblxuICAgICAgICAvLyB0byBlbnN1cmUgdGhhdCB3ZSBmZXRjaCBhIG5ldyB0b2tlbi5cbiAgICAgICAgdGhpcy5hdXRoQ3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzUHJvdmlkZXIuaW52YWxpZGF0ZVRva2VuKCkpLCBcbiAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIHVuZGVybHlpbmcgc3RyZWFtIGJlY2F1c2Ugd2UgYXJlIG5vIGxvbmdlciBpbnRlcmVzdGVkIGluIGV2ZW50cy5cbiAgICAgICAgbnVsbCAhPT0gdGhpcy5zdHJlYW0gJiYgKHRoaXMucW8oKSwgdGhpcy5zdHJlYW0uY2xvc2UoKSwgdGhpcy5zdHJlYW0gPSBudWxsKSwgXG4gICAgICAgIC8vIFRoaXMgc3RhdGUgbXVzdCBiZSBhc3NpZ25lZCBiZWZvcmUgY2FsbGluZyBvbkNsb3NlKCkgdG8gYWxsb3cgdGhlIGNhbGxiYWNrIHRvXG4gICAgICAgIC8vIGluaGliaXQgYmFja29mZiBvciBvdGhlcndpc2UgbWFuaXB1bGF0ZSB0aGUgc3RhdGUgaW4gaXRzIG5vbi1zdGFydGVkIHN0YXRlLlxuICAgICAgICB0aGlzLnN0YXRlID0gdCwgXG4gICAgICAgIC8vIE5vdGlmeSB0aGUgbGlzdGVuZXIgdGhhdCB0aGUgc3RyZWFtIGNsb3NlZC5cbiAgICAgICAgYXdhaXQgdGhpcy5saXN0ZW5lci5acihlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuIGJlIG92ZXJyaWRkZW4gdG8gcGVyZm9ybSBhZGRpdGlvbmFsIGNsZWFudXAgYmVmb3JlIHRoZSBzdHJlYW0gaXMgY2xvc2VkLlxuICAgICAqIENhbGxpbmcgc3VwZXIudGVhckRvd24oKSBpcyBub3QgcmVxdWlyZWQuXG4gICAgICovICAgIHFvKCkge31cbiAgICBhdXRoKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gMSAvKiBTdGFydGluZyAqLztcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuS28odGhpcy5TbyksIGUgPSB0aGlzLlNvO1xuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWQsIGJ1dCBzZWUgVE9ETyBiZWxvdy5cbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChbIHRoaXMuYXV0aENyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW3QsIG5dKSA9PiB7XG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cbiAgICAgICAgICAgIHRoaXMuU28gPT09IGUgJiYgXG4gICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcbiAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcbiAgICAgICAgICAgIHRoaXMuR28odCwgbik7XG4gICAgICAgIH0pLCAoZSA9PiB7XG4gICAgICAgICAgICB0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBMKEIuVU5LTk9XTiwgXCJGZXRjaGluZyBhdXRoIHRva2VuIGZhaWxlZDogXCIgKyBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLlFvKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEdvKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuS28odGhpcy5Tbyk7XG4gICAgICAgIHRoaXMuc3RyZWFtID0gdGhpcy5qbyh0LCBlKSwgdGhpcy5zdHJlYW0uWXIoKCgpID0+IHtcbiAgICAgICAgICAgIG4oKCgpID0+ICh0aGlzLnN0YXRlID0gMiAvKiBPcGVuICovICwgdGhpcy5DbyA9IHRoaXMuSHMuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy5WbywgMWU0LCAoKCkgPT4gKHRoaXMua28oKSAmJiAodGhpcy5zdGF0ZSA9IDMgLyogSGVhbHRoeSAqLyksIFxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSksIHRoaXMubGlzdGVuZXIuWXIoKSkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnN0cmVhbS5acigodCA9PiB7XG4gICAgICAgICAgICBuKCgoKSA9PiB0aGlzLlFvKHQpKSk7XG4gICAgICAgIH0pKSwgdGhpcy5zdHJlYW0ub25NZXNzYWdlKCh0ID0+IHtcbiAgICAgICAgICAgIG4oKCgpID0+IHRoaXMub25NZXNzYWdlKHQpKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgT28oKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSA1IC8qIEJhY2tvZmYgKi8gLCB0aGlzLnhvLlJvKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gMCAvKiBJbml0aWFsICovICwgdGhpcy5zdGFydCgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RzXG4gICAgUW8odCkge1xuICAgICAgICAvLyBJbiB0aGVvcnkgdGhlIHN0cmVhbSBjb3VsZCBjbG9zZSBjbGVhbmx5LCBob3dldmVyLCBpbiBvdXIgY3VycmVudCBtb2RlbFxuICAgICAgICAvLyB3ZSBuZXZlciBleHBlY3QgdGhpcyB0byBoYXBwZW4gYmVjYXVzZSBpZiB3ZSBzdG9wIGEgc3RyZWFtIG91cnNlbHZlcyxcbiAgICAgICAgLy8gdGhpcyBjYWxsYmFjayB3aWxsIG5ldmVyIGJlIGNhbGxlZC4gVG8gcHJldmVudCBjYXNlcyB3aGVyZSB3ZSByZXRyeVxuICAgICAgICAvLyB3aXRob3V0IGEgYmFja29mZiBhY2NpZGVudGFsbHksIHdlIHNldCB0aGUgc3RyZWFtIHRvIGVycm9yIGluIGFsbCBjYXNlcy5cbiAgICAgICAgcmV0dXJuIEMoXCJQZXJzaXN0ZW50U3RyZWFtXCIsIGBjbG9zZSB3aXRoIGVycm9yOiAke3R9YCksIHRoaXMuc3RyZWFtID0gbnVsbCwgdGhpcy5jbG9zZSg0IC8qIEVycm9yICovICwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBcImRpc3BhdGNoZXJcIiBmdW5jdGlvbiB0aGF0IGRpc3BhdGNoZXMgb3BlcmF0aW9ucyBvbnRvIHRoZVxuICAgICAqIEFzeW5jUXVldWUgYnV0IG9ubHkgcnVucyB0aGVtIGlmIGNsb3NlQ291bnQgcmVtYWlucyB1bmNoYW5nZWQuIFRoaXMgYWxsb3dzXG4gICAgICogdXMgdG8gdHVybiBhdXRoIC8gc3RyZWFtIGNhbGxiYWNrcyBpbnRvIG5vLW9wcyBpZiB0aGUgc3RyZWFtIGlzIGNsb3NlZCAvXG4gICAgICogcmUtb3BlbmVkLCBldGMuXG4gICAgICovICAgIEtvKHQpIHtcbiAgICAgICAgcmV0dXJuIGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5Icy5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiB0aGlzLlNvID09PSB0ID8gZSgpIDogKEMoXCJQZXJzaXN0ZW50U3RyZWFtXCIsIFwic3RyZWFtIGNhbGxiYWNrIHNraXBwZWQgYnkgZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlci5cIiksIFxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSB0aGF0IGltcGxlbWVudHMgdGhlIExpc3RlbiBSUEMuXG4gKlxuICogT25jZSB0aGUgTGlzdGVuIHN0cmVhbSBoYXMgY2FsbGVkIHRoZSBvbk9wZW4oKSBsaXN0ZW5lciwgYW55IG51bWJlciBvZlxuICogbGlzdGVuKCkgYW5kIHVubGlzdGVuKCkgY2FsbHMgY2FuIGJlIG1hZGUgdG8gY29udHJvbCB3aGF0IGNoYW5nZXMgd2lsbCBiZVxuICogc2VudCBmcm9tIHRoZSBzZXJ2ZXIgZm9yIExpc3RlblJlc3BvbnNlcy5cbiAqLyBjbGFzcyBudSBleHRlbmRzIGV1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHN1cGVyKHQsIFwibGlzdGVuX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIiAvKiBMaXN0ZW5TdHJlYW1Db25uZWN0aW9uQmFja29mZiAqLyAsIFwibGlzdGVuX3N0cmVhbV9pZGxlXCIgLyogTGlzdGVuU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBIZWFsdGhDaGVja1RpbWVvdXQgKi8gLCBlLCBuLCBzLCByKSwgXG4gICAgICAgIHRoaXMuSXQgPSBpO1xuICAgIH1cbiAgICBqbyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3Rpb24ud28oXCJMaXN0ZW5cIiwgdCwgZSk7XG4gICAgfVxuICAgIG9uTWVzc2FnZSh0KSB7XG4gICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHlcbiAgICAgICAgdGhpcy54by5yZXNldCgpO1xuICAgICAgICBjb25zdCBlID0gcXModGhpcy5JdCwgdCksIG4gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIHQpKSByZXR1cm4gc3QubWluKCk7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRDaGFuZ2U7XG4gICAgICAgICAgICByZXR1cm4gZS50YXJnZXRJZHMgJiYgZS50YXJnZXRJZHMubGVuZ3RoID8gc3QubWluKCkgOiBlLnJlYWRUaW1lID8gRHMoZS5yZWFkVGltZSkgOiBzdC5taW4oKTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuV28oZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZiB0aGUgdGFyZ2V0XG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcbiAgICAgKiBhZmZlY3QgdGhlIHRhcmdldCB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXG4gICAgICovICAgIHpvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHt9O1xuICAgICAgICBlLmRhdGFiYXNlID0gRnModGhpcy5JdCksIGUuYWRkVGFyZ2V0ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgbGV0IG47XG4gICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQ7XG4gICAgICAgICAgICByZXR1cm4gbiA9IE9lKHMpID8ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50czoganModCwgcylcbiAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IFdzKHQsIHMpXG4gICAgICAgICAgICB9LCBuLnRhcmdldElkID0gZS50YXJnZXRJZCwgZS5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwID8gbi5yZXN1bWVUb2tlbiA9IFZzKHQsIGUucmVzdW1lVG9rZW4pIDogZS5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHN0Lm1pbigpKSA+IDAgJiYgKFxuICAgICAgICAgICAgLy8gVE9ETyh3dWFuZHkpOiBDb25zaWRlciByZW1vdmluZyBhYm92ZSBjaGVjayBiZWNhdXNlIGl0IGlzIG1vc3QgbGlrZWx5IHRydWUuXG4gICAgICAgICAgICAvLyBSaWdodCBub3csIG1hbnkgdGVzdHMgZGVwZW5kIG9uIHRoaXMgYmVoYXZpb3VyIHRob3VnaCAobGVhdmluZyBtaW4oKSBvdXRcbiAgICAgICAgICAgIC8vIG9mIHNlcmlhbGl6YXRpb24pLlxuICAgICAgICAgICAgbi5yZWFkVGltZSA9IHZzKHQsIGUuc25hcHNob3RWZXJzaW9uLnRvVGltZXN0YW1wKCkpKSwgbjtcbiAgICAgICAgfSh0aGlzLkl0LCB0KTtcbiAgICAgICAgY29uc3QgbiA9IEhzKHRoaXMuSXQsIHQpO1xuICAgICAgICBuICYmIChlLmxhYmVscyA9IG4pLCB0aGlzLkJvKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aCB0aGVcbiAgICAgKiBnaXZlbiB0YXJnZXRJZC5cbiAgICAgKi8gICAgSG8odCkge1xuICAgICAgICBjb25zdCBlID0ge307XG4gICAgICAgIGUuZGF0YWJhc2UgPSBGcyh0aGlzLkl0KSwgZS5yZW1vdmVUYXJnZXQgPSB0LCB0aGlzLkJvKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIFN0cmVhbSB0aGF0IGltcGxlbWVudHMgdGhlIFdyaXRlIFJQQy5cbiAqXG4gKiBUaGUgV3JpdGUgUlBDIHJlcXVpcmVzIHRoZSBjYWxsZXIgdG8gbWFpbnRhaW4gc3BlY2lhbCBzdHJlYW1Ub2tlblxuICogc3RhdGUgaW4gYmV0d2VlbiBjYWxscywgdG8gaGVscCB0aGUgc2VydmVyIHVuZGVyc3RhbmQgd2hpY2ggcmVzcG9uc2VzIHRoZVxuICogY2xpZW50IGhhcyBwcm9jZXNzZWQgYnkgdGhlIHRpbWUgdGhlIG5leHQgcmVxdWVzdCBpcyBtYWRlLiBFdmVyeSByZXNwb25zZVxuICogd2lsbCBjb250YWluIGEgc3RyZWFtVG9rZW47IHRoaXMgdmFsdWUgbXVzdCBiZSBwYXNzZWQgdG8gdGhlIG5leHRcbiAqIHJlcXVlc3QuXG4gKlxuICogQWZ0ZXIgY2FsbGluZyBzdGFydCgpIG9uIHRoaXMgc3RyZWFtLCB0aGUgbmV4dCByZXF1ZXN0IG11c3QgYmUgYSBoYW5kc2hha2UsXG4gKiBjb250YWluaW5nIHdoYXRldmVyIHN0cmVhbVRva2VuIGlzIG9uIGhhbmQuIE9uY2UgYSByZXNwb25zZSB0byB0aGlzXG4gKiByZXF1ZXN0IGlzIHJlY2VpdmVkLCBhbGwgcGVuZGluZyBtdXRhdGlvbnMgbWF5IGJlIHN1Ym1pdHRlZC4gV2hlblxuICogc3VibWl0dGluZyBtdWx0aXBsZSBiYXRjaGVzIG9mIG11dGF0aW9ucyBhdCB0aGUgc2FtZSB0aW1lLCBpdCdzXG4gKiBva2F5IHRvIHVzZSB0aGUgc2FtZSBzdHJlYW1Ub2tlbiBmb3IgdGhlIGNhbGxzIHRvIHdyaXRlTXV0YXRpb25zLlxuICpcbiAqIFRPRE8oYi8zMzI3MTIzNSk6IFVzZSBwcm90byB0eXBlc1xuICovIGNsYXNzIHN1IGV4dGVuZHMgZXUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgc3VwZXIodCwgXCJ3cml0ZV9zdHJlYW1fY29ubmVjdGlvbl9iYWNrb2ZmXCIgLyogV3JpdGVTdHJlYW1Db25uZWN0aW9uQmFja29mZiAqLyAsIFwid3JpdGVfc3RyZWFtX2lkbGVcIiAvKiBXcml0ZVN0cmVhbUlkbGUgKi8gLCBcImhlYWx0aF9jaGVja190aW1lb3V0XCIgLyogSGVhbHRoQ2hlY2tUaW1lb3V0ICovICwgZSwgbiwgcywgciksIFxuICAgICAgICB0aGlzLkl0ID0gaSwgdGhpcy5KbyA9ICExO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFja3Mgd2hldGhlciBvciBub3QgYSBoYW5kc2hha2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGV4Y2hhbmdlZCBhbmRcbiAgICAgKiB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCBtdXRhdGlvbnMuXG4gICAgICovICAgIGdldCBZbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSm87XG4gICAgfVxuICAgIC8vIE92ZXJyaWRlIG9mIFBlcnNpc3RlbnRTdHJlYW0uc3RhcnRcbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5KbyA9ICExLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHZvaWQgMCwgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgcW8oKSB7XG4gICAgICAgIHRoaXMuSm8gJiYgdGhpcy5YbyhbXSk7XG4gICAgfVxuICAgIGpvKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi53byhcIldyaXRlXCIsIHQsIGUpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICBpZiAoXG4gICAgICAgIC8vIEFsd2F5cyBjYXB0dXJlIHRoZSBsYXN0IHN0cmVhbSB0b2tlbi5cbiAgICAgICAgTSghIXQuc3RyZWFtVG9rZW4pLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHQuc3RyZWFtVG9rZW4sIHRoaXMuSm8pIHtcbiAgICAgICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCBmaXJzdCB3cml0ZSByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHksXG4gICAgICAgICAgICAvLyBOb3RlLCB0aGF0IHdlIGNvdWxkIGNvbnNpZGVyIGEgc3VjY2Vzc2Z1bCBoYW5kc2hha2UgaGVhbHRoeSwgaG93ZXZlcixcbiAgICAgICAgICAgIC8vIHRoZSB3cml0ZSBpdHNlbGYgbWlnaHQgYmUgY2F1c2luZyBhbiBlcnJvciB3ZSB3YW50IHRvIGJhY2sgb2ZmIGZyb20uXG4gICAgICAgICAgICB0aGlzLnhvLnJlc2V0KCk7XG4gICAgICAgICAgICBjb25zdCBlID0gUXModC53cml0ZVJlc3VsdHMsIHQuY29tbWl0VGltZSksIG4gPSBEcyh0LmNvbW1pdFRpbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuWm8obiwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIGZpcnN0IHJlc3BvbnNlIGlzIGFsd2F5cyB0aGUgaGFuZHNoYWtlIHJlc3BvbnNlXG4gICAgICAgIHJldHVybiBNKCF0LndyaXRlUmVzdWx0cyB8fCAwID09PSB0LndyaXRlUmVzdWx0cy5sZW5ndGgpLCB0aGlzLkpvID0gITAsIHRoaXMubGlzdGVuZXIudHUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYW4gaW5pdGlhbCBzdHJlYW1Ub2tlbiB0byB0aGUgc2VydmVyLCBwZXJmb3JtaW5nIHRoZSBoYW5kc2hha2VcbiAgICAgKiByZXF1aXJlZCB0byBtYWtlIHRoZSBTdHJlYW1pbmdXcml0ZSBSUEMgd29yay4gU3Vic2VxdWVudFxuICAgICAqIGNhbGxzIHNob3VsZCB3YWl0IHVudGlsIG9uSGFuZHNoYWtlQ29tcGxldGUgd2FzIGNhbGxlZC5cbiAgICAgKi8gICAgZXUoKSB7XG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogU3VwcG9ydCBzdHJlYW0gcmVzdW1wdGlvbi4gV2UgaW50ZW50aW9uYWxseSBkbyBub3Qgc2V0IHRoZVxuICAgICAgICAvLyBzdHJlYW0gdG9rZW4gb24gdGhlIGhhbmRzaGFrZSwgaWdub3JpbmcgYW55IHN0cmVhbSB0b2tlbiB3ZSBtaWdodCBoYXZlLlxuICAgICAgICBjb25zdCB0ID0ge307XG4gICAgICAgIHQuZGF0YWJhc2UgPSBGcyh0aGlzLkl0KSwgdGhpcy5Cbyh0KTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgZ3JvdXAgb2YgbXV0YXRpb25zIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZCB0byBhcHBseS4gKi8gICAgWG8odCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgc3RyZWFtVG9rZW46IHRoaXMubGFzdFN0cmVhbVRva2VuLFxuICAgICAgICAgICAgd3JpdGVzOiB0Lm1hcCgodCA9PiBLcyh0aGlzLkl0LCB0KSkpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuQm8oZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEYXRhc3RvcmUgYW5kIGl0cyByZWxhdGVkIG1ldGhvZHMgYXJlIGEgd3JhcHBlciBhcm91bmQgdGhlIGV4dGVybmFsIEdvb2dsZVxuICogQ2xvdWQgRGF0YXN0b3JlIGdycGMgQVBJLCB3aGljaCBwcm92aWRlcyBhbiBpbnRlcmZhY2UgdGhhdCBpcyBtb3JlIGNvbnZlbmllbnRcbiAqIGZvciB0aGUgcmVzdCBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUgdG8gY29uc3VtZS5cbiAqL1xuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBEYXRhc3RvcmUgdGhhdCBleHBvc2VzIGFkZGl0aW9uYWwgc3RhdGUgZm9yIGludGVybmFsXG4gKiBjb25zdW1wdGlvbi5cbiAqL1xuY2xhc3MgaXUgZXh0ZW5kcyBjbGFzcyB7fSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmF1dGhDcmVkZW50aWFscyA9IHQsIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscyA9IGUsIHRoaXMuY29ubmVjdGlvbiA9IG4sIFxuICAgICAgICB0aGlzLkl0ID0gcywgdGhpcy5udSA9ICExO1xuICAgIH1cbiAgICBzdSgpIHtcbiAgICAgICAgaWYgKHRoaXMubnUpIHRocm93IG5ldyBMKEIuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJUaGUgY2xpZW50IGhhcyBhbHJlYWR5IGJlZW4gdGVybWluYXRlZC5cIik7XG4gICAgfVxuICAgIC8qKiBJbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBhdXRoIGFuZCBBcHBDaGVjayB0b2tlbnMuICovICAgIGFvKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3UoKSwgUHJvbWlzZS5hbGwoWyB0aGlzLmF1dGhDcmVkZW50aWFscy5nZXRUb2tlbigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW3MsIGldKSA9PiB0aGlzLmNvbm5lY3Rpb24uYW8odCwgZSwgbiwgcywgaSkpKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICB0aHJvdyBcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lID8gKHQuY29kZSA9PT0gQi5VTkFVVEhFTlRJQ0FURUQgJiYgKHRoaXMuYXV0aENyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpLCBcbiAgICAgICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSksIHQpIDogbmV3IEwoQi5VTktOT1dOLCB0LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKiBJbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBzdHJlYW1lZCByZXN1bHRzIHdpdGggYXV0aCBhbmQgQXBwQ2hlY2sgdG9rZW5zLiAqLyAgICBfbyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1KCksIFByb21pc2UuYWxsKFsgdGhpcy5hdXRoQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLmdldFRva2VuKCkgXSkudGhlbigoKFtpLCByXSkgPT4gdGhpcy5jb25uZWN0aW9uLl9vKHQsIGUsIG4sIGksIHIsIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IEIuVU5BVVRIRU5USUNBVEVEICYmICh0aGlzLmF1dGhDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCkpLCB0KSA6IG5ldyBMKEIuVU5LTk9XTiwgdC50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0ZXJtaW5hdGUoKSB7XG4gICAgICAgIHRoaXMubnUgPSAhMDtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JleHApOiBNYWtlIHN1cmUgdGhlcmUgaXMgb25seSBvbmUgRGF0YXN0b3JlIGluc3RhbmNlIHBlclxuLy8gZmlyZXN0b3JlLWV4cCBjbGllbnQuXG5hc3luYyBmdW5jdGlvbiBydSh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCksIHMgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBXcyh0LCBlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0cnVjdHVyZWRBZ2dyZWdhdGlvblF1ZXJ5OiB7XG4gICAgICAgICAgICAgICAgYWdncmVnYXRpb25zOiBbIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IHt9LFxuICAgICAgICAgICAgICAgICAgICBhbGlhczogXCJjb3VudF9hbGlhc1wiXG4gICAgICAgICAgICAgICAgfSBdLFxuICAgICAgICAgICAgICAgIHN0cnVjdHVyZWRRdWVyeTogbi5zdHJ1Y3R1cmVkUXVlcnlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwYXJlbnQ6IG4ucGFyZW50XG4gICAgICAgIH07XG4gICAgfShuLkl0LCBjbihlKSksIGkgPSBzLnBhcmVudDtcbiAgICBuLmNvbm5lY3Rpb24uY28gfHwgZGVsZXRlIHMucGFyZW50O1xuICAgIHJldHVybiAoYXdhaXQgbi5fbyhcIlJ1bkFnZ3JlZ2F0aW9uUXVlcnlcIiwgaSwgcywgLypleHBlY3RlZFJlc3BvbnNlQ291bnQ9Ki8gMSkpLmZpbHRlcigodCA9PiAhIXQucmVzdWx0KSkubWFwKCh0ID0+IHQucmVzdWx0LmFnZ3JlZ2F0ZUZpZWxkcykpO1xufVxuXG4vKipcbiAqIEEgY29tcG9uZW50IHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvIHRyYWNrIHRoZSBPbmxpbmVTdGF0ZSAodGhhdCBpcyxcbiAqIHdoZXRoZXIgb3Igbm90IHRoZSBjbGllbnQgYXMgYSB3aG9sZSBzaG91bGQgYmUgY29uc2lkZXJlZCB0byBiZSBvbmxpbmUgb3JcbiAqIG9mZmxpbmUpLCBpbXBsZW1lbnRpbmcgdGhlIGFwcHJvcHJpYXRlIGhldXJpc3RpY3MuXG4gKlxuICogSW4gcGFydGljdWxhciwgd2hlbiB0aGUgY2xpZW50IGlzIHRyeWluZyB0byBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLCB3ZVxuICogYWxsb3cgdXAgdG8gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB3aXRoaW4gT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgZm9yXG4gKiBhIGNvbm5lY3Rpb24gdG8gc3VjY2VlZC4gSWYgd2UgaGF2ZSB0b28gbWFueSBmYWlsdXJlcyBvciB0aGUgdGltZW91dCBlbGFwc2VzLFxuICogdGhlbiB3ZSBzZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUsIGFuZCB0aGUgY2xpZW50IHdpbGwgYmVoYXZlIGFzIGlmXG4gKiBpdCBpcyBvZmZsaW5lIChnZXQoKXMgd2lsbCByZXR1cm4gY2FjaGVkIGRhdGEsIGV0Yy4pLlxuICovXG5jbGFzcyBvdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IGUsIFxuICAgICAgICAvKiogVGhlIGN1cnJlbnQgT25saW5lU3RhdGUuICovXG4gICAgICAgIHRoaXMuc3RhdGUgPSBcIlVua25vd25cIiAvKiBVbmtub3duICovICwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGNvdW50IG9mIGNvbnNlY3V0aXZlIGZhaWx1cmVzIHRvIG9wZW4gdGhlIHN0cmVhbS4gSWYgaXQgcmVhY2hlcyB0aGVcbiAgICAgICAgICogbWF4aW11bSBkZWZpbmVkIGJ5IE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMsIHdlJ2xsIHNldCB0aGUgT25saW5lU3RhdGUgdG9cbiAgICAgICAgICogT2ZmbGluZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaXUgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdGltZXIgdGhhdCBlbGFwc2VzIGFmdGVyIE9OTElORV9TVEFURV9USU1FT1VUX01TLCBhdCB3aGljaCBwb2ludCB3ZVxuICAgICAgICAgKiB0cmFuc2l0aW9uIGZyb20gT25saW5lU3RhdGUuVW5rbm93biB0byBPbmxpbmVTdGF0ZS5PZmZsaW5lIHdpdGhvdXQgd2FpdGluZ1xuICAgICAgICAgKiBmb3IgdGhlIHN0cmVhbSB0byBhY3R1YWxseSBmYWlsIChNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTIHRpbWVzKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucnUgPSBudWxsLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNsaWVudCBzaG91bGQgbG9nIGEgd2FybmluZyBtZXNzYWdlIGlmIGl0IGZhaWxzIHRvIGNvbm5lY3QgdG9cbiAgICAgICAgICogdGhlIGJhY2tlbmQgKGluaXRpYWxseSB0cnVlLCBjbGVhcmVkIGFmdGVyIGEgc3VjY2Vzc2Z1bCBzdHJlYW0sIG9yIGlmIHdlJ3ZlXG4gICAgICAgICAqIGxvZ2dlZCB0aGUgbWVzc2FnZSBhbHJlYWR5KS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub3UgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IFJlbW90ZVN0b3JlIHdoZW4gYSB3YXRjaCBzdHJlYW0gaXMgc3RhcnRlZCAoaW5jbHVkaW5nIG9uIGVhY2hcbiAgICAgKiBiYWNrb2ZmIGF0dGVtcHQpLlxuICAgICAqXG4gICAgICogSWYgdGhpcyBpcyB0aGUgZmlyc3QgYXR0ZW1wdCwgaXQgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gVW5rbm93biBhbmQgc3RhcnRzXG4gICAgICogdGhlIG9ubGluZVN0YXRlVGltZXIuXG4gICAgICovICAgIHV1KCkge1xuICAgICAgICAwID09PSB0aGlzLml1ICYmICh0aGlzLmN1KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pLCB0aGlzLnJ1ID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwib25saW5lX3N0YXRlX3RpbWVvdXRcIiAvKiBPbmxpbmVTdGF0ZVRpbWVvdXQgKi8gLCAxZTQsICgoKSA9PiAodGhpcy5ydSA9IG51bGwsIFxuICAgICAgICB0aGlzLmF1KFwiQmFja2VuZCBkaWRuJ3QgcmVzcG9uZCB3aXRoaW4gMTAgc2Vjb25kcy5cIiksIHRoaXMuY3UoXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyksIFxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgb3VyIE9ubGluZVN0YXRlIGFzIGFwcHJvcHJpYXRlIGFmdGVyIHRoZSB3YXRjaCBzdHJlYW0gcmVwb3J0cyBhXG4gICAgICogZmFpbHVyZS4gVGhlIGZpcnN0IGZhaWx1cmUgbW92ZXMgdXMgdG8gdGhlICdVbmtub3duJyBzdGF0ZS4gV2UgdGhlbiBtYXlcbiAgICAgKiBhbGxvdyBtdWx0aXBsZSBmYWlsdXJlcyAoYmFzZWQgb24gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUykgYmVmb3JlIHdlXG4gICAgICogYWN0dWFsbHkgdHJhbnNpdGlvbiB0byB0aGUgJ09mZmxpbmUnIHN0YXRlLlxuICAgICAqLyAgICBodSh0KSB7XG4gICAgICAgIFwiT25saW5lXCIgLyogT25saW5lICovID09PSB0aGlzLnN0YXRlID8gdGhpcy5jdShcIlVua25vd25cIiAvKiBVbmtub3duICovKSA6ICh0aGlzLml1KyssIFxuICAgICAgICB0aGlzLml1ID49IDEgJiYgKHRoaXMubHUoKSwgdGhpcy5hdShgQ29ubmVjdGlvbiBmYWlsZWQgMSB0aW1lcy4gTW9zdCByZWNlbnQgZXJyb3I6ICR7dC50b1N0cmluZygpfWApLCBcbiAgICAgICAgdGhpcy5jdShcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeHBsaWNpdGx5IHNldHMgdGhlIE9ubGluZVN0YXRlIHRvIHRoZSBzcGVjaWZpZWQgc3RhdGUuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgdGhpcyByZXNldHMgb3VyIHRpbWVycyAvIGZhaWx1cmUgY291bnRlcnMsIGV0Yy4gdXNlZCBieSBvdXJcbiAgICAgKiBPZmZsaW5lIGhldXJpc3RpY3MsIHNvIG11c3Qgbm90IGJlIHVzZWQgaW4gcGxhY2Ugb2ZcbiAgICAgKiBoYW5kbGVXYXRjaFN0cmVhbVN0YXJ0KCkgYW5kIGhhbmRsZVdhdGNoU3RyZWFtRmFpbHVyZSgpLlxuICAgICAqLyAgICBzZXQodCkge1xuICAgICAgICB0aGlzLmx1KCksIHRoaXMuaXUgPSAwLCBcIk9ubGluZVwiIC8qIE9ubGluZSAqLyA9PT0gdCAmJiAoXG4gICAgICAgIC8vIFdlJ3ZlIGNvbm5lY3RlZCB0byB3YXRjaCBhdCBsZWFzdCBvbmNlLiBEb24ndCB3YXJuIHRoZSBkZXZlbG9wZXJcbiAgICAgICAgLy8gYWJvdXQgYmVpbmcgb2ZmbGluZSBnb2luZyBmb3J3YXJkLlxuICAgICAgICB0aGlzLm91ID0gITEpLCB0aGlzLmN1KHQpO1xuICAgIH1cbiAgICBjdSh0KSB7XG4gICAgICAgIHQgIT09IHRoaXMuc3RhdGUgJiYgKHRoaXMuc3RhdGUgPSB0LCB0aGlzLm9ubGluZVN0YXRlSGFuZGxlcih0KSk7XG4gICAgfVxuICAgIGF1KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGBDb3VsZCBub3QgcmVhY2ggQ2xvdWQgRmlyZXN0b3JlIGJhY2tlbmQuICR7dH1cXG5UaGlzIHR5cGljYWxseSBpbmRpY2F0ZXMgdGhhdCB5b3VyIGRldmljZSBkb2VzIG5vdCBoYXZlIGEgaGVhbHRoeSBJbnRlcm5ldCBjb25uZWN0aW9uIGF0IHRoZSBtb21lbnQuIFRoZSBjbGllbnQgd2lsbCBvcGVyYXRlIGluIG9mZmxpbmUgbW9kZSB1bnRpbCBpdCBpcyBhYmxlIHRvIHN1Y2Nlc3NmdWxseSBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLmA7XG4gICAgICAgIHRoaXMub3UgPyAoeChlKSwgdGhpcy5vdSA9ICExKSA6IEMoXCJPbmxpbmVTdGF0ZVRyYWNrZXJcIiwgZSk7XG4gICAgfVxuICAgIGx1KCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnJ1ICYmICh0aGlzLnJ1LmNhbmNlbCgpLCB0aGlzLnJ1ID0gbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyB1dSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGxvY2FsIHN0b3JlLCB1c2VkIHRvIGZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGggb3V0Ym91bmQgbXV0YXRpb25zLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgY2xpZW50LXNpZGUgcHJveHkgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIGJhY2tlbmQuICovXG4gICAgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSB0LCB0aGlzLmRhdGFzdG9yZSA9IGUsIHRoaXMuYXN5bmNRdWV1ZSA9IG4sIHRoaXMucmVtb3RlU3luY2VyID0ge30sIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBsaXN0IG9mIHVwIHRvIE1BWF9QRU5ESU5HX1dSSVRFUyB3cml0ZXMgdGhhdCB3ZSBoYXZlIGZldGNoZWQgZnJvbSB0aGVcbiAgICAgICAgICogTG9jYWxTdG9yZSB2aWEgZmlsbFdyaXRlUGlwZWxpbmUoKSBhbmQgaGF2ZSBvciB3aWxsIHNlbmQgdG8gdGhlIHdyaXRlXG4gICAgICAgICAqIHN0cmVhbS5cbiAgICAgICAgICpcbiAgICAgICAgICogV2hlbmV2ZXIgd3JpdGVQaXBlbGluZS5sZW5ndGggPiAwIHRoZSBSZW1vdGVTdG9yZSB3aWxsIGF0dGVtcHQgdG8gc3RhcnQgb3JcbiAgICAgICAgICogcmVzdGFydCB0aGUgd3JpdGUgc3RyZWFtLiBXaGVuIHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQgdGhlIHdyaXRlcyBpbiB0aGVcbiAgICAgICAgICogcGlwZWxpbmUgd2lsbCBiZSBzZW50IGluIG9yZGVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXcml0ZXMgcmVtYWluIGluIHdyaXRlUGlwZWxpbmUgdW50aWwgdGhleSBhcmUgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kXG4gICAgICAgICAqIGFuZCB0aHVzIHdpbGwgYXV0b21hdGljYWxseSBiZSByZS1zZW50IGlmIHRoZSBzdHJlYW0gaXMgaW50ZXJydXB0ZWQgL1xuICAgICAgICAgKiByZXN0YXJ0ZWQgYmVmb3JlIHRoZXkncmUgYWNrbm93bGVkZ2VkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXcml0ZSByZXNwb25zZXMgZnJvbSB0aGUgYmFja2VuZCBhcmUgbGlua2VkIHRvIHRoZWlyIG9yaWdpbmF0aW5nIHJlcXVlc3RcbiAgICAgICAgICogcHVyZWx5IGJhc2VkIG9uIG9yZGVyLCBhbmQgc28gd2UgY2FuIGp1c3Qgc2hpZnQoKSB3cml0ZXMgZnJvbSB0aGUgZnJvbnQgb2ZcbiAgICAgICAgICogdGhlIHdyaXRlUGlwZWxpbmUgYXMgd2UgcmVjZWl2ZSByZXNwb25zZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZ1ID0gW10sIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBtYXBwaW5nIG9mIHdhdGNoZWQgdGFyZ2V0cyB0aGF0IHRoZSBjbGllbnQgY2FyZXMgYWJvdXQgdHJhY2tpbmcgYW5kIHRoZVxuICAgICAgICAgKiB1c2VyIGhhcyBleHBsaWNpdGx5IGNhbGxlZCBhICdsaXN0ZW4nIGZvciB0aGlzIHRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlc2UgdGFyZ2V0cyBtYXkgb3IgbWF5IG5vdCBoYXZlIGJlZW4gc2VudCB0byBvciBhY2tub3dsZWRnZWQgYnkgdGhlXG4gICAgICAgICAqIHNlcnZlci4gT24gcmUtZXN0YWJsaXNoaW5nIHRoZSBsaXN0ZW4gc3RyZWFtLCB0aGVzZSB0YXJnZXRzIHNob3VsZCBiZSBzZW50XG4gICAgICAgICAqIHRvIHRoZSBzZXJ2ZXIuIFRoZSB0YXJnZXRzIHJlbW92ZWQgd2l0aCB1bmxpc3RlbnMgYXJlIHJlbW92ZWQgZWFnZXJseVxuICAgICAgICAgKiB3aXRob3V0IHdhaXRpbmcgZm9yIGNvbmZpcm1hdGlvbiBmcm9tIHRoZSBsaXN0ZW4gc3RyZWFtLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kdSA9IG5ldyBNYXAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBzZXQgb2YgcmVhc29ucyBmb3Igd2h5IHRoZSBSZW1vdGVTdG9yZSBtYXkgYmUgb2ZmbGluZS4gSWYgZW1wdHksIHRoZVxuICAgICAgICAgKiBSZW1vdGVTdG9yZSBtYXkgc3RhcnQgaXRzIG5ldHdvcmsgY29ubmVjdGlvbnMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl91ID0gbmV3IFNldCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFdmVudCBoYW5kbGVycyB0aGF0IGdldCBjYWxsZWQgd2hlbiB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCBvciBlbmFibGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiBQT1JUSU5HIE5PVEU6IFRoZXNlIGZ1bmN0aW9ucyBhcmUgdXNlZCBvbiB0aGUgV2ViIGNsaWVudCB0byBjcmVhdGUgdGhlXG4gICAgICAgICAqIHVuZGVybHlpbmcgc3RyZWFtcyAodG8gc3VwcG9ydCB0cmVlLXNoYWtlYWJsZSBzdHJlYW1zKS4gT24gQW5kcm9pZCBhbmQgaU9TLFxuICAgICAgICAgKiB0aGUgc3RyZWFtcyBhcmUgY3JlYXRlZCBkdXJpbmcgY29uc3RydWN0aW9uIG9mIFJlbW90ZVN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53dSA9IFtdLCB0aGlzLm11ID0gaSwgdGhpcy5tdS5xcigodCA9PiB7XG4gICAgICAgICAgICBuLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBQb3J0aW5nIE5vdGU6IFVubGlrZSBpT1MsIGByZXN0YXJ0TmV0d29yaygpYCBpcyBjYWxsZWQgZXZlbiB3aGVuIHRoZVxuICAgICAgICAgICAgICAgIC8vIG5ldHdvcmsgYmVjb21lcyB1bnJlYWNoYWJsZSBhcyB3ZSBkb24ndCBoYXZlIGFueSBvdGhlciB3YXkgdG8gdGVhclxuICAgICAgICAgICAgICAgIC8vIGRvd24gb3VyIHN0cmVhbXMuXG4gICAgICAgICAgICAgICAgbXUodGhpcykgJiYgKEMoXCJSZW1vdGVTdG9yZVwiLCBcIlJlc3RhcnRpbmcgc3RyZWFtcyBmb3IgbmV0d29yayByZWFjaGFiaWxpdHkgY2hhbmdlLlwiKSwgXG4gICAgICAgICAgICAgICAgYXdhaXQgYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gJCh0KTtcbiAgICAgICAgICAgICAgICAgICAgZS5fdS5hZGQoNCAvKiBDb25uZWN0aXZpdHlDaGFuZ2UgKi8pLCBhd2FpdCBhdShlKSwgZS5ndS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIFxuICAgICAgICAgICAgICAgICAgICBlLl91LmRlbGV0ZSg0IC8qIENvbm5lY3Rpdml0eUNoYW5nZSAqLyksIGF3YWl0IGN1KGUpO1xuICAgICAgICAgICAgICAgIH0odGhpcykpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSksIHRoaXMuZ3UgPSBuZXcgb3Uobiwgcyk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjdSh0KSB7XG4gICAgaWYgKG11KHQpKSBmb3IgKGNvbnN0IGUgb2YgdC53dSkgYXdhaXQgZSgvKiBlbmFibGVkPSAqLyAhMCk7XG59XG5cbi8qKlxuICogVGVtcG9yYXJpbHkgZGlzYWJsZXMgdGhlIG5ldHdvcmsuIFRoZSBuZXR3b3JrIGNhbiBiZSByZS1lbmFibGVkIHVzaW5nXG4gKiBlbmFibGVOZXR3b3JrKCkuXG4gKi8gYXN5bmMgZnVuY3Rpb24gYXUodCkge1xuICAgIGZvciAoY29uc3QgZSBvZiB0Lnd1KSBhd2FpdCBlKC8qIGVuYWJsZWQ9ICovICExKTtcbn1cblxuLyoqXG4gKiBTdGFydHMgbmV3IGxpc3RlbiBmb3IgdGhlIGdpdmVuIHRhcmdldC4gVXNlcyByZXN1bWUgdG9rZW4gaWYgcHJvdmlkZWQuIEl0XG4gKiBpcyBhIG5vLW9wIGlmIHRoZSB0YXJnZXQgb2YgZ2l2ZW4gYFRhcmdldERhdGFgIGlzIGFscmVhZHkgYmVpbmcgbGlzdGVuZWQgdG8uXG4gKi9cbmZ1bmN0aW9uIGh1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KTtcbiAgICBuLmR1LmhhcyhlLnRhcmdldElkKSB8fCAoXG4gICAgLy8gTWFyayB0aGlzIGFzIHNvbWV0aGluZyB0aGUgY2xpZW50IGlzIGN1cnJlbnRseSBsaXN0ZW5pbmcgZm9yLlxuICAgIG4uZHUuc2V0KGUudGFyZ2V0SWQsIGUpLCB3dShuKSA/IFxuICAgIC8vIFRoZSBsaXN0ZW4gd2lsbCBiZSBzZW50IGluIG9uV2F0Y2hTdHJlYW1PcGVuXG4gICAgX3UobikgOiBrdShuKS5rbygpICYmIGZ1KG4sIGUpKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIHRoZSBsaXN0ZW4gZnJvbSBzZXJ2ZXIuIEl0IGlzIGEgbm8tb3AgaWYgdGhlIGdpdmVuIHRhcmdldCBpZCBpc1xuICogbm90IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovIGZ1bmN0aW9uIGx1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KSwgcyA9IGt1KG4pO1xuICAgIG4uZHUuZGVsZXRlKGUpLCBzLmtvKCkgJiYgZHUobiwgZSksIDAgPT09IG4uZHUuc2l6ZSAmJiAocy5rbygpID8gcy5GbygpIDogbXUobikgJiYgXG4gICAgLy8gUmV2ZXJ0IHRvIE9ubGluZVN0YXRlLlVua25vd24gaWYgdGhlIHdhdGNoIHN0cmVhbSBpcyBub3Qgb3BlbiBhbmQgd2VcbiAgICAvLyBoYXZlIG5vIGxpc3RlbmVycywgc2luY2Ugd2l0aG91dCBhbnkgbGlzdGVucyB0byBzZW5kIHdlIGNhbm5vdFxuICAgIC8vIGNvbmZpcm0gaWYgdGhlIHN0cmVhbSBpcyBoZWFsdGh5IGFuZCB1cGdyYWRlIHRvIE9ubGluZVN0YXRlLk9ubGluZS5cbiAgICBuLmd1LnNldChcIlVua25vd25cIiAvKiBVbmtub3duICovKSk7XG59XG5cbi8qKlxuICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXG4gKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSBhY2sgdG8gcHJvY2VzcyBhbnkgbWVzc2FnZXMgZnJvbSB0aGlzIHRhcmdldC5cbiAqLyBmdW5jdGlvbiBmdSh0LCBlKSB7XG4gICAgdC55dS5NdChlLnRhcmdldElkKSwga3UodCkuem8oZSk7XG59XG5cbi8qKlxuICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcbiAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIHJlbW92YWwgb24gdGhlIHNlcnZlciBiZWZvcmUgd2UgcHJvY2VzcyBhbnlcbiAqIG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gZHUodCwgZSkge1xuICAgIHQueXUuTXQoZSksIGt1KHQpLkhvKGUpO1xufVxuXG5mdW5jdGlvbiBfdSh0KSB7XG4gICAgdC55dSA9IG5ldyBUcyh7XG4gICAgICAgIGdldFJlbW90ZUtleXNGb3JUYXJnZXQ6IGUgPT4gdC5yZW1vdGVTeW5jZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldChlKSxcbiAgICAgICAgc2U6IGUgPT4gdC5kdS5nZXQoZSkgfHwgbnVsbFxuICAgIH0pLCBrdSh0KS5zdGFydCgpLCB0Lmd1LnV1KCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSB3YXRjaCBzdHJlYW0gc2hvdWxkIGJlIHN0YXJ0ZWQgYmVjYXVzZSBpdCdzIG5lY2Vzc2FyeVxuICogYW5kIGhhcyBub3QgeWV0IGJlZW4gc3RhcnRlZC5cbiAqLyBmdW5jdGlvbiB3dSh0KSB7XG4gICAgcmV0dXJuIG11KHQpICYmICFrdSh0KS5ObygpICYmIHQuZHUuc2l6ZSA+IDA7XG59XG5cbmZ1bmN0aW9uIG11KHQpIHtcbiAgICByZXR1cm4gMCA9PT0gJCh0KS5fdS5zaXplO1xufVxuXG5mdW5jdGlvbiBndSh0KSB7XG4gICAgdC55dSA9IHZvaWQgMDtcbn1cblxuYXN5bmMgZnVuY3Rpb24geXUodCkge1xuICAgIHQuZHUuZm9yRWFjaCgoKGUsIG4pID0+IHtcbiAgICAgICAgZnUodCwgZSk7XG4gICAgfSkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBwdSh0LCBlKSB7XG4gICAgZ3UodCksIFxuICAgIC8vIElmIHdlIHN0aWxsIG5lZWQgdGhlIHdhdGNoIHN0cmVhbSwgcmV0cnkgdGhlIGNvbm5lY3Rpb24uXG4gICAgd3UodCkgPyAodC5ndS5odShlKSwgX3UodCkpIDogXG4gICAgLy8gTm8gbmVlZCB0byByZXN0YXJ0IHdhdGNoIHN0cmVhbSBiZWNhdXNlIHRoZXJlIGFyZSBubyBhY3RpdmUgdGFyZ2V0cy5cbiAgICAvLyBUaGUgb25saW5lIHN0YXRlIGlzIHNldCB0byB1bmtub3duIGJlY2F1c2UgdGhlcmUgaXMgbm8gYWN0aXZlIGF0dGVtcHRcbiAgICAvLyBhdCBlc3RhYmxpc2hpbmcgYSBjb25uZWN0aW9uXG4gICAgdC5ndS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEl1KHQsIGUsIG4pIHtcbiAgICBpZiAoXG4gICAgLy8gTWFyayB0aGUgY2xpZW50IGFzIG9ubGluZSBzaW5jZSB3ZSBnb3QgYSBtZXNzYWdlIGZyb20gdGhlIHNlcnZlclxuICAgIHQuZ3Uuc2V0KFwiT25saW5lXCIgLyogT25saW5lICovKSwgZSBpbnN0YW5jZW9mIHBzICYmIDIgLyogUmVtb3ZlZCAqLyA9PT0gZS5zdGF0ZSAmJiBlLmNhdXNlKSBcbiAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gYSB0YXJnZXQsIGRvbid0IHdhaXQgZm9yIGEgY29uc2lzdGVudCBzbmFwc2hvdFxuICAgIC8vIHRvIHJhaXNlIGV2ZW50c1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IFxuICAgICAgICAvKiogSGFuZGxlcyBhbiBlcnJvciBvbiBhIHRhcmdldCAqL1xuICAgICAgICBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5jYXVzZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBlLnRhcmdldElkcykgXG4gICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICB0LmR1LmhhcyhzKSAmJiAoYXdhaXQgdC5yZW1vdGVTeW5jZXIucmVqZWN0TGlzdGVuKHMsIG4pLCB0LmR1LmRlbGV0ZShzKSwgdC55dS5yZW1vdmVUYXJnZXQocykpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQXR0ZW1wdHMgdG8gZmlsbCBvdXIgd3JpdGUgcGlwZWxpbmUgd2l0aCB3cml0ZXMgZnJvbSB0aGUgTG9jYWxTdG9yZS5cbiAqXG4gKiBDYWxsZWQgaW50ZXJuYWxseSB0byBib290c3RyYXAgb3IgcmVmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSBhbmQgYnlcbiAqIFN5bmNFbmdpbmUgd2hlbmV2ZXIgdGhlcmUgYXJlIG5ldyBtdXRhdGlvbnMgdG8gcHJvY2Vzcy5cbiAqXG4gKiBTdGFydHMgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXG4gKi8gKHQsIGUpO1xuICAgIH0gY2F0Y2ggKG4pIHtcbiAgICAgICAgQyhcIlJlbW90ZVN0b3JlXCIsIFwiRmFpbGVkIHRvIHJlbW92ZSB0YXJnZXRzICVzOiAlcyBcIiwgZS50YXJnZXRJZHMuam9pbihcIixcIiksIG4pLCBcbiAgICAgICAgYXdhaXQgVHUodCwgbik7XG4gICAgfSBlbHNlIGlmIChlIGluc3RhbmNlb2YgZ3MgPyB0Lnl1Lkd0KGUpIDogZSBpbnN0YW5jZW9mIHlzID8gdC55dS5ZdChlKSA6IHQueXUuV3QoZSksIFxuICAgICFuLmlzRXF1YWwoc3QubWluKCkpKSB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgUm8odC5sb2NhbFN0b3JlKTtcbiAgICAgICAgbi5jb21wYXJlVG8oZSkgPj0gMCAmJiBcbiAgICAgICAgLy8gV2UgaGF2ZSByZWNlaXZlZCBhIHRhcmdldCBjaGFuZ2Ugd2l0aCBhIGdsb2JhbCBzbmFwc2hvdCBpZiB0aGUgc25hcHNob3RcbiAgICAgICAgLy8gdmVyc2lvbiBpcyBub3QgZXF1YWwgdG8gU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICAgICAgICBhd2FpdCBcbiAgICAgICAgLyoqXG4gKiBUYWtlcyBhIGJhdGNoIG9mIGNoYW5nZXMgZnJvbSB0aGUgRGF0YXN0b3JlLCByZXBhY2thZ2VzIHRoZW0gYXMgYVxuICogUmVtb3RlRXZlbnQsIGFuZCBwYXNzZXMgdGhhdCBvbiB0byB0aGUgbGlzdGVuZXIsIHdoaWNoIGlzIHR5cGljYWxseSB0aGVcbiAqIFN5bmNFbmdpbmUuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQueXUudGUoZSk7XG4gICAgICAgICAgICAvLyBVcGRhdGUgaW4tbWVtb3J5IHJlc3VtZSB0b2tlbnMuIExvY2FsU3RvcmUgd2lsbCB1cGRhdGUgdGhlXG4gICAgICAgICAgICAvLyBwZXJzaXN0ZW50IHZpZXcgb2YgdGhlc2Ugd2hlbiBhcHBseWluZyB0aGUgY29tcGxldGVkIFJlbW90ZUV2ZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4udGFyZ2V0Q2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChuLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZHUuZ2V0KHMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAmJiB0LmR1LnNldChzLCBpLndpdGhSZXN1bWVUb2tlbihuLnJlc3VtZVRva2VuLCBlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLCBcbiAgICAgICAgICAgIC8vIFJlLWVzdGFibGlzaCBsaXN0ZW5zIGZvciB0aGUgdGFyZ2V0cyB0aGF0IGhhdmUgYmVlbiBpbnZhbGlkYXRlZCBieVxuICAgICAgICAgICAgLy8gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAgICAgICAgbi50YXJnZXRNaXNtYXRjaGVzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmR1LmdldChlKTtcbiAgICAgICAgICAgICAgICBpZiAoIW4pIFxuICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIHJlc3VtZSB0b2tlbiBmb3IgdGhlIHRhcmdldCwgc2luY2Ugd2UncmUgaW4gYSBrbm93biBtaXNtYXRjaFxuICAgICAgICAgICAgICAgIC8vIHN0YXRlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmR1LnNldChlLCBuLndpdGhSZXN1bWVUb2tlbihXdC5FTVBUWV9CWVRFX1NUUklORywgbi5zbmFwc2hvdFZlcnNpb24pKSwgXG4gICAgICAgICAgICAgICAgLy8gQ2F1c2UgYSBoYXJkIHJlc2V0IGJ5IHVud2F0Y2hpbmcgYW5kIHJld2F0Y2hpbmcgaW1tZWRpYXRlbHksIGJ1dFxuICAgICAgICAgICAgICAgIC8vIGRlbGliZXJhdGVseSBkb24ndCBzZW5kIGEgcmVzdW1lIHRva2VuIHNvIHRoYXQgd2UgZ2V0IGEgZnVsbCB1cGRhdGUuXG4gICAgICAgICAgICAgICAgZHUodCwgZSk7XG4gICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgdGFyZ2V0IHdlIHNlbmQgYXMgYmVpbmcgb24gYmVoYWxmIG9mIGFuIGV4aXN0ZW5jZSBmaWx0ZXJcbiAgICAgICAgICAgICAgICAvLyBtaXNtYXRjaCwgYnV0IGRvbid0IGFjdHVhbGx5IHJldGFpbiB0aGF0IGluIGxpc3RlblRhcmdldHMuIFRoaXMgZW5zdXJlc1xuICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgZmxhZyB0aGUgZmlyc3QgcmUtbGlzdGVuIHRoaXMgd2F5IHdpdGhvdXQgaW1wYWN0aW5nIGZ1dHVyZVxuICAgICAgICAgICAgICAgIC8vIGxpc3RlbnMgb2YgdGhpcyB0YXJnZXQgKHRoYXQgbWlnaHQgaGFwcGVuIGUuZy4gb24gcmVjb25uZWN0KS5cbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IEZpKG4udGFyZ2V0LCBlLCAxIC8qIEV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovICwgbi5zZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICAgICAgZnUodCwgcyk7XG4gICAgICAgICAgICB9KSksIHQucmVtb3RlU3luY2VyLmFwcGx5UmVtb3RlRXZlbnQobik7XG4gICAgICAgIH0odCwgbik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBDKFwiUmVtb3RlU3RvcmVcIiwgXCJGYWlsZWQgdG8gcmFpc2Ugc25hcHNob3Q6XCIsIGUpLCBhd2FpdCBUdSh0LCBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb3ZlcnkgbG9naWMgZm9yIEluZGV4ZWREQiBlcnJvcnMgdGhhdCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsXG4gKiBgb3BgIHN1Y2NlZWRzLiBSZXRyaWVzIGFyZSBzY2hlZHVsZWQgd2l0aCBiYWNrb2ZmIHVzaW5nXG4gKiBgZW5xdWV1ZVJldHJ5YWJsZSgpYC4gSWYgYG9wKClgIGlzIG5vdCBwcm92aWRlZCwgSW5kZXhlZERCIGFjY2VzcyBpc1xuICogdmFsaWRhdGVkIHZpYSBhIGdlbmVyaWMgb3BlcmF0aW9uLlxuICpcbiAqIFRoZSByZXR1cm5lZCBQcm9taXNlIGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIGJlZm9yZVxuICogYW55IHJldHJ5IGF0dGVtcHQuXG4gKi8gYXN5bmMgZnVuY3Rpb24gVHUodCwgZSwgbikge1xuICAgIGlmICghVnQoZSkpIHRocm93IGU7XG4gICAgdC5fdS5hZGQoMSAvKiBJbmRleGVkRGJGYWlsZWQgKi8pLCBcbiAgICAvLyBEaXNhYmxlIG5ldHdvcmsgYW5kIHJhaXNlIG9mZmxpbmUgc25hcHNob3RzXG4gICAgYXdhaXQgYXUodCksIHQuZ3Uuc2V0KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pLCBuIHx8IChcbiAgICAvLyBVc2UgYSBzaW1wbGUgcmVhZCBvcGVyYXRpb24gdG8gZGV0ZXJtaW5lIGlmIEluZGV4ZWREQiByZWNvdmVyZWQuXG4gICAgLy8gSWRlYWxseSwgd2Ugd291bGQgZXhwb3NlIGEgaGVhbHRoIGNoZWNrIGRpcmVjdGx5IG9uIFNpbXBsZURiLCBidXRcbiAgICAvLyBSZW1vdGVTdG9yZSBvbmx5IGhhcyBhY2Nlc3MgdG8gcGVyc2lzdGVuY2UgdGhyb3VnaCBMb2NhbFN0b3JlLlxuICAgIG4gPSAoKSA9PiBSbyh0LmxvY2FsU3RvcmUpKSwgXG4gICAgLy8gUHJvYmUgSW5kZXhlZERCIHBlcmlvZGljYWxseSBhbmQgcmUtZW5hYmxlIG5ldHdvcmtcbiAgICB0LmFzeW5jUXVldWUuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBDKFwiUmVtb3RlU3RvcmVcIiwgXCJSZXRyeWluZyBJbmRleGVkREIgYWNjZXNzXCIpLCBhd2FpdCBuKCksIHQuX3UuZGVsZXRlKDEgLyogSW5kZXhlZERiRmFpbGVkICovKSwgXG4gICAgICAgIGF3YWl0IGN1KHQpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyBgb3BgLiBJZiBgb3BgIGZhaWxzLCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsIGBvcGBcbiAqIHN1Y2NlZWRzLiBSZXR1cm5zIGFmdGVyIHRoZSBmaXJzdCBhdHRlbXB0LlxuICovIGZ1bmN0aW9uIEV1KHQsIGUpIHtcbiAgICByZXR1cm4gZSgpLmNhdGNoKChuID0+IFR1KHQsIG4sIGUpKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEF1KHQpIHtcbiAgICBjb25zdCBlID0gJCh0KSwgbiA9IE91KGUpO1xuICAgIGxldCBzID0gZS5mdS5sZW5ndGggPiAwID8gZS5mdVtlLmZ1Lmxlbmd0aCAtIDFdLmJhdGNoSWQgOiAtMTtcbiAgICBmb3IgKDtSdShlKTsgKSB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdm8oZS5sb2NhbFN0b3JlLCBzKTtcbiAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgIDAgPT09IGUuZnUubGVuZ3RoICYmIG4uRm8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHMgPSB0LmJhdGNoSWQsIGJ1KGUsIHQpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgVHUoZSwgdCk7XG4gICAgfVxuICAgIFB1KGUpICYmIHZ1KGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBjYW4gYWRkIHRvIHRoZSB3cml0ZSBwaXBlbGluZSAoaS5lLiB0aGUgbmV0d29yayBpc1xuICogZW5hYmxlZCBhbmQgdGhlIHdyaXRlIHBpcGVsaW5lIGlzIG5vdCBmdWxsKS5cbiAqLyBmdW5jdGlvbiBSdSh0KSB7XG4gICAgcmV0dXJuIG11KHQpICYmIHQuZnUubGVuZ3RoIDwgMTA7XG59XG5cbi8qKlxuICogUXVldWVzIGFkZGl0aW9uYWwgd3JpdGVzIHRvIGJlIHNlbnQgdG8gdGhlIHdyaXRlIHN0cmVhbSwgc2VuZGluZyB0aGVtXG4gKiBpbW1lZGlhdGVseSBpZiB0aGUgd3JpdGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkLlxuICovIGZ1bmN0aW9uIGJ1KHQsIGUpIHtcbiAgICB0LmZ1LnB1c2goZSk7XG4gICAgY29uc3QgbiA9IE91KHQpO1xuICAgIG4ua28oKSAmJiBuLllvICYmIG4uWG8oZS5tdXRhdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBQdSh0KSB7XG4gICAgcmV0dXJuIG11KHQpICYmICFPdSh0KS5ObygpICYmIHQuZnUubGVuZ3RoID4gMDtcbn1cblxuZnVuY3Rpb24gdnUodCkge1xuICAgIE91KHQpLnN0YXJ0KCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFZ1KHQpIHtcbiAgICBPdSh0KS5ldSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBTdSh0KSB7XG4gICAgY29uc3QgZSA9IE91KHQpO1xuICAgIC8vIFNlbmQgdGhlIHdyaXRlIHBpcGVsaW5lIG5vdyB0aGF0IHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmZ1KSBlLlhvKG4ubXV0YXRpb25zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gRHUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LmZ1LnNoaWZ0KCksIGkgPSBPaS5mcm9tKHMsIGUsIG4pO1xuICAgIGF3YWl0IEV1KHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZShpKSkpLCBcbiAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uIGFub3RoZXJcbiAgICAvLyBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICBhd2FpdCBBdSh0KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gQ3UodCwgZSkge1xuICAgIC8vIElmIHRoZSB3cml0ZSBzdHJlYW0gY2xvc2VkIGFmdGVyIHRoZSB3cml0ZSBoYW5kc2hha2UgY29tcGxldGVzLCBhIHdyaXRlXG4gICAgLy8gb3BlcmF0aW9uIGZhaWxlZCBhbmQgd2UgZmFpbCB0aGUgcGVuZGluZyBvcGVyYXRpb24uXG4gICAgZSAmJiBPdSh0KS5ZbyAmJiBcbiAgICAvLyBUaGlzIGVycm9yIGFmZmVjdHMgdGhlIGFjdHVhbCB3cml0ZS5cbiAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIE9ubHkgaGFuZGxlIHBlcm1hbmVudCBlcnJvcnMgaGVyZS4gSWYgaXQncyB0cmFuc2llbnQsIGp1c3QgbGV0IHRoZSByZXRyeVxuICAgICAgICAvLyBsb2dpYyBraWNrIGluLlxuICAgICAgICBpZiAobiA9IGUuY29kZSwgWm4obikgJiYgbiAhPT0gQi5BQk9SVEVEKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHdhcyBhIHBlcm1hbmVudCBlcnJvciwgdGhlIHJlcXVlc3QgaXRzZWxmIHdhcyB0aGUgcHJvYmxlbVxuICAgICAgICAgICAgLy8gc28gaXQncyBub3QgZ29pbmcgdG8gc3VjY2VlZCBpZiB3ZSByZXNlbmQgaXQuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5mdS5zaGlmdCgpO1xuICAgICAgICAgICAgLy8gSW4gdGhpcyBjYXNlIGl0J3MgYWxzbyB1bmxpa2VseSB0aGF0IHRoZSBzZXJ2ZXIgaXRzZWxmIGlzIG1lbHRpbmdcbiAgICAgICAgICAgIC8vIGRvd24gLS0gdGhpcyB3YXMganVzdCBhIGJhZCByZXF1ZXN0IHNvIGluaGliaXQgYmFja29mZiBvbiB0aGUgbmV4dFxuICAgICAgICAgICAgLy8gcmVzdGFydC5cbiAgICAgICAgICAgICAgICAgICAgICAgIE91KHQpLk1vKCksIGF3YWl0IEV1KHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5yZWplY3RGYWlsZWRXcml0ZShuLmJhdGNoSWQsIGUpKSksIFxuICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvblxuICAgICAgICAgICAgLy8gYW5vdGhlciBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICAgICAgICAgIGF3YWl0IEF1KHQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuO1xuICAgIH0odCwgZSksIFxuICAgIC8vIFRoZSB3cml0ZSBzdHJlYW0gbWlnaHQgaGF2ZSBiZWVuIHN0YXJ0ZWQgYnkgcmVmaWxsaW5nIHRoZSB3cml0ZVxuICAgIC8vIHBpcGVsaW5lIGZvciBmYWlsZWQgd3JpdGVzXG4gICAgUHUodCkgJiYgdnUodCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHh1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KTtcbiAgICBuLmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBDKFwiUmVtb3RlU3RvcmVcIiwgXCJSZW1vdGVTdG9yZSByZWNlaXZlZCBuZXcgY3JlZGVudGlhbHNcIik7XG4gICAgY29uc3QgcyA9IG11KG4pO1xuICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAvLyBmcmVzaCBhdXRoIHRva2VuIGZvciB0aGUgbmV3IHVzZXIgYW5kIHJlLWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGhcbiAgICAvLyBuZXcgbXV0YXRpb25zIGZyb20gdGhlIExvY2FsU3RvcmUgKHNpbmNlIG11dGF0aW9ucyBhcmUgcGVyLXVzZXIpLlxuICAgICAgICBuLl91LmFkZCgzIC8qIENyZWRlbnRpYWxDaGFuZ2UgKi8pLCBhd2FpdCBhdShuKSwgcyAmJiBcbiAgICAvLyBEb24ndCBzZXQgdGhlIG5ldHdvcmsgc3RhdHVzIHRvIFVua25vd24gaWYgd2UgYXJlIG9mZmxpbmUuXG4gICAgbi5ndS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIGF3YWl0IG4ucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoZSksIFxuICAgIG4uX3UuZGVsZXRlKDMgLyogQ3JlZGVudGlhbENoYW5nZSAqLyksIGF3YWl0IGN1KG4pO1xufVxuXG4vKipcbiAqIFRvZ2dsZXMgdGhlIG5ldHdvcmsgc3RhdGUgd2hlbiB0aGUgY2xpZW50IGdhaW5zIG9yIGxvc2VzIGl0cyBwcmltYXJ5IGxlYXNlLlxuICovIGFzeW5jIGZ1bmN0aW9uIE51KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KTtcbiAgICBlID8gKG4uX3UuZGVsZXRlKDIgLyogSXNTZWNvbmRhcnkgKi8pLCBhd2FpdCBjdShuKSkgOiBlIHx8IChuLl91LmFkZCgyIC8qIElzU2Vjb25kYXJ5ICovKSwgXG4gICAgYXdhaXQgYXUobiksIG4uZ3Uuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pKTtcbn1cblxuLyoqXG4gKiBJZiBub3QgeWV0IGluaXRpYWxpemVkLCByZWdpc3RlcnMgdGhlIFdhdGNoU3RyZWFtIGFuZCBpdHMgbmV0d29yayBzdGF0ZVxuICogY2FsbGJhY2sgd2l0aCBgcmVtb3RlU3RvcmVJbXBsYC4gUmV0dXJucyB0aGUgZXhpc3Rpbmcgc3RyZWFtIGlmIG9uZSBpc1xuICogYWxyZWFkeSBhdmFpbGFibGUuXG4gKlxuICogUE9SVElORyBOT1RFOiBPbiBpT1MgYW5kIEFuZHJvaWQsIHRoZSBXYXRjaFN0cmVhbSBnZXRzIHJlZ2lzdGVyZWQgb24gc3RhcnR1cC5cbiAqIFRoaXMgaXMgbm90IGRvbmUgb24gV2ViIHRvIGFsbG93IGl0IHRvIGJlIHRyZWUtc2hha2VuLlxuICovIGZ1bmN0aW9uIGt1KHQpIHtcbiAgICByZXR1cm4gdC5wdSB8fCAoXG4gICAgLy8gQ3JlYXRlIHN0cmVhbSAoYnV0IG5vdGUgdGhhdCBpdCBpcyBub3Qgc3RhcnRlZCB5ZXQpLlxuICAgIHQucHUgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSAkKHQpO1xuICAgICAgICByZXR1cm4gcy5zdSgpLCBuZXcgbnUoZSwgcy5jb25uZWN0aW9uLCBzLmF1dGhDcmVkZW50aWFscywgcy5hcHBDaGVja0NyZWRlbnRpYWxzLCBzLkl0LCBuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQuZGF0YXN0b3JlLCB0LmFzeW5jUXVldWUsIHtcbiAgICAgICAgWXI6IHl1LmJpbmQobnVsbCwgdCksXG4gICAgICAgIFpyOiBwdS5iaW5kKG51bGwsIHQpLFxuICAgICAgICBXbzogSXUuYmluZChudWxsLCB0KVxuICAgIH0pLCB0Lnd1LnB1c2goKGFzeW5jIGUgPT4ge1xuICAgICAgICBlID8gKHQucHUuTW8oKSwgd3UodCkgPyBfdSh0KSA6IHQuZ3Uuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pKSA6IChhd2FpdCB0LnB1LnN0b3AoKSwgXG4gICAgICAgIGd1KHQpKTtcbiAgICB9KSkpLCB0LnB1O1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV3JpdGVTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdyaXRlU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gT3UodCkge1xuICAgIHJldHVybiB0Lkl1IHx8IChcbiAgICAvLyBDcmVhdGUgc3RyZWFtIChidXQgbm90ZSB0aGF0IGl0IGlzIG5vdCBzdGFydGVkIHlldCkuXG4gICAgdC5JdSA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9ICQodCk7XG4gICAgICAgIHJldHVybiBzLnN1KCksIG5ldyBzdShlLCBzLmNvbm5lY3Rpb24sIHMuYXV0aENyZWRlbnRpYWxzLCBzLmFwcENoZWNrQ3JlZGVudGlhbHMsIHMuSXQsIG4pO1xuICAgIH0odC5kYXRhc3RvcmUsIHQuYXN5bmNRdWV1ZSwge1xuICAgICAgICBZcjogVnUuYmluZChudWxsLCB0KSxcbiAgICAgICAgWnI6IEN1LmJpbmQobnVsbCwgdCksXG4gICAgICAgIHR1OiBTdS5iaW5kKG51bGwsIHQpLFxuICAgICAgICBabzogRHUuYmluZChudWxsLCB0KVxuICAgIH0pLCB0Lnd1LnB1c2goKGFzeW5jIGUgPT4ge1xuICAgICAgICBlID8gKHQuSXUuTW8oKSwgXG4gICAgICAgIC8vIFRoaXMgd2lsbCBzdGFydCB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cbiAgICAgICAgYXdhaXQgQXUodCkpIDogKGF3YWl0IHQuSXUuc3RvcCgpLCB0LmZ1Lmxlbmd0aCA+IDAgJiYgKEMoXCJSZW1vdGVTdG9yZVwiLCBgU3RvcHBpbmcgd3JpdGUgc3RyZWFtIHdpdGggJHt0LmZ1Lmxlbmd0aH0gcGVuZGluZyB3cml0ZXNgKSwgXG4gICAgICAgIHQuZnUgPSBbXSkpO1xuICAgIH0pKSksIHQuSXU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYW4gb3BlcmF0aW9uIHNjaGVkdWxlZCB0byBiZSBydW4gaW4gdGhlIGZ1dHVyZSBvbiBhbiBBc3luY1F1ZXVlLlxuICpcbiAqIEl0IGlzIGNyZWF0ZWQgdmlhIERlbGF5ZWRPcGVyYXRpb24uY3JlYXRlQW5kU2NoZWR1bGUoKS5cbiAqXG4gKiBTdXBwb3J0cyBjYW5jZWxsYXRpb24gKHZpYSBjYW5jZWwoKSkgYW5kIGVhcmx5IGV4ZWN1dGlvbiAodmlhIHNraXBEZWxheSgpKS5cbiAqXG4gKiBOb3RlOiBXZSBpbXBsZW1lbnQgYFByb21pc2VMaWtlYCBpbnN0ZWFkIG9mIGBQcm9taXNlYCwgYXMgdGhlIGBQcm9taXNlYCB0eXBlXG4gKiBpbiBuZXdlciB2ZXJzaW9ucyBvZiBUeXBlU2NyaXB0IGRlZmluZXMgYGZpbmFsbHlgLCB3aGljaCBpcyBub3QgYXZhaWxhYmxlIGluXG4gKiBJRS5cbiAqL1xuY2xhc3MgTXUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy50aW1lcklkID0gZSwgdGhpcy50YXJnZXRUaW1lTXMgPSBuLCB0aGlzLm9wID0gcywgdGhpcy5yZW1vdmFsQ2FsbGJhY2sgPSBpLCBcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IG5ldyBVLCB0aGlzLnRoZW4gPSB0aGlzLmRlZmVycmVkLnByb21pc2UudGhlbi5iaW5kKHRoaXMuZGVmZXJyZWQucHJvbWlzZSksIFxuICAgICAgICAvLyBJdCdzIG5vcm1hbCBmb3IgdGhlIGRlZmVycmVkIHByb21pc2UgdG8gYmUgY2FuY2VsZWQgKGR1ZSB0byBjYW5jZWxsYXRpb24pXG4gICAgICAgIC8vIGFuZCBzbyB3ZSBhdHRhY2ggYSBkdW1teSBjYXRjaCBjYWxsYmFjayB0byBhdm9pZFxuICAgICAgICAvLyAnVW5oYW5kbGVkUHJvbWlzZVJlamVjdGlvbldhcm5pbmcnIGxvZyBzcGFtLlxuICAgICAgICB0aGlzLmRlZmVycmVkLnByb21pc2UuY2F0Y2goKHQgPT4ge30pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIERlbGF5ZWRPcGVyYXRpb24gdGhhdCBoYXMgYmVlbiBzY2hlZHVsZWQgdG8gYmVcbiAgICAgKiBleGVjdXRlZCBvbiB0aGUgcHJvdmlkZWQgYXN5bmNRdWV1ZSBhZnRlciB0aGUgcHJvdmlkZWQgZGVsYXlNcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhc3luY1F1ZXVlIC0gVGhlIHF1ZXVlIHRvIHNjaGVkdWxlIHRoZSBvcGVyYXRpb24gb24uXG4gICAgICogQHBhcmFtIGlkIC0gQSBUaW1lciBJRCBpZGVudGlmeWluZyB0aGUgdHlwZSBvZiBvcGVyYXRpb24gdGhpcyBpcy5cbiAgICAgKiBAcGFyYW0gZGVsYXlNcyAtIFRoZSBkZWxheSAobXMpIGJlZm9yZSB0aGUgb3BlcmF0aW9uIHNob3VsZCBiZSBzY2hlZHVsZWQuXG4gICAgICogQHBhcmFtIG9wIC0gVGhlIG9wZXJhdGlvbiB0byBydW4uXG4gICAgICogQHBhcmFtIHJlbW92YWxDYWxsYmFjayAtIEEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgb25jZSB0aGVcbiAgICAgKiAgIG9wZXJhdGlvbiBpcyBleGVjdXRlZCBvciBjYW5jZWxlZCwgbm90aWZ5aW5nIHRoZSBBc3luY1F1ZXVlIHRvIHJlbW92ZSBpdFxuICAgICAqICAgZnJvbSBpdHMgZGVsYXllZE9wZXJhdGlvbnMgbGlzdC5cbiAgICAgKiAgIFBPUlRJTkcgTk9URTogVGhpcyBleGlzdHMgdG8gcHJldmVudCBtYWtpbmcgcmVtb3ZlRGVsYXllZE9wZXJhdGlvbigpIGFuZFxuICAgICAqICAgdGhlIERlbGF5ZWRPcGVyYXRpb24gY2xhc3MgcHVibGljLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlQW5kU2NoZWR1bGUodCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gRGF0ZS5ub3coKSArIG4sIG8gPSBuZXcgTXUodCwgZSwgciwgcywgaSk7XG4gICAgICAgIHJldHVybiBvLnN0YXJ0KG4pLCBvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIHRpbWVyLiBUaGlzIGlzIGNhbGxlZCBpbW1lZGlhdGVseSBhZnRlciBjb25zdHJ1Y3Rpb24gYnlcbiAgICAgKiBjcmVhdGVBbmRTY2hlZHVsZSgpLlxuICAgICAqLyAgICBzdGFydCh0KSB7XG4gICAgICAgIHRoaXMudGltZXJIYW5kbGUgPSBzZXRUaW1lb3V0KCgoKSA9PiB0aGlzLmhhbmRsZURlbGF5RWxhcHNlZCgpKSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFF1ZXVlcyB0aGUgb3BlcmF0aW9uIHRvIHJ1biBpbW1lZGlhdGVseSAoaWYgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBydW4gb3JcbiAgICAgKiBjYW5jZWxlZCkuXG4gICAgICovICAgIHNraXBEZWxheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbmNlbHMgdGhlIG9wZXJhdGlvbiBpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLiBUaGVcbiAgICAgKiBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQuXG4gICAgICpcbiAgICAgKiBBcyBsb25nIGFzIHRoZSBvcGVyYXRpb24gaGFzIG5vdCB5ZXQgYmVlbiBydW4sIGNhbGxpbmcgY2FuY2VsKCkgcHJvdmlkZXMgYVxuICAgICAqIGd1YXJhbnRlZSB0aGF0IHRoZSBvcGVyYXRpb24gd2lsbCBub3QgYmUgcnVuLlxuICAgICAqLyAgICBjYW5jZWwodCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlICYmICh0aGlzLmNsZWFyVGltZW91dCgpLCB0aGlzLmRlZmVycmVkLnJlamVjdChuZXcgTChCLkNBTkNFTExFRCwgXCJPcGVyYXRpb24gY2FuY2VsbGVkXCIgKyAodCA/IFwiOiBcIiArIHQgOiBcIlwiKSkpKTtcbiAgICB9XG4gICAgaGFuZGxlRGVsYXlFbGFwc2VkKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gbnVsbCAhPT0gdGhpcy50aW1lckhhbmRsZSA/ICh0aGlzLmNsZWFyVGltZW91dCgpLCBcbiAgICAgICAgdGhpcy5vcCgpLnRoZW4oKHQgPT4gdGhpcy5kZWZlcnJlZC5yZXNvbHZlKHQpKSkpIDogUHJvbWlzZS5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgY2xlYXJUaW1lb3V0KCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlICYmICh0aGlzLnJlbW92YWxDYWxsYmFjayh0aGlzKSwgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJIYW5kbGUpLCBcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgRmlyZXN0b3JlRXJyb3IgdGhhdCBjYW4gYmUgc3VyZmFjZWQgdG8gdGhlIHVzZXIgaWYgdGhlIHByb3ZpZGVkXG4gKiBlcnJvciBpcyBhbiBJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yLiBSZS10aHJvd3MgdGhlIGVycm9yIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBGdSh0LCBlKSB7XG4gICAgaWYgKHgoXCJBc3luY1F1ZXVlXCIsIGAke2V9OiAke3R9YCksIFZ0KHQpKSByZXR1cm4gbmV3IEwoQi5VTkFWQUlMQUJMRSwgYCR7ZX06ICR7dH1gKTtcbiAgICB0aHJvdyB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEb2N1bWVudFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBkb2N1bWVudHNcbiAqIGluIG9yZGVyIHNwZWNpZmllZCBieSB0aGUgcHJvdmlkZWQgY29tcGFyYXRvci4gV2UgYWx3YXlzIGFkZCBhIGRvY3VtZW50IGtleVxuICogY29tcGFyYXRvciBvbiB0b3Agb2Ygd2hhdCBpcyBwcm92aWRlZCB0byBndWFyYW50ZWUgZG9jdW1lbnQgZXF1YWxpdHkgYmFzZWQgb25cbiAqIHRoZSBrZXkuXG4gKi8gY2xhc3MgJHUge1xuICAgIC8qKiBUaGUgZGVmYXVsdCBvcmRlcmluZyBpcyBieSBrZXkgaWYgdGhlIGNvbXBhcmF0b3IgaXMgb21pdHRlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgLy8gV2UgYXJlIGFkZGluZyBkb2N1bWVudCBrZXkgY29tcGFyYXRvciB0byB0aGUgZW5kIGFzIGl0J3MgdGhlIG9ubHlcbiAgICAgICAgLy8gZ3VhcmFudGVlZCB1bmlxdWUgcHJvcGVydHkgb2YgYSBkb2N1bWVudC5cbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gdCA/IChlLCBuKSA9PiB0KGUsIG4pIHx8IGN0LmNvbXBhcmF0b3IoZS5rZXksIG4ua2V5KSA6ICh0LCBlKSA9PiBjdC5jb21wYXJhdG9yKHQua2V5LCBlLmtleSksIFxuICAgICAgICB0aGlzLmtleWVkTWFwID0gcnMoKSwgdGhpcy5zb3J0ZWRTZXQgPSBuZXcgQnQodGhpcy5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBlbXB0eSBjb3B5IG9mIHRoZSBleGlzdGluZyBEb2N1bWVudFNldCwgdXNpbmcgdGhlIHNhbWVcbiAgICAgKiBjb21wYXJhdG9yLlxuICAgICAqLyAgICBzdGF0aWMgZW1wdHlTZXQodCkge1xuICAgICAgICByZXR1cm4gbmV3ICR1KHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMua2V5ZWRNYXAuZ2V0KHQpO1xuICAgIH1cbiAgICBnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXllZE1hcC5nZXQodCk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQubWluS2V5KCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5tYXhLZXkoKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0LmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHByb3ZpZGVkIGtleSBpbiB0aGUgZG9jdW1lbnQgc2V0LCBvciAtMSBpZiB0aGVcbiAgICAgKiBkb2N1bWVudCBrZXkgaXMgbm90IHByZXNlbnQgaW4gdGhlIHNldDtcbiAgICAgKi8gICAgaW5kZXhPZih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmtleWVkTWFwLmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyB0aGlzLnNvcnRlZFNldC5pbmRleE9mKGUpIDogLTE7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuc2l6ZTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIGRvY3VtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovICAgIGZvckVhY2godCkge1xuICAgICAgICB0aGlzLnNvcnRlZFNldC5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4gKHQoZSksICExKSkpO1xuICAgIH1cbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXkgKi8gICAgYWRkKHQpIHtcbiAgICAgICAgLy8gRmlyc3QgcmVtb3ZlIHRoZSBlbGVtZW50IGlmIHdlIGhhdmUgaXQuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRlbGV0ZSh0LmtleSk7XG4gICAgICAgIHJldHVybiBlLmNvcHkoZS5rZXllZE1hcC5pbnNlcnQodC5rZXksIHQpLCBlLnNvcnRlZFNldC5pbnNlcnQodCwgbnVsbCkpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyBhIGRvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSA/IHRoaXMuY29weSh0aGlzLmtleWVkTWFwLnJlbW92ZSh0KSwgdGhpcy5zb3J0ZWRTZXQucmVtb3ZlKGUpKSA6IHRoaXM7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgJHUpKSByZXR1cm4gITE7XG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IHQuc2l6ZSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKSwgbiA9IHQuc29ydGVkU2V0LmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO2UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldE5leHQoKS5rZXksIHMgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoIXQuaXNFcXVhbChzKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0LnB1c2goZS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpLCAwID09PSB0Lmxlbmd0aCA/IFwiRG9jdW1lbnRTZXQgKClcIiA6IFwiRG9jdW1lbnRTZXQgKFxcbiAgXCIgKyB0LmpvaW4oXCIgIFxcblwiKSArIFwiXFxuKVwiO1xuICAgIH1cbiAgICBjb3B5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyAkdTtcbiAgICAgICAgcmV0dXJuIG4uY29tcGFyYXRvciA9IHRoaXMuY29tcGFyYXRvciwgbi5rZXllZE1hcCA9IHQsIG4uc29ydGVkU2V0ID0gZSwgbjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50Q2hhbmdlU2V0IGtlZXBzIHRyYWNrIG9mIGEgc2V0IG9mIGNoYW5nZXMgdG8gZG9jcyBpbiBhIHF1ZXJ5LCBtZXJnaW5nXG4gKiBkdXBsaWNhdGUgZXZlbnRzIGZvciB0aGUgc2FtZSBkb2MuXG4gKi8gY2xhc3MgQnUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLlR1ID0gbmV3IEJ0KGN0LmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICB0cmFjayh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRvYy5rZXksIG4gPSB0aGlzLlR1LmdldChlKTtcbiAgICAgICAgbiA/IFxuICAgICAgICAvLyBNZXJnZSB0aGUgbmV3IGNoYW5nZSB3aXRoIHRoZSBleGlzdGluZyBjaGFuZ2UuXG4gICAgICAgIDAgLyogQWRkZWQgKi8gIT09IHQudHlwZSAmJiAzIC8qIE1ldGFkYXRhICovID09PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5pbnNlcnQoZSwgdCkgOiAzIC8qIE1ldGFkYXRhICovID09PSB0LnR5cGUgJiYgMSAvKiBSZW1vdmVkICovICE9PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogbi50eXBlLFxuICAgICAgICAgICAgZG9jOiB0LmRvY1xuICAgICAgICB9KSA6IDIgLyogTW9kaWZpZWQgKi8gPT09IHQudHlwZSAmJiAyIC8qIE1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogMiAvKiBNb2RpZmllZCAqLyA9PT0gdC50eXBlICYmIDAgLyogQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuVHUgPSB0aGlzLlR1Lmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAwIC8qIEFkZGVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiAxIC8qIFJlbW92ZWQgKi8gPT09IHQudHlwZSAmJiAwIC8qIEFkZGVkICovID09PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5yZW1vdmUoZSkgOiAxIC8qIFJlbW92ZWQgKi8gPT09IHQudHlwZSAmJiAyIC8qIE1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgIGRvYzogbi5kb2NcbiAgICAgICAgfSkgOiAwIC8qIEFkZGVkICovID09PSB0LnR5cGUgJiYgMSAvKiBSZW1vdmVkICovID09PSBuLnR5cGUgPyB0aGlzLlR1ID0gdGhpcy5UdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogXG4gICAgICAgIC8vIFRoaXMgaW5jbHVkZXMgdGhlc2UgY2FzZXMsIHdoaWNoIGRvbid0IG1ha2Ugc2Vuc2U6XG4gICAgICAgIC8vIEFkZGVkLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5SZW1vdmVkXG4gICAgICAgIC8vIE1vZGlmaWVkLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5Nb2RpZmllZFxuICAgICAgICAvLyBNZXRhZGF0YS0+QWRkZWRcbiAgICAgICAgLy8gUmVtb3ZlZC0+TWV0YWRhdGFcbiAgICAgICAgTygpIDogdGhpcy5UdSA9IHRoaXMuVHUuaW5zZXJ0KGUsIHQpO1xuICAgIH1cbiAgICBFdSgpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5UdS5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgdC5wdXNoKG4pO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxufVxuXG5jbGFzcyBMdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbywgdSwgYykge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy5kb2NzID0gZSwgdGhpcy5vbGREb2NzID0gbiwgdGhpcy5kb2NDaGFuZ2VzID0gcywgdGhpcy5tdXRhdGVkS2V5cyA9IGksIFxuICAgICAgICB0aGlzLmZyb21DYWNoZSA9IHIsIHRoaXMuc3luY1N0YXRlQ2hhbmdlZCA9IG8sIHRoaXMuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMgPSB1LCBcbiAgICAgICAgdGhpcy5oYXNDYWNoZWRSZXN1bHRzID0gYztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIGFsbCBkb2N1bWVudHMgaW4gdGhlIHNuYXBzaG90IHdlcmUgYWRkZWQuICovICAgIHN0YXRpYyBmcm9tSW5pdGlhbERvY3VtZW50cyh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBbXTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICByLnB1c2goe1xuICAgICAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKSwgbmV3IEx1KHQsIGUsICR1LmVtcHR5U2V0KGUpLCByLCBuLCBzLCBcbiAgICAgICAgLyogc3luY1N0YXRlQ2hhbmdlZD0gKi8gITAsIFxuICAgICAgICAvKiBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcz0gKi8gITEsIGkpO1xuICAgIH1cbiAgICBnZXQgaGFzUGVuZGluZ1dyaXRlcygpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLm11dGF0ZWRLZXlzLmlzRW1wdHkoKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIGlmICghKHRoaXMuZnJvbUNhY2hlID09PSB0LmZyb21DYWNoZSAmJiB0aGlzLmhhc0NhY2hlZFJlc3VsdHMgPT09IHQuaGFzQ2FjaGVkUmVzdWx0cyAmJiB0aGlzLnN5bmNTdGF0ZUNoYW5nZWQgPT09IHQuc3luY1N0YXRlQ2hhbmdlZCAmJiB0aGlzLm11dGF0ZWRLZXlzLmlzRXF1YWwodC5tdXRhdGVkS2V5cykgJiYgaG4odGhpcy5xdWVyeSwgdC5xdWVyeSkgJiYgdGhpcy5kb2NzLmlzRXF1YWwodC5kb2NzKSAmJiB0aGlzLm9sZERvY3MuaXNFcXVhbCh0Lm9sZERvY3MpKSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5kb2NDaGFuZ2VzLCBuID0gdC5kb2NDaGFuZ2VzO1xuICAgICAgICBpZiAoZS5sZW5ndGggIT09IG4ubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgZS5sZW5ndGg7IHQrKykgaWYgKGVbdF0udHlwZSAhPT0gblt0XS50eXBlIHx8ICFlW3RdLmRvYy5pc0VxdWFsKG5bdF0uZG9jKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIb2xkcyB0aGUgbGlzdGVuZXJzIGFuZCB0aGUgbGFzdCByZWNlaXZlZCBWaWV3U25hcHNob3QgZm9yIGEgcXVlcnkgYmVpbmdcbiAqIHRyYWNrZWQgYnkgRXZlbnRNYW5hZ2VyLlxuICovIGNsYXNzIFV1IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5BdSA9IHZvaWQgMCwgdGhpcy5saXN0ZW5lcnMgPSBbXTtcbiAgICB9XG59XG5cbmNsYXNzIHF1IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gbmV3IGVzKCh0ID0+IGxuKHQpKSwgaG4pLCB0aGlzLm9ubGluZVN0YXRlID0gXCJVbmtub3duXCIgLyogVW5rbm93biAqLyAsIFxuICAgICAgICB0aGlzLlJ1ID0gbmV3IFNldDtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEt1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KSwgcyA9IGUucXVlcnk7XG4gICAgbGV0IGkgPSAhMSwgciA9IG4ucXVlcmllcy5nZXQocyk7XG4gICAgaWYgKHIgfHwgKGkgPSAhMCwgciA9IG5ldyBVdSksIGkpIHRyeSB7XG4gICAgICAgIHIuQXUgPSBhd2FpdCBuLm9uTGlzdGVuKHMpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgY29uc3QgbiA9IEZ1KHQsIGBJbml0aWFsaXphdGlvbiBvZiBxdWVyeSAnJHtmbihlLnF1ZXJ5KX0nIGZhaWxlZGApO1xuICAgICAgICByZXR1cm4gdm9pZCBlLm9uRXJyb3Iobik7XG4gICAgfVxuICAgIGlmIChuLnF1ZXJpZXMuc2V0KHMsIHIpLCByLmxpc3RlbmVycy5wdXNoKGUpLCBcbiAgICAvLyBSdW4gZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyBpZiBhIGNvbnNpc3RlbnQgc25hcHNob3QgaGFzIGJlZW4gZW1pdHRlZC5cbiAgICBlLmJ1KG4ub25saW5lU3RhdGUpLCByLkF1KSB7XG4gICAgICAgIGUuUHUoci5BdSkgJiYgV3Uobik7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBHdSh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCksIHMgPSBlLnF1ZXJ5O1xuICAgIGxldCBpID0gITE7XG4gICAgY29uc3QgciA9IG4ucXVlcmllcy5nZXQocyk7XG4gICAgaWYgKHIpIHtcbiAgICAgICAgY29uc3QgdCA9IHIubGlzdGVuZXJzLmluZGV4T2YoZSk7XG4gICAgICAgIHQgPj0gMCAmJiAoci5saXN0ZW5lcnMuc3BsaWNlKHQsIDEpLCBpID0gMCA9PT0gci5saXN0ZW5lcnMubGVuZ3RoKTtcbiAgICB9XG4gICAgaWYgKGkpIHJldHVybiBuLnF1ZXJpZXMuZGVsZXRlKHMpLCBuLm9uVW5saXN0ZW4ocyk7XG59XG5cbmZ1bmN0aW9uIFF1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KTtcbiAgICBsZXQgcyA9ICExO1xuICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnF1ZXJ5LCBpID0gbi5xdWVyaWVzLmdldChlKTtcbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpLmxpc3RlbmVycykgZS5QdSh0KSAmJiAocyA9ICEwKTtcbiAgICAgICAgICAgIGkuQXUgPSB0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHMgJiYgV3Uobik7XG59XG5cbmZ1bmN0aW9uIGp1KHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gJCh0KSwgaSA9IHMucXVlcmllcy5nZXQoZSk7XG4gICAgaWYgKGkpIGZvciAoY29uc3QgdCBvZiBpLmxpc3RlbmVycykgdC5vbkVycm9yKG4pO1xuICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzLiBOT1RFOiBXZSBkb24ndCBuZWVkIHRvIGNhbGwgc3luY0VuZ2luZS51bmxpc3RlbigpXG4gICAgLy8gYWZ0ZXIgYW4gZXJyb3IuXG4gICAgICAgIHMucXVlcmllcy5kZWxldGUoZSk7XG59XG5cbi8vIENhbGwgYWxsIGdsb2JhbCBzbmFwc2hvdCBsaXN0ZW5lcnMgdGhhdCBoYXZlIGJlZW4gc2V0LlxuZnVuY3Rpb24gV3UodCkge1xuICAgIHQuUnUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgIHQubmV4dCgpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBRdWVyeUxpc3RlbmVyIHRha2VzIGEgc2VyaWVzIG9mIGludGVybmFsIHZpZXcgc25hcHNob3RzIGFuZCBkZXRlcm1pbmVzXG4gKiB3aGVuIHRvIHJhaXNlIHRoZSBldmVudC5cbiAqXG4gKiBJdCB1c2VzIGFuIE9ic2VydmVyIHRvIGRpc3BhdGNoIGV2ZW50cy5cbiAqLyBjbGFzcyB6dSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy52dSA9IGUsIFxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbCBzbmFwc2hvdHMgKGUuZy4gZnJvbSBjYWNoZSkgbWF5IG5vdCBiZSBwcm9wYWdhdGVkIHRvIHRoZSB3cmFwcGVkXG4gICAgICAgICAqIG9ic2VydmVyLiBUaGlzIGZsYWcgaXMgc2V0IHRvIHRydWUgb25jZSB3ZSd2ZSBhY3R1YWxseSByYWlzZWQgYW4gZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlZ1ID0gITEsIHRoaXMuU3UgPSBudWxsLCB0aGlzLm9ubGluZVN0YXRlID0gXCJVbmtub3duXCIgLyogVW5rbm93biAqLyAsIHRoaXMub3B0aW9ucyA9IG4gfHwge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIG5ldyBWaWV3U25hcHNob3QgdG8gdGhpcyBsaXN0ZW5lciwgcmFpc2luZyBhIHVzZXItZmFjaW5nIGV2ZW50XG4gICAgICogaWYgYXBwbGljYWJsZSAoZGVwZW5kaW5nIG9uIHdoYXQgY2hhbmdlZCwgd2hldGhlciB0aGUgdXNlciBoYXMgb3B0ZWQgaW50b1xuICAgICAqIG1ldGFkYXRhLW9ubHkgY2hhbmdlcywgZXRjLikuIFJldHVybnMgdHJ1ZSBpZiBhIHVzZXItZmFjaW5nIGV2ZW50IHdhc1xuICAgICAqIGluZGVlZCByYWlzZWQuXG4gICAgICovICAgIFB1KHQpIHtcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcykge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBtZXRhZGF0YSBvbmx5IGNoYW5nZXMuXG4gICAgICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5kb2NDaGFuZ2VzKSAzIC8qIE1ldGFkYXRhICovICE9PSBuLnR5cGUgJiYgZS5wdXNoKG4pO1xuICAgICAgICAgICAgdCA9IG5ldyBMdSh0LnF1ZXJ5LCB0LmRvY3MsIHQub2xkRG9jcywgZSwgdC5tdXRhdGVkS2V5cywgdC5mcm9tQ2FjaGUsIHQuc3luY1N0YXRlQ2hhbmdlZCwgXG4gICAgICAgICAgICAvKiBleGNsdWRlc01ldGFkYXRhQ2hhbmdlcz0gKi8gITAsIHQuaGFzQ2FjaGVkUmVzdWx0cyk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuVnUgPyB0aGlzLkR1KHQpICYmICh0aGlzLnZ1Lm5leHQodCksIGUgPSAhMCkgOiB0aGlzLkN1KHQsIHRoaXMub25saW5lU3RhdGUpICYmICh0aGlzLnh1KHQpLCBcbiAgICAgICAgZSA9ICEwKSwgdGhpcy5TdSA9IHQsIGU7XG4gICAgfVxuICAgIG9uRXJyb3IodCkge1xuICAgICAgICB0aGlzLnZ1LmVycm9yKHQpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIGEgc25hcHNob3Qgd2FzIHJhaXNlZC4gKi8gICAgYnUodCkge1xuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gdDtcbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuU3UgJiYgIXRoaXMuVnUgJiYgdGhpcy5DdSh0aGlzLlN1LCB0KSAmJiAodGhpcy54dSh0aGlzLlN1KSwgZSA9ICEwKSwgXG4gICAgICAgIGU7XG4gICAgfVxuICAgIEN1KHQsIGUpIHtcbiAgICAgICAgLy8gQWx3YXlzIHJhaXNlIHRoZSBmaXJzdCBldmVudCB3aGVuIHdlJ3JlIHN5bmNlZFxuICAgICAgICBpZiAoIXQuZnJvbUNhY2hlKSByZXR1cm4gITA7XG4gICAgICAgIC8vIE5PVEU6IFdlIGNvbnNpZGVyIE9ubGluZVN0YXRlLlVua25vd24gYXMgb25saW5lIChpdCBzaG91bGQgYmVjb21lIE9mZmxpbmVcbiAgICAgICAgLy8gb3IgT25saW5lIGlmIHdlIHdhaXQgbG9uZyBlbm91Z2gpLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovICE9PSBlO1xuICAgICAgICAvLyBEb24ndCByYWlzZSB0aGUgZXZlbnQgaWYgd2UncmUgb25saW5lLCBhcmVuJ3Qgc3luY2VkIHlldCAoY2hlY2tlZFxuICAgICAgICAvLyBhYm92ZSkgYW5kIGFyZSB3YWl0aW5nIGZvciBhIHN5bmMuXG4gICAgICAgICAgICAgICAgcmV0dXJuICghdGhpcy5vcHRpb25zLk51IHx8ICFuKSAmJiAoIXQuZG9jcy5pc0VtcHR5KCkgfHwgdC5oYXNDYWNoZWRSZXN1bHRzIHx8IFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8gPT09IGUpO1xuICAgICAgICAvLyBSYWlzZSBkYXRhIGZyb20gY2FjaGUgaWYgd2UgaGF2ZSBhbnkgZG9jdW1lbnRzLCBoYXZlIGNhY2hlZCByZXN1bHRzIGJlZm9yZSxcbiAgICAgICAgLy8gb3Igd2UgYXJlIG9mZmxpbmUuXG4gICAgICAgIH1cbiAgICBEdSh0KSB7XG4gICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gaGFuZGxlIGluY2x1ZGVEb2N1bWVudE1ldGFkYXRhQ2hhbmdlcyBoZXJlIGJlY2F1c2VcbiAgICAgICAgLy8gdGhlIE1ldGFkYXRhIG9ubHkgY2hhbmdlcyBoYXZlIGFscmVhZHkgYmVlbiBzdHJpcHBlZCBvdXQgaWYgbmVlZGVkLlxuICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHRoZSBvbmx5IGNoYW5nZXMgd2Ugd2lsbCBzZWUgYXJlIHRoZSBvbmVzIHdlIHNob3VsZFxuICAgICAgICAvLyBwcm9wYWdhdGUuXG4gICAgICAgIGlmICh0LmRvY0NoYW5nZXMubGVuZ3RoID4gMCkgcmV0dXJuICEwO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5TdSAmJiB0aGlzLlN1Lmhhc1BlbmRpbmdXcml0ZXMgIT09IHQuaGFzUGVuZGluZ1dyaXRlcztcbiAgICAgICAgcmV0dXJuICEoIXQuc3luY1N0YXRlQ2hhbmdlZCAmJiAhZSkgJiYgITAgPT09IHRoaXMub3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzO1xuICAgICAgICAvLyBHZW5lcmFsbHkgd2Ugc2hvdWxkIGhhdmUgaGl0IG9uZSBvZiB0aGUgY2FzZXMgYWJvdmUsIGJ1dCBpdCdzIHBvc3NpYmxlXG4gICAgICAgIC8vIHRvIGdldCBoZXJlIGlmIHRoZXJlIHdlcmUgb25seSBtZXRhZGF0YSBkb2NDaGFuZ2VzIGFuZCB0aGV5IGdvdFxuICAgICAgICAvLyBzdHJpcHBlZCBvdXQuXG4gICAgICAgIH1cbiAgICB4dSh0KSB7XG4gICAgICAgIHQgPSBMdS5mcm9tSW5pdGlhbERvY3VtZW50cyh0LnF1ZXJ5LCB0LmRvY3MsIHQubXV0YXRlZEtleXMsIHQuZnJvbUNhY2hlLCB0Lmhhc0NhY2hlZFJlc3VsdHMpLCBcbiAgICAgICAgdGhpcy5WdSA9ICEwLCB0aGlzLnZ1Lm5leHQodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNvbXBsZXRlIGVsZW1lbnQgaW4gdGhlIGJ1bmRsZSBzdHJlYW0sIHRvZ2V0aGVyIHdpdGggdGhlIGJ5dGUgbGVuZ3RoIGl0XG4gKiBvY2N1cGllcyBpbiB0aGUgc3RyZWFtLlxuICovIGNsYXNzIEh1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvLyBIb3cgbWFueSBieXRlcyB0aGlzIGVsZW1lbnQgdGFrZXMgdG8gc3RvcmUgaW4gdGhlIGJ1bmRsZS5cbiAgICBlKSB7XG4gICAgICAgIHRoaXMua3UgPSB0LCB0aGlzLmJ5dGVMZW5ndGggPSBlO1xuICAgIH1cbiAgICBPdSgpIHtcbiAgICAgICAgcmV0dXJuIFwibWV0YWRhdGFcIiBpbiB0aGlzLmt1O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSGVscGVyIHRvIGNvbnZlcnQgb2JqZWN0cyBmcm9tIGJ1bmRsZXMgdG8gbW9kZWwgb2JqZWN0cyBpbiB0aGUgU0RLLlxuICovIGNsYXNzIEp1IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuSXQgPSB0O1xuICAgIH1cbiAgICBKaSh0KSB7XG4gICAgICAgIHJldHVybiBrcyh0aGlzLkl0LCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBCdW5kbGVEb2N1bWVudCB0byBhIE11dGFibGVEb2N1bWVudC5cbiAgICAgKi8gICAgWWkodCkge1xuICAgICAgICByZXR1cm4gdC5tZXRhZGF0YS5leGlzdHMgPyBMcyh0aGlzLkl0LCB0LmRvY3VtZW50LCAhMSkgOiBTZS5uZXdOb0RvY3VtZW50KHRoaXMuSmkodC5tZXRhZGF0YS5uYW1lKSwgdGhpcy5YaSh0Lm1ldGFkYXRhLnJlYWRUaW1lKSk7XG4gICAgfVxuICAgIFhpKHQpIHtcbiAgICAgICAgcmV0dXJuIERzKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGNsYXNzIHRvIHByb2Nlc3MgdGhlIGVsZW1lbnRzIGZyb20gYSBidW5kbGUsIGxvYWQgdGhlbSBpbnRvIGxvY2FsXG4gKiBzdG9yYWdlIGFuZCBwcm92aWRlIHByb2dyZXNzIHVwZGF0ZSB3aGlsZSBsb2FkaW5nLlxuICovIGNsYXNzIFl1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuTXUgPSB0LCB0aGlzLmxvY2FsU3RvcmUgPSBlLCB0aGlzLkl0ID0gbiwgXG4gICAgICAgIC8qKiBCYXRjaGVkIHF1ZXJpZXMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMucXVlcmllcyA9IFtdLCBcbiAgICAgICAgLyoqIEJhdGNoZWQgZG9jdW1lbnRzIHRvIGJlIHNhdmVkIGludG8gc3RvcmFnZSAqL1xuICAgICAgICB0aGlzLmRvY3VtZW50cyA9IFtdLCBcbiAgICAgICAgLyoqIFRoZSBjb2xsZWN0aW9uIGdyb3VwcyBhZmZlY3RlZCBieSB0aGlzIGJ1bmRsZS4gKi9cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uR3JvdXBzID0gbmV3IFNldCwgdGhpcy5wcm9ncmVzcyA9IFh1KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGVsZW1lbnQgZnJvbSB0aGUgYnVuZGxlIHRvIHRoZSBsb2FkZXIuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHByb2dyZXNzIGlmIGFkZGluZyB0aGUgZWxlbWVudCBsZWFkcyB0byBhIG5ldyBwcm9ncmVzcyxcbiAgICAgKiBvdGhlcndpc2UgcmV0dXJucyBudWxsLlxuICAgICAqLyAgICBGdSh0KSB7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3MuYnl0ZXNMb2FkZWQgKz0gdC5ieXRlTGVuZ3RoO1xuICAgICAgICBsZXQgZSA9IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkO1xuICAgICAgICBpZiAodC5rdS5uYW1lZFF1ZXJ5KSB0aGlzLnF1ZXJpZXMucHVzaCh0Lmt1Lm5hbWVkUXVlcnkpOyBlbHNlIGlmICh0Lmt1LmRvY3VtZW50TWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB0Lmt1LmRvY3VtZW50TWV0YWRhdGFcbiAgICAgICAgICAgIH0pLCB0Lmt1LmRvY3VtZW50TWV0YWRhdGEuZXhpc3RzIHx8ICsrZTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBydC5mcm9tU3RyaW5nKHQua3UuZG9jdW1lbnRNZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbkdyb3Vwcy5hZGQobi5nZXQobi5sZW5ndGggLSAyKSk7XG4gICAgICAgIH0gZWxzZSB0Lmt1LmRvY3VtZW50ICYmICh0aGlzLmRvY3VtZW50c1t0aGlzLmRvY3VtZW50cy5sZW5ndGggLSAxXS5kb2N1bWVudCA9IHQua3UuZG9jdW1lbnQsIFxuICAgICAgICArK2UpO1xuICAgICAgICByZXR1cm4gZSAhPT0gdGhpcy5wcm9ncmVzcy5kb2N1bWVudHNMb2FkZWQgPyAodGhpcy5wcm9ncmVzcy5kb2N1bWVudHNMb2FkZWQgPSBlLCBcbiAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wcm9ncmVzcykpIDogbnVsbDtcbiAgICB9XG4gICAgJHUodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IE1hcCwgbiA9IG5ldyBKdSh0aGlzLkl0KTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIGlmIChzLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLkppKHMubWV0YWRhdGEubmFtZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2Ygcy5tZXRhZGF0YS5xdWVyaWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IChlLmdldChuKSB8fCBmcygpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgZS5zZXQobiwgcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgdG8gJ1N1Y2Nlc3MnIGFuZCByZXR1cm4gdGhlIHVwZGF0ZWQgcHJvZ3Jlc3MuXG4gICAgICovICAgIGFzeW5jIGNvbXBsZXRlKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQga28odGhpcy5sb2NhbFN0b3JlLCBuZXcgSnUodGhpcy5JdCksIHRoaXMuZG9jdW1lbnRzLCB0aGlzLk11LmlkKSwgZSA9IHRoaXMuJHUodGhpcy5kb2N1bWVudHMpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5xdWVyaWVzKSBhd2FpdCBPbyh0aGlzLmxvY2FsU3RvcmUsIHQsIGUuZ2V0KHQubmFtZSkpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9ncmVzcy50YXNrU3RhdGUgPSBcIlN1Y2Nlc3NcIiwge1xuICAgICAgICAgICAgcHJvZ3Jlc3M6IHRoaXMucHJvZ3Jlc3MsXG4gICAgICAgICAgICBCdTogdGhpcy5jb2xsZWN0aW9uR3JvdXBzLFxuICAgICAgICAgICAgTHU6IHRcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCByZXByZXNlbnRpbmcgdGhlIGluaXRpYWwgcHJvZ3Jlc3Mgb2ZcbiAqIGxvYWRpbmcgYSBidW5kbGUuXG4gKi8gZnVuY3Rpb24gWHUodCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRhc2tTdGF0ZTogXCJSdW5uaW5nXCIsXG4gICAgICAgIGRvY3VtZW50c0xvYWRlZDogMCxcbiAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgIHRvdGFsRG9jdW1lbnRzOiB0LnRvdGFsRG9jdW1lbnRzLFxuICAgICAgICB0b3RhbEJ5dGVzOiB0LnRvdGFsQnl0ZXNcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBgTG9hZEJ1bmRsZVRhc2tQcm9ncmVzc2AgcmVwcmVzZW50aW5nIHRoZSBwcm9ncmVzcyB0aGF0IHRoZSBsb2FkaW5nXG4gKiBoYXMgc3VjY2VlZGVkLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgWnUge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0O1xuICAgIH1cbn1cblxuY2xhc3MgdGMge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBWaWV3IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wdXRpbmcgdGhlIGZpbmFsIG1lcmdlZCB0cnV0aCBvZiB3aGF0IGRvY3MgYXJlIGluXG4gKiBhIHF1ZXJ5LiBJdCBnZXRzIG5vdGlmaWVkIG9mIGxvY2FsIGFuZCByZW1vdGUgY2hhbmdlcyB0byBkb2NzLCBhbmQgYXBwbGllc1xuICogdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdCBwb3NzaWJsZSByZXN1bHRzLlxuICovIGNsYXNzIGVjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvKiogRG9jdW1lbnRzIGluY2x1ZGVkIGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy5VdSA9IGUsIHRoaXMucXUgPSBudWxsLCB0aGlzLmhhc0NhY2hlZFJlc3VsdHMgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGZsYWcgd2hldGhlciB0aGUgdmlldyBpcyBjdXJyZW50IHdpdGggdGhlIGJhY2tlbmQuIEEgdmlldyBpcyBjb25zaWRlcmVkXG4gICAgICAgICAqIGN1cnJlbnQgYWZ0ZXIgaXQgaGFzIHNlZW4gdGhlIGN1cnJlbnQgZmxhZyBmcm9tIHRoZSBiYWNrZW5kIGFuZCBkaWQgbm90XG4gICAgICAgICAqIGxvc2UgY29uc2lzdGVuY3kgd2l0aGluIHRoZSB3YXRjaCBzdHJlYW0gKGUuZy4gYmVjYXVzZSBvZiBhbiBleGlzdGVuY2VcbiAgICAgICAgICogZmlsdGVyIG1pc21hdGNoKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3VycmVudCA9ICExLCBcbiAgICAgICAgLyoqIERvY3VtZW50cyBpbiB0aGUgdmlldyBidXQgbm90IGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXG4gICAgICAgIHRoaXMuS3UgPSBmcygpLCBcbiAgICAgICAgLyoqIERvY3VtZW50IEtleXMgdGhhdCBoYXZlIGxvY2FsIGNoYW5nZXMgKi9cbiAgICAgICAgdGhpcy5tdXRhdGVkS2V5cyA9IGZzKCksIHRoaXMuR3UgPSB3bih0KSwgdGhpcy5RdSA9IG5ldyAkdSh0aGlzLkd1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiByZW1vdGUgZG9jdW1lbnRzIHRoYXQgdGhlIHNlcnZlciBoYXMgdG9sZCB1cyBiZWxvbmdzIHRvIHRoZSB0YXJnZXQgYXNzb2NpYXRlZCB3aXRoXG4gICAgICogdGhpcyB2aWV3LlxuICAgICAqLyAgICBnZXQganUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlV1O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGEgc2V0IG9mIGRvYyBjaGFuZ2VzLCBhcHBsaWVzIHRoZSBxdWVyeSBsaW1pdCwgYW5kIGNvbXB1dGVzXG4gICAgICogd2hhdCB0aGUgbmV3IHJlc3VsdHMgc2hvdWxkIGJlLCB3aGF0IHRoZSBjaGFuZ2VzIHdlcmUsIGFuZCB3aGV0aGVyIHdlIG1heVxuICAgICAqIG5lZWQgdG8gZ28gYmFjayB0byB0aGUgbG9jYWwgY2FjaGUgZm9yIG1vcmUgcmVzdWx0cy4gRG9lcyBub3QgbWFrZSBhbnlcbiAgICAgKiBjaGFuZ2VzIHRvIHRoZSB2aWV3LlxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIC0gVGhlIGRvYyBjaGFuZ2VzIHRvIGFwcGx5IHRvIHRoaXMgdmlldy5cbiAgICAgKiBAcGFyYW0gcHJldmlvdXNDaGFuZ2VzIC0gSWYgdGhpcyBpcyBiZWluZyBjYWxsZWQgd2l0aCBhIHJlZmlsbCwgdGhlbiBzdGFydFxuICAgICAqICAgICAgICB3aXRoIHRoaXMgc2V0IG9mIGRvY3MgYW5kIGNoYW5nZXMgaW5zdGVhZCBvZiB0aGUgY3VycmVudCB2aWV3LlxuICAgICAqIEByZXR1cm5zIGEgbmV3IHNldCBvZiBkb2NzLCBjaGFuZ2VzLCBhbmQgcmVmaWxsIGZsYWcuXG4gICAgICovICAgIFd1KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgPyBlLnp1IDogbmV3IEJ1LCBzID0gZSA/IGUuUXUgOiB0aGlzLlF1O1xuICAgICAgICBsZXQgaSA9IGUgPyBlLm11dGF0ZWRLZXlzIDogdGhpcy5tdXRhdGVkS2V5cywgciA9IHMsIG8gPSAhMTtcbiAgICAgICAgLy8gVHJhY2sgdGhlIGxhc3QgZG9jIGluIGEgKGZ1bGwpIGxpbWl0LiBUaGlzIGlzIG5lY2Vzc2FyeSwgYmVjYXVzZSBzb21lXG4gICAgICAgIC8vIHVwZGF0ZSAoYSBkZWxldGUsIG9yIGFuIHVwZGF0ZSBtb3ZpbmcgYSBkb2MgcGFzdCB0aGUgb2xkIGxpbWl0KSBtaWdodFxuICAgICAgICAvLyBtZWFuIHRoZXJlIGlzIHNvbWUgb3RoZXIgZG9jdW1lbnQgaW4gdGhlIGxvY2FsIGNhY2hlIHRoYXQgZWl0aGVyIHNob3VsZFxuICAgICAgICAvLyBjb21lICgxKSBiZXR3ZWVuIHRoZSBvbGQgbGFzdCBsaW1pdCBkb2MgYW5kIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlXG4gICAgICAgIC8vIGNhc2Ugb2YgdXBkYXRlcywgb3IgKDIpIGFmdGVyIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlIGNhc2Ugb2ZcbiAgICAgICAgLy8gZGVsZXRlcy4gU28gd2Uga2VlcCB0aGlzIGRvYyBhdCB0aGUgb2xkIGxpbWl0IHRvIGNvbXBhcmUgdGhlIHVwZGF0ZXMgdG8uXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGlzIHNob3VsZCBuZXZlciBnZXQgdXNlZCBpbiBhIHJlZmlsbCAod2hlbiBwcmV2aW91c0NoYW5nZXMgaXNcbiAgICAgICAgLy8gc2V0KSwgYmVjYXVzZSB0aGVyZSB3aWxsIG9ubHkgYmUgYWRkcyAtLSBubyBkZWxldGVzIG9yIHVwZGF0ZXMuXG4gICAgICAgIGNvbnN0IHUgPSBcIkZcIiAvKiBGaXJzdCAqLyA9PT0gdGhpcy5xdWVyeS5saW1pdFR5cGUgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5sYXN0KCkgOiBudWxsLCBjID0gXCJMXCIgLyogTGFzdCAqLyA9PT0gdGhpcy5xdWVyeS5saW1pdFR5cGUgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5maXJzdCgpIDogbnVsbDtcbiAgICAgICAgLy8gRHJvcCBkb2N1bWVudHMgb3V0IHRvIG1lZXQgbGltaXQvbGltaXRUb0xhc3QgcmVxdWlyZW1lbnQuXG4gICAgICAgIGlmICh0Lmlub3JkZXJUcmF2ZXJzYWwoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhID0gcy5nZXQodCksIGggPSBkbih0aGlzLnF1ZXJ5LCBlKSA/IGUgOiBudWxsLCBsID0gISFhICYmIHRoaXMubXV0YXRlZEtleXMuaGFzKGEua2V5KSwgZiA9ICEhaCAmJiAoaC5oYXNMb2NhbE11dGF0aW9ucyB8fCBcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgY29tbWl0dGVkIG11dGF0aW9ucyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZVxuICAgICAgICAgICAgLy8gbXV0YXRlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRoZSB2aWV3LlxuICAgICAgICAgICAgdGhpcy5tdXRhdGVkS2V5cy5oYXMoaC5rZXkpICYmIGguaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICAgICAgICAgIGxldCBkID0gITE7XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYSAmJiBoKSB7XG4gICAgICAgICAgICAgICAgYS5kYXRhLmlzRXF1YWwoaC5kYXRhKSA/IGwgIT09IGYgJiYgKG4udHJhY2soe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAzIC8qIE1ldGFkYXRhICovICxcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBoXG4gICAgICAgICAgICAgICAgfSksIGQgPSAhMCkgOiB0aGlzLkh1KGEsIGgpIHx8IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgICAgIH0pLCBkID0gITAsICh1ICYmIHRoaXMuR3UoaCwgdSkgPiAwIHx8IGMgJiYgdGhpcy5HdShoLCBjKSA8IDApICYmIChcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGRvYyBtb3ZlZCBmcm9tIGluc2lkZSB0aGUgbGltaXQgdG8gb3V0c2lkZSB0aGUgbGltaXQuXG4gICAgICAgICAgICAgICAgLy8gVGhhdCBtZWFucyB0aGVyZSBtYXkgYmUgc29tZSBvdGhlciBkb2MgaW4gdGhlIGxvY2FsIGNhY2hlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBvID0gITApKTtcbiAgICAgICAgICAgIH0gZWxzZSAhYSAmJiBoID8gKG4udHJhY2soe1xuICAgICAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgfSksIGQgPSAhMCkgOiBhICYmICFoICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAxIC8qIFJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogYVxuICAgICAgICAgICAgfSksIGQgPSAhMCwgKHUgfHwgYykgJiYgKFxuICAgICAgICAgICAgLy8gQSBkb2Mgd2FzIHJlbW92ZWQgZnJvbSBhIGZ1bGwgbGltaXQgcXVlcnkuIFdlJ2xsIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIHJlcXVlcnkgZnJvbSB0aGUgbG9jYWwgY2FjaGUgdG8gc2VlIGlmIHdlIGtub3cgYWJvdXQgc29tZSBvdGhlclxuICAgICAgICAgICAgLy8gZG9jIHRoYXQgc2hvdWxkIGJlIGluIHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICBkICYmIChoID8gKHIgPSByLmFkZChoKSwgaSA9IGYgPyBpLmFkZCh0KSA6IGkuZGVsZXRlKHQpKSA6IChyID0gci5kZWxldGUodCksIGkgPSBpLmRlbGV0ZSh0KSkpO1xuICAgICAgICB9KSksIG51bGwgIT09IHRoaXMucXVlcnkubGltaXQpIGZvciAoO3Iuc2l6ZSA+IHRoaXMucXVlcnkubGltaXQ7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IFwiRlwiIC8qIEZpcnN0ICovID09PSB0aGlzLnF1ZXJ5LmxpbWl0VHlwZSA/IHIubGFzdCgpIDogci5maXJzdCgpO1xuICAgICAgICAgICAgciA9IHIuZGVsZXRlKHQua2V5KSwgaSA9IGkuZGVsZXRlKHQua2V5KSwgbi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBRdTogcixcbiAgICAgICAgICAgIHp1OiBuLFxuICAgICAgICAgICAgJGk6IG8sXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogaVxuICAgICAgICB9O1xuICAgIH1cbiAgICBIdSh0LCBlKSB7XG4gICAgICAgIC8vIFdlIHN1cHByZXNzIHRoZSBpbml0aWFsIGNoYW5nZSBldmVudCBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSBtb2RpZmllZCBhc1xuICAgICAgICAvLyBwYXJ0IG9mIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgKGUuZy4gd2hlbiB0aGUgdmFsdWUgb2YgYSBzZXJ2ZXIgdHJhbnNmb3JtXG4gICAgICAgIC8vIGlzIGFwcGxpZWQpIGFzIFdhdGNoIHdpbGwgc2VuZCB1cyB0aGUgc2FtZSBkb2N1bWVudCBhZ2Fpbi5cbiAgICAgICAgLy8gQnkgc3VwcHJlc3NpbmcgdGhlIGV2ZW50LCB3ZSBvbmx5IHJhaXNlIHR3byB1c2VyIHZpc2libGUgZXZlbnRzIChvbmUgd2l0aFxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpIGluc3RlYWQgb2YgdGhyZWVcbiAgICAgICAgLy8gKG9uZSB3aXRoIGBoYXNQZW5kaW5nV3JpdGVzYCwgdGhlIG1vZGlmaWVkIGRvY3VtZW50IHdpdGhcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KS5cbiAgICAgICAgcmV0dXJuIHQuaGFzTG9jYWxNdXRhdGlvbnMgJiYgZS5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiYgIWUuaGFzTG9jYWxNdXRhdGlvbnM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHZpZXcgd2l0aCB0aGUgZ2l2ZW4gVmlld0RvY3VtZW50Q2hhbmdlcyBhbmQgb3B0aW9uYWxseSB1cGRhdGVzXG4gICAgICogbGltYm8gZG9jcyBhbmQgc3luYyBzdGF0ZSBmcm9tIHRoZSBwcm92aWRlZCB0YXJnZXQgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIC0gVGhlIHNldCBvZiBjaGFuZ2VzIHRvIG1ha2UgdG8gdGhlIHZpZXcncyBkb2NzLlxuICAgICAqIEBwYXJhbSB1cGRhdGVMaW1ib0RvY3VtZW50cyAtIFdoZXRoZXIgdG8gdXBkYXRlIGxpbWJvIGRvY3VtZW50cyBiYXNlZCBvblxuICAgICAqICAgICAgICB0aGlzIGNoYW5nZS5cbiAgICAgKiBAcGFyYW0gdGFyZ2V0Q2hhbmdlIC0gQSB0YXJnZXQgY2hhbmdlIHRvIGFwcGx5IGZvciBjb21wdXRpbmcgbGltYm8gZG9jcyBhbmRcbiAgICAgKiAgICAgICAgc3luYyBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyBBIG5ldyBWaWV3Q2hhbmdlIHdpdGggdGhlIGdpdmVuIGRvY3MsIGNoYW5nZXMsIGFuZCBzeW5jIHN0YXRlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIGlPUy9BbmRyb2lkIGNsaWVudHMgYWx3YXlzIGNvbXB1dGUgbGltYm8gZG9jdW1lbnQgY2hhbmdlcy5cbiAgICBhcHBseUNoYW5nZXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdGhpcy5RdTtcbiAgICAgICAgdGhpcy5RdSA9IHQuUXUsIHRoaXMubXV0YXRlZEtleXMgPSB0Lm11dGF0ZWRLZXlzO1xuICAgICAgICAvLyBTb3J0IGNoYW5nZXMgYmFzZWQgb24gdHlwZSBhbmQgcXVlcnkgY29tcGFyYXRvclxuICAgICAgICBjb25zdCBpID0gdC56dS5FdSgpO1xuICAgICAgICBpLnNvcnQoKCh0LCBlKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcblxuICAgICAgICAgICAgICAgICAgY2FzZSAyIC8qIE1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBNZXRhZGF0YSAqLyA6XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgbWV0YWRhdGEgY2hhbmdlIGlzIGNvbnZlcnRlZCB0byBhIG1vZGlmaWVkIGNoYW5nZSBhdCB0aGUgcHVibGljXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwaSBsYXllci4gIFNpbmNlIHdlIHNvcnQgYnkgZG9jdW1lbnQga2V5IGFuZCB0aGVuIGNoYW5nZSB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBtZXRhZGF0YSBhbmQgbW9kaWZpZWQgY2hhbmdlcyBtdXN0IGJlIHNvcnRlZCBlcXVpdmFsZW50bHkuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbih0KSAtIG4oZSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQudHlwZSwgZS50eXBlKSB8fCB0aGlzLkd1KHQuZG9jLCBlLmRvYykpKSwgdGhpcy5KdShuKTtcbiAgICAgICAgY29uc3QgciA9IGUgPyB0aGlzLll1KCkgOiBbXSwgbyA9IDAgPT09IHRoaXMuS3Uuc2l6ZSAmJiB0aGlzLmN1cnJlbnQgPyAxIC8qIFN5bmNlZCAqLyA6IDAgLyogTG9jYWwgKi8gLCB1ID0gbyAhPT0gdGhpcy5xdTtcbiAgICAgICAgaWYgKHRoaXMucXUgPSBvLCAwICE9PSBpLmxlbmd0aCB8fCB1KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNuYXBzaG90OiBuZXcgTHUodGhpcy5xdWVyeSwgdC5RdSwgcywgaSwgdC5tdXRhdGVkS2V5cywgMCAvKiBMb2NhbCAqLyA9PT0gbywgdSwgXG4gICAgICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExLCAhIW4gJiYgbi5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwKSxcbiAgICAgICAgICAgICAgICBYdTogclxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAvLyBubyBjaGFuZ2VzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBYdTogclxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGFuIE9ubGluZVN0YXRlIGNoYW5nZSB0byB0aGUgdmlldywgcG90ZW50aWFsbHkgZ2VuZXJhdGluZyBhXG4gICAgICogVmlld0NoYW5nZSBpZiB0aGUgdmlldydzIHN5bmNTdGF0ZSBjaGFuZ2VzIGFzIGEgcmVzdWx0LlxuICAgICAqLyAgICBidSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnQgJiYgXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyA9PT0gdCA/IChcbiAgICAgICAgLy8gSWYgd2UncmUgb2ZmbGluZSwgc2V0IGBjdXJyZW50YCB0byBmYWxzZSBhbmQgdGhlbiBjYWxsIGFwcGx5Q2hhbmdlcygpXG4gICAgICAgIC8vIHRvIHJlZnJlc2ggb3VyIHN5bmNTdGF0ZSBhbmQgZ2VuZXJhdGUgYSBWaWV3Q2hhbmdlIGFzIGFwcHJvcHJpYXRlLiBXZVxuICAgICAgICAvLyBhcmUgZ3VhcmFudGVlZCB0byBnZXQgYSBuZXcgVGFyZ2V0Q2hhbmdlIHRoYXQgc2V0cyBgY3VycmVudGAgYmFjayB0b1xuICAgICAgICAvLyB0cnVlIG9uY2UgdGhlIGNsaWVudCBpcyBiYWNrIG9ubGluZS5cbiAgICAgICAgdGhpcy5jdXJyZW50ID0gITEsIHRoaXMuYXBwbHlDaGFuZ2VzKHtcbiAgICAgICAgICAgIFF1OiB0aGlzLlF1LFxuICAgICAgICAgICAgenU6IG5ldyBCdSxcbiAgICAgICAgICAgIG11dGF0ZWRLZXlzOiB0aGlzLm11dGF0ZWRLZXlzLFxuICAgICAgICAgICAgJGk6ICExXG4gICAgICAgIH0sIFxuICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gITEpKSA6IHtcbiAgICAgICAgICAgIFh1OiBbXVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGRvYyBmb3IgdGhlIGdpdmVuIGtleSBzaG91bGQgYmUgaW4gbGltYm8uXG4gICAgICovICAgIFp1KHQpIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlbW90ZSBlbmQgc2F5cyBpdCdzIHBhcnQgb2YgdGhpcyBxdWVyeSwgaXQncyBub3QgaW4gbGltYm8uXG4gICAgICAgIHJldHVybiAhdGhpcy5VdS5oYXModCkgJiYgKFxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgZG9lc24ndCB0aGluayBpdCdzIGEgcmVzdWx0LCBzbyBpdCBzaG91bGRuJ3QgYmUgaW4gbGltYm8uXG4gICAgICAgICEhdGhpcy5RdS5oYXModCkgJiYgIXRoaXMuUXUuZ2V0KHQpLmhhc0xvY2FsTXV0YXRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBzeW5jZWREb2N1bWVudHMsIGN1cnJlbnQsIGFuZCBsaW1ibyBkb2NzIGJhc2VkIG9uIHRoZSBnaXZlbiBjaGFuZ2UuXG4gICAgICogUmV0dXJucyB0aGUgbGlzdCBvZiBjaGFuZ2VzIHRvIHdoaWNoIGRvY3MgYXJlIGluIGxpbWJvLlxuICAgICAqLyAgICBKdSh0KSB7XG4gICAgICAgIHQgJiYgKHQuYWRkZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLlV1ID0gdGhpcy5VdS5hZGQodCkpKSwgdC5tb2RpZmllZERvY3VtZW50cy5mb3JFYWNoKCh0ID0+IHt9KSksIFxuICAgICAgICB0LnJlbW92ZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLlV1ID0gdGhpcy5VdS5kZWxldGUodCkpKSwgdGhpcy5jdXJyZW50ID0gdC5jdXJyZW50KTtcbiAgICB9XG4gICAgWXUoKSB7XG4gICAgICAgIC8vIFdlIGNhbiBvbmx5IGRldGVybWluZSBsaW1ibyBkb2N1bWVudHMgd2hlbiB3ZSdyZSBpbi1zeW5jIHdpdGggdGhlIHNlcnZlci5cbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnQpIHJldHVybiBbXTtcbiAgICAgICAgLy8gVE9ETyhrbGltdCk6IERvIHRoaXMgaW5jcmVtZW50YWxseSBzbyB0aGF0IGl0J3Mgbm90IHF1YWRyYXRpYyB3aGVuXG4gICAgICAgIC8vIHVwZGF0aW5nIG1hbnkgZG9jdW1lbnRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLkt1O1xuICAgICAgICB0aGlzLkt1ID0gZnMoKSwgdGhpcy5RdS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuWnUodC5rZXkpICYmICh0aGlzLkt1ID0gdGhpcy5LdS5hZGQodC5rZXkpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICAvLyBEaWZmIHRoZSBuZXcgbGltYm8gZG9jcyB3aXRoIHRoZSBvbGQgbGltYm8gZG9jcy5cbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuS3UuaGFzKHQpIHx8IGUucHVzaChuZXcgdGModCkpO1xuICAgICAgICB9KSksIHRoaXMuS3UuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICB0LmhhcyhuKSB8fCBlLnB1c2gobmV3IFp1KG4pKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiB0aGUgY3VycmVudCB2aWV3IHdpdGggdGhlIHN0YXRlIHJlYWQgZnJvbVxuICAgICAqIHBlcnNpc3RlbmNlLlxuICAgICAqXG4gICAgICogV2UgdXBkYXRlIHRoZSBxdWVyeSB2aWV3IHdoZW5ldmVyIGEgY2xpZW50J3MgcHJpbWFyeSBzdGF0dXMgY2hhbmdlczpcbiAgICAgKiAtIFdoZW4gYSBjbGllbnQgdHJhbnNpdGlvbnMgZnJvbSBwcmltYXJ5IHRvIHNlY29uZGFyeSwgaXQgY2FuIG1pc3NcbiAgICAgKiAgIExvY2FsU3RvcmFnZSB1cGRhdGVzIGFuZCBpdHMgcXVlcnkgdmlld3MgbWF5IHRlbXBvcmFyaWx5IG5vdCBiZVxuICAgICAqICAgc3luY2hyb25pemVkIHdpdGggdGhlIHN0YXRlIG9uIGRpc2suXG4gICAgICogLSBGb3Igc2Vjb25kYXJ5IHRvIHByaW1hcnkgdHJhbnNpdGlvbnMsIHRoZSBjbGllbnQgbmVlZHMgdG8gdXBkYXRlIHRoZSBsaXN0XG4gICAgICogICBvZiBgc3luY2VkRG9jdW1lbnRzYCBzaW5jZSBzZWNvbmRhcnkgY2xpZW50cyB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3NcbiAgICAgKiAgIGJhc2VkIHB1cmVseSBvbiBzeW50aGVzaXplZCBSZW1vdGVFdmVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQuZG9jdW1lbnRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSBxdWVyeSBhY2NvcmRpbmdcbiAgICAgKiB0byB0aGUgTG9jYWxTdG9yZS5cbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQucmVtb3RlS2V5cyAtIFRoZSBrZXlzIG9mIHRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGVcbiAgICAgKiBxdWVyeSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tlbmQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgVmlld0NoYW5nZSB0aGF0IHJlc3VsdGVkIGZyb20gdGhpcyBzeW5jaHJvbml6YXRpb24uXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICB0Yyh0KSB7XG4gICAgICAgIHRoaXMuVXUgPSB0LkhpLCB0aGlzLkt1ID0gZnMoKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuV3UodC5kb2N1bWVudHMpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXMoZSwgLyp1cGRhdGVMaW1ib0RvY3VtZW50cz0qLyAhMCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIHRoaXMgcXVlcnkgd2FzIGp1c3QgbGlzdGVuZWQgdG8uIENvbnRhaW5zXG4gICAgICogYSBkb2N1bWVudCBhZGQgZm9yIGV2ZXJ5IGV4aXN0aW5nIGRvY3VtZW50IGFuZCB0aGUgYGZyb21DYWNoZWAgYW5kXG4gICAgICogYGhhc1BlbmRpbmdXcml0ZXNgIHN0YXR1cyBvZiB0aGUgYWxyZWFkeSBlc3RhYmxpc2hlZCB2aWV3LlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgZWMoKSB7XG4gICAgICAgIHJldHVybiBMdS5mcm9tSW5pdGlhbERvY3VtZW50cyh0aGlzLnF1ZXJ5LCB0aGlzLlF1LCB0aGlzLm11dGF0ZWRLZXlzLCAwIC8qIExvY2FsICovID09PSB0aGlzLnF1LCB0aGlzLmhhc0NhY2hlZFJlc3VsdHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBRdWVyeVZpZXcgY29udGFpbnMgYWxsIG9mIHRoZSBkYXRhIHRoYXQgU3luY0VuZ2luZSBuZWVkcyB0byBrZWVwIHRyYWNrIG9mIGZvclxuICogYSBwYXJ0aWN1bGFyIHF1ZXJ5LlxuICovXG5jbGFzcyBuYyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHF1ZXJ5IGl0c2VsZi5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IG51bWJlciBjcmVhdGVkIGJ5IHRoZSBjbGllbnQgdGhhdCBpcyB1c2VkIGluIHRoZSB3YXRjaFxuICAgICAqIHN0cmVhbSB0byBpZGVudGlmeSB0aGlzIHF1ZXJ5LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSB2aWV3IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wdXRpbmcgdGhlIGZpbmFsIG1lcmdlZCB0cnV0aCBvZiB3aGF0XG4gICAgICogZG9jcyBhcmUgaW4gdGhlIHF1ZXJ5LiBJdCBnZXRzIG5vdGlmaWVkIG9mIGxvY2FsIGFuZCByZW1vdGUgY2hhbmdlcyxcbiAgICAgKiBhbmQgYXBwbGllcyB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0XG4gICAgICogcG9zc2libGUgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBuKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLnRhcmdldElkID0gZSwgdGhpcy52aWV3ID0gbjtcbiAgICB9XG59XG5cbi8qKiBUcmFja3MgYSBsaW1ibyByZXNvbHV0aW9uLiAqLyBjbGFzcyBzYyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IHRvIHRydWUgb25jZSB3ZSd2ZSByZWNlaXZlZCBhIGRvY3VtZW50LiBUaGlzIGlzIHVzZWQgaW5cbiAgICAgICAgICogZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCgpIGFuZCB1bHRpbWF0ZWx5IHVzZWQgYnkgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yIHRvXG4gICAgICAgICAqIGRlY2lkZSB3aGV0aGVyIGl0IG5lZWRzIHRvIG1hbnVmYWN0dXJlIGEgZGVsZXRlIGV2ZW50IGZvciB0aGUgdGFyZ2V0IG9uY2VcbiAgICAgICAgICogdGhlIHRhcmdldCBpcyBDVVJSRU5ULlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYyA9ICExO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBgU3luY0VuZ2luZWAgY29vcmRpbmF0aW5nIHdpdGggb3RoZXIgcGFydHMgb2YgU0RLLlxuICpcbiAqIFRoZSBwYXJ0cyBvZiBTeW5jRW5naW5lIHRoYXQgYWN0IGFzIGEgY2FsbGJhY2sgdG8gUmVtb3RlU3RvcmUgbmVlZCB0byBiZVxuICogcmVnaXN0ZXJlZCBpbmRpdmlkdWFsbHkuIFRoaXMgaXMgZG9uZSBpbiBgc3luY0VuZ2luZVdyaXRlKClgIGFuZFxuICogYHN5bmNFbmdpbmVMaXN0ZW4oKWAgKGFzIHdlbGwgYXMgYGFwcGx5UHJpbWFyeVN0YXRlKClgKSBhcyB0aGVzZSBtZXRob2RzXG4gKiBzZXJ2ZSBhcyBlbnRyeSBwb2ludHMgdG8gUmVtb3RlU3RvcmUncyBmdW5jdGlvbmFsaXR5LlxuICpcbiAqIE5vdGU6IHNvbWUgZmllbGQgZGVmaW5lZCBpbiB0aGlzIGNsYXNzIG1pZ2h0IGhhdmUgcHVibGljIGFjY2VzcyBsZXZlbCwgYnV0XG4gKiB0aGUgY2xhc3MgaXMgbm90IGV4cG9ydGVkIHNvIHRoZXkgYXJlIG9ubHkgYWNjZXNzaWJsZSBmcm9tIHRoaXMgbW9kdWxlLlxuICogVGhpcyBpcyB1c2VmdWwgdG8gaW1wbGVtZW50IG9wdGlvbmFsIGZlYXR1cmVzIChsaWtlIGJ1bmRsZXMpIGluIGZyZWVcbiAqIGZ1bmN0aW9ucywgc3VjaCB0aGF0IHRoZXkgYXJlIHRyZWUtc2hha2VhYmxlLlxuICovIGNsYXNzIGljIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE1hbmFnZXMgc3RhdGUgc3luY2hyb25pemF0aW9uIGluIG11bHRpLXRhYiBlbnZpcm9ubWVudHMuXG4gICAgcywgaSwgcikge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSB0LCB0aGlzLnJlbW90ZVN0b3JlID0gZSwgdGhpcy5ldmVudE1hbmFnZXIgPSBuLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gcywgXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBpLCB0aGlzLm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zID0gciwgdGhpcy5zYyA9IHt9LCB0aGlzLmljID0gbmV3IGVzKCh0ID0+IGxuKHQpKSwgaG4pLCBcbiAgICAgICAgdGhpcy5yYyA9IG5ldyBNYXAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGtleXMgb2YgZG9jdW1lbnRzIHRoYXQgYXJlIGluIGxpbWJvIGZvciB3aGljaCB3ZSBoYXZlbid0IHlldCBzdGFydGVkIGFcbiAgICAgICAgICogbGltYm8gcmVzb2x1dGlvbiBxdWVyeS4gVGhlIHN0cmluZ3MgaW4gdGhpcyBzZXQgYXJlIHRoZSByZXN1bHQgb2YgY2FsbGluZ1xuICAgICAgICAgKiBga2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKClgIHdoZXJlIGBrZXlgIGlzIGEgYERvY3VtZW50S2V5YCBvYmplY3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBgU2V0YCB0eXBlIHdhcyBjaG9zZW4gYmVjYXVzZSBpdCBwcm92aWRlcyBlZmZpY2llbnQgbG9va3VwIGFuZCByZW1vdmFsXG4gICAgICAgICAqIG9mIGFyYml0cmFyeSBlbGVtZW50cyBhbmQgaXQgYWxzbyBtYWludGFpbnMgaW5zZXJ0aW9uIG9yZGVyLCBwcm92aWRpbmcgdGhlXG4gICAgICAgICAqIGRlc2lyZWQgcXVldWUtbGlrZSBGSUZPIHNlbWFudGljcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub2MgPSBuZXcgU2V0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSB0YXJnZXQgSUQgZm9yIGVhY2ggZG9jdW1lbnQgdGhhdCBpcyBpbiBsaW1ibyB3aXRoIGFuXG4gICAgICAgICAqIGFjdGl2ZSB0YXJnZXQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnVjID0gbmV3IEJ0KGN0LmNvbXBhcmF0b3IpLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBpbmZvcm1hdGlvbiBhYm91dCBhbiBhY3RpdmUgbGltYm8gcmVzb2x1dGlvbiBmb3IgZWFjaFxuICAgICAgICAgKiBhY3RpdmUgdGFyZ2V0IElEIHRoYXQgd2FzIHN0YXJ0ZWQgZm9yIHRoZSBwdXJwb3NlIG9mIGxpbWJvIHJlc29sdXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNjID0gbmV3IE1hcCwgdGhpcy5hYyA9IG5ldyBlbywgXG4gICAgICAgIC8qKiBTdG9yZXMgdXNlciBjb21wbGV0aW9uIGhhbmRsZXJzLCBpbmRleGVkIGJ5IFVzZXIgYW5kIEJhdGNoSWQuICovXG4gICAgICAgIHRoaXMuaGMgPSB7fSwgXG4gICAgICAgIC8qKiBTdG9yZXMgdXNlciBjYWxsYmFja3Mgd2FpdGluZyBmb3IgYWxsIHBlbmRpbmcgd3JpdGVzIHRvIGJlIGFja25vd2xlZGdlZC4gKi9cbiAgICAgICAgdGhpcy5sYyA9IG5ldyBNYXAsIHRoaXMuZmMgPSBDci52bigpLCB0aGlzLm9ubGluZVN0YXRlID0gXCJVbmtub3duXCIgLyogVW5rbm93biAqLyAsIFxuICAgICAgICAvLyBUaGUgcHJpbWFyeSBzdGF0ZSBpcyBzZXQgdG8gYHRydWVgIG9yIGBmYWxzZWAgaW1tZWRpYXRlbHkgYWZ0ZXIgRmlyZXN0b3JlXG4gICAgICAgIC8vIHN0YXJ0dXAuIEluIHRoZSBpbnRlcmltLCBhIGNsaWVudCBzaG91bGQgb25seSBiZSBjb25zaWRlcmVkIHByaW1hcnkgaWZcbiAgICAgICAgLy8gYGlzUHJpbWFyeWAgaXMgdHJ1ZS5cbiAgICAgICAgdGhpcy5kYyA9IHZvaWQgMDtcbiAgICB9XG4gICAgZ2V0IGlzUHJpbWFyeUNsaWVudCgpIHtcbiAgICAgICAgcmV0dXJuICEwID09PSB0aGlzLmRjO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWF0ZXMgdGhlIG5ldyBsaXN0ZW4sIHJlc29sdmVzIHByb21pc2Ugd2hlbiBsaXN0ZW4gZW5xdWV1ZWQgdG8gdGhlXG4gKiBzZXJ2ZXIuIEFsbCB0aGUgc3Vic2VxdWVudCB2aWV3IHNuYXBzaG90cyBvciBlcnJvcnMgYXJlIHNlbnQgdG8gdGhlXG4gKiBzdWJzY3JpYmVkIGhhbmRsZXJzLiBSZXR1cm5zIHRoZSBpbml0aWFsIHNuYXBzaG90LlxuICovXG5hc3luYyBmdW5jdGlvbiByYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGtjKHQpO1xuICAgIGxldCBzLCBpO1xuICAgIGNvbnN0IHIgPSBuLmljLmdldChlKTtcbiAgICBpZiAocikgXG4gICAgLy8gUE9SVElORyBOT1RFOiBXaXRoIE11bHRpLVRhYiBXZWIsIGl0IGlzIHBvc3NpYmxlIHRoYXQgYSBxdWVyeSB2aWV3XG4gICAgLy8gYWxyZWFkeSBleGlzdHMgd2hlbiBFdmVudE1hbmFnZXIgY2FsbHMgdXMgZm9yIHRoZSBmaXJzdCB0aW1lLiBUaGlzXG4gICAgLy8gaGFwcGVucyB3aGVuIHRoZSBwcmltYXJ5IHRhYiBpcyBhbHJlYWR5IGxpc3RlbmluZyB0byB0aGlzIHF1ZXJ5IG9uXG4gICAgLy8gYmVoYWxmIG9mIGFub3RoZXIgdGFiIGFuZCB0aGUgdXNlciBvZiB0aGUgcHJpbWFyeSBhbHNvIHN0YXJ0cyBsaXN0ZW5pbmdcbiAgICAvLyB0byB0aGUgcXVlcnkuIEV2ZW50TWFuYWdlciB3aWxsIG5vdCBoYXZlIGFuIGFzc2lnbmVkIHRhcmdldCBJRCBpbiB0aGlzXG4gICAgLy8gY2FzZSBhbmQgY2FsbHMgYGxpc3RlbmAgdG8gb2J0YWluIHRoaXMgSUQuXG4gICAgcyA9IHIudGFyZ2V0SWQsIG4uc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldChzKSwgaSA9IHIudmlldy5lYygpOyBlbHNlIHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IFZvKG4ubG9jYWxTdG9yZSwgY24oZSkpO1xuICAgICAgICBuLmlzUHJpbWFyeUNsaWVudCAmJiBodShuLnJlbW90ZVN0b3JlLCB0KTtcbiAgICAgICAgY29uc3QgciA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldCh0LnRhcmdldElkKTtcbiAgICAgICAgcyA9IHQudGFyZ2V0SWQsIGkgPSBhd2FpdCBvYyhuLCBlLCBzLCBcImN1cnJlbnRcIiA9PT0gciwgdC5yZXN1bWVUb2tlbik7XG4gICAgfVxuICAgIHJldHVybiBpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBhIHZpZXcgZm9yIGEgcHJldmlvdXNseSB1bmtub3duIHF1ZXJ5IGFuZCBjb21wdXRlcyBpdHMgaW5pdGlhbFxuICogc25hcHNob3QuXG4gKi8gYXN5bmMgZnVuY3Rpb24gb2ModCwgZSwgbiwgcywgaSkge1xuICAgIC8vIFBPUlRJTkcgTk9URTogT24gV2ViIG9ubHksIHdlIGluamVjdCB0aGUgY29kZSB0aGF0IHJlZ2lzdGVycyBuZXcgTGltYm9cbiAgICAvLyB0YXJnZXRzIGJhc2VkIG9uIHZpZXcgY2hhbmdlcy4gVGhpcyBhbGxvd3MgdXMgdG8gb25seSBkZXBlbmQgb24gTGltYm9cbiAgICAvLyBjaGFuZ2VzIHdoZW4gdXNlciBjb2RlIGluY2x1ZGVzIHF1ZXJpZXMuXG4gICAgdC5fYyA9IChlLCBuLCBzKSA9PiBhc3luYyBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGxldCBpID0gZS52aWV3Lld1KG4pO1xuICAgICAgICBpLiRpICYmIChcbiAgICAgICAgLy8gVGhlIHF1ZXJ5IGhhcyBhIGxpbWl0IGFuZCBzb21lIGRvY3Mgd2VyZSByZW1vdmVkLCBzbyB3ZSBuZWVkXG4gICAgICAgIC8vIHRvIHJlLXJ1biB0aGUgcXVlcnkgYWdhaW5zdCB0aGUgbG9jYWwgc3RvcmUgdG8gbWFrZSBzdXJlIHdlXG4gICAgICAgIC8vIGRpZG4ndCBsb3NlIGFueSBnb29kIGRvY3MgdGhhdCBoYWQgYmVlbiBwYXN0IHRoZSBsaW1pdC5cbiAgICAgICAgaSA9IGF3YWl0IERvKHQubG9jYWxTdG9yZSwgZS5xdWVyeSwgXG4gICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITEpLnRoZW4oKCh7ZG9jdW1lbnRzOiB0fSkgPT4gZS52aWV3Lld1KHQsIGkpKSkpO1xuICAgICAgICBjb25zdCByID0gcyAmJiBzLnRhcmdldENoYW5nZXMuZ2V0KGUudGFyZ2V0SWQpLCBvID0gZS52aWV3LmFwcGx5Q2hhbmdlcyhpLCBcbiAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIHQuaXNQcmltYXJ5Q2xpZW50LCByKTtcbiAgICAgICAgcmV0dXJuIHBjKHQsIGUudGFyZ2V0SWQsIG8uWHUpLCBvLnNuYXBzaG90O1xuICAgIH0odCwgZSwgbiwgcyk7XG4gICAgY29uc3QgciA9IGF3YWl0IERvKHQubG9jYWxTdG9yZSwgZSwgXG4gICAgLyogdXNlUHJldmlvdXNSZXN1bHRzPSAqLyAhMCksIG8gPSBuZXcgZWMoZSwgci5IaSksIHUgPSBvLld1KHIuZG9jdW1lbnRzKSwgYyA9IG1zLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZShuLCBzICYmIFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8gIT09IHQub25saW5lU3RhdGUsIGkpLCBhID0gby5hcHBseUNoYW5nZXModSwgXG4gICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIHQuaXNQcmltYXJ5Q2xpZW50LCBjKTtcbiAgICBwYyh0LCBuLCBhLlh1KTtcbiAgICBjb25zdCBoID0gbmV3IG5jKGUsIG4sIG8pO1xuICAgIHJldHVybiB0LmljLnNldChlLCBoKSwgdC5yYy5oYXMobikgPyB0LnJjLmdldChuKS5wdXNoKGUpIDogdC5yYy5zZXQobiwgWyBlIF0pLCBhLnNuYXBzaG90O1xufVxuXG4vKiogU3RvcHMgbGlzdGVuaW5nIHRvIHRoZSBxdWVyeS4gKi8gYXN5bmMgZnVuY3Rpb24gdWModCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpLCBzID0gbi5pYy5nZXQoZSksIGkgPSBuLnJjLmdldChzLnRhcmdldElkKTtcbiAgICBpZiAoaS5sZW5ndGggPiAxKSByZXR1cm4gbi5yYy5zZXQocy50YXJnZXRJZCwgaS5maWx0ZXIoKHQgPT4gIWhuKHQsIGUpKSkpLCB2b2lkIG4uaWMuZGVsZXRlKGUpO1xuICAgIC8vIE5vIG90aGVyIHF1ZXJpZXMgYXJlIG1hcHBlZCB0byB0aGUgdGFyZ2V0LCBjbGVhbiB1cCB0aGUgcXVlcnkgYW5kIHRoZSB0YXJnZXQuXG4gICAgICAgIGlmIChuLmlzUHJpbWFyeUNsaWVudCkge1xuICAgICAgICAvLyBXZSBuZWVkIHRvIHJlbW92ZSB0aGUgbG9jYWwgcXVlcnkgdGFyZ2V0IGZpcnN0IHRvIGFsbG93IHVzIHRvIHZlcmlmeVxuICAgICAgICAvLyB3aGV0aGVyIGFueSBvdGhlciBjbGllbnQgaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGlzIHRhcmdldC5cbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHMudGFyZ2V0SWQpO1xuICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLmlzQWN0aXZlUXVlcnlUYXJnZXQocy50YXJnZXRJZCkgfHwgYXdhaXQgU28obi5sb2NhbFN0b3JlLCBzLnRhcmdldElkLCBcbiAgICAgICAgLyprZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YT0qLyAhMSkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5jbGVhclF1ZXJ5U3RhdGUocy50YXJnZXRJZCksIGx1KG4ucmVtb3RlU3RvcmUsIHMudGFyZ2V0SWQpLCBcbiAgICAgICAgICAgIGdjKG4sIHMudGFyZ2V0SWQpO1xuICAgICAgICB9KSkuY2F0Y2goRXQpO1xuICAgIH0gZWxzZSBnYyhuLCBzLnRhcmdldElkKSwgYXdhaXQgU28obi5sb2NhbFN0b3JlLCBzLnRhcmdldElkLCBcbiAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICEwKTtcbn1cblxuLyoqXG4gKiBJbml0aWF0ZXMgdGhlIHdyaXRlIG9mIGxvY2FsIG11dGF0aW9uIGJhdGNoIHdoaWNoIGludm9sdmVzIGFkZGluZyB0aGVcbiAqIHdyaXRlcyB0byB0aGUgbXV0YXRpb24gcXVldWUsIG5vdGlmeWluZyB0aGUgcmVtb3RlIHN0b3JlIGFib3V0IG5ld1xuICogbXV0YXRpb25zIGFuZCByYWlzaW5nIGV2ZW50cyBmb3IgYW55IGNoYW5nZXMgdGhpcyB3cml0ZSBjYXVzZWQuXG4gKlxuICogVGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhpcyBjYWxsIGlzIHJlc29sdmVkIHdoZW4gdGhlIGFib3ZlIHN0ZXBzXG4gKiBoYXZlIGNvbXBsZXRlZCwgKm5vdCogd2hlbiB0aGUgd3JpdGUgd2FzIGFja2VkIGJ5IHRoZSBiYWNrZW5kLiBUaGVcbiAqIHVzZXJDYWxsYmFjayBpcyByZXNvbHZlZCBvbmNlIHRoZSB3cml0ZSB3YXMgYWNrZWQvcmVqZWN0ZWQgYnkgdGhlXG4gKiBiYWNrZW5kIChvciBmYWlsZWQgbG9jYWxseSBmb3IgYW55IG90aGVyIHJlYXNvbikuXG4gKi8gYXN5bmMgZnVuY3Rpb24gY2ModCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBPYyh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9ICQodCksIHMgPSBudC5ub3coKSwgaSA9IGUucmVkdWNlKCgodCwgZSkgPT4gdC5hZGQoZS5rZXkpKSwgZnMoKSk7XG4gICAgICAgICAgICBsZXQgciwgbztcbiAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiTG9jYWxseSB3cml0ZSBtdXRhdGlvbnNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEZpZ3VyZSBvdXQgd2hpY2gga2V5cyBkbyBub3QgaGF2ZSBhIHJlbW90ZSB2ZXJzaW9uIGluIHRoZSBjYWNoZSwgdGhpc1xuICAgICAgICAgICAgICAgIC8vIGlzIG5lZWRlZCB0byBjcmVhdGUgdGhlIHJpZ2h0IG92ZXJsYXkgbXV0YXRpb246IGlmIG5vIHJlbW90ZSB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgLy8gcHJlc2VudHMsIHdlIGRvIG5vdCBuZWVkIHRvIGNyZWF0ZSBvdmVybGF5cyBhcyBwYXRjaCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhPdmVybGF5KTogSXMgdGhlcmUgYSBiZXR0ZXIgd2F5IHRvIGRldGVybWluZSB0aGlzPyBVc2luZyB0aGVcbiAgICAgICAgICAgICAgICAvLyAgZG9jdW1lbnQgdmVyc2lvbiBkb2VzIG5vdCB3b3JrIGJlY2F1c2UgbG9jYWwgbXV0YXRpb25zIHNldCB0aGVtIGJhY2tcbiAgICAgICAgICAgICAgICAvLyAgdG8gMC5cbiAgICAgICAgICAgICAgICBsZXQgdSA9IHNzKCksIGMgPSBmcygpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLkdpLmdldEVudHJpZXModCwgaSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHUgPSB0LCB1LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLmlzVmFsaWREb2N1bWVudCgpIHx8IChjID0gYy5hZGQodCkpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0T3ZlcmxheWVkRG9jdW1lbnRzKHQsIHUpKSkubmV4dCgoaSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHIgPSBpO1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3Igbm9uLWlkZW1wb3RlbnQgbXV0YXRpb25zIChzdWNoIGFzIGBGaWVsZFZhbHVlLmluY3JlbWVudCgpYCksXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIHJlY29yZCB0aGUgYmFzZSBzdGF0ZSBpbiBhIHNlcGFyYXRlIHBhdGNoIG11dGF0aW9uLiBUaGlzIGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIGxhdGVyIHVzZWQgdG8gZ3VhcmFudGVlIGNvbnNpc3RlbnQgdmFsdWVzIGFuZCBwcmV2ZW50cyBmbGlja2VyXG4gICAgICAgICAgICAgICAgICAgIC8vIGV2ZW4gaWYgdGhlIGJhY2tlbmQgc2VuZHMgdXMgYW4gdXBkYXRlIHRoYXQgYWxyZWFkeSBpbmNsdWRlcyBvdXJcbiAgICAgICAgICAgICAgICAgICAgLy8gdHJhbnNmb3JtLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gVW4odCwgci5nZXQodC5rZXkpLm92ZXJsYXllZERvY3VtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gZSAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IFRoZSBiYXNlIHN0YXRlIHNob3VsZCBvbmx5IGJlIGFwcGxpZWQgaWYgdGhlcmUncyBzb21lXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleGlzdGluZyBkb2N1bWVudCB0byBvdmVycmlkZSwgc28gdXNlIGEgUHJlY29uZGl0aW9uIG9mXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleGlzdHM9dHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgby5wdXNoKG5ldyBHbih0LmtleSwgZSwgVmUoZS52YWx1ZS5tYXBWYWx1ZSksIE9uLmV4aXN0cyghMCkpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5tdXRhdGlvblF1ZXVlLmFkZE11dGF0aW9uQmF0Y2godCwgcywgbywgZSk7XG4gICAgICAgICAgICAgICAgfSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvID0gZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IGUuYXBwbHlUb0xvY2FsRG9jdW1lbnRTZXQociwgYyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmRvY3VtZW50T3ZlcmxheUNhY2hlLnNhdmVPdmVybGF5cyh0LCBlLmJhdGNoSWQsIHMpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKS50aGVuKCgoKSA9PiAoe1xuICAgICAgICAgICAgICAgIGJhdGNoSWQ6IG8uYmF0Y2hJZCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiBvcyhyKVxuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgfShzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLmFkZFBlbmRpbmdNdXRhdGlvbih0LmJhdGNoSWQpLCBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBsZXQgcyA9IHQuaGNbdC5jdXJyZW50VXNlci50b0tleSgpXTtcbiAgICAgICAgICAgIHMgfHwgKHMgPSBuZXcgQnQoWikpO1xuICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KGUsIG4pLCB0LmhjW3QuY3VycmVudFVzZXIudG9LZXkoKV0gPSBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVzb2x2ZXMgb3IgcmVqZWN0cyB0aGUgdXNlciBjYWxsYmFjayBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCB0aGVuIGRpc2NhcmRzXG4gKiBpdC5cbiAqLyAocywgdC5iYXRjaElkLCBuKSwgYXdhaXQgRWMocywgdC5jaGFuZ2VzKSwgYXdhaXQgQXUocy5yZW1vdGVTdG9yZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICAvLyBJZiB3ZSBjYW4ndCBwZXJzaXN0IHRoZSBtdXRhdGlvbiwgd2UgcmVqZWN0IHRoZSB1c2VyIGNhbGxiYWNrIGFuZFxuICAgICAgICAvLyBkb24ndCBzZW5kIHRoZSBtdXRhdGlvbi4gVGhlIHVzZXIgY2FuIHRoZW4gcmV0cnkgdGhlIHdyaXRlLlxuICAgICAgICBjb25zdCBlID0gRnUodCwgXCJGYWlsZWQgdG8gcGVyc2lzdCB3cml0ZVwiKTtcbiAgICAgICAgbi5yZWplY3QoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgb25lIHJlbW90ZSBldmVudCB0byB0aGUgc3luYyBlbmdpbmUsIG5vdGlmeWluZyBhbnkgdmlld3Mgb2YgdGhlXG4gKiBjaGFuZ2VzLCBhbmQgcmVsZWFzaW5nIGFueSBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMgdGhhdCB3b3VsZCBiZWNvbWVcbiAqIHZpc2libGUgYmVjYXVzZSBvZiB0aGUgc25hcHNob3QgdmVyc2lvbiB0aGUgcmVtb3RlIGV2ZW50IGNvbnRhaW5zLlxuICovIGFzeW5jIGZ1bmN0aW9uIGFjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgYm8obi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVXBkYXRlIGByZWNlaXZlZERvY3VtZW50YCBhcyBhcHByb3ByaWF0ZSBmb3IgYW55IGxpbWJvIHRhcmdldHMuXG4gICAgICAgICAgICAgICAgZS50YXJnZXRDaGFuZ2VzLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5jYy5nZXQoZSk7XG4gICAgICAgICAgICBzICYmIChcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgYSBsaW1ibyByZXNvbHV0aW9uIGxvb2t1cCwgaXQncyBmb3IgYSBzaW5nbGUgZG9jdW1lbnRcbiAgICAgICAgICAgIC8vIGFuZCBpdCBjb3VsZCBiZSBhZGRlZCwgbW9kaWZpZWQsIG9yIHJlbW92ZWQsIGJ1dCBub3QgYSBjb21iaW5hdGlvbi5cbiAgICAgICAgICAgIE0odC5hZGRlZERvY3VtZW50cy5zaXplICsgdC5tb2RpZmllZERvY3VtZW50cy5zaXplICsgdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPD0gMSksIFxuICAgICAgICAgICAgdC5hZGRlZERvY3VtZW50cy5zaXplID4gMCA/IHMubmMgPSAhMCA6IHQubW9kaWZpZWREb2N1bWVudHMuc2l6ZSA+IDAgPyBNKHMubmMpIDogdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwICYmIChNKHMubmMpLCBcbiAgICAgICAgICAgIHMubmMgPSAhMSkpO1xuICAgICAgICB9KSksIGF3YWl0IEVjKG4sIHQsIGUpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgRXQodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSBzeW5jIGVuZ2luZSBhbmQgbm90aWZpZXMgYW55IHZpZXdzIG9mXG4gKiB0aGUgY2hhbmdlLlxuICovIGZ1bmN0aW9uIGhjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gJCh0KTtcbiAgICAvLyBJZiB3ZSBhcmUgdGhlIHNlY29uZGFyeSBjbGllbnQsIHdlIGV4cGxpY2l0bHkgaWdub3JlIHRoZSByZW1vdGUgc3RvcmUnc1xuICAgIC8vIG9ubGluZSBzdGF0ZSAodGhlIGxvY2FsIGNsaWVudCBtYXkgZ28gb2ZmbGluZSwgZXZlbiB0aG91Z2ggdGhlIHByaW1hcnlcbiAgICAvLyB0YWIgcmVtYWlucyBvbmxpbmUpIGFuZCBvbmx5IGFwcGx5IHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZSBmcm9tXG4gICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXG4gICAgICAgIGlmIChzLmlzUHJpbWFyeUNsaWVudCAmJiAwIC8qIFJlbW90ZVN0b3JlICovID09PSBuIHx8ICFzLmlzUHJpbWFyeUNsaWVudCAmJiAxIC8qIFNoYXJlZENsaWVudFN0YXRlICovID09PSBuKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcy5pYy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHMudmlldy5idShlKTtcbiAgICAgICAgICAgIGkuc25hcHNob3QgJiYgdC5wdXNoKGkuc25hcHNob3QpO1xuICAgICAgICB9KSksIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgICAgICAgICAgbi5vbmxpbmVTdGF0ZSA9IGU7XG4gICAgICAgICAgICBsZXQgcyA9ICExO1xuICAgICAgICAgICAgbi5xdWVyaWVzLmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4ubGlzdGVuZXJzKSBcbiAgICAgICAgICAgICAgICAvLyBSdW4gZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyBpZiBhIGNvbnNpc3RlbnQgc25hcHNob3QgaGFzIGJlZW4gZW1pdHRlZC5cbiAgICAgICAgICAgICAgICB0LmJ1KGUpICYmIChzID0gITApO1xuICAgICAgICAgICAgfSkpLCBzICYmIFd1KG4pO1xuICAgICAgICB9KHMuZXZlbnRNYW5hZ2VyLCBlKSwgdC5sZW5ndGggJiYgcy5zYy5Xbyh0KSwgcy5vbmxpbmVTdGF0ZSA9IGUsIHMuaXNQcmltYXJ5Q2xpZW50ICYmIHMuc2hhcmVkQ2xpZW50U3RhdGUuc2V0T25saW5lU3RhdGUoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlamVjdHMgdGhlIGxpc3RlbiBmb3IgdGhlIGdpdmVuIHRhcmdldElELiBUaGlzIGNhbiBiZSB0cmlnZ2VyZWQgYnkgdGhlXG4gKiBiYWNrZW5kIGZvciBhbnkgYWN0aXZlIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0gc3luY0VuZ2luZSAtIFRoZSBzeW5jIGVuZ2luZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB0YXJnZXRJZCAtIFRoZSB0YXJnZXRJRCBjb3JyZXNwb25kcyB0byBvbmUgcHJldmlvdXNseSBpbml0aWF0ZWQgYnkgdGhlXG4gKiB1c2VyIGFzIHBhcnQgb2YgVGFyZ2V0RGF0YSBwYXNzZWQgdG8gbGlzdGVuKCkgb24gUmVtb3RlU3RvcmUuXG4gKiBAcGFyYW0gZXJyIC0gQSBkZXNjcmlwdGlvbiBvZiB0aGUgY29uZGl0aW9uIHRoYXQgaGFzIGZvcmNlZCB0aGUgcmVqZWN0aW9uLlxuICogTmVhcmx5IGFsd2F5cyB0aGlzIHdpbGwgYmUgYW4gaW5kaWNhdGlvbiB0aGF0IHRoZSB1c2VyIGlzIG5vIGxvbmdlclxuICogYXV0aG9yaXplZCB0byBzZWUgdGhlIGRhdGEgbWF0Y2hpbmcgdGhlIHRhcmdldC5cbiAqLyBhc3luYyBmdW5jdGlvbiBsYyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9ICQodCk7XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbik7XG4gICAgY29uc3QgaSA9IHMuY2MuZ2V0KGUpLCByID0gaSAmJiBpLmtleTtcbiAgICBpZiAocikge1xuICAgICAgICAvLyBUT0RPKGtsaW10KTogV2UgcmVhbGx5IG9ubHkgc2hvdWxkIGRvIHRoZSBmb2xsb3dpbmcgb24gcGVybWlzc2lvblxuICAgICAgICAvLyBkZW5pZWQgZXJyb3JzLCBidXQgd2UgZG9uJ3QgaGF2ZSB0aGUgY2F1c2UgY29kZSBoZXJlLlxuICAgICAgICAvLyBJdCdzIGEgbGltYm8gZG9jLiBDcmVhdGUgYSBzeW50aGV0aWMgZXZlbnQgc2F5aW5nIGl0IHdhcyBkZWxldGVkLlxuICAgICAgICAvLyBUaGlzIGlzIGtpbmQgb2YgYSBoYWNrLiBJZGVhbGx5LCB3ZSB3b3VsZCBoYXZlIGEgbWV0aG9kIGluIHRoZSBsb2NhbFxuICAgICAgICAvLyBzdG9yZSB0byBwdXJnZSBhIGRvY3VtZW50LiBIb3dldmVyLCBpdCB3b3VsZCBiZSB0cmlja3kgdG8ga2VlcCBhbGwgb2ZcbiAgICAgICAgLy8gdGhlIGxvY2FsIHN0b3JlJ3MgaW52YXJpYW50cyB3aXRoIGFub3RoZXIgbWV0aG9kLlxuICAgICAgICBsZXQgdCA9IG5ldyBCdChjdC5jb21wYXJhdG9yKTtcbiAgICAgICAgLy8gVE9ETyhiLzIxNzE4OTIxNik6IFRoaXMgbGltYm8gZG9jdW1lbnQgc2hvdWxkIGlkZWFsbHkgaGF2ZSBhIHJlYWQgdGltZSxcbiAgICAgICAgLy8gc28gdGhhdCBpdCBpcyBwaWNrZWQgdXAgYnkgYW55IHJlYWQtdGltZSBiYXNlZCBzY2Fucy4gVGhlIGJhY2tlbmQsXG4gICAgICAgIC8vIGhvd2V2ZXIsIGRvZXMgbm90IHNlbmQgYSByZWFkIHRpbWUgZm9yIHRhcmdldCByZW1vdmFscy5cbiAgICAgICAgICAgICAgICB0ID0gdC5pbnNlcnQociwgU2UubmV3Tm9Eb2N1bWVudChyLCBzdC5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gZnMoKS5hZGQociksIGkgPSBuZXcgd3Moc3QubWluKCksIFxuICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyBuZXcgTWFwLCBcbiAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IHF0KFopLCB0LCBuKTtcbiAgICAgICAgYXdhaXQgYWMocywgaSksIFxuICAgICAgICAvLyBTaW5jZSB0aGlzIHF1ZXJ5IGZhaWxlZCwgd2Ugd29uJ3Qgd2FudCB0byBtYW51YWxseSB1bmxpc3RlbiB0byBpdC5cbiAgICAgICAgLy8gV2Ugb25seSByZW1vdmUgaXQgZnJvbSBib29ra2VlcGluZyBhZnRlciB3ZSBzdWNjZXNzZnVsbHkgYXBwbGllZCB0aGVcbiAgICAgICAgLy8gUmVtb3RlRXZlbnQuIElmIGBhcHBseVJlbW90ZUV2ZW50KClgIHRocm93cywgd2Ugd2FudCB0byByZS1saXN0ZW4gdG9cbiAgICAgICAgLy8gdGhpcyBxdWVyeSB3aGVuIHRoZSBSZW1vdGVTdG9yZSByZXN0YXJ0cyB0aGUgV2F0Y2ggc3RyZWFtLCB3aGljaCBzaG91bGRcbiAgICAgICAgLy8gcmUtdHJpZ2dlciB0aGUgdGFyZ2V0IGZhaWx1cmUuXG4gICAgICAgIHMudWMgPSBzLnVjLnJlbW92ZShyKSwgcy5jYy5kZWxldGUoZSksIFRjKHMpO1xuICAgIH0gZWxzZSBhd2FpdCBTbyhzLmxvY2FsU3RvcmUsIGUsIFxuICAgIC8qIGtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhICovICExKS50aGVuKCgoKSA9PiBnYyhzLCBlLCBuKSkpLmNhdGNoKEV0KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmModCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpLCBzID0gZS5iYXRjaC5iYXRjaElkO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBBbyhuLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodFxuICAgICAgICAvLyB1cCksIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuXG4gICAgICAgIC8vIGJlZm9yZSBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIG1jKG4sIHMsIC8qZXJyb3I9Ki8gbnVsbCksIHdjKG4sIHMpLCBuLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZU11dGF0aW9uU3RhdGUocywgXCJhY2tub3dsZWRnZWRcIiksIFxuICAgICAgICBhd2FpdCBFYyhuLCB0KTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIGF3YWl0IEV0KHQpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZGModCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSAkKHQpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gJCh0KTtcbiAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiUmVqZWN0IGJhdGNoXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBzO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLm11dGF0aW9uUXVldWUubG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKS5uZXh0KChlID0+IChNKG51bGwgIT09IGUpLCBzID0gZS5rZXlzKCksIFxuICAgICAgICAgICAgICAgIG4ubXV0YXRpb25RdWV1ZS5yZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpKSkpLm5leHQoKCgpID0+IG4ubXV0YXRpb25RdWV1ZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSkpLm5leHQoKCgpID0+IG4uZG9jdW1lbnRPdmVybGF5Q2FjaGUucmVtb3ZlT3ZlcmxheXNGb3JCYXRjaElkKHQsIHMsIGUpKSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5yZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyh0LCBzKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHQsIHMpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXJnZXN0IChsYXRlc3QpIGJhdGNoIGlkIGluIG11dGF0aW9uIHF1ZXVlIHRoYXQgaXMgcGVuZGluZ1xuICogc2VydmVyIHJlc3BvbnNlLlxuICpcbiAqIFJldHVybnMgYEJBVENISURfVU5LTk9XTmAgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICovIChzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIG1jKHMsIGUsIG4pLCB3YyhzLCBlKSwgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbiksIFxuICAgICAgICBhd2FpdCBFYyhzLCB0KTtcbiAgICB9IGNhdGNoIChuKSB7XG4gICAgICAgIGF3YWl0IEV0KG4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB1c2VyIGNhbGxiYWNrIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgcGVuZGluZyBtdXRhdGlvbnMgYXQgdGhlIG1vbWVudCBvZiBjYWxsaW5nXG4gKiBhcmUgYWNrbm93bGVkZ2VkIC5cbiAqLyBhc3luYyBmdW5jdGlvbiBfYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCk7XG4gICAgbXUobi5yZW1vdGVTdG9yZSkgfHwgQyhcIlN5bmNFbmdpbmVcIiwgXCJUaGUgbmV0d29yayBpcyBkaXNhYmxlZC4gVGhlIHRhc2sgcmV0dXJuZWQgYnkgJ2F3YWl0UGVuZGluZ1dyaXRlcygpJyB3aWxsIG5vdCBjb21wbGV0ZSB1bnRpbCB0aGUgbmV0d29yayBpcyBlbmFibGVkLlwiKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9ICQodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBoaWdoZXN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGlkXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5tdXRhdGlvblF1ZXVlLmdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQodCkpKTtcbiAgICAgICAgfShuLmxvY2FsU3RvcmUpO1xuICAgICAgICBpZiAoLTEgPT09IHQpIFxuICAgICAgICAvLyBUcmlnZ2VyIHRoZSBjYWxsYmFjayByaWdodCBhd2F5IGlmIHRoZXJlIGlzIG5vIHBlbmRpbmcgd3JpdGVzIGF0IHRoZSBtb21lbnQuXG4gICAgICAgIHJldHVybiB2b2lkIGUucmVzb2x2ZSgpO1xuICAgICAgICBjb25zdCBzID0gbi5sYy5nZXQodCkgfHwgW107XG4gICAgICAgIHMucHVzaChlKSwgbi5sYy5zZXQodCwgcyk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBjb25zdCBuID0gRnUodCwgXCJJbml0aWFsaXphdGlvbiBvZiB3YWl0Rm9yUGVuZGluZ1dyaXRlcygpIG9wZXJhdGlvbiBmYWlsZWRcIik7XG4gICAgICAgIGUucmVqZWN0KG4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUcmlnZ2VycyB0aGUgY2FsbGJhY2tzIHRoYXQgYXJlIHdhaXRpbmcgZm9yIHRoaXMgYmF0Y2ggaWQgdG8gZ2V0IGFja25vd2xlZGdlZCBieSBzZXJ2ZXIsXG4gKiBpZiB0aGVyZSBhcmUgYW55LlxuICovIGZ1bmN0aW9uIHdjKHQsIGUpIHtcbiAgICAodC5sYy5nZXQoZSkgfHwgW10pLmZvckVhY2goKHQgPT4ge1xuICAgICAgICB0LnJlc29sdmUoKTtcbiAgICB9KSksIHQubGMuZGVsZXRlKGUpO1xufVxuXG4vKiogUmVqZWN0IGFsbCBvdXRzdGFuZGluZyBjYWxsYmFja3Mgd2FpdGluZyBmb3IgcGVuZGluZyB3cml0ZXMgdG8gY29tcGxldGUuICovIGZ1bmN0aW9uIG1jKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gJCh0KTtcbiAgICBsZXQgaSA9IHMuaGNbcy5jdXJyZW50VXNlci50b0tleSgpXTtcbiAgICAvLyBOT1RFOiBNdXRhdGlvbnMgcmVzdG9yZWQgZnJvbSBwZXJzaXN0ZW5jZSB3b24ndCBoYXZlIGNhbGxiYWNrcywgc28gaXQnc1xuICAgIC8vIG9rYXkgZm9yIHRoZXJlIHRvIGJlIG5vIGNhbGxiYWNrIGZvciB0aGlzIElELlxuICAgICAgICBpZiAoaSkge1xuICAgICAgICBjb25zdCB0ID0gaS5nZXQoZSk7XG4gICAgICAgIHQgJiYgKG4gPyB0LnJlamVjdChuKSA6IHQucmVzb2x2ZSgpLCBpID0gaS5yZW1vdmUoZSkpLCBzLmhjW3MuY3VycmVudFVzZXIudG9LZXkoKV0gPSBpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2ModCwgZSwgbiA9IG51bGwpIHtcbiAgICB0LnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQoZSk7XG4gICAgZm9yIChjb25zdCBzIG9mIHQucmMuZ2V0KGUpKSB0LmljLmRlbGV0ZShzKSwgbiAmJiB0LnNjLndjKHMsIG4pO1xuICAgIGlmICh0LnJjLmRlbGV0ZShlKSwgdC5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgdC5hYy5scyhlKS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQuYWMuY29udGFpbnNLZXkoZSkgfHwgXG4gICAgICAgICAgICAvLyBXZSByZW1vdmVkIHRoZSBsYXN0IHJlZmVyZW5jZSBmb3IgdGhpcyBrZXlcbiAgICAgICAgICAgIHljKHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB5Yyh0LCBlKSB7XG4gICAgdC5vYy5kZWxldGUoZS5wYXRoLmNhbm9uaWNhbFN0cmluZygpKTtcbiAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgdGhlIHRhcmdldCBhbHJlYWR5IGdvdCByZW1vdmVkIGJlY2F1c2UgdGhlIHF1ZXJ5IGZhaWxlZC4gSW4gdGhhdCBjYXNlLFxuICAgIC8vIHRoZSBrZXkgd29uJ3QgZXhpc3QgaW4gYGxpbWJvVGFyZ2V0c0J5S2V5YC4gT25seSBkbyB0aGUgY2xlYW51cCBpZiB3ZSBzdGlsbCBoYXZlIHRoZSB0YXJnZXQuXG4gICAgY29uc3QgbiA9IHQudWMuZ2V0KGUpO1xuICAgIG51bGwgIT09IG4gJiYgKGx1KHQucmVtb3RlU3RvcmUsIG4pLCB0LnVjID0gdC51Yy5yZW1vdmUoZSksIHQuY2MuZGVsZXRlKG4pLCBUYyh0KSk7XG59XG5cbmZ1bmN0aW9uIHBjKHQsIGUsIG4pIHtcbiAgICBmb3IgKGNvbnN0IHMgb2YgbikgaWYgKHMgaW5zdGFuY2VvZiBadSkgdC5hYy5hZGRSZWZlcmVuY2Uocy5rZXksIGUpLCBJYyh0LCBzKTsgZWxzZSBpZiAocyBpbnN0YW5jZW9mIHRjKSB7XG4gICAgICAgIEMoXCJTeW5jRW5naW5lXCIsIFwiRG9jdW1lbnQgbm8gbG9uZ2VyIGluIGxpbWJvOiBcIiArIHMua2V5KSwgdC5hYy5yZW1vdmVSZWZlcmVuY2Uocy5rZXksIGUpO1xuICAgICAgICB0LmFjLmNvbnRhaW5zS2V5KHMua2V5KSB8fCBcbiAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XG4gICAgICAgIHljKHQsIHMua2V5KTtcbiAgICB9IGVsc2UgTygpO1xufVxuXG5mdW5jdGlvbiBJYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUua2V5LCBzID0gbi5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xuICAgIHQudWMuZ2V0KG4pIHx8IHQub2MuaGFzKHMpIHx8IChDKFwiU3luY0VuZ2luZVwiLCBcIk5ldyBkb2N1bWVudCBpbiBsaW1ibzogXCIgKyBuKSwgdC5vYy5hZGQocyksIFxuICAgIFRjKHQpKTtcbn1cblxuLyoqXG4gKiBTdGFydHMgbGlzdGVucyBmb3IgZG9jdW1lbnRzIGluIGxpbWJvIHRoYXQgYXJlIGVucXVldWVkIGZvciByZXNvbHV0aW9uLFxuICogc3ViamVjdCB0byBhIG1heGltdW0gbnVtYmVyIG9mIGNvbmN1cnJlbnQgcmVzb2x1dGlvbnMuXG4gKlxuICogV2l0aG91dCBib3VuZGluZyB0aGUgbnVtYmVyIG9mIGNvbmN1cnJlbnQgcmVzb2x1dGlvbnMsIHRoZSBzZXJ2ZXIgY2FuIGZhaWxcbiAqIHdpdGggXCJyZXNvdXJjZSBleGhhdXN0ZWRcIiBlcnJvcnMgd2hpY2ggY2FuIGxlYWQgdG8gcGF0aG9sb2dpY2FsIGNsaWVudFxuICogYmVoYXZpb3IgYXMgc2VlbiBpbiBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy8yNjgzLlxuICovIGZ1bmN0aW9uIFRjKHQpIHtcbiAgICBmb3IgKDt0Lm9jLnNpemUgPiAwICYmIHQudWMuc2l6ZSA8IHQubWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnM7ICkge1xuICAgICAgICBjb25zdCBlID0gdC5vYy52YWx1ZXMoKS5uZXh0KCkudmFsdWU7XG4gICAgICAgIHQub2MuZGVsZXRlKGUpO1xuICAgICAgICBjb25zdCBuID0gbmV3IGN0KHJ0LmZyb21TdHJpbmcoZSkpLCBzID0gdC5mYy5uZXh0KCk7XG4gICAgICAgIHQuY2Muc2V0KHMsIG5ldyBzYyhuKSksIHQudWMgPSB0LnVjLmluc2VydChuLCBzKSwgaHUodC5yZW1vdGVTdG9yZSwgbmV3IEZpKGNuKGVuKG4ucGF0aCkpLCBzLCAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyAsIE90LmF0KSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBFYyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9ICQodCksIGkgPSBbXSwgciA9IFtdLCBvID0gW107XG4gICAgcy5pYy5pc0VtcHR5KCkgfHwgKHMuaWMuZm9yRWFjaCgoKHQsIHUpID0+IHtcbiAgICAgICAgby5wdXNoKHMuX2ModSwgZSwgbikudGhlbigodCA9PiB7XG4gICAgICAgICAgICAvLyBVcGRhdGUgdmlld3MgaWYgdGhlcmUgYXJlIGFjdHVhbCBjaGFuZ2VzLlxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGNoYW5nZXMsIG9yIHdlIGFyZSBoYW5kbGluZyBhIGdsb2JhbCBzbmFwc2hvdCwgbm90aWZ5XG4gICAgICAgICAgICAvLyBzZWNvbmRhcnkgY2xpZW50cyB0byB1cGRhdGUgcXVlcnkgc3RhdGUuXG4gICAgICAgICAgICAodCB8fCBuKSAmJiBzLmlzUHJpbWFyeUNsaWVudCAmJiBzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZVF1ZXJ5U3RhdGUodS50YXJnZXRJZCwgKG51bGwgPT0gdCA/IHZvaWQgMCA6IHQuZnJvbUNhY2hlKSA/IFwibm90LWN1cnJlbnRcIiA6IFwiY3VycmVudFwiKSwgXG4gICAgICAgICAgICB0KSB7XG4gICAgICAgICAgICAgICAgaS5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB5by5DaSh1LnRhcmdldElkLCB0KTtcbiAgICAgICAgICAgICAgICByLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSk7XG4gICAgfSkpLCBhd2FpdCBQcm9taXNlLmFsbChvKSwgcy5zYy5XbyhpKSwgYXdhaXQgYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gJCh0KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJub3RpZnlMb2NhbFZpZXdDaGFuZ2VzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IEF0LmZvckVhY2goZSwgKGUgPT4gQXQuZm9yRWFjaChlLlNpLCAocyA9PiBuLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLmFkZFJlZmVyZW5jZSh0LCBlLnRhcmdldElkLCBzKSkpLm5leHQoKCgpID0+IEF0LmZvckVhY2goZS5EaSwgKHMgPT4gbi5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodCwgZS50YXJnZXRJZCwgcykpKSkpKSkpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgaWYgKCFWdCh0KSkgdGhyb3cgdDtcbiAgICAgICAgICAgIC8vIElmIGBub3RpZnlMb2NhbFZpZXdDaGFuZ2VzYCBmYWlscywgd2UgZGlkIG5vdCBhZHZhbmNlIHRoZSBzZXF1ZW5jZVxuICAgICAgICAgICAgLy8gbnVtYmVyIGZvciB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBpbmNsdWRlZCBpbiB0aGlzIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBtaWdodCB0cmlnZ2VyIHRoZW0gdG8gYmUgZGVsZXRlZCBlYXJsaWVyIHRoYW4gdGhleSBvdGhlcndpc2VcbiAgICAgICAgICAgIC8vIHdvdWxkIGhhdmUsIGJ1dCBpdCBzaG91bGQgbm90IGludmFsaWRhdGUgdGhlIGludGVncml0eSBvZiB0aGUgZGF0YS5cbiAgICAgICAgICAgIEMoXCJMb2NhbFN0b3JlXCIsIFwiRmFpbGVkIHRvIHVwZGF0ZSBzZXF1ZW5jZSBudW1iZXJzOiBcIiArIHQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRJZDtcbiAgICAgICAgICAgIGlmICghdC5mcm9tQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5VaS5nZXQoZSksIHMgPSB0LnNuYXBzaG90VmVyc2lvbiwgaSA9IHQud2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24ocyk7XG4gICAgICAgICAgICAgICAgLy8gQWR2YW5jZSB0aGUgbGFzdCBsaW1ibyBmcmVlIHNuYXBzaG90IHZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5VaSA9IG4uVWkuaW5zZXJ0KGUsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfShzLmxvY2FsU3RvcmUsIHIpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gQWModCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIGlmICghbi5jdXJyZW50VXNlci5pc0VxdWFsKGUpKSB7XG4gICAgICAgIEMoXCJTeW5jRW5naW5lXCIsIFwiVXNlciBjaGFuZ2UuIE5ldyB1c2VyOlwiLCBlLnRvS2V5KCkpO1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgRW8obi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgbi5jdXJyZW50VXNlciA9IGUsIFxuICAgICAgICAvLyBGYWlscyB0YXNrcyB3YWl0aW5nIGZvciBwZW5kaW5nIHdyaXRlcyByZXF1ZXN0ZWQgYnkgcHJldmlvdXMgdXNlci5cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgdC5sYy5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0LnJlamVjdChuZXcgTChCLkNBTkNFTExFRCwgZSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKSwgdC5sYy5jbGVhcigpO1xuICAgICAgICB9KG4sIFwiJ3dhaXRGb3JQZW5kaW5nV3JpdGVzJyBwcm9taXNlIGlzIHJlamVjdGVkIGR1ZSB0byBhIHVzZXIgY2hhbmdlLlwiKSwgXG4gICAgICAgIC8vIFRPRE8oYi8xMTQyMjY0MTcpOiBDb25zaWRlciBjYWxsaW5nIHRoaXMgb25seSBpbiB0aGUgcHJpbWFyeSB0YWIuXG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaGFuZGxlVXNlckNoYW5nZShlLCB0LnJlbW92ZWRCYXRjaElkcywgdC5hZGRlZEJhdGNoSWRzKSwgYXdhaXQgRWMobiwgdC5qaSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBSYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9ICQodCksIHMgPSBuLmNjLmdldChlKTtcbiAgICBpZiAocyAmJiBzLm5jKSByZXR1cm4gZnMoKS5hZGQocy5rZXkpO1xuICAgIHtcbiAgICAgICAgbGV0IHQgPSBmcygpO1xuICAgICAgICBjb25zdCBzID0gbi5yYy5nZXQoZSk7XG4gICAgICAgIGlmICghcykgcmV0dXJuIHQ7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBzKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5pYy5nZXQoZSk7XG4gICAgICAgICAgICB0ID0gdC51bmlvbldpdGgocy52aWV3Lmp1KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb25jaWxlIHRoZSBsaXN0IG9mIHN5bmNlZCBkb2N1bWVudHMgaW4gYW4gZXhpc3RpbmcgdmlldyB3aXRoIHRob3NlXG4gKiBmcm9tIHBlcnNpc3RlbmNlLlxuICovIGFzeW5jIGZ1bmN0aW9uIGJjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gJCh0KSwgcyA9IGF3YWl0IERvKG4ubG9jYWxTdG9yZSwgZS5xdWVyeSwgXG4gICAgLyogdXNlUHJldmlvdXNSZXN1bHRzPSAqLyAhMCksIGkgPSBlLnZpZXcudGMocyk7XG4gICAgcmV0dXJuIG4uaXNQcmltYXJ5Q2xpZW50ICYmIHBjKG4sIGUudGFyZ2V0SWQsIGkuWHUpLCBpO1xufVxuXG4vKipcbiAqIFJldHJpZXZlcyBuZXdseSBjaGFuZ2VkIGRvY3VtZW50cyBmcm9tIHJlbW90ZSBkb2N1bWVudCBjYWNoZSBhbmQgcmFpc2VzXG4gKiBzbmFwc2hvdHMgaWYgbmVlZGVkLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gUGModCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIHJldHVybiB4byhuLmxvY2FsU3RvcmUsIGUpLnRoZW4oKHQgPT4gRWMobiwgdCkpKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBtdXRhdGlvbiBzdGF0ZSB0byBhbiBleGlzdGluZyBiYXRjaC4gICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gdmModCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSAkKHQpLCByID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gJCh0KSwgcyA9ICQobi5tdXRhdGlvblF1ZXVlKTtcbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb29rdXAgbXV0YXRpb24gZG9jdW1lbnRzXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gcy5Ubih0LCBlKS5uZXh0KChlID0+IGUgPyBuLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0LCBlKSA6IEF0LnJlc29sdmUobnVsbCkpKSkpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgIChpLmxvY2FsU3RvcmUsIGUpO1xuICAgIG51bGwgIT09IHIgPyAoXCJwZW5kaW5nXCIgPT09IG4gPyBcbiAgICAvLyBJZiB3ZSBhcmUgdGhlIHByaW1hcnkgY2xpZW50LCB3ZSBuZWVkIHRvIHNlbmQgdGhpcyB3cml0ZSB0byB0aGVcbiAgICAvLyBiYWNrZW5kLiBTZWNvbmRhcnkgY2xpZW50cyB3aWxsIGlnbm9yZSB0aGVzZSB3cml0ZXMgc2luY2UgdGhlaXIgcmVtb3RlXG4gICAgLy8gY29ubmVjdGlvbiBpcyBkaXNhYmxlZC5cbiAgICBhd2FpdCBBdShpLnJlbW90ZVN0b3JlKSA6IFwiYWNrbm93bGVkZ2VkXCIgPT09IG4gfHwgXCJyZWplY3RlZFwiID09PSBuID8gKFxuICAgIC8vIE5PVEU6IEJvdGggdGhlc2UgbWV0aG9kcyBhcmUgbm8tb3BzIGZvciBiYXRjaGVzIHRoYXQgb3JpZ2luYXRlZCBmcm9tXG4gICAgLy8gb3RoZXIgY2xpZW50cy5cbiAgICBtYyhpLCBlLCBzIHx8IG51bGwpLCB3YyhpLCBlKSwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAkKCQodCkubXV0YXRpb25RdWV1ZSkuQW4oZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgZSkpIDogTygpLCBhd2FpdCBFYyhpLCByKSkgOiBcbiAgICAvLyBBIHRocm90dGxlZCB0YWIgbWF5IG5vdCBoYXZlIHNlZW4gdGhlIG11dGF0aW9uIGJlZm9yZSBpdCB3YXMgY29tcGxldGVkXG4gICAgLy8gYW5kIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUsIGluIHdoaWNoIGNhc2Ugd2Ugd29uJ3QgaGF2ZSBjYWNoZWRcbiAgICAvLyB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzLiBJbiB0aGlzIGNhc2Ugd2UgY2FuIHNhZmVseSBpZ25vcmUgdGhlIHVwZGF0ZVxuICAgIC8vIHNpbmNlIHRoYXQgbWVhbnMgd2UgZGlkbid0IGFwcGx5IHRoZSBtdXRhdGlvbiBsb2NhbGx5IGF0IGFsbCAoaWYgd2VcbiAgICAvLyBoYWQsIHdlIHdvdWxkIGhhdmUgY2FjaGVkIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMpLCBhbmQgc28gd2Ugd2lsbCBqdXN0XG4gICAgLy8gc2VlIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcyB2aWEgbm9ybWFsIHJlbW90ZSBkb2N1bWVudCB1cGRhdGVzXG4gICAgLy8gYXMgYXBwbGljYWJsZS5cbiAgICBDKFwiU3luY0VuZ2luZVwiLCBcIkNhbm5vdCBhcHBseSBtdXRhdGlvbiBiYXRjaCB3aXRoIGlkOiBcIiArIGUpO1xufVxuXG4vKiogQXBwbGllcyBhIHF1ZXJ5IHRhcmdldCBjaGFuZ2UgZnJvbSBhIGRpZmZlcmVudCB0YWIuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gVmModCwgZSkge1xuICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgIGlmIChrYyhuKSwgT2MobiksICEwID09PSBlICYmICEwICE9PSBuLmRjKSB7XG4gICAgICAgIC8vIFNlY29uZGFyeSB0YWJzIG9ubHkgbWFpbnRhaW4gVmlld3MgZm9yIHRoZWlyIGxvY2FsIGxpc3RlbmVycyBhbmQgdGhlXG4gICAgICAgIC8vIFZpZXdzIGludGVybmFsIHN0YXRlIG1heSBub3QgYmUgMTAwJSBwb3B1bGF0ZWQgKGluIHBhcnRpY3VsYXJcbiAgICAgICAgLy8gc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgdHJhY2sgc3luY2VkRG9jdW1lbnRzLCB0aGUgc2V0IG9mIGRvY3VtZW50cyB0aGVcbiAgICAgICAgLy8gc2VydmVyIGNvbnNpZGVycyB0byBiZSBpbiB0aGUgdGFyZ2V0KS4gU28gd2hlbiBhIHNlY29uZGFyeSBiZWNvbWVzXG4gICAgICAgIC8vIHByaW1hcnksIHdlIG5lZWQgdG8gbmVlZCB0byBtYWtlIHN1cmUgdGhhdCBhbGwgdmlld3MgZm9yIGFsbCB0YXJnZXRzXG4gICAgICAgIC8vIG1hdGNoIHRoZSBzdGF0ZSBvbiBkaXNrLlxuICAgICAgICBjb25zdCB0ID0gbi5zaGFyZWRDbGllbnRTdGF0ZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSwgZSA9IGF3YWl0IFNjKG4sIHQudG9BcnJheSgpKTtcbiAgICAgICAgbi5kYyA9ICEwLCBhd2FpdCBOdShuLnJlbW90ZVN0b3JlLCAhMCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBodShuLnJlbW90ZVN0b3JlLCB0KTtcbiAgICB9IGVsc2UgaWYgKCExID09PSBlICYmICExICE9PSBuLmRjKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgbGV0IGUgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgbi5yYy5mb3JFYWNoKCgocywgaSkgPT4ge1xuICAgICAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0xvY2FsUXVlcnlUYXJnZXQoaSkgPyB0LnB1c2goaSkgOiBlID0gZS50aGVuKCgoKSA9PiAoZ2MobiwgaSksIFxuICAgICAgICAgICAgU28obi5sb2NhbFN0b3JlLCBpLCBcbiAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITApKSkpLCBsdShuLnJlbW90ZVN0b3JlLCBpKTtcbiAgICAgICAgfSkpLCBhd2FpdCBlLCBhd2FpdCBTYyhuLCB0KSwgXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgICAgICAgICAgZS5jYy5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGx1KGUucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICAgICAgfSkpLCBlLmFjLmZzKCksIGUuY2MgPSBuZXcgTWFwLCBlLnVjID0gbmV3IEJ0KGN0LmNvbXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVjb25jaWxlIHRoZSBxdWVyeSB2aWV3cyBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgdGFyZ2V0cyB3aXRoIHRoZSBzdGF0ZSBmcm9tXG4gKiBwZXJzaXN0ZW5jZS4gUmFpc2VzIHNuYXBzaG90cyBmb3IgYW55IGNoYW5nZXMgdGhhdCBhZmZlY3QgdGhlIGxvY2FsXG4gKiBjbGllbnQgYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUgb2YgYWxsIHRhcmdldCdzIHF1ZXJ5IGRhdGEuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBUaGUgc3luYyBlbmdpbmUgaW1wbGVtZW50YXRpb25cbiAqIEBwYXJhbSB0YXJnZXRzIC0gdGhlIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIHZpZXdzIHRoYXQgbmVlZCB0byBiZSByZWNvbXB1dGVkXG4gKiBAcGFyYW0gdHJhbnNpdGlvblRvUHJpbWFyeSAtIGB0cnVlYCBpZmYgdGhlIHRhYiB0cmFuc2l0aW9ucyBmcm9tIGEgc2Vjb25kYXJ5XG4gKiB0YWIgdG8gYSBwcmltYXJ5IHRhYlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuKSwgbi5kYyA9ICExLCBhd2FpdCBOdShuLnJlbW90ZVN0b3JlLCAhMSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBTYyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9ICQodCksIGkgPSBbXSwgciA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgIGxldCBlO1xuICAgICAgICBjb25zdCBuID0gcy5yYy5nZXQodCk7XG4gICAgICAgIGlmIChuICYmIDAgIT09IG4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IGhhdmUgYSBsb2NhbCBWaWV3LCB3ZSBmZXRjaCB0aGVpciBjdXJyZW50IHN0YXRlXG4gICAgICAgICAgICAvLyBmcm9tIExvY2FsU3RvcmUgKGFzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHRoZSBzbmFwc2hvdCB2ZXJzaW9uXG4gICAgICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQpIGFuZCByZWNvbmNpbGUgdGhlaXIgdmlld3Mgd2l0aCB0aGUgcGVyc2lzdGVkXG4gICAgICAgICAgICAvLyBzdGF0ZSAodGhlIGxpc3Qgb2Ygc3luY2VkRG9jdW1lbnRzIG1heSBoYXZlIGdvdHRlbiBvdXQgb2Ygc3luYykuXG4gICAgICAgICAgICBlID0gYXdhaXQgVm8ocy5sb2NhbFN0b3JlLCBjbihuWzBdKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzLmljLmdldCh0KSwgbiA9IGF3YWl0IGJjKHMsIGUpO1xuICAgICAgICAgICAgICAgIG4uc25hcHNob3QgJiYgci5wdXNoKG4uc25hcHNob3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBuZXZlciBleGVjdXRlZCBvbiB0aGlzIGNsaWVudCwgd2UgbmVlZCB0b1xuICAgICAgICAgICAgLy8gYWxsb2NhdGUgdGhlIHRhcmdldCBpbiBMb2NhbFN0b3JlIGFuZCBpbml0aWFsaXplIGEgbmV3IFZpZXcuXG4gICAgICAgICAgICBjb25zdCBuID0gYXdhaXQgQ28ocy5sb2NhbFN0b3JlLCB0KTtcbiAgICAgICAgICAgIGUgPSBhd2FpdCBWbyhzLmxvY2FsU3RvcmUsIG4pLCBhd2FpdCBvYyhzLCBEYyhuKSwgdCwgXG4gICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gITEsIGUucmVzdW1lVG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGkucHVzaChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHMuc2MuV28ociksIGk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGBRdWVyeWAgb2JqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBgVGFyZ2V0YC4gVGhlcmUgaXMgbm8gd2F5IHRvXG4gKiBvYnRhaW4gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIHNvIHdlIHN5bnRoZXNpemUgYSBgUXVlcnlgIGZyb20gdGhlIGBUYXJnZXRgXG4gKiBvYmplY3QuXG4gKlxuICogVGhlIHN5bnRoZXNpemVkIHJlc3VsdCBtaWdodCBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JpZ2luYWwgYFF1ZXJ5YCwgYnV0XG4gKiBzaW5jZSB0aGUgc3ludGhlc2l6ZWQgYFF1ZXJ5YCBzaG91bGQgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdHMgYXMgdGhlXG4gKiBvcmlnaW5hbCBvbmUgKG9ubHkgdGhlIHByZXNlbnRhdGlvbiBvZiByZXN1bHRzIG1pZ2h0IGRpZmZlciksIHRoZSBwb3RlbnRpYWxcbiAqIGRpZmZlcmVuY2Ugd2lsbCBub3QgY2F1c2UgaXNzdWVzLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gRGModCkge1xuICAgIHJldHVybiB0bih0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0Lm9yZGVyQnksIHQuZmlsdGVycywgdC5saW1pdCwgXCJGXCIgLyogRmlyc3QgKi8gLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xufVxuXG4vKiogUmV0dXJucyB0aGUgSURzIG9mIHRoZSBjbGllbnRzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gQ2ModCkge1xuICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgIHJldHVybiAkKCQoZS5sb2NhbFN0b3JlKS5wZXJzaXN0ZW5jZSkudmkoKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBxdWVyeSB0YXJnZXQgY2hhbmdlIGZyb20gYSBkaWZmZXJlbnQgdGFiLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIHhjKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gJCh0KTtcbiAgICBpZiAoaS5kYykgXG4gICAgLy8gSWYgd2UgcmVjZWl2ZSBhIHRhcmdldCBzdGF0ZSBub3RpZmljYXRpb24gdmlhIFdlYlN0b3JhZ2UsIHdlIGFyZVxuICAgIC8vIGVpdGhlciBhbHJlYWR5IHNlY29uZGFyeSBvciBhbm90aGVyIHRhYiBoYXMgdGFrZW4gdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgcmV0dXJuIHZvaWQgQyhcIlN5bmNFbmdpbmVcIiwgXCJJZ25vcmluZyB1bmV4cGVjdGVkIHF1ZXJ5IHN0YXRlIG5vdGlmaWNhdGlvbi5cIik7XG4gICAgY29uc3QgciA9IGkucmMuZ2V0KGUpO1xuICAgIGlmIChyICYmIHIubGVuZ3RoID4gMCkgc3dpdGNoIChuKSB7XG4gICAgICBjYXNlIFwiY3VycmVudFwiOlxuICAgICAgY2FzZSBcIm5vdC1jdXJyZW50XCI6XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBhd2FpdCB4byhpLmxvY2FsU3RvcmUsIF9uKHJbMF0pKSwgcyA9IHdzLmNyZWF0ZVN5bnRoZXNpemVkUmVtb3RlRXZlbnRGb3JDdXJyZW50Q2hhbmdlKGUsIFwiY3VycmVudFwiID09PSBuLCBXdC5FTVBUWV9CWVRFX1NUUklORyk7XG4gICAgICAgICAgICBhd2FpdCBFYyhpLCB0LCBzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgIGNhc2UgXCJyZWplY3RlZFwiOlxuICAgICAgICBhd2FpdCBTbyhpLmxvY2FsU3RvcmUsIGUsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMCksIGdjKGksIGUsIHMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgTygpO1xuICAgIH1cbn1cblxuLyoqIEFkZHMgb3IgcmVtb3ZlcyBXYXRjaCB0YXJnZXRzIGZvciBxdWVyaWVzIGZyb20gZGlmZmVyZW50IHRhYnMuICovIGFzeW5jIGZ1bmN0aW9uIE5jKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0ga2ModCk7XG4gICAgaWYgKHMuZGMpIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGlmIChzLnJjLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgIC8vIEEgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiBhZGRlZCBpbiBhIHByZXZpb3VzIGF0dGVtcHRcbiAgICAgICAgICAgICAgICBDKFwiU3luY0VuZ2luZVwiLCBcIkFkZGluZyBhbiBhbHJlYWR5IGFjdGl2ZSB0YXJnZXQgXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGUgPSBhd2FpdCBDbyhzLmxvY2FsU3RvcmUsIHQpLCBuID0gYXdhaXQgVm8ocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgICAgIGF3YWl0IG9jKHMsIERjKGUpLCBuLnRhcmdldElkLCBcbiAgICAgICAgICAgIC8qY3VycmVudD0qLyAhMSwgbi5yZXN1bWVUb2tlbiksIGh1KHMucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSBcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzIHN0aWxsIGFjdGl2ZSBzaW5jZSB0aGUgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlblxuICAgICAgICAvLyByZW1vdmVkIGlmIGl0IGhhcyBiZWVuIHJlamVjdGVkIGJ5IHRoZSBiYWNrZW5kLlxuICAgICAgICBzLnJjLmhhcyh0KSAmJiBcbiAgICAgICAgLy8gUmVsZWFzZSBxdWVyaWVzIHRoYXQgYXJlIHN0aWxsIGFjdGl2ZS5cbiAgICAgICAgYXdhaXQgU28ocy5sb2NhbFN0b3JlLCB0LCBcbiAgICAgICAgLyoga2VlcFBlcnNpc3RlZFRhcmdldERhdGEgKi8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIGx1KHMucmVtb3RlU3RvcmUsIHQpLCBnYyhzLCB0KTtcbiAgICAgICAgfSkpLmNhdGNoKEV0KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGtjKHQpIHtcbiAgICBjb25zdCBlID0gJCh0KTtcbiAgICByZXR1cm4gZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudCA9IGFjLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBSYy5iaW5kKG51bGwsIGUpLCBcbiAgICBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4gPSBsYy5iaW5kKG51bGwsIGUpLCBlLnNjLldvID0gUXUuYmluZChudWxsLCBlLmV2ZW50TWFuYWdlciksIFxuICAgIGUuc2Mud2MgPSBqdS5iaW5kKG51bGwsIGUuZXZlbnRNYW5hZ2VyKSwgZTtcbn1cblxuZnVuY3Rpb24gT2ModCkge1xuICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgIHJldHVybiBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZSA9IGZjLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlID0gZGMuYmluZChudWxsLCBlKSwgXG4gICAgZTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgU0RLLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgYnVuZGxlIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBTeW5jRW5naW5lIHRvIHVzZS5cbiAqIEBwYXJhbSBidW5kbGVSZWFkZXIgLSBCdW5kbGUgdG8gbG9hZCBpbnRvIHRoZSBTREsuXG4gKiBAcGFyYW0gdGFzayAtIExvYWRCdW5kbGVUYXNrIHVzZWQgdG8gdXBkYXRlIHRoZSBsb2FkaW5nIHByb2dyZXNzIHRvIHB1YmxpYyBBUEkuXG4gKi8gZnVuY3Rpb24gTWModCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSAkKHQpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgKFxuICAgIC8qKiBMb2FkcyBhIGJ1bmRsZSBhbmQgcmV0dXJucyB0aGUgbGlzdCBvZiBhZmZlY3RlZCBjb2xsZWN0aW9uIGdyb3Vwcy4gKi9cbiAgICBhc3luYyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzID0gYXdhaXQgZS5nZXRNZXRhZGF0YSgpO1xuICAgICAgICAgICAgaWYgKGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gJCh0KSwgcyA9IERzKGUuY3JlYXRlVGltZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJoYXNOZXdlckJ1bmRsZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IG4uTnMuZ2V0QnVuZGxlTWV0YWRhdGEodCwgZS5pZCkpKS50aGVuKCh0ID0+ICEhdCAmJiB0LmNyZWF0ZVRpbWUuY29tcGFyZVRvKHMpID49IDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogU2F2ZXMgdGhlIGdpdmVuIGBCdW5kbGVNZXRhZGF0YWAgdG8gbG9jYWwgcGVyc2lzdGVuY2UuXG4gKi8gKHQubG9jYWxTdG9yZSwgcykpIHJldHVybiBhd2FpdCBlLmNsb3NlKCksIG4uX2NvbXBsZXRlV2l0aChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza1N0YXRlOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiB0LnRvdGFsRG9jdW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICBieXRlc0xvYWRlZDogdC50b3RhbEJ5dGVzLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbERvY3VtZW50czogdC50b3RhbERvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxCeXRlczogdC50b3RhbEJ5dGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0ocykpLCBQcm9taXNlLnJlc29sdmUobmV3IFNldCk7XG4gICAgICAgICAgICBuLl91cGRhdGVQcm9ncmVzcyhYdShzKSk7XG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IFl1KHMsIHQubG9jYWxTdG9yZSwgZS5JdCk7XG4gICAgICAgICAgICBsZXQgciA9IGF3YWl0IGUubWMoKTtcbiAgICAgICAgICAgIGZvciAoO3I7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBhd2FpdCBpLkZ1KHIpO1xuICAgICAgICAgICAgICAgIHQgJiYgbi5fdXBkYXRlUHJvZ3Jlc3ModCksIHIgPSBhd2FpdCBlLm1jKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBvID0gYXdhaXQgaS5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IEVjKHQsIG8uTHUsIFxuICAgICAgICAgICAgLyogcmVtb3RlRXZlbnQgKi8gdm9pZCAwKSwgXG4gICAgICAgICAgICAvLyBTYXZlIG1ldGFkYXRhLCBzbyBsb2FkaW5nIHRoZSBzYW1lIGJ1bmRsZSB3aWxsIHNraXAuXG4gICAgICAgICAgICBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9ICQodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJTYXZlIGJ1bmRsZVwiLCBcInJlYWR3cml0ZVwiLCAodCA9PiBuLk5zLnNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSBvZiBhIGBOYW1lZFF1ZXJ5YCBhc3NvY2lhdGVkIHdpdGggZ2l2ZW4gcXVlcnkgbmFtZS4gUHJvbWlzZVxuICogcmVzb2x2ZXMgdG8gdW5kZWZpbmVkIGlmIG5vIHBlcnNpc3RlZCBkYXRhIGNhbiBiZSBmb3VuZC5cbiAqLyAodC5sb2NhbFN0b3JlLCBzKSwgbi5fY29tcGxldGVXaXRoKG8ucHJvZ3Jlc3MpLCBQcm9taXNlLnJlc29sdmUoby5CdSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBOKFwiU3luY0VuZ2luZVwiLCBgTG9hZGluZyBidW5kbGUgZmFpbGVkIHdpdGggJHt0fWApLCBuLl9mYWlsV2l0aCh0KSwgUHJvbWlzZS5yZXNvbHZlKG5ldyBTZXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIGluLW1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAqIFVzZXMgRWFnZXJHQyBnYXJiYWdlIGNvbGxlY3Rpb24uXG4gKi8pKHMsIGUsIG4pLnRoZW4oKHQgPT4ge1xuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLm5vdGlmeUJ1bmRsZUxvYWRlZCh0KTtcbiAgICB9KSk7XG59XG5cbmNsYXNzIEZjIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZSh0KSB7XG4gICAgICAgIHRoaXMuSXQgPSBabyh0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHRoaXMuZ2ModCksIHRoaXMucGVyc2lzdGVuY2UgPSB0aGlzLnljKHQpLCBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zdGFydCgpLCB0aGlzLmxvY2FsU3RvcmUgPSB0aGlzLkljKHQpLCB0aGlzLmdjU2NoZWR1bGVyID0gdGhpcy5UYyh0LCB0aGlzLmxvY2FsU3RvcmUpLCBcbiAgICAgICAgdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIgPSB0aGlzLkVjKHQsIHRoaXMubG9jYWxTdG9yZSk7XG4gICAgfVxuICAgIFRjKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIEVjKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIEljKHQpIHtcbiAgICAgICAgcmV0dXJuIFRvKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBwbywgdC5pbml0aWFsVXNlciwgdGhpcy5JdCk7XG4gICAgfVxuICAgIHljKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1byhhby5CcywgdGhpcy5JdCk7XG4gICAgfVxuICAgIGdjKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRbztcbiAgICB9XG4gICAgYXN5bmMgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmdjU2NoZWR1bGVyICYmIHRoaXMuZ2NTY2hlZHVsZXIuc3RvcCgpLCBhd2FpdCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnNodXRkb3duKCksIFxuICAgICAgICBhd2FpdCB0aGlzLnBlcnNpc3RlbmNlLnNodXRkb3duKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggSW5kZXhlZERCIHBlcnNpc3RlbmNlLlxuICovIGNsYXNzICRjIGV4dGVuZHMgRmMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5BYyA9IHQsIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSBlLCB0aGlzLmZvcmNlT3duZXJzaGlwID0gbiwgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMTtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZSh0KSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLmluaXRpYWxpemUodCksIGF3YWl0IHRoaXMuQWMuaW5pdGlhbGl6ZSh0aGlzLCB0KSwgXG4gICAgICAgIC8vIEVucXVldWUgd3JpdGVzIGZyb20gYSBwcmV2aW91cyBzZXNzaW9uXG4gICAgICAgIGF3YWl0IE9jKHRoaXMuQWMuc3luY0VuZ2luZSksIGF3YWl0IEF1KHRoaXMuQWMucmVtb3RlU3RvcmUpLCBcbiAgICAgICAgLy8gTk9URTogVGhpcyB3aWxsIGltbWVkaWF0ZWx5IGNhbGwgdGhlIGxpc3RlbmVyLCBzbyB3ZSBtYWtlIHN1cmUgdG9cbiAgICAgICAgLy8gc2V0IGl0IGFmdGVyIGxvY2FsU3RvcmUgLyByZW1vdGVTdG9yZSBhcmUgc3RhcnRlZC5cbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5saSgoKCkgPT4gKHRoaXMuZ2NTY2hlZHVsZXIgJiYgIXRoaXMuZ2NTY2hlZHVsZXIuc3RhcnRlZCAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0KCksIFxuICAgICAgICB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlciAmJiAhdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIuc3RhcnRlZCAmJiB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdGFydCgpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgfVxuICAgIEljKHQpIHtcbiAgICAgICAgcmV0dXJuIFRvKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBwbywgdC5pbml0aWFsVXNlciwgdGhpcy5JdCk7XG4gICAgfVxuICAgIFRjKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuZ2FyYmFnZUNvbGxlY3RvcjtcbiAgICAgICAgcmV0dXJuIG5ldyAkcihuLCB0LmFzeW5jUXVldWUsIGUpO1xuICAgIH1cbiAgICBFYyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcga3QoZSwgdGhpcy5wZXJzaXN0ZW5jZSk7XG4gICAgICAgIHJldHVybiBuZXcgTnQodC5hc3luY1F1ZXVlLCBuKTtcbiAgICB9XG4gICAgeWModCkge1xuICAgICAgICBjb25zdCBlID0gZ28odC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCwgdC5kYXRhYmFzZUluZm8ucGVyc2lzdGVuY2VLZXkpLCBuID0gdm9pZCAwICE9PSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID8gQXIud2l0aENhY2hlU2l6ZSh0aGlzLmNhY2hlU2l6ZUJ5dGVzKSA6IEFyLkRFRkFVTFQ7XG4gICAgICAgIHJldHVybiBuZXcgX28odGhpcy5zeW5jaHJvbml6ZVRhYnMsIGUsIHQuY2xpZW50SWQsIG4sIHQuYXN5bmNRdWV1ZSwgWW8oKSwgWG8oKSwgdGhpcy5JdCwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgISF0aGlzLmZvcmNlT3duZXJzaGlwKTtcbiAgICB9XG4gICAgZ2ModCkge1xuICAgICAgICByZXR1cm4gbmV3IFFvO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIG11bHRpLXRhYiBJbmRleGVkREJcbiAqIHBlcnNpc3RlbmNlLlxuICpcbiAqIEluIHRoZSBsZWdhY3kgY2xpZW50LCB0aGlzIHByb3ZpZGVyIGlzIHVzZWQgdG8gcHJvdmlkZSBib3RoIG11bHRpLXRhYiBhbmRcbiAqIG5vbi1tdWx0aS10YWIgcGVyc2lzdGVuY2Ugc2luY2Ugd2UgY2Fubm90IHRlbGwgYXQgYnVpbGQgdGltZSB3aGV0aGVyXG4gKiBgc3luY2hyb25pemVUYWJzYCB3aWxsIGJlIGVuYWJsZWQuXG4gKi8gY2xhc3MgQmMgZXh0ZW5kcyAkYyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlLCAvKiBmb3JjZU93bmVyc2hpcD0gKi8gITEpLCB0aGlzLkFjID0gdCwgdGhpcy5jYWNoZVNpemVCeXRlcyA9IGUsIHRoaXMuc3luY2hyb25pemVUYWJzID0gITA7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5BYy5zeW5jRW5naW5lO1xuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlIGluc3RhbmNlb2YgR28gJiYgKHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3luY0VuZ2luZSA9IHtcbiAgICAgICAgICAgIEZyOiB2Yy5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgJHI6IHhjLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBCcjogTmMuYmluZChudWxsLCBlKSxcbiAgICAgICAgICAgIHZpOiBDYy5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgTXI6IFBjLmJpbmQobnVsbCwgZSlcbiAgICAgICAgfSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zdGFydCgpKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2UubGkoKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgYXdhaXQgVmModGhpcy5BYy5zeW5jRW5naW5lLCB0KSwgdGhpcy5nY1NjaGVkdWxlciAmJiAodCAmJiAhdGhpcy5nY1NjaGVkdWxlci5zdGFydGVkID8gdGhpcy5nY1NjaGVkdWxlci5zdGFydCgpIDogdCB8fCB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSksIFxuICAgICAgICAgICAgdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIgJiYgKHQgJiYgIXRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyLnN0YXJ0ZWQgPyB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdGFydCgpIDogdCB8fCB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlci5zdG9wKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdjKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFlvKCk7XG4gICAgICAgIGlmICghR28uQyhlKSkgdGhyb3cgbmV3IEwoQi5VTklNUExFTUVOVEVELCBcIkluZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS5cIik7XG4gICAgICAgIGNvbnN0IG4gPSBnbyh0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB0LmRhdGFiYXNlSW5mby5wZXJzaXN0ZW5jZUtleSk7XG4gICAgICAgIHJldHVybiBuZXcgR28oZSwgdC5hc3luY1F1ZXVlLCBuLCB0LmNsaWVudElkLCB0LmluaXRpYWxVc2VyKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYW5kIHdpcmVzIHRoZSBjb21wb25lbnRzIHRoYXQgYXJlIG5lZWRlZCB0byBpbnRlcmZhY2Ugd2l0aCB0aGVcbiAqIG5ldHdvcmsuXG4gKi8gY2xhc3MgTGMge1xuICAgIGFzeW5jIGluaXRpYWxpemUodCwgZSkge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgfHwgKHRoaXMubG9jYWxTdG9yZSA9IHQubG9jYWxTdG9yZSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHQuc2hhcmVkQ2xpZW50U3RhdGUsIFxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHRoaXMuY3JlYXRlRGF0YXN0b3JlKGUpLCB0aGlzLnJlbW90ZVN0b3JlID0gdGhpcy5jcmVhdGVSZW1vdGVTdG9yZShlKSwgXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gdGhpcy5jcmVhdGVFdmVudE1hbmFnZXIoZSksIHRoaXMuc3luY0VuZ2luZSA9IHRoaXMuY3JlYXRlU3luY0VuZ2luZShlLCBcbiAgICAgICAgLyogc3RhcnRBc1ByaW1hcnk9Ki8gIXQuc3luY2hyb25pemVUYWJzKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5vbmxpbmVTdGF0ZUhhbmRsZXIgPSB0ID0+IGhjKHRoaXMuc3luY0VuZ2luZSwgdCwgMSAvKiBTaGFyZWRDbGllbnRTdGF0ZSAqLyksIFxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gQWMuYmluZChudWxsLCB0aGlzLnN5bmNFbmdpbmUpLCBcbiAgICAgICAgYXdhaXQgTnUodGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zeW5jRW5naW5lLmlzUHJpbWFyeUNsaWVudCkpO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IHF1O1xuICAgIH1cbiAgICBjcmVhdGVEYXRhc3RvcmUodCkge1xuICAgICAgICBjb25zdCBlID0gWm8odC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIG4gPSAocyA9IHQuZGF0YWJhc2VJbmZvLCBuZXcgSm8ocykpO1xuICAgICAgICB2YXIgcztcbiAgICAgICAgLyoqIFJldHVybiB0aGUgUGxhdGZvcm0tc3BlY2lmaWMgY29ubmVjdGl2aXR5IG1vbml0b3IuICovICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBpdSh0LCBlLCBuLCBzKTtcbiAgICAgICAgfSh0LmF1dGhDcmVkZW50aWFscywgdC5hcHBDaGVja0NyZWRlbnRpYWxzLCBuLCBlKTtcbiAgICB9XG4gICAgY3JlYXRlUmVtb3RlU3RvcmUodCkge1xuICAgICAgICByZXR1cm4gZSA9IHRoaXMubG9jYWxTdG9yZSwgbiA9IHRoaXMuZGF0YXN0b3JlLCBzID0gdC5hc3luY1F1ZXVlLCBpID0gdCA9PiBoYyh0aGlzLnN5bmNFbmdpbmUsIHQsIDAgLyogUmVtb3RlU3RvcmUgKi8pLCBcbiAgICAgICAgciA9IFdvLkMoKSA/IG5ldyBXbyA6IG5ldyBqbywgbmV3IHV1KGUsIG4sIHMsIGksIHIpO1xuICAgICAgICB2YXIgZSwgbiwgcywgaSwgcjtcbiAgICAgICAgLyoqIFJlLWVuYWJsZXMgdGhlIG5ldHdvcmsuIElkZW1wb3RlbnQuICovICAgIH1cbiAgICBjcmVhdGVTeW5jRW5naW5lKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIFxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE1hbmFnZXMgc3RhdGUgc3luY2hyb25pemF0aW9uIGluIG11bHRpLXRhYiBlbnZpcm9ubWVudHMuXG4gICAgICAgIHMsIGksIHIsIG8pIHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBuZXcgaWModCwgZSwgbiwgcywgaSwgcik7XG4gICAgICAgICAgICByZXR1cm4gbyAmJiAodS5kYyA9ICEwKSwgdTtcbiAgICAgICAgfSh0aGlzLmxvY2FsU3RvcmUsIHRoaXMucmVtb3RlU3RvcmUsIHRoaXMuZXZlbnRNYW5hZ2VyLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLCB0LmluaXRpYWxVc2VyLCB0Lm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zLCBlKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICByZXR1cm4gYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9ICQodCk7XG4gICAgICAgICAgICBDKFwiUmVtb3RlU3RvcmVcIiwgXCJSZW1vdGVTdG9yZSBzaHV0dGluZyBkb3duLlwiKSwgZS5fdS5hZGQoNSAvKiBTaHV0ZG93biAqLyksIGF3YWl0IGF1KGUpLCBcbiAgICAgICAgICAgIGUubXUuc2h1dGRvd24oKSwgXG4gICAgICAgICAgICAvLyBTZXQgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gKHJhdGhlciB0aGFuIE9mZmxpbmUpIHRvIGF2b2lkIHBvdGVudGlhbGx5XG4gICAgICAgICAgICAvLyB0cmlnZ2VyaW5nIHNwdXJpb3VzIGxpc3RlbmVyIGV2ZW50cyB3aXRoIGNhY2hlZCBkYXRhLCBldGMuXG4gICAgICAgICAgICBlLmd1LnNldChcIlVua25vd25cIiAvKiBVbmtub3duICovKTtcbiAgICAgICAgfSh0aGlzLnJlbW90ZVN0b3JlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIFVjKHQsIGUsIG4pIHtcbiAgICBpZiAoIW4pIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSBjYW5ub3QgYmUgY2FsbGVkIHdpdGggYW4gZW1wdHkgJHtlfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0d28gYm9vbGVhbiBvcHRpb25zIGFyZSBub3Qgc2V0IGF0IHRoZSBzYW1lIHRpbWUuXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBxYyh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKCEwID09PSBlICYmICEwID09PSBzKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGAke3R9IGFuZCAke259IGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyLmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBkb2N1bWVudCAoaW5kaWNhdGVkIGJ5IHRoZSBmYWN0IGl0IGNvbnRhaW5zXG4gKiBhbiBldmVuIG51bWJlcnMgb2Ygc2VnbWVudHMpLlxuICovIGZ1bmN0aW9uIEtjKHQpIHtcbiAgICBpZiAoIWN0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgZG9jdW1lbnQgcmVmZXJlbmNlLiBEb2N1bWVudCByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBjb2xsZWN0aW9uIChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXRcbiAqIGNvbnRhaW5zIGFuIG9kZCBudW1iZXJzIG9mIHNlZ21lbnRzKS5cbiAqLyBmdW5jdGlvbiBHYyh0KSB7XG4gICAgaWYgKGN0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiByZWZlcmVuY2UuIENvbGxlY3Rpb24gcmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCdzIGEgbm9uLW51bGwgb2JqZWN0IHdpdGhvdXQgYSBjdXN0b20gcHJvdG90eXBlXG4gKiAoaS5lLiBleGNsdWRlcyBBcnJheSwgRGF0ZSwgZXRjLikuXG4gKi9cbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovXG5mdW5jdGlvbiBRYyh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgcmV0dXJuIFwidW5kZWZpbmVkXCI7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBcIm51bGxcIjtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHQubGVuZ3RoID4gMjAgJiYgKHQgPSBgJHt0LnN1YnN0cmluZygwLCAyMCl9Li4uYCksIFxuICAgIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0IHx8IFwiYm9vbGVhblwiID09IHR5cGVvZiB0KSByZXR1cm4gXCJcIiArIHQ7XG4gICAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIHQpIHtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBBcnJheSkgcmV0dXJuIFwiYW4gYXJyYXlcIjtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAgICAgLyoqIHRyeSB0byBnZXQgdGhlIGNvbnN0cnVjdG9yIG5hbWUgZm9yIGFuIG9iamVjdC4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAodC5jb25zdHJ1Y3RvcikgcmV0dXJuIHQuY29uc3RydWN0b3IubmFtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQ2FzdHMgYG9iamAgdG8gYFRgLCBvcHRpb25hbGx5IHVud3JhcHBpbmcgQ29tcGF0IHR5cGVzIHRvIGV4cG9zZSB0aGVcbiAqIHVuZGVybHlpbmcgaW5zdGFuY2UuIFRocm93cyBpZiAgYG9iamAgaXMgbm90IGFuIGluc3RhbmNlIG9mIGBUYC5cbiAqXG4gKiBUaGlzIGNhc3QgaXMgdXNlZCBpbiB0aGUgTGl0ZSBhbmQgRnVsbCBTREsgdG8gdmVyaWZ5IGluc3RhbmNlIHR5cGVzIGZvclxuICogYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgcHVibGljIEFQSS5cbiAqIEBpbnRlcm5hbFxuICovICh0KTtcbiAgICAgICAgICAgIHJldHVybiBlID8gYGEgY3VzdG9tICR7ZX0gb2JqZWN0YCA6IFwiYW4gb2JqZWN0XCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCA/IFwiYSBmdW5jdGlvblwiIDogTygpO1xufVxuXG5mdW5jdGlvbiBqYyh0LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5lKSB7XG4gICAgaWYgKFwiX2RlbGVnYXRlXCIgaW4gdCAmJiAoXG4gICAgLy8gVW53cmFwIENvbXBhdCB0eXBlc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCA9IHQuX2RlbGVnYXRlKSwgISh0IGluc3RhbmNlb2YgZSkpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gdC5jb25zdHJ1Y3Rvci5uYW1lKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiVHlwZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgaW5zdGFuY2UuIERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBTREs/XCIpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBuID0gUWModCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBFeHBlY3RlZCB0eXBlICcke2UubmFtZX0nLCBidXQgaXQgd2FzOiAke259YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbmZ1bmN0aW9uIFdjKHQsIGUpIHtcbiAgICBpZiAoZSA8PSAwKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke3R9KCkgcmVxdWlyZXMgYSBwb3NpdGl2ZSBudW1iZXIsIGJ1dCBpdCB3YXM6ICR7ZX0uYCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHpjID0gbmV3IE1hcDtcblxuLyoqXG4gKiBBbiBpbnN0YW5jZSBtYXAgdGhhdCBlbnN1cmVzIG9ubHkgb25lIERhdGFzdG9yZSBleGlzdHMgcGVyIEZpcmVzdG9yZVxuICogaW5zdGFuY2UuXG4gKi9cbi8qKlxuICogQSBjb25jcmV0ZSB0eXBlIGRlc2NyaWJpbmcgYWxsIHRoZSB2YWx1ZXMgdGhhdCBjYW4gYmUgYXBwbGllZCB2aWEgYVxuICogdXNlci1zdXBwbGllZCBgRmlyZXN0b3JlU2V0dGluZ3NgIG9iamVjdC4gVGhpcyBpcyBhIHNlcGFyYXRlIHR5cGUgc28gdGhhdFxuICogZGVmYXVsdHMgY2FuIGJlIHN1cHBsaWVkIGFuZCB0aGUgdmFsdWUgY2FuIGJlIGNoZWNrZWQgZm9yIGVxdWFsaXR5LlxuICovXG5jbGFzcyBIYyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gdC5ob3N0KSB7XG4gICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LnNzbCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIkNhbid0IHByb3ZpZGUgc3NsIG9wdGlvbiBpZiBob3N0IG9wdGlvbiBpcyBub3Qgc2V0XCIpO1xuICAgICAgICAgICAgdGhpcy5ob3N0ID0gXCJmaXJlc3RvcmUuZ29vZ2xlYXBpcy5jb21cIiwgdGhpcy5zc2wgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgdGhpcy5ob3N0ID0gdC5ob3N0LCB0aGlzLnNzbCA9IG51bGwgPT09IChlID0gdC5zc2wpIHx8IHZvaWQgMCA9PT0gZSB8fCBlO1xuICAgICAgICBpZiAodGhpcy5jcmVkZW50aWFscyA9IHQuY3JlZGVudGlhbHMsIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9ICEhdC5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzLCBcbiAgICAgICAgdm9pZCAwID09PSB0LmNhY2hlU2l6ZUJ5dGVzKSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gNDE5NDMwNDA7IGVsc2Uge1xuICAgICAgICAgICAgaWYgKC0xICE9PSB0LmNhY2hlU2l6ZUJ5dGVzICYmIHQuY2FjaGVTaXplQnl0ZXMgPCAxMDQ4NTc2KSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiY2FjaGVTaXplQnl0ZXMgbXVzdCBiZSBhdCBsZWFzdCAxMDQ4NTc2XCIpO1xuICAgICAgICAgICAgdGhpcy5jYWNoZVNpemVCeXRlcyA9IHQuY2FjaGVTaXplQnl0ZXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nID0gISF0LmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nID0gISF0LmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZywgXG4gICAgICAgIHRoaXMudXNlRmV0Y2hTdHJlYW1zID0gISF0LnVzZUZldGNoU3RyZWFtcywgcWMoXCJleHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nXCIsIHQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgXCJleHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmdcIiwgdC5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaG9zdCA9PT0gdC5ob3N0ICYmIHRoaXMuc3NsID09PSB0LnNzbCAmJiB0aGlzLmNyZWRlbnRpYWxzID09PSB0LmNyZWRlbnRpYWxzICYmIHRoaXMuY2FjaGVTaXplQnl0ZXMgPT09IHQuY2FjaGVTaXplQnl0ZXMgJiYgdGhpcy5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nID09PSB0LmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgJiYgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPT09IHQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nICYmIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9PT0gdC5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzICYmIHRoaXMudXNlRmV0Y2hTdHJlYW1zID09PSB0LnVzZUZldGNoU3RyZWFtcztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBDbG91ZCBGaXJlc3RvcmUgc2VydmljZSBpbnRlcmZhY2UuXG4gKlxuICogRG8gbm90IGNhbGwgdGhpcyBjb25zdHJ1Y3RvciBkaXJlY3RseS4gSW5zdGVhZCwgdXNlIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS5cbiAqLyBjbGFzcyBKYyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuX2F1dGhDcmVkZW50aWFscyA9IHQsIHRoaXMuX2FwcENoZWNrQ3JlZGVudGlhbHMgPSBlLCB0aGlzLl9kYXRhYmFzZUlkID0gbiwgXG4gICAgICAgIHRoaXMuX2FwcCA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCdzIGEgRmlyZXN0b3JlIG9yIEZpcmVzdG9yZSBMaXRlIGluc3RhbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJmaXJlc3RvcmUtbGl0ZVwiLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwiKGxpdGUpXCIsIHRoaXMuX3NldHRpbmdzID0gbmV3IEhjKHt9KSwgXG4gICAgICAgIHRoaXMuX3NldHRpbmdzRnJvemVuID0gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gYXNzb2NpYXRlZCB3aXRoIHRoaXMgYEZpcmVzdG9yZWAgc2VydmljZVxuICAgICAqIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgYXBwKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FwcCkgdGhyb3cgbmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIG5vdCBhdmFpbGFibGVcIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHA7XG4gICAgfVxuICAgIGdldCBfaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbjtcbiAgICB9XG4gICAgZ2V0IF90ZXJtaW5hdGVkKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICBfc2V0U2V0dGluZ3ModCkge1xuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3NGcm96ZW4pIHRocm93IG5ldyBMKEIuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciBiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgbW9kaWZ5IHNldHRpbmdzIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gbmV3IEhjKHQpLCB2b2lkIDAgIT09IHQuY3JlZGVudGlhbHMgJiYgKHRoaXMuX2F1dGhDcmVkZW50aWFscyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGlmICghdCkgcmV0dXJuIG5ldyBLO1xuICAgICAgICAgICAgc3dpdGNoICh0LnR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSBcImdhcGlcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jbGllbnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBXKGUsIHQuc2Vzc2lvbkluZGV4IHx8IFwiMFwiLCB0LmlhbVRva2VuIHx8IG51bGwsIHQuYXV0aFRva2VuRmFjdG9yeSB8fCBudWxsKTtcblxuICAgICAgICAgICAgICBjYXNlIFwicHJvdmlkZXJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5jbGllbnQ7XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwibWFrZUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIGZhaWxlZCBkdWUgdG8gaW52YWxpZCBjcmVkZW50aWFsIHR5cGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0odC5jcmVkZW50aWFscykpO1xuICAgIH1cbiAgICBfZ2V0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncztcbiAgICB9XG4gICAgX2ZyZWV6ZVNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMCwgdGhpcy5fc2V0dGluZ3M7XG4gICAgfVxuICAgIF9kZWxldGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXJtaW5hdGVUYXNrIHx8ICh0aGlzLl90ZXJtaW5hdGVUYXNrID0gdGhpcy5fdGVybWluYXRlKCkpLCB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYEZpcmVzdG9yZWAgaW5zdGFuY2UuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFwcDogdGhpcy5fYXBwLFxuICAgICAgICAgICAgZGF0YWJhc2VJZDogdGhpcy5fZGF0YWJhc2VJZCxcbiAgICAgICAgICAgIHNldHRpbmdzOiB0aGlzLl9zZXR0aW5nc1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZXJtaW5hdGVzIGFsbCBjb21wb25lbnRzIHVzZWQgYnkgdGhpcyBjbGllbnQuIFN1YmNsYXNzZXMgY2FuIG92ZXJyaWRlXG4gICAgICogdGhpcyBtZXRob2QgdG8gY2xlYW4gdXAgdGhlaXIgb3duIGRlcGVuZGVuY2llcywgYnV0IG11c3QgYWxzbyBjYWxsIHRoaXNcbiAgICAgKiBtZXRob2QuXG4gICAgICpcbiAgICAgKiBPbmx5IGV2ZXIgY2FsbGVkIG9uY2UuXG4gICAgICovICAgIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIC8qKlxuICogUmVtb3ZlcyBhbGwgY29tcG9uZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGluc3RhbmNlLiBNdXN0IGJlIGNhbGxlZFxuICogd2hlbiB0aGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgaXMgdGVybWluYXRlZC5cbiAqL1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHpjLmdldCh0KTtcbiAgICAgICAgICAgIGUgJiYgKEMoXCJDb21wb25lbnRQcm92aWRlclwiLCBcIlJlbW92aW5nIERhdGFzdG9yZVwiKSwgemMuZGVsZXRlKHQpLCBlLnRlcm1pbmF0ZSgpKTtcbiAgICAgICAgfSh0aGlzKSwgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1vZGlmeSB0aGlzIGluc3RhbmNlIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIENsb3VkIEZpcmVzdG9yZSBlbXVsYXRvci5cbiAqXG4gKiBOb3RlOiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSB0aGlzIGluc3RhbmNlIGhhcyBiZWVuIHVzZWQgdG8gZG8gYW55XG4gKiBvcGVyYXRpb25zLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgdG8gY29uZmlndXJlIHRvIGNvbm5lY3QgdG8gdGhlXG4gKiBlbXVsYXRvci5cbiAqIEBwYXJhbSBob3N0IC0gdGhlIGVtdWxhdG9yIGhvc3QgKGV4OiBsb2NhbGhvc3QpLlxuICogQHBhcmFtIHBvcnQgLSB0aGUgZW11bGF0b3IgcG9ydCAoZXg6IDkwMDApLlxuICogQHBhcmFtIG9wdGlvbnMubW9ja1VzZXJUb2tlbiAtIHRoZSBtb2NrIGF1dGggdG9rZW4gdG8gdXNlIGZvciB1bml0IHRlc3RpbmdcbiAqIFNlY3VyaXR5IFJ1bGVzLlxuICovIGZ1bmN0aW9uIFljKHQsIGUsIG4sIHMgPSB7fSkge1xuICAgIHZhciBpO1xuICAgIGNvbnN0IHIgPSAodCA9IGpjKHQsIEpjKSkuX2dldFNldHRpbmdzKCk7XG4gICAgaWYgKFwiZmlyZXN0b3JlLmdvb2dsZWFwaXMuY29tXCIgIT09IHIuaG9zdCAmJiByLmhvc3QgIT09IGUgJiYgTihcIkhvc3QgaGFzIGJlZW4gc2V0IGluIGJvdGggc2V0dGluZ3MoKSBhbmQgdXNlRW11bGF0b3IoKSwgZW11bGF0b3IgaG9zdCB3aWxsIGJlIHVzZWRcIiksIFxuICAgIHQuX3NldFNldHRpbmdzKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgciksIHtcbiAgICAgICAgaG9zdDogYCR7ZX06JHtufWAsXG4gICAgICAgIHNzbDogITFcbiAgICB9KSksIHMubW9ja1VzZXJUb2tlbikge1xuICAgICAgICBsZXQgZSwgbjtcbiAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHMubW9ja1VzZXJUb2tlbikgZSA9IHMubW9ja1VzZXJUb2tlbiwgbiA9IFAuTU9DS19VU0VSOyBlbHNlIHtcbiAgICAgICAgICAgIC8vIExldCBjcmVhdGVNb2NrVXNlclRva2VuIHZhbGlkYXRlIGZpcnN0IChjYXRjaGVzIGNvbW1vbiBtaXN0YWtlcyBsaWtlXG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpZWxkIFwidWlkXCIgYW5kIG1pc3NpbmcgZmllbGQgXCJzdWJcIiAvIFwidXNlcl9pZFwiLilcbiAgICAgICAgICAgIGUgPSBjcmVhdGVNb2NrVXNlclRva2VuKHMubW9ja1VzZXJUb2tlbiwgbnVsbCA9PT0gKGkgPSB0Ll9hcHApIHx8IHZvaWQgMCA9PT0gaSA/IHZvaWQgMCA6IGkub3B0aW9ucy5wcm9qZWN0SWQpO1xuICAgICAgICAgICAgY29uc3QgciA9IHMubW9ja1VzZXJUb2tlbi5zdWIgfHwgcy5tb2NrVXNlclRva2VuLnVzZXJfaWQ7XG4gICAgICAgICAgICBpZiAoIXIpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJtb2NrVXNlclRva2VuIG11c3QgY29udGFpbiAnc3ViJyBvciAndXNlcl9pZCcgZmllbGQhXCIpO1xuICAgICAgICAgICAgbiA9IG5ldyBQKHIpO1xuICAgICAgICB9XG4gICAgICAgIHQuX2F1dGhDcmVkZW50aWFscyA9IG5ldyBHKG5ldyBxKGUsIG4pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYERvY3VtZW50UmVmZXJlbmNlYCByZWZlcnMgdG8gYSBkb2N1bWVudCBsb2NhdGlvbiBpbiBhIEZpcmVzdG9yZSBkYXRhYmFzZVxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHdyaXRlLCByZWFkLCBvciBsaXN0ZW4gdG8gdGhlIGxvY2F0aW9uLiBUaGUgZG9jdW1lbnQgYXRcbiAqIHRoZSByZWZlcmVuY2VkIGxvY2F0aW9uIG1heSBvciBtYXkgbm90IGV4aXN0LlxuICovIGNsYXNzIFhjIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJkb2N1bWVudFwiLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGdldCBfcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZG9jdW1lbnQncyBpZGVudGlmaWVyIHdpdGhpbiBpdHMgY29sbGVjdGlvbi5cbiAgICAgKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwYXRoIG9mIHRoZSByZWZlcmVuY2VkIGRvY3VtZW50IChyZWxhdGl2ZVxuICAgICAqIHRvIHRoZSByb290IG9mIHRoZSBkYXRhYmFzZSkuXG4gICAgICovICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBiZWxvbmdzIHRvLlxuICAgICAqLyAgICBnZXQgcGFyZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IHRhKHRoaXMuZmlyZXN0b3JlLCB0aGlzLmNvbnZlcnRlciwgdGhpcy5fa2V5LnBhdGgucG9wTGFzdCgpKTtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWGModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX2tleSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5YCByZWZlcnMgdG8gYSBxdWVyeSB3aGljaCB5b3UgY2FuIHJlYWQgb3IgbGlzdGVuIHRvLiBZb3UgY2FuIGFsc29cbiAqIGNvbnN0cnVjdCByZWZpbmVkIGBRdWVyeWAgb2JqZWN0cyBieSBhZGRpbmcgZmlsdGVycyBhbmQgb3JkZXJpbmcuXG4gKi8gY2xhc3MgWmMge1xuICAgIC8vIFRoaXMgaXMgdGhlIGxpdGUgdmVyc2lvbiBvZiB0aGUgUXVlcnkgY2xhc3MgaW4gdGhlIG1haW4gU0RLLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9xdWVyeSA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcInF1ZXJ5XCIsIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWmModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX3F1ZXJ5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgQ29sbGVjdGlvblJlZmVyZW5jZWAgb2JqZWN0IGNhbiBiZSB1c2VkIGZvciBhZGRpbmcgZG9jdW1lbnRzLCBnZXR0aW5nXG4gKiBkb2N1bWVudCByZWZlcmVuY2VzLCBhbmQgcXVlcnlpbmcgZm9yIGRvY3VtZW50cyAodXNpbmcge0BsaW5rIHF1ZXJ5fSkuXG4gKi8gY2xhc3MgdGEgZXh0ZW5kcyBaYyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIGVuKG4pKSwgdGhpcy5fcGF0aCA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImNvbGxlY3Rpb25cIjtcbiAgICB9XG4gICAgLyoqIFRoZSBjb2xsZWN0aW9uJ3MgaWRlbnRpZmllci4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgY29sbGVjdGlvbiAocmVsYXRpdmVcbiAgICAgKiB0byB0aGUgcm9vdCBvZiB0aGUgZGF0YWJhc2UpLlxuICAgICAqLyAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgcmVmZXJlbmNlIHRvIHRoZSBjb250YWluaW5nIGBEb2N1bWVudFJlZmVyZW5jZWAgaWYgdGhpcyBpcyBhXG4gICAgICogc3ViY29sbGVjdGlvbi4gSWYgdGhpcyBpc24ndCBhIHN1YmNvbGxlY3Rpb24sIHRoZSByZWZlcmVuY2UgaXMgbnVsbC5cbiAgICAgKi8gICAgZ2V0IHBhcmVudCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhdGgucG9wTGFzdCgpO1xuICAgICAgICByZXR1cm4gdC5pc0VtcHR5KCkgPyBudWxsIDogbmV3IFhjKHRoaXMuZmlyZXN0b3JlLCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgY3QodCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB0YSh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcGF0aCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBlYSh0LCBlLCAuLi5uKSB7XG4gICAgaWYgKHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCksIFVjKFwiY29sbGVjdGlvblwiLCBcInBhdGhcIiwgZSksIHQgaW5zdGFuY2VvZiBKYykge1xuICAgICAgICBjb25zdCBzID0gcnQuZnJvbVN0cmluZyhlLCAuLi5uKTtcbiAgICAgICAgcmV0dXJuIEdjKHMpLCBuZXcgdGEodCwgLyogY29udmVydGVyPSAqLyBudWxsLCBzKTtcbiAgICB9XG4gICAge1xuICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgWGMgfHwgdCBpbnN0YW5jZW9mIHRhKSkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIkV4cGVjdGVkIGZpcnN0IGFyZ3VtZW50IHRvIGNvbGxlY3Rpb24oKSB0byBiZSBhIENvbGxlY3Rpb25SZWZlcmVuY2UsIGEgRG9jdW1lbnRSZWZlcmVuY2Ugb3IgRmlyZWJhc2VGaXJlc3RvcmVcIik7XG4gICAgICAgIGNvbnN0IHMgPSB0Ll9wYXRoLmNoaWxkKHJ0LmZyb21TdHJpbmcoZSwgLi4ubikpO1xuICAgICAgICByZXR1cm4gR2MocyksIG5ldyB0YSh0LmZpcmVzdG9yZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZWxpdGUpOiBDb25zaWRlciB1c2luZyBFcnJvckZhY3RvcnkgLVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzAxMzFlMWYvcGFja2FnZXMvdXRpbC9zcmMvZXJyb3JzLnRzI0wxMDZcbi8qKlxuICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBgUXVlcnlgIGluc3RhbmNlIHRoYXQgaW5jbHVkZXMgYWxsIGRvY3VtZW50cyBpbiB0aGVcbiAqIGRhdGFiYXNlIHRoYXQgYXJlIGNvbnRhaW5lZCBpbiBhIGNvbGxlY3Rpb24gb3Igc3ViY29sbGVjdGlvbiB3aXRoIHRoZVxuICogZ2l2ZW4gYGNvbGxlY3Rpb25JZGAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSByb290IGBGaXJlc3RvcmVgIGluc3RhbmNlLlxuICogQHBhcmFtIGNvbGxlY3Rpb25JZCAtIElkZW50aWZpZXMgdGhlIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IG92ZXIuIEV2ZXJ5XG4gKiBjb2xsZWN0aW9uIG9yIHN1YmNvbGxlY3Rpb24gd2l0aCB0aGlzIElEIGFzIHRoZSBsYXN0IHNlZ21lbnQgb2YgaXRzIHBhdGhcbiAqIHdpbGwgYmUgaW5jbHVkZWQuIENhbm5vdCBjb250YWluIGEgc2xhc2guXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCBgUXVlcnlgLlxuICovIGZ1bmN0aW9uIG5hKHQsIGUpIHtcbiAgICBpZiAodCA9IGpjKHQsIEpjKSwgVWMoXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJjb2xsZWN0aW9uIGlkXCIsIGUpLCBlLmluZGV4T2YoXCIvXCIpID49IDApIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiBJRCAnJHtlfScgcGFzc2VkIHRvIGZ1bmN0aW9uIGNvbGxlY3Rpb25Hcm91cCgpLiBDb2xsZWN0aW9uIElEcyBtdXN0IG5vdCBjb250YWluICcvJy5gKTtcbiAgICByZXR1cm4gbmV3IFpjKHQsIFxuICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgXG4gICAgLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHNcbiAqIHdpdGhpbiB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBncm91cC5cbiAqL1xuICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBaZShydC5lbXB0eVBhdGgoKSwgdCk7XG4gICAgfShlKSk7XG59XG5cbmZ1bmN0aW9uIHNhKHQsIGUsIC4uLm4pIHtcbiAgICBpZiAodCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgXG4gICAgLy8gV2UgYWxsb3cgb21pc3Npb24gb2YgJ3BhdGhTdHJpbmcnIGJ1dCBleHBsaWNpdGx5IHByb2hpYml0IHBhc3NpbmcgaW4gYm90aFxuICAgIC8vICd1bmRlZmluZWQnIGFuZCAnbnVsbCcuXG4gICAgMSA9PT0gYXJndW1lbnRzLmxlbmd0aCAmJiAoZSA9IFguUigpKSwgVWMoXCJkb2NcIiwgXCJwYXRoXCIsIGUpLCB0IGluc3RhbmNlb2YgSmMpIHtcbiAgICAgICAgY29uc3QgcyA9IHJ0LmZyb21TdHJpbmcoZSwgLi4ubik7XG4gICAgICAgIHJldHVybiBLYyhzKSwgbmV3IFhjKHQsIFxuICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIG5ldyBjdChzKSk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIFhjIHx8IHQgaW5zdGFuY2VvZiB0YSkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCBzID0gdC5fcGF0aC5jaGlsZChydC5mcm9tU3RyaW5nKGUsIC4uLm4pKTtcbiAgICAgICAgcmV0dXJuIEtjKHMpLCBuZXcgWGModC5maXJlc3RvcmUsIHQgaW5zdGFuY2VvZiB0YSA/IHQuY29udmVydGVyIDogbnVsbCwgbmV3IGN0KHMpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCByZWZlcmVuY2VzIGFyZSBlcXVhbC5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgcmVmZXJlbmNlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlcyBwb2ludCB0byB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgc2FtZVxuICogRmlyZXN0b3JlIGRhdGFiYXNlLlxuICovIGZ1bmN0aW9uIGlhKHQsIGUpIHtcbiAgICByZXR1cm4gdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgKHQgaW5zdGFuY2VvZiBYYyB8fCB0IGluc3RhbmNlb2YgdGEpICYmIChlIGluc3RhbmNlb2YgWGMgfHwgZSBpbnN0YW5jZW9mIHRhKSAmJiAodC5maXJlc3RvcmUgPT09IGUuZmlyZXN0b3JlICYmIHQucGF0aCA9PT0gZS5wYXRoICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBxdWVyaWVzIHBvaW50IHRvIHRoZSBzYW1lIGNvbGxlY3Rpb24gYW5kIGFwcGx5XG4gKiB0aGUgc2FtZSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBgUXVlcnlgIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2VzIHBvaW50IHRvIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBzYW1lXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UuXG4gKi8gZnVuY3Rpb24gcmEodCwgZSkge1xuICAgIHJldHVybiB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpLCB0IGluc3RhbmNlb2YgWmMgJiYgZSBpbnN0YW5jZW9mIFpjICYmICh0LmZpcmVzdG9yZSA9PT0gZS5maXJlc3RvcmUgJiYgaG4odC5fcXVlcnksIGUuX3F1ZXJ5KSAmJiB0LmNvbnZlcnRlciA9PT0gZS5jb252ZXJ0ZXIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIb3cgbWFueSBieXRlcyB0byByZWFkIGVhY2ggdGltZSB3aGVuIGBSZWFkYWJsZVN0cmVhbVJlYWRlci5yZWFkKClgIGlzXG4gKiBjYWxsZWQuIE9ubHkgYXBwbGljYWJsZSBmb3IgYnl0ZSBzdHJlYW1zIHRoYXQgd2UgY29udHJvbCAoZS5nLiB0aG9zZSBiYWNrZWRcbiAqIGJ5IGFuIFVJbnQ4QXJyYXkpLlxuICovXG4vKipcbiAqIEJ1aWxkcyBhIGBCeXRlU3RyZWFtUmVhZGVyYCBmcm9tIGEgVUludDhBcnJheS5cbiAqIEBwYXJhbSBzb3VyY2UgLSBUaGUgZGF0YSBzb3VyY2UgdG8gdXNlLlxuICogQHBhcmFtIGJ5dGVzUGVyUmVhZCAtIEhvdyBtYW55IGJ5dGVzIGVhY2ggYHJlYWQoKWAgZnJvbSB0aGUgcmV0dXJuZWQgcmVhZGVyXG4gKiAgICAgICAgd2lsbCByZWFkLlxuICovXG5mdW5jdGlvbiBvYSh0LCBlID0gMTAyNDApIHtcbiAgICBsZXQgbiA9IDA7XG4gICAgLy8gVGhlIFR5cGVTY3JpcHQgZGVmaW5pdGlvbiBmb3IgUmVhZGFibGVTdHJlYW1SZWFkZXIgY2hhbmdlZC4gV2UgdXNlXG4gICAgLy8gYGFueWAgaGVyZSB0byBhbGxvdyB0aGlzIGNvZGUgdG8gY29tcGlsZSB3aXRoIGRpZmZlcmVudCB2ZXJzaW9ucy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy80Mjk3MFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGFzeW5jIHJlYWQoKSB7XG4gICAgICAgICAgICBpZiAobiA8IHQuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnNsaWNlKG4sIG4gKyBlKSxcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogITFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBuICs9IGUsIHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjYW5jZWwoKSB7fSxcbiAgICAgICAgcmVsZWFzZUxvY2soKSB7fSxcbiAgICAgICAgY2xvc2VkOiBQcm9taXNlLnJlamVjdChcInVuaW1wbGVtZW50ZWRcIilcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBPbiB3ZWIsIGEgYFJlYWRhYmxlU3RyZWFtYCBpcyB3cmFwcGVkIGFyb3VuZCBieSBhIGBCeXRlU3RyZWFtUmVhZGVyYC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxuICovXG5jbGFzcyB1YSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGVkID0gITE7XG4gICAgfVxuICAgIG5leHQodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm5leHQgJiYgdGhpcy5SYyh0aGlzLm9ic2VydmVyLm5leHQsIHQpO1xuICAgIH1cbiAgICBlcnJvcih0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIuZXJyb3IgPyB0aGlzLlJjKHRoaXMub2JzZXJ2ZXIuZXJyb3IsIHQpIDogeChcIlVuY2F1Z2h0IEVycm9yIGluIHNuYXBzaG90IGxpc3RlbmVyOlwiLCB0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBiYygpIHtcbiAgICAgICAgdGhpcy5tdXRlZCA9ICEwO1xuICAgIH1cbiAgICBSYyh0LCBlKSB7XG4gICAgICAgIHRoaXMubXV0ZWQgfHwgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5tdXRlZCB8fCB0KGUpO1xuICAgICAgICB9KSwgMCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNsYXNzIHJlcHJlc2VudGluZyBhIGJ1bmRsZS5cbiAqXG4gKiBUYWtlcyBhIGJ1bmRsZSBzdHJlYW0gb3IgYnVmZmVyLCBhbmQgcHJlc2VudHMgYWJzdHJhY3Rpb25zIHRvIHJlYWQgYnVuZGxlZFxuICogZWxlbWVudHMgb3V0IG9mIHRoZSB1bmRlcmx5aW5nIGNvbnRlbnQuXG4gKi8gY2xhc3MgY2Ege1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgcmVhZGVyIHRvIHJlYWQgZnJvbSB1bmRlcmx5aW5nIGJpbmFyeSBidW5kbGUgZGF0YSBzb3VyY2UuICovXG4gICAgdCwgZSkge1xuICAgICAgICB0aGlzLlBjID0gdCwgdGhpcy5JdCA9IGUsIFxuICAgICAgICAvKiogQ2FjaGVkIGJ1bmRsZSBtZXRhZGF0YS4gKi9cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBVLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGJ1ZmZlciB0byBob2xkIGJ1bmRsZSBjb250ZW50LCBhY2N1bXVsYXRpbmcgaW5jb21wbGV0ZSBlbGVtZW50XG4gICAgICAgICAqIGNvbnRlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5LCB0aGlzLnZjID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIiksIFxuICAgICAgICAvLyBSZWFkIHRoZSBtZXRhZGF0YSAod2hpY2ggaXMgdGhlIGZpcnN0IGVsZW1lbnQpLlxuICAgICAgICB0aGlzLlZjKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0ICYmIHQuT3UoKSA/IHRoaXMubWV0YWRhdGEucmVzb2x2ZSh0Lmt1Lm1ldGFkYXRhKSA6IHRoaXMubWV0YWRhdGEucmVqZWN0KG5ldyBFcnJvcihgVGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGJ1bmRsZSBpcyBub3QgYSBtZXRhZGF0YSwgaXQgaXNcXG4gICAgICAgICAgICAgJHtKU09OLnN0cmluZ2lmeShudWxsID09IHQgPyB2b2lkIDAgOiB0Lmt1KX1gKSk7XG4gICAgICAgIH0pLCAodCA9PiB0aGlzLm1ldGFkYXRhLnJlamVjdCh0KSkpO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUGMuY2FuY2VsKCk7XG4gICAgfVxuICAgIGFzeW5jIGdldE1ldGFkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZXRhZGF0YS5wcm9taXNlO1xuICAgIH1cbiAgICBhc3luYyBtYygpIHtcbiAgICAgICAgLy8gTWFrZXMgc3VyZSBtZXRhZGF0YSBpcyByZWFkIGJlZm9yZSBwcm9jZWVkaW5nLlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRNZXRhZGF0YSgpLCB0aGlzLlZjKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGhlYWQgb2YgaW50ZXJuYWwgYnVmZmVyLCBhbmQgcHVsbGluZyBtb3JlIGRhdGEgZnJvbVxuICAgICAqIHVuZGVybHlpbmcgc3RyZWFtIGlmIGEgY29tcGxldGUgZWxlbWVudCBjYW5ub3QgYmUgZm91bmQsIHVudGlsIGFuXG4gICAgICogZWxlbWVudChpbmNsdWRpbmcgdGhlIHByZWZpeGVkIGxlbmd0aCBhbmQgdGhlIEpTT04gc3RyaW5nKSBpcyBmb3VuZC5cbiAgICAgKlxuICAgICAqIE9uY2UgYSBjb21wbGV0ZSBlbGVtZW50IGlzIHJlYWQsIGl0IGlzIGRyb3BwZWQgZnJvbSBpbnRlcm5hbCBidWZmZXIuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGVpdGhlciB0aGUgYnVuZGxlZCBlbGVtZW50LCBvciBudWxsIGlmIHdlIGhhdmUgcmVhY2hlZCB0aGUgZW5kIG9mXG4gICAgICogdGhlIHN0cmVhbS5cbiAgICAgKi8gICAgYXN5bmMgVmMoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB0aGlzLlNjKCk7XG4gICAgICAgIGlmIChudWxsID09PSB0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMudmMuZGVjb2RlKHQpLCBuID0gTnVtYmVyKGUpO1xuICAgICAgICBpc05hTihuKSAmJiB0aGlzLkRjKGBsZW5ndGggc3RyaW5nICgke2V9KSBpcyBub3QgdmFsaWQgbnVtYmVyYCk7XG4gICAgICAgIGNvbnN0IHMgPSBhd2FpdCB0aGlzLkNjKG4pO1xuICAgICAgICByZXR1cm4gbmV3IEh1KEpTT04ucGFyc2UocyksIHQubGVuZ3RoICsgbik7XG4gICAgfVxuICAgIC8qKiBGaXJzdCBpbmRleCBvZiAneycgZnJvbSB0aGUgdW5kZXJseWluZyBidWZmZXIuICovICAgIHhjKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIuZmluZEluZGV4KCh0ID0+IHQgPT09IFwie1wiLmNoYXJDb2RlQXQoMCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBpbnRlcm5hbCBidWZmZXIsIHVudGlsIHRoZSBmaXJzdCAneycsIGFuZFxuICAgICAqIHJldHVybiB0aGUgY29udGVudC5cbiAgICAgKlxuICAgICAqIElmIHJlYWNoZWQgZW5kIG9mIHRoZSBzdHJlYW0sIHJldHVybnMgYSBudWxsLlxuICAgICAqLyAgICBhc3luYyBTYygpIHtcbiAgICAgICAgZm9yICg7dGhpcy54YygpIDwgMDsgKSB7XG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5OYygpKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAvLyBCcm9rZSBvdXQgb2YgdGhlIGxvb3AgYmVjYXVzZSB1bmRlcmx5aW5nIHN0cmVhbSBpcyBjbG9zZWQsIGFuZCB0aGVyZVxuICAgICAgICAvLyBoYXBwZW5zIHRvIGJlIG5vIG1vcmUgZGF0YSB0byBwcm9jZXNzLlxuICAgICAgICAgICAgICAgIGlmICgwID09PSB0aGlzLmJ1ZmZlci5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy54YygpO1xuICAgICAgICAvLyBCcm9rZSBvdXQgb2YgdGhlIGxvb3AgYmVjYXVzZSB1bmRlcmx5aW5nIHN0cmVhbSBpcyBjbG9zZWQsIGJ1dCBzdGlsbFxuICAgICAgICAvLyBjYW5ub3QgZmluZCBhbiBvcGVuIGJyYWNrZXQuXG4gICAgICAgICAgICAgICAgdCA8IDAgJiYgdGhpcy5EYyhcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBhIGxlbmd0aCBzdHJpbmcgaXMgZXhwZWN0ZWQuXCIpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5idWZmZXIuc2xpY2UoMCwgdCk7XG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgaW50ZXJuYWwgYnVmZmVyIHRvIGRyb3AgdGhlIHJlYWQgbGVuZ3RoLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKHQpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIGEgc3BlY2lmaWVkIHBvc2l0aW9uIGZyb20gdGhlIGludGVybmFsIGJ1ZmZlciwgZm9yIGEgc3BlY2lmaWVkXG4gICAgICogbnVtYmVyIG9mIGJ5dGVzLCBwdWxsaW5nIG1vcmUgZGF0YSBmcm9tIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBpZiBuZWVkZWQuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIGRlY29kZWQgZnJvbSB0aGUgcmVhZCBieXRlcy5cbiAgICAgKi8gICAgYXN5bmMgQ2ModCkge1xuICAgICAgICBmb3IgKDt0aGlzLmJ1ZmZlci5sZW5ndGggPCB0OyApIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuTmMoKSAmJiB0aGlzLkRjKFwiUmVhY2hlZCB0aGUgZW5kIG9mIGJ1bmRsZSB3aGVuIG1vcmUgaXMgZXhwZWN0ZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnZjLmRlY29kZSh0aGlzLmJ1ZmZlci5zbGljZSgwLCB0KSk7XG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgaW50ZXJuYWwgYnVmZmVyIHRvIGRyb3AgdGhlIHJlYWQganNvbiBzdHJpbmcuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuc2xpY2UodCksIGU7XG4gICAgfVxuICAgIERjKHQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aHJvdyB0aGlzLlBjLmNhbmNlbCgpLCBuZXcgRXJyb3IoYEludmFsaWQgYnVuZGxlIGZvcm1hdDogJHt0fWApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQdWxscyBtb3JlIGRhdGEgZnJvbSB1bmRlcmx5aW5nIHN0cmVhbSB0byBpbnRlcm5hbCBidWZmZXIuXG4gICAgICogUmV0dXJucyBhIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBzdHJlYW0gaXMgZmluaXNoZWQuXG4gICAgICovICAgIGFzeW5jIE5jKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5QYy5yZWFkKCk7XG4gICAgICAgIGlmICghdC5kb25lKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIubGVuZ3RoICsgdC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICAgICAgZS5zZXQodGhpcy5idWZmZXIpLCBlLnNldCh0LnZhbHVlLCB0aGlzLmJ1ZmZlci5sZW5ndGgpLCB0aGlzLmJ1ZmZlciA9IGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQuZG9uZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYW4gYWdncmVnYXRpb24gdGhhdCBjYW4gYmUgcGVyZm9ybWVkIGJ5IEZpcmVzdG9yZS5cbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuY2xhc3MgYWEge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvKiogQSB0eXBlIHN0cmluZyB0byB1bmlxdWVseSBpZGVudGlmeSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcy4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJBZ2dyZWdhdGVGaWVsZFwiO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGUgcmVzdWx0cyBvZiBleGVjdXRpbmcgYW4gYWdncmVnYXRpb24gcXVlcnkuXG4gKi8gY2xhc3MgaGEge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9kYXRhID0gZSwgXG4gICAgICAgIC8qKiBBIHR5cGUgc3RyaW5nIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcIkFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RcIiwgdGhpcy5xdWVyeSA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHJlc3VsdHMgb2YgdGhlIGFnZ3JlZ2F0aW9ucyBwZXJmb3JtZWQgb3ZlciB0aGUgdW5kZXJseWluZ1xuICAgICAqIHF1ZXJ5LlxuICAgICAqXG4gICAgICogVGhlIGtleXMgb2YgdGhlIHJldHVybmVkIG9iamVjdCB3aWxsIGJlIHRoZSBzYW1lIGFzIHRob3NlIG9mIHRoZVxuICAgICAqIGBBZ2dyZWdhdGVTcGVjYCBvYmplY3Qgc3BlY2lmaWVkIHRvIHRoZSBhZ2dyZWdhdGlvbiBtZXRob2QsIGFuZCB0aGUgdmFsdWVzXG4gICAgICogd2lsbCBiZSB0aGUgY29ycmVzcG9uZGluZyBhZ2dyZWdhdGlvbiByZXN1bHQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVzdWx0cyBvZiB0aGUgYWdncmVnYXRpb25zIHBlcmZvcm1lZCBvdmVyIHRoZSB1bmRlcmx5aW5nXG4gICAgICogcXVlcnkuXG4gICAgICovICAgIGRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ291bnRRdWVyeVJ1bm5lciBlbmNhcHN1bGF0ZXMgdGhlIGxvZ2ljIG5lZWRlZCB0byBydW4gdGhlIGNvdW50IGFnZ3JlZ2F0aW9uXG4gKiBxdWVyaWVzLlxuICovIGNsYXNzIGxhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLmRhdGFzdG9yZSA9IGUsIHRoaXMudXNlckRhdGFXcml0ZXIgPSBuO1xuICAgIH1cbiAgICBydW4oKSB7XG4gICAgICAgIHJldHVybiBydSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5xdWVyeS5fcXVlcnkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgTSh2b2lkIDAgIT09IHRbMF0pO1xuICAgICAgICAgICAgY29uc3QgZSA9IE9iamVjdC5lbnRyaWVzKHRbMF0pLmZpbHRlcigoKFt0LCBlXSkgPT4gXCJjb3VudF9hbGlhc1wiID09PSB0KSkubWFwKCgoW3QsIGVdKSA9PiB0aGlzLnVzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZShlKSkpWzBdO1xuICAgICAgICAgICAgcmV0dXJuIE0oXCJudW1iZXJcIiA9PSB0eXBlb2YgZSksIFByb21pc2UucmVzb2x2ZShuZXcgaGEodGhpcy5xdWVyeSwge1xuICAgICAgICAgICAgICAgIGNvdW50OiBlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEludGVybmFsIHRyYW5zYWN0aW9uIG9iamVjdCByZXNwb25zaWJsZSBmb3IgYWNjdW11bGF0aW5nIHRoZSBtdXRhdGlvbnMgdG9cbiAqIHBlcmZvcm0gYW5kIHRoZSBiYXNlIHZlcnNpb25zIGZvciBhbnkgZG9jdW1lbnRzIHJlYWQuXG4gKi8gY2xhc3MgZmEge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5kYXRhc3RvcmUgPSB0LCBcbiAgICAgICAgLy8gVGhlIHZlcnNpb24gb2YgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGR1cmluZyB0aGlzIHRyYW5zYWN0aW9uLlxuICAgICAgICB0aGlzLnJlYWRWZXJzaW9ucyA9IG5ldyBNYXAsIHRoaXMubXV0YXRpb25zID0gW10sIHRoaXMuY29tbWl0dGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBkZWZlcnJlZCB1c2FnZSBlcnJvciB0aGF0IG9jY3VycmVkIHByZXZpb3VzbHkgaW4gdGhpcyB0cmFuc2FjdGlvbiB0aGF0XG4gICAgICAgICAqIHdpbGwgY2F1c2UgdGhlIHRyYW5zYWN0aW9uIHRvIGZhaWwgb25jZSBpdCBhY3R1YWxseSBjb21taXRzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5sYXN0V3JpdGVFcnJvciA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogU2V0IG9mIGRvY3VtZW50cyB0aGF0IGhhdmUgYmVlbiB3cml0dGVuIGluIHRoZSB0cmFuc2FjdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogV2hlbiB0aGVyZSdzIG1vcmUgdGhhbiBvbmUgd3JpdGUgdG8gdGhlIHNhbWUga2V5IGluIGEgdHJhbnNhY3Rpb24sIGFueVxuICAgICAgICAgKiB3cml0ZXMgYWZ0ZXIgdGhlIGZpcnN0IGFyZSBoYW5kbGVkIGRpZmZlcmVudGx5LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53cml0dGVuRG9jcyA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIGFzeW5jIGxvb2t1cCh0KSB7XG4gICAgICAgIGlmICh0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLm11dGF0aW9ucy5sZW5ndGggPiAwKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiRmlyZXN0b3JlIHRyYW5zYWN0aW9ucyByZXF1aXJlIGFsbCByZWFkcyB0byBiZSBleGVjdXRlZCBiZWZvcmUgYWxsIHdyaXRlcy5cIik7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gJCh0KSwgcyA9IEZzKG4uSXQpICsgXCIvZG9jdW1lbnRzXCIsIGkgPSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBlLm1hcCgodCA9PiBOcyhuLkl0LCB0KSkpXG4gICAgICAgICAgICB9LCByID0gYXdhaXQgbi5fbyhcIkJhdGNoR2V0RG9jdW1lbnRzXCIsIHMsIGksIGUubGVuZ3RoKSwgbyA9IG5ldyBNYXA7XG4gICAgICAgICAgICByLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBVcyhuLkl0LCB0KTtcbiAgICAgICAgICAgICAgICBvLnNldChlLmtleS50b1N0cmluZygpLCBlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBvLmdldCh0LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIE0oISFlKSwgdS5wdXNoKGUpO1xuICAgICAgICAgICAgfSkpLCB1O1xuICAgICAgICB9KHRoaXMuZGF0YXN0b3JlLCB0KTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB0aGlzLnJlY29yZFZlcnNpb24odCkpKSwgZTtcbiAgICB9XG4gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgdGhpcy53cml0ZShlLnRvTXV0YXRpb24odCwgdGhpcy5wcmVjb25kaXRpb24odCkpKSwgdGhpcy53cml0dGVuRG9jcy5hZGQodC50b1N0cmluZygpKTtcbiAgICB9XG4gICAgdXBkYXRlKHQsIGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud3JpdGUoZS50b011dGF0aW9uKHQsIHRoaXMucHJlY29uZGl0aW9uRm9yVXBkYXRlKHQpKSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIHRoaXMubGFzdFdyaXRlRXJyb3IgPSB0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIHRoaXMud3JpdGUobmV3IHpuKHQsIHRoaXMucHJlY29uZGl0aW9uKHQpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIGFzeW5jIGNvbW1pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCksIHRoaXMubGFzdFdyaXRlRXJyb3IpIHRocm93IHRoaXMubGFzdFdyaXRlRXJyb3I7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLnJlYWRWZXJzaW9ucztcbiAgICAgICAgLy8gRm9yIGVhY2ggbXV0YXRpb24sIG5vdGUgdGhhdCB0aGUgZG9jIHdhcyB3cml0dGVuLlxuICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25zLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdC5kZWxldGUoZS5rZXkudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEZvciBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgYnV0IG5vdCB3cml0dGVuIHRvLCB3ZSB3YW50IHRvIHBlcmZvcm1cbiAgICAgICAgLy8gYSBgdmVyaWZ5YCBvcGVyYXRpb24uXG4gICAgICAgIHQuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBjdC5mcm9tUGF0aChlKTtcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25zLnB1c2gobmV3IEhuKG4sIHRoaXMucHJlY29uZGl0aW9uKG4pKSk7XG4gICAgICAgIH0pKSwgYXdhaXQgYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9ICQodCksIHMgPSBGcyhuLkl0KSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIHdyaXRlczogZS5tYXAoKHQgPT4gS3Mobi5JdCwgdCkpKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGF3YWl0IG4uYW8oXCJDb21taXRcIiwgcywgaSk7XG4gICAgICAgIH0odGhpcy5kYXRhc3RvcmUsIHRoaXMubXV0YXRpb25zKSwgdGhpcy5jb21taXR0ZWQgPSAhMDtcbiAgICB9XG4gICAgcmVjb3JkVmVyc2lvbih0KSB7XG4gICAgICAgIGxldCBlO1xuICAgICAgICBpZiAodC5pc0ZvdW5kRG9jdW1lbnQoKSkgZSA9IHQudmVyc2lvbjsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIXQuaXNOb0RvY3VtZW50KCkpIHRocm93IE8oKTtcbiAgICAgICAgICAgIC8vIFJlcHJlc2VudCBhIGRlbGV0ZWQgZG9jIHVzaW5nIFNuYXBzaG90VmVyc2lvbi5taW4oKS5cbiAgICAgICAgICAgIGUgPSBzdC5taW4oKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgaWYgKCFlLmlzRXF1YWwobikpIFxuICAgICAgICAgICAgLy8gVGhpcyB0cmFuc2FjdGlvbiB3aWxsIGZhaWwgbm8gbWF0dGVyIHdoYXQuXG4gICAgICAgICAgICB0aHJvdyBuZXcgTChCLkFCT1JURUQsIFwiRG9jdW1lbnQgdmVyc2lvbiBjaGFuZ2VkIGJldHdlZW4gdHdvIHJlYWRzLlwiKTtcbiAgICAgICAgfSBlbHNlIHRoaXMucmVhZFZlcnNpb25zLnNldCh0LmtleS50b1N0cmluZygpLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmVyc2lvbiBvZiB0aGlzIGRvY3VtZW50IHdoZW4gaXQgd2FzIHJlYWQgaW4gdGhpcyB0cmFuc2FjdGlvbixcbiAgICAgKiBhcyBhIHByZWNvbmRpdGlvbiwgb3Igbm8gcHJlY29uZGl0aW9uIGlmIGl0IHdhcyBub3QgcmVhZC5cbiAgICAgKi8gICAgcHJlY29uZGl0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMucmVhZFZlcnNpb25zLmdldCh0LnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gIXRoaXMud3JpdHRlbkRvY3MuaGFzKHQudG9TdHJpbmcoKSkgJiYgZSA/IGUuaXNFcXVhbChzdC5taW4oKSkgPyBPbi5leGlzdHMoITEpIDogT24udXBkYXRlVGltZShlKSA6IE9uLm5vbmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJlY29uZGl0aW9uIGZvciBhIGRvY3VtZW50IGlmIHRoZSBvcGVyYXRpb24gaXMgYW4gdXBkYXRlLlxuICAgICAqLyAgICBwcmVjb25kaXRpb25Gb3JVcGRhdGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIC8vIFRoZSBmaXJzdCB0aW1lIGEgZG9jdW1lbnQgaXMgd3JpdHRlbiwgd2Ugd2FudCB0byB0YWtlIGludG8gYWNjb3VudCB0aGVcbiAgICAgICAgLy8gcmVhZCB0aW1lIGFuZCBleGlzdGVuY2VcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud3JpdHRlbkRvY3MuaGFzKHQudG9TdHJpbmcoKSkgJiYgZSkge1xuICAgICAgICAgICAgaWYgKGUuaXNFcXVhbChzdC5taW4oKSkpIFxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgdmFsaWRhdGVkIGxvY2FsbHkgYmVjYXVzZSB5b3UgY2FuJ3Qgc2VuZCBhXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb24gdGhhdCBhIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IHdpdGhvdXQgY2hhbmdpbmcgdGhlXG4gICAgICAgICAgICAvLyBzZW1hbnRpY3Mgb2YgdGhlIGJhY2tlbmQgd3JpdGUgdG8gYmUgYW4gaW5zZXJ0LiBUaGlzIGlzIHRoZSByZXZlcnNlXG4gICAgICAgICAgICAvLyBvZiB3aGF0IHdlIHdhbnQsIHNpbmNlIHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgIC8vIGV4aXN0IGJ1dCB0aGVuIHNlbmQgdGhlIHVwZGF0ZSBhbmQgaGF2ZSBpdCBmYWlsLiBTaW5jZSB3ZSBjYW4ndFxuICAgICAgICAgICAgLy8gZXhwcmVzcyB0aGF0IHRvIHRoZSBiYWNrZW5kLCB3ZSBoYXZlIHRvIHZhbGlkYXRlIGxvY2FsbHkuXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGlzIGNhbiBjaGFuZ2Ugb25jZSB3ZSBjYW4gc2VuZCBzZXBhcmF0ZSB2ZXJpZnkgd3JpdGVzIGluIHRoZVxuICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgdXBkYXRlIGEgZG9jdW1lbnQgdGhhdCBkb2Vzbid0IGV4aXN0LlwiKTtcbiAgICAgICAgICAgIC8vIERvY3VtZW50IGV4aXN0cywgYmFzZSBwcmVjb25kaXRpb24gb24gZG9jdW1lbnQgdXBkYXRlIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT24udXBkYXRlVGltZShlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb2N1bWVudCB3YXMgbm90IHJlYWQsIHNvIHdlIGp1c3QgdXNlIHRoZSBwcmVjb25kaXRpb25zIGZvciBhIGJsaW5kXG4gICAgICAgIC8vIHVwZGF0ZS5cbiAgICAgICAgcmV0dXJuIE9uLmV4aXN0cyghMCk7XG4gICAgfVxuICAgIHdyaXRlKHQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMucHVzaCh0KTtcbiAgICB9XG4gICAgZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVHJhbnNhY3Rpb25SdW5uZXIgZW5jYXBzdWxhdGVzIHRoZSBsb2dpYyBuZWVkZWQgdG8gcnVuIGFuZCByZXRyeSB0cmFuc2FjdGlvbnNcbiAqIHdpdGggYmFja29mZi5cbiAqLyBjbGFzcyBkYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLmRhdGFzdG9yZSA9IGUsIHRoaXMub3B0aW9ucyA9IG4sIHRoaXMudXBkYXRlRnVuY3Rpb24gPSBzLCBcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IGksIHRoaXMua2MgPSBuLm1heEF0dGVtcHRzLCB0aGlzLnhvID0gbmV3IHR1KHRoaXMuYXN5bmNRdWV1ZSwgXCJ0cmFuc2FjdGlvbl9yZXRyeVwiIC8qIFRyYW5zYWN0aW9uUmV0cnkgKi8pO1xuICAgIH1cbiAgICAvKiogUnVucyB0aGUgdHJhbnNhY3Rpb24gYW5kIHNldHMgdGhlIHJlc3VsdCBvbiBkZWZlcnJlZC4gKi8gICAgcnVuKCkge1xuICAgICAgICB0aGlzLmtjIC09IDEsIHRoaXMuT2MoKTtcbiAgICB9XG4gICAgT2MoKSB7XG4gICAgICAgIHRoaXMueG8uUm8oKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgZmEodGhpcy5kYXRhc3RvcmUpLCBlID0gdGhpcy5NYyh0KTtcbiAgICAgICAgICAgIGUgJiYgZS50aGVuKChlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gdC5jb21taXQoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmZXJyZWQucmVzb2x2ZShlKTtcbiAgICAgICAgICAgICAgICB9KSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLkZjKHQpO1xuICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgfSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLkZjKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIE1jKHQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnVwZGF0ZUZ1bmN0aW9uKHQpO1xuICAgICAgICAgICAgcmV0dXJuICFzZShlKSAmJiBlLmNhdGNoICYmIGUudGhlbiA/IGUgOiAodGhpcy5kZWZlcnJlZC5yZWplY3QoRXJyb3IoXCJUcmFuc2FjdGlvbiBjYWxsYmFjayBtdXN0IHJldHVybiBhIFByb21pc2VcIikpLCBcbiAgICAgICAgICAgIG51bGwpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBEbyBub3QgcmV0cnkgZXJyb3JzIHRocm93biBieSB1c2VyIHByb3ZpZGVkIHVwZGF0ZUZ1bmN0aW9uLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmZXJyZWQucmVqZWN0KHQpLCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIEZjKHQpIHtcbiAgICAgICAgdGhpcy5rYyA+IDAgJiYgdGhpcy4kYyh0KSA/ICh0aGlzLmtjIC09IDEsIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiAodGhpcy5PYygpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSkpIDogdGhpcy5kZWZlcnJlZC5yZWplY3QodCk7XG4gICAgfVxuICAgICRjKHQpIHtcbiAgICAgICAgaWYgKFwiRmlyZWJhc2VFcnJvclwiID09PSB0Lm5hbWUpIHtcbiAgICAgICAgICAgIC8vIEluIHRyYW5zYWN0aW9ucywgdGhlIGJhY2tlbmQgd2lsbCBmYWlsIG91dGRhdGVkIHJlYWRzIHdpdGggRkFJTEVEX1BSRUNPTkRJVElPTiBhbmRcbiAgICAgICAgICAgIC8vIG5vbi1tYXRjaGluZyBkb2N1bWVudCB2ZXJzaW9ucyB3aXRoIEFCT1JURUQuIFRoZXNlIGVycm9ycyBzaG91bGQgYmUgcmV0cmllZC5cbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvZGU7XG4gICAgICAgICAgICByZXR1cm4gXCJhYm9ydGVkXCIgPT09IGUgfHwgXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIgPT09IGUgfHwgXCJhbHJlYWR5LWV4aXN0c1wiID09PSBlIHx8ICFabihlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBGaXJlc3RvcmVDbGllbnQgaXMgYSB0b3AtbGV2ZWwgY2xhc3MgdGhhdCBjb25zdHJ1Y3RzIGFuZCBvd25zIGFsbCBvZiB0aGVcbiAqIHBpZWNlcyBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGVcbiAqIGFzeW5jIHF1ZXVlIHRoYXQgaXMgc2hhcmVkIGJ5IGFsbCBvZiB0aGUgb3RoZXIgY29tcG9uZW50cyBpbiB0aGUgc3lzdGVtLlxuICovXG5jbGFzcyBfYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgXG4gICAgLyoqXG4gICAgICogQXN5bmNocm9ub3VzIHF1ZXVlIHJlc3BvbnNpYmxlIGZvciBhbGwgb2Ygb3VyIGludGVybmFsIHByb2Nlc3NpbmcuIFdoZW5cbiAgICAgKiB3ZSBnZXQgaW5jb21pbmcgd29yayBmcm9tIHRoZSB1c2VyICh2aWEgcHVibGljIEFQSSkgb3IgdGhlIG5ldHdvcmtcbiAgICAgKiAoaW5jb21pbmcgR1JQQyBtZXNzYWdlcyksIHdlIHNob3VsZCBhbHdheXMgc2NoZWR1bGUgb250byB0aGlzIHF1ZXVlLlxuICAgICAqIFRoaXMgZW5zdXJlcyBhbGwgb2Ygb3VyIHdvcmsgaXMgcHJvcGVybHkgc2VyaWFsaXplZCAoZS5nLiB3ZSBkb24ndFxuICAgICAqIHN0YXJ0IHByb2Nlc3NpbmcgYSBuZXcgb3BlcmF0aW9uIHdoaWxlIHRoZSBwcmV2aW91cyBvbmUgaXMgd2FpdGluZyBmb3JcbiAgICAgKiBhbiBhc3luYyBJL08gdG8gY29tcGxldGUpLlxuICAgICAqL1xuICAgIG4sIHMpIHtcbiAgICAgICAgdGhpcy5hdXRoQ3JlZGVudGlhbHMgPSB0LCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMgPSBlLCB0aGlzLmFzeW5jUXVldWUgPSBuLCB0aGlzLmRhdGFiYXNlSW5mbyA9IHMsIFxuICAgICAgICB0aGlzLnVzZXIgPSBQLlVOQVVUSEVOVElDQVRFRCwgdGhpcy5jbGllbnRJZCA9IFguUigpLCB0aGlzLmF1dGhDcmVkZW50aWFsTGlzdGVuZXIgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoKSwgXG4gICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFsTGlzdGVuZXIgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoKSwgdGhpcy5hdXRoQ3JlZGVudGlhbHMuc3RhcnQobiwgKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgQyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlJlY2VpdmVkIHVzZXI9XCIsIHQudWlkKSwgYXdhaXQgdGhpcy5hdXRoQ3JlZGVudGlhbExpc3RlbmVyKHQpLCBcbiAgICAgICAgICAgIHRoaXMudXNlciA9IHQ7XG4gICAgICAgIH0pKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLnN0YXJ0KG4sICh0ID0+IChDKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiUmVjZWl2ZWQgbmV3IGFwcCBjaGVjayB0b2tlbj1cIiwgdCksIFxuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbExpc3RlbmVyKHQsIHRoaXMudXNlcikpKSk7XG4gICAgfVxuICAgIGFzeW5jIGdldENvbmZpZ3VyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhc3luY1F1ZXVlOiB0aGlzLmFzeW5jUXVldWUsXG4gICAgICAgICAgICBkYXRhYmFzZUluZm86IHRoaXMuZGF0YWJhc2VJbmZvLFxuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgICBhdXRoQ3JlZGVudGlhbHM6IHRoaXMuYXV0aENyZWRlbnRpYWxzLFxuICAgICAgICAgICAgYXBwQ2hlY2tDcmVkZW50aWFsczogdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLFxuICAgICAgICAgICAgaW5pdGlhbFVzZXI6IHRoaXMudXNlcixcbiAgICAgICAgICAgIG1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOiAxMDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc2V0Q3JlZGVudGlhbENoYW5nZUxpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5hdXRoQ3JlZGVudGlhbExpc3RlbmVyID0gdDtcbiAgICB9XG4gICAgc2V0QXBwQ2hlY2tUb2tlbkNoYW5nZUxpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGF0IHRoZSBjbGllbnQgaGFzIG5vdCBiZWVuIHRlcm1pbmF0ZWQuIEVuc3VyZXMgdGhhdCBvdGhlciBtZXRob2RzIG9uXG4gICAgICogdGhpcyBjbGFzcyBjYW5ub3QgYmUgY2FsbGVkIGFmdGVyIHRoZSBjbGllbnQgaXMgdGVybWluYXRlZC5cbiAgICAgKi8gICAgdmVyaWZ5Tm90VGVybWluYXRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXN5bmNRdWV1ZS5pc1NodXR0aW5nRG93bikgdGhyb3cgbmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlRoZSBjbGllbnQgaGFzIGFscmVhZHkgYmVlbiB0ZXJtaW5hdGVkLlwiKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW50ZXJSZXN0cmljdGVkTW9kZSgpO1xuICAgICAgICBjb25zdCB0ID0gbmV3IFU7XG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMub25saW5lQ29tcG9uZW50cy50ZXJtaW5hdGUoKSwgdGhpcy5vZmZsaW5lQ29tcG9uZW50cyAmJiBhd2FpdCB0aGlzLm9mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFscy5zaHV0ZG93bigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuc2h1dGRvd24oKSwgdC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEZ1KGUsIFwiRmFpbGVkIHRvIHNodXRkb3duIHBlcnNpc3RlbmNlXCIpO1xuICAgICAgICAgICAgICAgIHQucmVqZWN0KG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHQucHJvbWlzZTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHdhKHQsIGUpIHtcbiAgICB0LmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBDKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiSW5pdGlhbGl6aW5nIE9mZmxpbmVDb21wb25lbnRQcm92aWRlclwiKTtcbiAgICBjb25zdCBuID0gYXdhaXQgdC5nZXRDb25maWd1cmF0aW9uKCk7XG4gICAgYXdhaXQgZS5pbml0aWFsaXplKG4pO1xuICAgIGxldCBzID0gbi5pbml0aWFsVXNlcjtcbiAgICB0LnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigoYXN5bmMgdCA9PiB7XG4gICAgICAgIHMuaXNFcXVhbCh0KSB8fCAoYXdhaXQgRW8oZS5sb2NhbFN0b3JlLCB0KSwgcyA9IHQpO1xuICAgIH0pKSwgXG4gICAgLy8gV2hlbiBhIHVzZXIgY2FsbHMgY2xlYXJQZXJzaXN0ZW5jZSgpIGluIG9uZSBjbGllbnQsIGFsbCBvdGhlciBjbGllbnRzXG4gICAgLy8gbmVlZCB0byBiZSB0ZXJtaW5hdGVkIHRvIGFsbG93IHRoZSBkZWxldGUgdG8gc3VjY2VlZC5cbiAgICBlLnBlcnNpc3RlbmNlLnNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCgoKSA9PiB0LnRlcm1pbmF0ZSgpKSksIHQub2ZmbGluZUNvbXBvbmVudHMgPSBlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBtYSh0LCBlKSB7XG4gICAgdC5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKTtcbiAgICBjb25zdCBuID0gYXdhaXQgZ2EodCk7XG4gICAgQyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIkluaXRpYWxpemluZyBPbmxpbmVDb21wb25lbnRQcm92aWRlclwiKTtcbiAgICBjb25zdCBzID0gYXdhaXQgdC5nZXRDb25maWd1cmF0aW9uKCk7XG4gICAgYXdhaXQgZS5pbml0aWFsaXplKG4sIHMpLCBcbiAgICAvLyBUaGUgQ3JlZGVudGlhbENoYW5nZUxpc3RlbmVyIG9mIHRoZSBvbmxpbmUgY29tcG9uZW50IHByb3ZpZGVyIHRha2VzXG4gICAgLy8gcHJlY2VkZW5jZSBvdmVyIHRoZSBvZmZsaW5lIGNvbXBvbmVudCBwcm92aWRlci5cbiAgICB0LnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigodCA9PiB4dShlLnJlbW90ZVN0b3JlLCB0KSkpLCB0LnNldEFwcENoZWNrVG9rZW5DaGFuZ2VMaXN0ZW5lcigoKHQsIG4pID0+IHh1KGUucmVtb3RlU3RvcmUsIG4pKSksIFxuICAgIHQub25saW5lQ29tcG9uZW50cyA9IGU7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdhKHQpIHtcbiAgICByZXR1cm4gdC5vZmZsaW5lQ29tcG9uZW50cyB8fCAoQyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCB3YSh0LCBuZXcgRmMpKSwgdC5vZmZsaW5lQ29tcG9uZW50cztcbn1cblxuYXN5bmMgZnVuY3Rpb24geWEodCkge1xuICAgIHJldHVybiB0Lm9ubGluZUNvbXBvbmVudHMgfHwgKEMoXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJVc2luZyBkZWZhdWx0IE9ubGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBtYSh0LCBuZXcgTGMpKSwgdC5vbmxpbmVDb21wb25lbnRzO1xufVxuXG5mdW5jdGlvbiBwYSh0KSB7XG4gICAgcmV0dXJuIGdhKHQpLnRoZW4oKHQgPT4gdC5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiBJYSh0KSB7XG4gICAgcmV0dXJuIGdhKHQpLnRoZW4oKHQgPT4gdC5sb2NhbFN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIFRhKHQpIHtcbiAgICByZXR1cm4geWEodCkudGhlbigodCA9PiB0LnJlbW90ZVN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIEVhKHQpIHtcbiAgICByZXR1cm4geWEodCkudGhlbigodCA9PiB0LnN5bmNFbmdpbmUpKTtcbn1cblxuZnVuY3Rpb24gQWEodCkge1xuICAgIHJldHVybiB5YSh0KS50aGVuKCh0ID0+IHQuZGF0YXN0b3JlKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFJhKHQpIHtcbiAgICBjb25zdCBlID0gYXdhaXQgeWEodCksIG4gPSBlLmV2ZW50TWFuYWdlcjtcbiAgICByZXR1cm4gbi5vbkxpc3RlbiA9IHJjLmJpbmQobnVsbCwgZS5zeW5jRW5naW5lKSwgbi5vblVubGlzdGVuID0gdWMuYmluZChudWxsLCBlLnN5bmNFbmdpbmUpLCBcbiAgICBuO1xufVxuXG4vKiogRW5hYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uIGFuZCByZS1lbnF1ZXVlcyBhbGwgcGVuZGluZyBvcGVyYXRpb25zLiAqLyBmdW5jdGlvbiBiYSh0KSB7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBwYSh0KSwgbiA9IGF3YWl0IFRhKHQpO1xuICAgICAgICByZXR1cm4gZS5zZXROZXR3b3JrRW5hYmxlZCghMCksIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGUuX3UuZGVsZXRlKDAgLyogVXNlckRpc2FibGVkICovKSwgY3UoZSk7XG4gICAgICAgIH0obik7XG4gICAgfSkpO1xufVxuXG4vKiogRGlzYWJsZXMgdGhlIG5ldHdvcmsgY29ubmVjdGlvbi4gUGVuZGluZyBvcGVyYXRpb25zIHdpbGwgbm90IGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBQYSh0KSB7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBwYSh0KSwgbiA9IGF3YWl0IFRhKHQpO1xuICAgICAgICByZXR1cm4gZS5zZXROZXR3b3JrRW5hYmxlZCghMSksIGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSAkKHQpO1xuICAgICAgICAgICAgZS5fdS5hZGQoMCAvKiBVc2VyRGlzYWJsZWQgKi8pLCBhd2FpdCBhdShlKSwgXG4gICAgICAgICAgICAvLyBTZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUgc28gZ2V0KClzIHJldHVybiBmcm9tIGNhY2hlLCBldGMuXG4gICAgICAgICAgICBlLmd1LnNldChcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovKTtcbiAgICAgICAgfShuKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIGFsbCB3cml0ZXMgdGhhdCB3ZXJlIHBlbmRpbmcgYXQgdGhlIHRpbWVcbiAqIHRoaXMgbWV0aG9kIHdhcyBjYWxsZWQgcmVjZWl2ZWQgc2VydmVyIGFja25vd2xlZGdlbWVudC4gQW4gYWNrbm93bGVkZ2VtZW50XG4gKiBjYW4gYmUgZWl0aGVyIGFjY2VwdGFuY2Ugb3IgcmVqZWN0aW9uLlxuICovIGZ1bmN0aW9uIHZhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gbmV3IFU7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBhc3luYyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSAkKHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwicmVhZCBkb2N1bWVudFwiLCBcInJlYWRvbmx5XCIsICh0ID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnQodCwgZSkpKTtcbiAgICAgICAgICAgIH0odCwgZSk7XG4gICAgICAgICAgICBzLmlzRm91bmREb2N1bWVudCgpID8gbi5yZXNvbHZlKHMpIDogcy5pc05vRG9jdW1lbnQoKSA/IG4ucmVzb2x2ZShudWxsKSA6IG4ucmVqZWN0KG5ldyBMKEIuVU5BVkFJTEFCTEUsIFwiRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIGNhY2hlLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBtYXkgZXhpc3Qgb24gdGhlIHNlcnZlci4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyAnc291cmNlJyBpbiB0aGUgR2V0T3B0aW9ucyB0byBhdHRlbXB0IHRvIHJldHJpZXZlIHRoZSBkb2N1bWVudCBmcm9tIHRoZSBzZXJ2ZXIuKVwiKSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBGdSh0LCBgRmFpbGVkIHRvIGdldCBkb2N1bWVudCAnJHtlfSBmcm9tIGNhY2hlYCk7XG4gICAgICAgICAgICBuLnJlamVjdChzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAqIFJldHJpZXZlcyBhIGxhdGVuY3ktY29tcGVuc2F0ZWQgZG9jdW1lbnQgZnJvbSB0aGUgYmFja2VuZCB2aWEgYVxuICogU25hcHNob3RMaXN0ZW5lci5cbiAqLyAoYXdhaXQgSWEodCksIGUsIG4pKSksIG4ucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gVmEodCwgZSwgbiA9IHt9KSB7XG4gICAgY29uc3QgcyA9IG5ldyBVO1xuICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gZnVuY3Rpb24odCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gbmV3IHVhKHtcbiAgICAgICAgICAgIG5leHQ6IHIgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBxdWVyeSBmaXJzdCBiZWZvcmUgcGFzc2luZyBldmVudCB0byB1c2VyIHRvIGF2b2lkXG4gICAgICAgICAgICAgICAgLy8gdXNlciBhY3Rpb25zIGFmZmVjdGluZyB0aGUgbm93IHN0YWxlIHF1ZXJ5LlxuICAgICAgICAgICAgICAgIGUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gR3UodCwgbykpKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1ID0gci5kb2NzLmhhcyhuKTtcbiAgICAgICAgICAgICAgICAhdSAmJiByLmZyb21DYWNoZSA/IFxuICAgICAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogSWYgd2UncmUgb25saW5lIGFuZCB0aGUgZG9jdW1lbnQgZG9lc24ndFxuICAgICAgICAgICAgICAgIC8vIGV4aXN0IHRoZW4gd2UgcmVzb2x2ZSB3aXRoIGEgZG9jLmV4aXN0cyBzZXQgdG8gZmFsc2UuIElmXG4gICAgICAgICAgICAgICAgLy8gd2UncmUgb2ZmbGluZSBob3dldmVyLCB3ZSByZWplY3QgdGhlIFByb21pc2UgaW4gdGhpc1xuICAgICAgICAgICAgICAgIC8vIGNhc2UuIFR3byBvcHRpb25zOiAxKSBDYWNoZSB0aGUgbmVnYXRpdmUgcmVzcG9uc2UgZnJvbVxuICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIgc28gd2UgY2FuIGRlbGl2ZXIgdGhhdCBldmVuIHdoZW4geW91J3JlXG4gICAgICAgICAgICAgICAgLy8gb2ZmbGluZSAyKSBBY3R1YWxseSByZWplY3QgdGhlIFByb21pc2UgaW4gdGhlIG9ubGluZSBjYXNlXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICAgICAgICAgICAgaS5yZWplY3QobmV3IEwoQi5VTkFWQUlMQUJMRSwgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGJlY2F1c2UgdGhlIGNsaWVudCBpcyBvZmZsaW5lLlwiKSkgOiB1ICYmIHIuZnJvbUNhY2hlICYmIHMgJiYgXCJzZXJ2ZXJcIiA9PT0gcy5zb3VyY2UgPyBpLnJlamVjdChuZXcgTChCLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIHNlcnZlci4gKEhvd2V2ZXIsIHRoaXMgZG9jdW1lbnQgZG9lcyBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudC4pJykpIDogaS5yZXNvbHZlKHIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiB0ID0+IGkucmVqZWN0KHQpXG4gICAgICAgIH0pLCBvID0gbmV3IHp1KGVuKG4ucGF0aCksIHIsIHtcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6ICEwLFxuICAgICAgICAgICAgTnU6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gS3UodCwgbyk7XG4gICAgfShhd2FpdCBSYSh0KSwgdC5hc3luY1F1ZXVlLCBlLCBuLCBzKSkpLCBzLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIFNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gbmV3IFU7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBhc3luYyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzID0gYXdhaXQgRG8odCwgZSwgXG4gICAgICAgICAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgaSA9IG5ldyBlYyhlLCBzLkhpKSwgciA9IGkuV3Uocy5kb2N1bWVudHMpLCBvID0gaS5hcHBseUNoYW5nZXMociwgXG4gICAgICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gITEpO1xuICAgICAgICAgICAgbi5yZXNvbHZlKG8uc25hcHNob3QpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBjb25zdCBzID0gRnUodCwgYEZhaWxlZCB0byBleGVjdXRlIHF1ZXJ5ICcke2V9IGFnYWluc3QgY2FjaGVgKTtcbiAgICAgICAgICAgIG4ucmVqZWN0KHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogUmV0cmlldmVzIGEgbGF0ZW5jeS1jb21wZW5zYXRlZCBxdWVyeSBzbmFwc2hvdCBmcm9tIHRoZSBiYWNrZW5kIHZpYSBhXG4gKiBTbmFwc2hvdExpc3RlbmVyLlxuICovIChhd2FpdCBJYSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBEYSh0LCBlLCBuID0ge30pIHtcbiAgICBjb25zdCBzID0gbmV3IFU7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgdWEoe1xuICAgICAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBHdSh0LCBvKSkpLCBuLmZyb21DYWNoZSAmJiBcInNlcnZlclwiID09PSBzLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBMKEIuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50cyBmcm9tIHNlcnZlci4gKEhvd2V2ZXIsIHRoZXNlIGRvY3VtZW50cyBtYXkgZXhpc3QgaW4gdGhlIGxvY2FsIGNhY2hlLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nIHNvdXJjZSB0byBcInNlcnZlclwiIHRvIHJldHJpZXZlIHRoZSBjYWNoZWQgZG9jdW1lbnRzLiknKSkgOiBpLnJlc29sdmUobik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHQgPT4gaS5yZWplY3QodClcbiAgICAgICAgfSksIG8gPSBuZXcgenUobiwgciwge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICBOdTogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBLdSh0LCBvKTtcbiAgICB9KGF3YWl0IFJhKHQpLCB0LmFzeW5jUXVldWUsIGUsIG4sIHMpKSksIHMucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gQ2EodCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgdWEoZSk7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICQodCkuUnUuYWRkKGUpLCBcbiAgICAgICAgLy8gSW1tZWRpYXRlbHkgZmlyZSBhbiBpbml0aWFsIGV2ZW50LCBpbmRpY2F0aW5nIGFsbCBleGlzdGluZyBsaXN0ZW5lcnNcbiAgICAgICAgLy8gYXJlIGluLXN5bmMuXG4gICAgICAgIGUubmV4dCgpO1xuICAgIH0oYXdhaXQgUmEodCksIG4pKSksICgpID0+IHtcbiAgICAgICAgbi5iYygpLCB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgJCh0KS5SdS5kZWxldGUoZSk7XG4gICAgICAgIH0oYXdhaXQgUmEodCksIG4pKSk7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBUYWtlcyBhbiB1cGRhdGVGdW5jdGlvbiBpbiB3aGljaCBhIHNldCBvZiByZWFkcyBhbmQgd3JpdGVzIGNhbiBiZSBwZXJmb3JtZWRcbiAqIGF0b21pY2FsbHkuIEluIHRoZSB1cGRhdGVGdW5jdGlvbiwgdGhlIGNsaWVudCBjYW4gcmVhZCBhbmQgd3JpdGUgdmFsdWVzXG4gKiB1c2luZyB0aGUgc3VwcGxpZWQgdHJhbnNhY3Rpb24gb2JqZWN0LiBBZnRlciB0aGUgdXBkYXRlRnVuY3Rpb24sIGFsbFxuICogY2hhbmdlcyB3aWxsIGJlIGNvbW1pdHRlZC4gSWYgYSByZXRyeWFibGUgZXJyb3Igb2NjdXJzIChleDogc29tZSBvdGhlclxuICogY2xpZW50IGhhcyBjaGFuZ2VkIGFueSBvZiB0aGUgZGF0YSByZWZlcmVuY2VkKSwgdGhlbiB0aGUgdXBkYXRlRnVuY3Rpb25cbiAqIHdpbGwgYmUgY2FsbGVkIGFnYWluIGFmdGVyIGEgYmFja29mZi4gSWYgdGhlIHVwZGF0ZUZ1bmN0aW9uIHN0aWxsIGZhaWxzXG4gKiBhZnRlciBhbGwgcmV0cmllcywgdGhlbiB0aGUgdHJhbnNhY3Rpb24gd2lsbCBiZSByZWplY3RlZC5cbiAqXG4gKiBUaGUgdHJhbnNhY3Rpb24gb2JqZWN0IHBhc3NlZCB0byB0aGUgdXBkYXRlRnVuY3Rpb24gY29udGFpbnMgbWV0aG9kcyBmb3JcbiAqIGFjY2Vzc2luZyBkb2N1bWVudHMgYW5kIGNvbGxlY3Rpb25zLiBVbmxpa2Ugb3RoZXIgZGF0YXN0b3JlIGFjY2VzcywgZGF0YVxuICogYWNjZXNzZWQgd2l0aCB0aGUgdHJhbnNhY3Rpb24gd2lsbCBub3QgcmVmbGVjdCBsb2NhbCBjaGFuZ2VzIHRoYXQgaGF2ZSBub3RcbiAqIGJlZW4gY29tbWl0dGVkLiBGb3IgdGhpcyByZWFzb24sIGl0IGlzIHJlcXVpcmVkIHRoYXQgYWxsIHJlYWRzIGFyZVxuICogcGVyZm9ybWVkIGJlZm9yZSBhbnkgd3JpdGVzLiBUcmFuc2FjdGlvbnMgbXVzdCBiZSBwZXJmb3JtZWQgd2hpbGUgb25saW5lLlxuICovIGZ1bmN0aW9uIHhhKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgbiA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQgPyAobmV3IFRleHRFbmNvZGVyKS5lbmNvZGUodCkgOiB0O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBjYSh0LCBlKTtcbiAgICAgICAgfShmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHJldHVybiBvYSh0LCBlKTtcbiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHJldHVybiBvYShuZXcgVWludDhBcnJheSh0KSwgZSk7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFJlYWRhYmxlU3RyZWFtKSByZXR1cm4gdC5nZXRSZWFkZXIoKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNvdXJjZSBvZiBgdG9CeXRlU3RyZWFtUmVhZGVyYCBoYXMgdG8gYmUgYSBBcnJheUJ1ZmZlciBvciBSZWFkYWJsZVN0cmVhbVwiKTtcbiAgICAgICAgfShuKSwgZSk7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIChuLCBabyhlKSk7XG4gICAgdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgTWMoYXdhaXQgRWEodCksIGksIHMpO1xuICAgIH0pKTtcbn1cblxuZnVuY3Rpb24gTmEodCwgZSkge1xuICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gJCh0KTtcbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgbmFtZWQgcXVlcnlcIiwgXCJyZWFkb25seVwiLCAodCA9PiBuLk5zLmdldE5hbWVkUXVlcnkodCwgZSkpKTtcbiAgICB9KGF3YWl0IElhKHQpLCBlKSkpO1xufVxuXG5jbGFzcyBrYSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHByb21pc2UgaW4gdGhlIHF1ZXVlLlxuICAgICAgICB0aGlzLkJjID0gUHJvbWlzZS5yZXNvbHZlKCksIFxuICAgICAgICAvLyBBIGxpc3Qgb2YgcmV0cnlhYmxlIG9wZXJhdGlvbnMuIFJldHJ5YWJsZSBvcGVyYXRpb25zIGFyZSBydW4gaW4gb3JkZXIgYW5kXG4gICAgICAgIC8vIHJldHJpZWQgd2l0aCBiYWNrb2ZmLlxuICAgICAgICB0aGlzLkxjID0gW10sIFxuICAgICAgICAvLyBJcyB0aGlzIEFzeW5jUXVldWUgYmVpbmcgc2h1dCBkb3duPyBPbmNlIGl0IGlzIHNldCB0byB0cnVlLCBpdCB3aWxsIG5vdFxuICAgICAgICAvLyBiZSBjaGFuZ2VkIGFnYWluLlxuICAgICAgICB0aGlzLlVjID0gITEsIFxuICAgICAgICAvLyBPcGVyYXRpb25zIHNjaGVkdWxlZCB0byBiZSBxdWV1ZWQgaW4gdGhlIGZ1dHVyZS4gT3BlcmF0aW9ucyBhcmVcbiAgICAgICAgLy8gYXV0b21hdGljYWxseSByZW1vdmVkIGFmdGVyIHRoZXkgYXJlIHJ1biBvciBjYW5jZWxlZC5cbiAgICAgICAgdGhpcy5xYyA9IFtdLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICB0aGlzLktjID0gbnVsbCwgXG4gICAgICAgIC8vIEZsYWcgc2V0IHdoaWxlIHRoZXJlJ3MgYW4gb3V0c3RhbmRpbmcgQXN5bmNRdWV1ZSBvcGVyYXRpb24sIHVzZWQgZm9yXG4gICAgICAgIC8vIGFzc2VydGlvbiBzYW5pdHktY2hlY2tzLlxuICAgICAgICB0aGlzLkdjID0gITEsIFxuICAgICAgICAvLyBFbmFibGVkIGR1cmluZyBzaHV0ZG93biBvbiBTYWZhcmkgdG8gcHJldmVudCBmdXR1cmUgYWNjZXNzIHRvIEluZGV4ZWREQi5cbiAgICAgICAgdGhpcy5RYyA9ICExLCBcbiAgICAgICAgLy8gTGlzdCBvZiBUaW1lcklkcyB0byBmYXN0LWZvcndhcmQgZGVsYXlzIGZvci5cbiAgICAgICAgdGhpcy5qYyA9IFtdLCBcbiAgICAgICAgLy8gQmFja29mZiB0aW1lciB1c2VkIHRvIHNjaGVkdWxlIHJldHJpZXMgZm9yIHJldHJ5YWJsZSBvcGVyYXRpb25zXG4gICAgICAgIHRoaXMueG8gPSBuZXcgdHUodGhpcywgXCJhc3luY19xdWV1ZV9yZXRyeVwiIC8qIEFzeW5jUXVldWVSZXRyeSAqLyksIFxuICAgICAgICAvLyBWaXNpYmlsaXR5IGhhbmRsZXIgdGhhdCB0cmlnZ2VycyBhbiBpbW1lZGlhdGUgcmV0cnkgb2YgYWxsIHJldHJ5YWJsZVxuICAgICAgICAvLyBvcGVyYXRpb25zLiBNZWFudCB0byBzcGVlZCB1cCByZWNvdmVyeSB3aGVuIHdlIHJlZ2FpbiBmaWxlIHN5c3RlbSBhY2Nlc3NcbiAgICAgICAgLy8gYWZ0ZXIgcGFnZSBjb21lcyBpbnRvIGZvcmVncm91bmQuXG4gICAgICAgIHRoaXMuV2MgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gWG8oKTtcbiAgICAgICAgICAgIHQgJiYgQyhcIkFzeW5jUXVldWVcIiwgXCJWaXNpYmlsaXR5IHN0YXRlIGNoYW5nZWQgdG8gXCIgKyB0LnZpc2liaWxpdHlTdGF0ZSksIHRoaXMueG8uUG8oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdCA9IFhvKCk7XG4gICAgICAgIHQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0LmFkZEV2ZW50TGlzdGVuZXIgJiYgdC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLldjKTtcbiAgICB9XG4gICAgZ2V0IGlzU2h1dHRpbmdEb3duKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5VYztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyBvcGVyYXRpb24gdG8gdGhlIHF1ZXVlIHdpdGhvdXQgd2FpdGluZyBmb3IgaXQgdG8gY29tcGxldGUgKGkuZS5cbiAgICAgKiB3ZSBpZ25vcmUgdGhlIFByb21pc2UgcmVzdWx0KS5cbiAgICAgKi8gICAgZW5xdWV1ZUFuZEZvcmdldCh0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhpcy5lbnF1ZXVlKHQpO1xuICAgIH1cbiAgICBlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCh0KSB7XG4gICAgICAgIHRoaXMuemMoKSwgXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhpcy5IYyh0KTtcbiAgICB9XG4gICAgZW50ZXJSZXN0cmljdGVkTW9kZSh0KSB7XG4gICAgICAgIGlmICghdGhpcy5VYykge1xuICAgICAgICAgICAgdGhpcy5VYyA9ICEwLCB0aGlzLlFjID0gdCB8fCAhMTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBYbygpO1xuICAgICAgICAgICAgZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiBlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIHRoaXMuV2MpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVucXVldWUodCkge1xuICAgICAgICBpZiAodGhpcy56YygpLCB0aGlzLlVjKSBcbiAgICAgICAgLy8gUmV0dXJuIGEgUHJvbWlzZSB3aGljaCBuZXZlciByZXNvbHZlcy5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCgoKSA9PiB7fSkpO1xuICAgICAgICAvLyBDcmVhdGUgYSBkZWZlcnJlZCBQcm9taXNlIHRoYXQgd2UgY2FuIHJldHVybiB0byB0aGUgY2FsbGVlLiBUaGlzXG4gICAgICAgIC8vIGFsbG93cyB1cyB0byByZXR1cm4gYSBcImhhbmdpbmcgUHJvbWlzZVwiIG9ubHkgdG8gdGhlIGNhbGxlZSBhbmQgc3RpbGxcbiAgICAgICAgLy8gYWR2YW5jZSB0aGUgcXVldWUgZXZlbiB3aGVuIHRoZSBvcGVyYXRpb24gaXMgbm90IHJ1bi5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFU7XG4gICAgICAgIHJldHVybiB0aGlzLkhjKCgoKSA9PiB0aGlzLlVjICYmIHRoaXMuUWMgPyBQcm9taXNlLnJlc29sdmUoKSA6ICh0KCkudGhlbihlLnJlc29sdmUsIGUucmVqZWN0KSwgXG4gICAgICAgIGUucHJvbWlzZSkpKS50aGVuKCgoKSA9PiBlLnByb21pc2UpKTtcbiAgICB9XG4gICAgZW5xdWV1ZVJldHJ5YWJsZSh0KSB7XG4gICAgICAgIHRoaXMuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuTGMucHVzaCh0KSwgdGhpcy5KYygpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSdW5zIHRoZSBuZXh0IG9wZXJhdGlvbiBmcm9tIHRoZSByZXRyeWFibGUgcXVldWUuIElmIHRoZSBvcGVyYXRpb24gZmFpbHMsXG4gICAgICogcmVzY2hlZHVsZXMgd2l0aCBiYWNrb2ZmLlxuICAgICAqLyAgICBhc3luYyBKYygpIHtcbiAgICAgICAgaWYgKDAgIT09IHRoaXMuTGMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuTGNbMF0oKSwgdGhpcy5MYy5zaGlmdCgpLCB0aGlzLnhvLnJlc2V0KCk7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFWdCh0KSkgdGhyb3cgdDtcbiAvLyBGYWlsdXJlIHdpbGwgYmUgaGFuZGxlZCBieSBBc3luY1F1ZXVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEMoXCJBc3luY1F1ZXVlXCIsIFwiT3BlcmF0aW9uIGZhaWxlZCB3aXRoIHJldHJ5YWJsZSBlcnJvcjogXCIgKyB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuTGMubGVuZ3RoID4gMCAmJiBcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBhZGRpdGlvbmFsIG9wZXJhdGlvbnMsIHdlIHJlLXNjaGVkdWxlIGByZXRyeU5leHRPcCgpYC5cbiAgICAgICAgICAgIC8vIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIHJ1biByZXRyeWFibGUgb3BlcmF0aW9ucyB0aGF0IGZhaWxlZCBkdXJpbmdcbiAgICAgICAgICAgIC8vIHRoZWlyIGluaXRpYWwgYXR0ZW1wdCBzaW5jZSB3ZSBkb24ndCBrbm93IHdoZXRoZXIgdGhleSBhcmUgYWxyZWFkeVxuICAgICAgICAgICAgLy8gZW5xdWV1ZWQuIElmLCBmb3IgZXhhbXBsZSwgYG9wMWAsIGBvcDJgLCBgb3AzYCBhcmUgZW5xdWV1ZWQgYW5kIGBvcDFgXG4gICAgICAgICAgICAvLyBuZWVkcyB0byAgYmUgcmUtcnVuLCB3ZSB3aWxsIHJ1biBgb3AxYCwgYG9wMWAsIGBvcDJgIHVzaW5nIHRoZVxuICAgICAgICAgICAgLy8gYWxyZWFkeSBlbnF1ZXVlZCBjYWxscyB0byBgcmV0cnlOZXh0T3AoKWAuIGBvcDMoKWAgd2lsbCB0aGVuIHJ1biBpbiB0aGVcbiAgICAgICAgICAgIC8vIGNhbGwgc2NoZWR1bGVkIGhlcmUuXG4gICAgICAgICAgICAvLyBTaW5jZSBgYmFja29mZkFuZFJ1bigpYCBjYW5jZWxzIGFuIGV4aXN0aW5nIGJhY2tvZmYgYW5kIHNjaGVkdWxlcyBhXG4gICAgICAgICAgICAvLyBuZXcgYmFja29mZiBvbiBldmVyeSBjYWxsLCB0aGVyZSBpcyBvbmx5IGV2ZXIgYSBzaW5nbGUgYWRkaXRpb25hbFxuICAgICAgICAgICAgLy8gb3BlcmF0aW9uIGluIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgIHRoaXMueG8uUm8oKCgpID0+IHRoaXMuSmMoKSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIEhjKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuQmMudGhlbigoKCkgPT4gKHRoaXMuR2MgPSAhMCwgdCgpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuS2MgPSB0LCB0aGlzLkdjID0gITE7XG4gICAgICAgICAgICBjb25zdCBlID0gXG4gICAgICAgICAgICAvKipcbiAqIENocm9tZSBpbmNsdWRlcyBFcnJvci5tZXNzYWdlIGluIEVycm9yLnN0YWNrLiBPdGhlciBicm93c2VycyBkbyBub3QuXG4gKiBUaGlzIHJldHVybnMgZXhwZWN0ZWQgb3V0cHV0IG9mIG1lc3NhZ2UgKyBzdGFjayB3aGVuIGF2YWlsYWJsZS5cbiAqIEBwYXJhbSBlcnJvciAtIEVycm9yIG9yIEZpcmVzdG9yZUVycm9yXG4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQubWVzc2FnZSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIHQuc3RhY2sgJiYgKGUgPSB0LnN0YWNrLmluY2x1ZGVzKHQubWVzc2FnZSkgPyB0LnN0YWNrIDogdC5tZXNzYWdlICsgXCJcXG5cIiArIHQuc3RhY2spO1xuICAgICAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQpO1xuICAgICAgICAgICAgLy8gUmUtdGhyb3cgdGhlIGVycm9yIHNvIHRoYXQgdGhpcy50YWlsIGJlY29tZXMgYSByZWplY3RlZCBQcm9taXNlIGFuZFxuICAgICAgICAgICAgLy8gYWxsIGZ1cnRoZXIgYXR0ZW1wdHMgdG8gY2hhaW4gKHZpYSAudGhlbikgd2lsbCBqdXN0IHNob3J0LWNpcmN1aXRcbiAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gdGhlIHJlamVjdGVkIFByb21pc2UuXG4gICAgICAgICAgICB0aHJvdyB4KFwiSU5URVJOQUwgVU5IQU5ETEVEIEVSUk9SOiBcIiwgZSksIHQ7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+ICh0aGlzLkdjID0gITEsIHQpKSkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLkJjID0gZSwgZTtcbiAgICB9XG4gICAgZW5xdWV1ZUFmdGVyRGVsYXkodCwgZSwgbikge1xuICAgICAgICB0aGlzLnpjKCksIFxuICAgICAgICAvLyBGYXN0LWZvcndhcmQgZGVsYXlzIGZvciB0aW1lcklkcyB0aGF0IGhhdmUgYmVlbiBvdmVycmlkZW4uXG4gICAgICAgIHRoaXMuamMuaW5kZXhPZih0KSA+IC0xICYmIChlID0gMCk7XG4gICAgICAgIGNvbnN0IHMgPSBNdS5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCB0LCBlLCBuLCAodCA9PiB0aGlzLlljKHQpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnFjLnB1c2gocyksIHM7XG4gICAgfVxuICAgIHpjKCkge1xuICAgICAgICB0aGlzLktjICYmIE8oKTtcbiAgICB9XG4gICAgdmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpIHt9XG4gICAgLyoqXG4gICAgICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBxdWV1ZWQgdGFza3MgYXJlIGZpbmlzaGVkIGV4ZWN1dGluZy4gRGVsYXllZFxuICAgICAqIG9wZXJhdGlvbnMgYXJlIG5vdCBydW4uXG4gICAgICovICAgIGFzeW5jIFhjKCkge1xuICAgICAgICAvLyBPcGVyYXRpb25zIGluIHRoZSBxdWV1ZSBwcmlvciB0byBkcmFpbmluZyBtYXkgaGF2ZSBlbnF1ZXVlZCBhZGRpdGlvbmFsXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIEtlZXAgZHJhaW5pbmcgdGhlIHF1ZXVlIHVudGlsIHRoZSB0YWlsIGlzIG5vIGxvbmdlciBhZHZhbmNlZCxcbiAgICAgICAgLy8gd2hpY2ggaW5kaWNhdGVzIHRoYXQgbm8gbW9yZSBuZXcgb3BlcmF0aW9ucyB3ZXJlIGVucXVldWVkIGFuZCB0aGF0IGFsbFxuICAgICAgICAvLyBvcGVyYXRpb25zIHdlcmUgZXhlY3V0ZWQuXG4gICAgICAgIGxldCB0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB0ID0gdGhpcy5CYywgYXdhaXQgdDtcbiAgICAgICAgfSB3aGlsZSAodCAhPT0gdGhpcy5CYyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogRGV0ZXJtaW5lIGlmIGEgZGVsYXllZCBvcGVyYXRpb24gd2l0aCBhIHBhcnRpY3VsYXIgVGltZXJJZFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi8gICAgWmModCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5xYykgaWYgKGUudGltZXJJZCA9PT0gdCkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogUnVucyBzb21lIG9yIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMgZWFybHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGFzdFRpbWVySWQgLSBEZWxheWVkIG9wZXJhdGlvbnMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGlzIFRpbWVySWRcbiAgICAgKiB3aWxsIGJlIGRyYWluZWQuIFBhc3MgVGltZXJJZC5BbGwgdG8gcnVuIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMuXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgb25jZSBhbGwgb3BlcmF0aW9ucyBoYXZlIGJlZW4gcnVuLlxuICAgICAqLyAgICB0YSh0KSB7XG4gICAgICAgIC8vIE5vdGUgdGhhdCBkcmFpbmluZyBtYXkgZ2VuZXJhdGUgbW9yZSBkZWxheWVkIG9wcywgc28gd2UgZG8gdGhhdCBmaXJzdC5cbiAgICAgICAgcmV0dXJuIHRoaXMuWGMoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBSdW4gb3BzIGluIHRoZSBzYW1lIG9yZGVyIHRoZXknZCBydW4gaWYgdGhleSByYW4gbmF0dXJhbGx5LlxuICAgICAgICAgICAgdGhpcy5xYy5zb3J0KCgodCwgZSkgPT4gdC50YXJnZXRUaW1lTXMgLSBlLnRhcmdldFRpbWVNcykpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMucWMpIGlmIChlLnNraXBEZWxheSgpLCBcImFsbFwiIC8qIEFsbCAqLyAhPT0gdCAmJiBlLnRpbWVySWQgPT09IHQpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuWGMoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFNraXAgYWxsIHN1YnNlcXVlbnQgZGVsYXlzIGZvciBhIHRpbWVyIGlkLlxuICAgICAqLyAgICBlYSh0KSB7XG4gICAgICAgIHRoaXMuamMucHVzaCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovICAgIFljKHQpIHtcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnFjLmluZGV4T2YodCk7XG4gICAgICAgIHRoaXMucWMuc3BsaWNlKGUsIDEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gT2EodCkge1xuICAgIC8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgYW5kIGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBvZiB0aGUgc3BlY2lmaWVkXG4gKiBtZXRob2RzLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIHQgfHwgbnVsbCA9PT0gdCkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gdDtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIGlmICh0IGluIG4gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBuW3RdKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFJlcHJlc2VudHMgdGhlIHRhc2sgb2YgbG9hZGluZyBhIEZpcmVzdG9yZSBidW5kbGUuIEl0IHByb3ZpZGVzIHByb2dyZXNzIG9mIGJ1bmRsZVxuICogbG9hZGluZywgYXMgd2VsbCBhcyB0YXNrIGNvbXBsZXRpb24gYW5kIGVycm9yIGV2ZW50cy5cbiAqXG4gKiBUaGUgQVBJIGlzIGNvbXBhdGlibGUgd2l0aCBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gKHQsIFsgXCJuZXh0XCIsIFwiZXJyb3JcIiwgXCJjb21wbGV0ZVwiIF0pO1xufVxuXG5jbGFzcyBNYSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIgPSB7fSwgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlciA9IG5ldyBVLCB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB7XG4gICAgICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICAgICAgdG90YWxCeXRlczogMCxcbiAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiAwLFxuICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGZ1bmN0aW9ucyB0byBsaXN0ZW4gdG8gYnVuZGxlIGxvYWRpbmcgcHJvZ3Jlc3MgZXZlbnRzLlxuICAgICAqIEBwYXJhbSBuZXh0IC0gQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBwcm9ncmVzcyB1cGRhdGUgZnJvbSBidW5kbGUgbG9hZGluZy4gVHlwaWNhbGx5IGBuZXh0YCBjYWxscyBvY2N1clxuICAgICAqICAgZWFjaCB0aW1lIGEgRmlyZXN0b3JlIGRvY3VtZW50IGlzIGxvYWRlZCBmcm9tIHRoZSBidW5kbGUuXG4gICAgICogQHBhcmFtIGVycm9yIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy4gVGhlIHRhc2sgYWJvcnRzIGFmdGVyIHJlcG9ydGluZyB0aGVcbiAgICAgKiAgIGVycm9yLCBhbmQgdGhlcmUgc2hvdWxkIGJlIG5vIG1vcmUgdXBkYXRlcyBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSBjb21wbGV0ZSAtIENhbGxlZCB3aGVuIHRoZSBsb2FkaW5nIHRhc2sgaXMgY29tcGxldGUuXG4gICAgICovICAgIG9uUHJvZ3Jlc3ModCwgZSwgbikge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge1xuICAgICAgICAgICAgbmV4dDogdCxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgICAgY29tcGxldGU6IG5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4uY2F0Y2hgIGludGVyZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5wcm9taXNlLmNhdGNoKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPi50aGVuYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBDYWxsZWQgb24gdGhlIGNvbXBsZXRpb24gb2YgdGhlIGxvYWRpbmcgdGFzayB3aXRoIGEgZmluYWwgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHVwZGF0ZS5cbiAgICAgKiAgIFRoZSB1cGRhdGUgd2lsbCBhbHdheXMgaGF2ZSBpdHMgYHRhc2tTdGF0ZWAgc2V0IHRvIGBcIlN1Y2Nlc3NcImAuXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBDYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGJ1bmRsZSBsb2FkaW5nLlxuICAgICAqLyAgICB0aGVuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS50aGVuKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGNvbXBsZXRlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovICAgIF9jb21wbGV0ZVdpdGgodCkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyh0KSwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmNvbXBsZXRlKCksIFxuICAgICAgICB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlc29sdmUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIGFsbCBvYnNlcnZlcnMgdGhhdCBidW5kbGUgbG9hZGluZyBoYXMgZmFpbGVkLCB3aXRoIGEgcHJvdmlkZWRcbiAgICAgKiBgRXJyb3JgIGFzIHRoZSByZWFzb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfZmFpbFdpdGgodCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MudGFza1N0YXRlID0gXCJFcnJvclwiLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHRoaXMuX2xhc3RQcm9ncmVzcyksIFxuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuZXJyb3IodCksIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucmVqZWN0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhIHByb2dyZXNzIHVwZGF0ZSBvZiBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBwcm9ncmVzcyAtIFRoZSBuZXcgcHJvZ3Jlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfdXBkYXRlUHJvZ3Jlc3ModCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB0LCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBET01FeGNlcHRpb24gZXJyb3IgY29kZSBjb25zdGFudHMuICovIGNvbnN0IEZhID0gLTE7XG5cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9LlxuICovXG5jbGFzcyAkYSBleHRlbmRzIEpjIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgc3VwZXIodCwgZSwgbiwgcyksIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCdzIGEge0BsaW5rIEZpcmVzdG9yZX0gb3IgRmlyZXN0b3JlIExpdGUgaW5zdGFuY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImZpcmVzdG9yZVwiLCB0aGlzLl9xdWV1ZSA9IG5ldyBrYSwgdGhpcy5fcGVyc2lzdGVuY2VLZXkgPSAobnVsbCA9PSBzID8gdm9pZCAwIDogcy5uYW1lKSB8fCBcIltERUZBVUxUXVwiO1xuICAgIH1cbiAgICBfdGVybWluYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50IHx8IFxuICAgICAgICAvLyBUaGUgY2xpZW50IG11c3QgYmUgaW5pdGlhbGl6ZWQgdG8gZW5zdXJlIHRoYXQgYWxsIHN1YnNlcXVlbnQgQVBJXG4gICAgICAgIC8vIHVzYWdlIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICAgIHFhKHRoaXMpLCB0aGlzLl9maXJlc3RvcmVDbGllbnQudGVybWluYXRlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHtAbGluayBGaXJlc3RvcmV9IHdpdGggdGhlIHByb3ZpZGVkIHNldHRpbmdzLlxuICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb24sIGluY2x1ZGluZ1xuICoge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9LiBJZiB0aGUgY3VzdG9tIHNldHRpbmdzIGFyZSBlbXB0eSwgdGhpcyBmdW5jdGlvbiBpc1xuICogZXF1aXZhbGVudCB0byBjYWxsaW5nIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS5cbiAqXG4gKiBAcGFyYW0gYXBwIC0gVGhlIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSB3aXRoIHdoaWNoIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiBiZSBhc3NvY2lhdGVkLlxuICogQHBhcmFtIHNldHRpbmdzIC0gQSBzZXR0aW5ncyBvYmplY3QgdG8gY29uZmlndXJlIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBkYXRhYmFzZUlkIC0gVGhlIG5hbWUgb2YgZGF0YWJhc2UuXG4gKiBAcmV0dXJucyBBIG5ld2x5IGluaXRpYWxpemVkIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICovIGZ1bmN0aW9uIEJhKHQsIGUsIG4pIHtcbiAgICBuIHx8IChuID0gXCIoZGVmYXVsdClcIik7XG4gICAgY29uc3QgcyA9IF9nZXRQcm92aWRlcih0LCBcImZpcmVzdG9yZVwiKTtcbiAgICBpZiAocy5pc0luaXRpYWxpemVkKG4pKSB7XG4gICAgICAgIGNvbnN0IHQgPSBzLmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiBuXG4gICAgICAgIH0pLCBpID0gcy5nZXRPcHRpb25zKG4pO1xuICAgICAgICBpZiAoZGVlcEVxdWFsKGksIGUpKSByZXR1cm4gdDtcbiAgICAgICAgdGhyb3cgbmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBcImluaXRpYWxpemVGaXJlc3RvcmUoKSBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZCB3aXRoIGRpZmZlcmVudCBvcHRpb25zLiBUbyBhdm9pZCB0aGlzIGVycm9yLCBjYWxsIGluaXRpYWxpemVGaXJlc3RvcmUoKSB3aXRoIHRoZSBzYW1lIG9wdGlvbnMgYXMgd2hlbiBpdCB3YXMgb3JpZ2luYWxseSBjYWxsZWQsIG9yIGNhbGwgZ2V0RmlyZXN0b3JlKCkgdG8gcmV0dXJuIHRoZSBhbHJlYWR5IGluaXRpYWxpemVkIGluc3RhbmNlLlwiKTtcbiAgICB9XG4gICAgaWYgKHZvaWQgMCAhPT0gZS5jYWNoZVNpemVCeXRlcyAmJiAtMSAhPT0gZS5jYWNoZVNpemVCeXRlcyAmJiBlLmNhY2hlU2l6ZUJ5dGVzIDwgMTA0ODU3NikgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcImNhY2hlU2l6ZUJ5dGVzIG11c3QgYmUgYXQgbGVhc3QgMTA0ODU3NlwiKTtcbiAgICByZXR1cm4gcy5pbml0aWFsaXplKHtcbiAgICAgICAgb3B0aW9uczogZSxcbiAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBuXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIExhKGUsIG4pIHtcbiAgICBjb25zdCBzID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSA/IGUgOiBnZXRBcHAoKSwgaSA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBlIDogbiB8fCBcIihkZWZhdWx0KVwiLCByID0gX2dldFByb3ZpZGVyKHMsIFwiZmlyZXN0b3JlXCIpLmdldEltbWVkaWF0ZSh7XG4gICAgICAgIGlkZW50aWZpZXI6IGlcbiAgICB9KTtcbiAgICBpZiAoIXIuX2luaXRpYWxpemVkKSB7XG4gICAgICAgIGNvbnN0IHQgPSBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQoXCJmaXJlc3RvcmVcIik7XG4gICAgICAgIHQgJiYgWWMociwgLi4udCk7XG4gICAgfVxuICAgIHJldHVybiByO1xufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIFVhKHQpIHtcbiAgICByZXR1cm4gdC5fZmlyZXN0b3JlQ2xpZW50IHx8IHFhKHQpLCB0Ll9maXJlc3RvcmVDbGllbnQudmVyaWZ5Tm90VGVybWluYXRlZCgpLCB0Ll9maXJlc3RvcmVDbGllbnQ7XG59XG5cbmZ1bmN0aW9uIHFhKHQpIHtcbiAgICB2YXIgZTtcbiAgICBjb25zdCBuID0gdC5fZnJlZXplU2V0dGluZ3MoKSwgcyA9IGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBlZSh0LCBlLCBuLCBzLmhvc3QsIHMuc3NsLCBzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcsIHMuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBzLnVzZUZldGNoU3RyZWFtcyk7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgLy8gc2V0dGluZ3MoKSBkZWZhdWx0czpcbiAgICAodC5fZGF0YWJhc2VJZCwgKG51bGwgPT09IChlID0gdC5fYXBwKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLm9wdGlvbnMuYXBwSWQpIHx8IFwiXCIsIHQuX3BlcnNpc3RlbmNlS2V5LCBuKTtcbiAgICB0Ll9maXJlc3RvcmVDbGllbnQgPSBuZXcgX2EodC5fYXV0aENyZWRlbnRpYWxzLCB0Ll9hcHBDaGVja0NyZWRlbnRpYWxzLCB0Ll9xdWV1ZSwgcyk7XG59XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gZW5hYmxlIHBlcnNpc3RlbnQgc3RvcmFnZSwgaWYgcG9zc2libGUuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgYmVmb3JlIGFueSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW5cbiAqIHtAbGluayBpbml0aWFsaXplRmlyZXN0b3JlfSwge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9IG9yXG4gKiB7QGxpbmsgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZX0uXG4gKlxuICogSWYgdGhpcyBmYWlscywgYGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlIGl0XG4gKiByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIuXG4gKiAgICogdW5pbXBsZW1lbnRlZDogVGhlIGJyb3dzZXIgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIG9mZmxpbmVcbiAqICAgICBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGVuYWJsZSBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyAtIE9wdGlvbmFsIHNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmVcbiAqIHBlcnNpc3RlbmNlLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50IHN0b3JhZ2UuXG4gKi8gZnVuY3Rpb24gS2EodCwgZSkge1xuICAgIFphKHQgPSBqYyh0LCAkYSkpO1xuICAgIGNvbnN0IG4gPSBVYSh0KSwgcyA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIGkgPSBuZXcgTGM7XG4gICAgcmV0dXJuIFFhKG4sIGksIG5ldyAkYyhpLCBzLmNhY2hlU2l6ZUJ5dGVzLCBudWxsID09IGUgPyB2b2lkIDAgOiBlLmZvcmNlT3duZXJzaGlwKSk7XG59XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gZW5hYmxlIG11bHRpLXRhYiBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLiBJZiBlbmFibGVkXG4gKiBhY3Jvc3MgYWxsIHRhYnMsIGFsbCBvcGVyYXRpb25zIHNoYXJlIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZSwgaW5jbHVkaW5nXG4gKiBzaGFyZWQgZXhlY3V0aW9uIG9mIHF1ZXJpZXMgYW5kIGxhdGVuY3ktY29tcGVuc2F0ZWQgbG9jYWwgZG9jdW1lbnQgdXBkYXRlc1xuICogYWNyb3NzIGFsbCBjb25uZWN0ZWQgaW5zdGFuY2VzLlxuICpcbiAqIElmIHRoaXMgZmFpbHMsIGBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlXG4gKiBpdCByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIgYW5kXG4gKiAgICAgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkLlxuICogICAqIHVuaW1wbGVtZW50ZWQ6IFRoZSBicm93c2VyIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBvZmZsaW5lXG4gKiAgICAgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24uXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBlbmFibGUgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50XG4gKiBzdG9yYWdlLlxuICovIGZ1bmN0aW9uIEdhKHQpIHtcbiAgICBaYSh0ID0gamModCwgJGEpKTtcbiAgICBjb25zdCBlID0gVWEodCksIG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gbmV3IExjO1xuICAgIHJldHVybiBRYShlLCBzLCBuZXcgQmMocywgbi5jYWNoZVNpemVCeXRlcykpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBib3RoIHRoZSBgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyYCBhbmQgYE9ubGluZUNvbXBvbmVudFByb3ZpZGVyYC5cbiAqIElmIHRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhIHJlY292ZXJhYmxlIGVycm9yIChzZWVcbiAqIGBjYW5SZWNvdmVyRnJvbUluZGV4ZWREYkVycm9yKClgIGJlbG93KSwgdGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVqZWN0ZWRcbiAqIGJ1dCB0aGUgY2xpZW50IHJlbWFpbnMgdXNhYmxlLlxuICovIGZ1bmN0aW9uIFFhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IFU7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB3YSh0LCBuKSwgYXdhaXQgbWEodCwgZSksIHMucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdDtcbiAgICAgICAgICAgIGlmICghXG4gICAgICAgICAgICAvKipcbiAqIERlY2lkZXMgd2hldGhlciB0aGUgcHJvdmlkZWQgZXJyb3IgYWxsb3dzIHVzIHRvIGdyYWNlZnVsbHkgZGlzYWJsZVxuICogcGVyc2lzdGVuY2UgKGFzIG9wcG9zZWQgdG8gY3Jhc2hpbmcgdGhlIGNsaWVudCkuXG4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSkgcmV0dXJuIHQuY29kZSA9PT0gQi5GQUlMRURfUFJFQ09ORElUSU9OIHx8IHQuY29kZSA9PT0gQi5VTklNUExFTUVOVEVEO1xuICAgICAgICAgICAgICAgIGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBET01FeGNlcHRpb24gJiYgdCBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbikgXG4gICAgICAgICAgICAgICAgLy8gVGhlcmUgYXJlIGEgZmV3IGtub3duIGNpcmN1bXN0YW5jZXMgd2hlcmUgd2UgY2FuIG9wZW4gSW5kZXhlZERiIGJ1dFxuICAgICAgICAgICAgICAgIC8vIHRyeWluZyB0byByZWFkL3dyaXRlIHdpbGwgZmFpbCAoZS5nLiBxdW90YSBleGNlZWRlZCkuIEZvclxuICAgICAgICAgICAgICAgIC8vIHdlbGwtdW5kZXJzdG9vZCBjYXNlcywgd2UgYXR0ZW1wdCB0byBkZXRlY3QgdGhlc2UgYW5kIHRoZW4gZ3JhY2VmdWxseVxuICAgICAgICAgICAgICAgIC8vIGZhbGwgYmFjayB0byBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgICAgICAgICAgLy8gTk9URTogUmF0aGVyIHRoYW4gY29udGludWUgdG8gYWRkIHRvIHRoaXMgbGlzdCwgd2UgY291bGQgZGVjaWRlIHRvXG4gICAgICAgICAgICAgICAgLy8gYWx3YXlzIGZhbGwgYmFjaywgd2l0aCB0aGUgcmlzayB0aGF0IHdlIG1pZ2h0IGFjY2lkZW50YWxseSBoaWRlIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIHJlcHJlc2VudGluZyBhY3R1YWwgU0RLIGJ1Z3MuXG4gICAgICAgICAgICAgICAgLy8gV2hlbiB0aGUgYnJvd3NlciBpcyBvdXQgb2YgcXVvdGEgd2UgY291bGQgZ2V0IGVpdGhlciBxdW90YSBleGNlZWRlZFxuICAgICAgICAgICAgICAgIC8vIG9yIGFuIGFib3J0ZWQgZXJyb3IgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIGVycm9yIGhhcHBlbmVkIGR1cmluZ1xuICAgICAgICAgICAgICAgIC8vIHNjaGVtYSBtaWdyYXRpb24uXG4gICAgICAgICAgICAgICAgcmV0dXJuIDIyID09PSB0LmNvZGUgfHwgMjAgPT09IHQuY29kZSB8fCBcbiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IFByaXZhdGUgQnJvd3NpbmcgbW9kZSBkaXNhYmxlcyBJbmRleGVkRGIgYW5kIHJldHVybnNcbiAgICAgICAgICAgICAgICAvLyBJTlZBTElEX1NUQVRFIGZvciBhbnkgdXNhZ2UuXG4gICAgICAgICAgICAgICAgMTEgPT09IHQuY29kZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIENsZWFycyB0aGUgcGVyc2lzdGVudCBzdG9yYWdlLiBUaGlzIGluY2x1ZGVzIHBlbmRpbmcgd3JpdGVzIGFuZCBjYWNoZWRcbiAqIGRvY3VtZW50cy5cbiAqXG4gKiBNdXN0IGJlIGNhbGxlZCB3aGlsZSB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgaXMgbm90IHN0YXJ0ZWQgKGFmdGVyIHRoZSBhcHAgaXNcbiAqIHRlcm1pbmF0ZWQgb3Igd2hlbiB0aGUgYXBwIGlzIGZpcnN0IGluaXRpYWxpemVkKS4gT24gc3RhcnR1cCwgdGhpcyBmdW5jdGlvblxuICogbXVzdCBiZSBjYWxsZWQgYmVmb3JlIG90aGVyIGZ1bmN0aW9ucyAob3RoZXIgdGhhbiB7QGxpbmtcbiAqIGluaXRpYWxpemVGaXJlc3RvcmV9IG9yIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfSkpLiBJZiB0aGUge0BsaW5rIEZpcmVzdG9yZX1cbiAqIGluc3RhbmNlIGlzIHN0aWxsIHJ1bm5pbmcsIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgZXJyb3IgY29kZVxuICogb2YgYGZhaWxlZC1wcmVjb25kaXRpb25gLlxuICpcbiAqIE5vdGU6IGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIGlzIHByaW1hcmlseSBpbnRlbmRlZCB0byBoZWxwIHdyaXRlXG4gKiByZWxpYWJsZSB0ZXN0cyB0aGF0IHVzZSBDbG91ZCBGaXJlc3RvcmUuIEl0IHVzZXMgYW4gZWZmaWNpZW50IG1lY2hhbmlzbSBmb3JcbiAqIGRyb3BwaW5nIGV4aXN0aW5nIGRhdGEgYnV0IGRvZXMgbm90IGF0dGVtcHQgdG8gc2VjdXJlbHkgb3ZlcndyaXRlIG9yXG4gKiBvdGhlcndpc2UgbWFrZSBjYWNoZWQgZGF0YSB1bnJlY292ZXJhYmxlLiBGb3IgYXBwbGljYXRpb25zIHRoYXQgYXJlIHNlbnNpdGl2ZVxuICogdG8gdGhlIGRpc2Nsb3N1cmUgb2YgY2FjaGVkIGRhdGEgaW4gYmV0d2VlbiB1c2VyIHNlc3Npb25zLCB3ZSBzdHJvbmdseVxuICogcmVjb21tZW5kIG5vdCBlbmFibGluZyBwZXJzaXN0ZW5jZSBhdCBhbGwuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBjbGVhciBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIHBlcnNpc3RlbnQgc3RvcmFnZSBpc1xuICogY2xlYXJlZC4gT3RoZXJ3aXNlLCB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCB3aXRoIGFuIGVycm9yLlxuICovIChlKSkgdGhyb3cgZTtcbiAgICAgICAgICAgIE4oXCJFcnJvciBlbmFibGluZyBvZmZsaW5lIHBlcnNpc3RlbmNlLiBGYWxsaW5nIGJhY2sgdG8gcGVyc2lzdGVuY2UgZGlzYWJsZWQ6IFwiICsgZSksIFxuICAgICAgICAgICAgcy5yZWplY3QoZSk7XG4gICAgICAgIH1cbiAgICB9KSkudGhlbigoKCkgPT4gcy5wcm9taXNlKSk7XG59XG5cbmZ1bmN0aW9uIGphKHQpIHtcbiAgICBpZiAodC5faW5pdGlhbGl6ZWQgJiYgIXQuX3Rlcm1pbmF0ZWQpIHRocm93IG5ldyBMKEIuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJQZXJzaXN0ZW5jZSBjYW4gb25seSBiZSBjbGVhcmVkIGJlZm9yZSBhIEZpcmVzdG9yZSBpbnN0YW5jZSBpcyBpbml0aWFsaXplZCBvciBhZnRlciBpdCBpcyB0ZXJtaW5hdGVkLlwiKTtcbiAgICBjb25zdCBlID0gbmV3IFU7XG4gICAgcmV0dXJuIHQuX3F1ZXVlLmVucXVldWVBbmRGb3JnZXRFdmVuV2hpbGVSZXN0cmljdGVkKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFidC5DKCkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCArIFwibWFpblwiO1xuICAgICAgICAgICAgICAgIGF3YWl0IGJ0LmRlbGV0ZShlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgICAgICAgICAvKipcbiAqIENvbXBhcmVzIHR3byBhcnJheSBmb3IgZXF1YWxpdHkgdXNpbmcgY29tcGFyYXRvci4gVGhlIG1ldGhvZCBjb21wdXRlcyB0aGVcbiAqIGludGVyc2VjdGlvbiBhbmQgaW52b2tlcyBgb25BZGRgIGZvciBldmVyeSBlbGVtZW50IHRoYXQgaXMgaW4gYGFmdGVyYCBidXQgbm90XG4gKiBgYmVmb3JlYC4gYG9uUmVtb3ZlYCBpcyBpbnZva2VkIGZvciBldmVyeSBlbGVtZW50IGluIGBiZWZvcmVgIGJ1dCBtaXNzaW5nXG4gKiBmcm9tIGBhZnRlcmAuXG4gKlxuICogVGhlIG1ldGhvZCBjcmVhdGVzIGEgY29weSBvZiBib3RoIGBiZWZvcmVgIGFuZCBgYWZ0ZXJgIGFuZCBydW5zIGluIE8obiBsb2dcbiAqIG4pLCB3aGVyZSBuIGlzIHRoZSBzaXplIG9mIHRoZSB0d28gbGlzdHMuXG4gKlxuICogQHBhcmFtIGJlZm9yZSAtIFRoZSBlbGVtZW50cyB0aGF0IGV4aXN0IGluIHRoZSBvcmlnaW5hbCBhcnJheS5cbiAqIEBwYXJhbSBhZnRlciAtIFRoZSBlbGVtZW50cyB0byBkaWZmIGFnYWluc3QgdGhlIG9yaWdpbmFsIGFycmF5LlxuICogQHBhcmFtIGNvbXBhcmF0b3IgLSBUaGUgY29tcGFyYXRvciBmb3IgdGhlIGVsZW1lbnRzIGluIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gKiBAcGFyYW0gb25BZGQgLSBBIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIHBhcnQgb2YgYFxuICogYWZ0ZXJgIGJ1dCBub3QgYGJlZm9yZWAuXG4gKiBAcGFyYW0gb25SZW1vdmUgLSBBIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIHBhcnQgb2ZcbiAqIGBiZWZvcmVgIGJ1dCBub3QgYGFmdGVyYC5cbiAqLyAoZ28odC5fZGF0YWJhc2VJZCwgdC5fcGVyc2lzdGVuY2VLZXkpKSwgZS5yZXNvbHZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGUucmVqZWN0KHQpO1xuICAgICAgICB9XG4gICAgfSkpLCBlLnByb21pc2U7XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBmb3IgdGhlIGFjdGl2ZSB1c2VyIGhhdmUgYmVlblxuICogYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kLlxuICpcbiAqIFRoZSByZXR1cm5lZCBwcm9taXNlIHJlc29sdmVzIGltbWVkaWF0ZWx5IGlmIHRoZXJlIGFyZSBubyBvdXRzdGFuZGluZyB3cml0ZXMuXG4gKiBPdGhlcndpc2UsIHRoZSBwcm9taXNlIHdhaXRzIGZvciBhbGwgcHJldmlvdXNseSBpc3N1ZWQgd3JpdGVzIChpbmNsdWRpbmdcbiAqIHRob3NlIHdyaXR0ZW4gaW4gYSBwcmV2aW91cyBhcHAgc2Vzc2lvbiksIGJ1dCBpdCBkb2VzIG5vdCB3YWl0IGZvciB3cml0ZXNcbiAqIHRoYXQgd2VyZSBhZGRlZCBhZnRlciB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byB3YWl0IGZvclxuICogYWRkaXRpb25hbCB3cml0ZXMsIGNhbGwgYHdhaXRGb3JQZW5kaW5nV3JpdGVzKClgIGFnYWluLlxuICpcbiAqIEFueSBvdXRzdGFuZGluZyBgd2FpdEZvclBlbmRpbmdXcml0ZXMoKWAgcHJvbWlzZXMgYXJlIHJlamVjdGVkIGR1cmluZyB1c2VyXG4gKiBjaGFuZ2VzLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHdoaWNoIHJlc29sdmVzIHdoZW4gYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBoYXZlIGJlZW5cbiAqIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZC5cbiAqLyBmdW5jdGlvbiBXYSh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBVO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IF9jKGF3YWl0IEVhKHQpLCBlKSkpLCBlLnByb21pc2U7XG4gICAgfShVYSh0ID0gamModCwgJGEpKSk7XG59XG5cbi8qKlxuICogUmUtZW5hYmxlcyB1c2Ugb2YgdGhlIG5ldHdvcmsgZm9yIHRoaXMge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgYWZ0ZXIgYSBwcmlvclxuICogY2FsbCB0byB7QGxpbmsgZGlzYWJsZU5ldHdvcmt9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBlbmFibGVkLlxuICovIGZ1bmN0aW9uIHphKHQpIHtcbiAgICByZXR1cm4gYmEoVWEodCA9IGpjKHQsICRhKSkpO1xufVxuXG4vKipcbiAqIERpc2FibGVzIG5ldHdvcmsgdXNhZ2UgZm9yIHRoaXMgaW5zdGFuY2UuIEl0IGNhbiBiZSByZS1lbmFibGVkIHZpYSB7QGxpbmtcbiAqIGVuYWJsZU5ldHdvcmt9LiBXaGlsZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCwgYW55IHNuYXBzaG90IGxpc3RlbmVycyxcbiAqIGBnZXREb2MoKWAgb3IgYGdldERvY3MoKWAgY2FsbHMgd2lsbCByZXR1cm4gcmVzdWx0cyBmcm9tIGNhY2hlLCBhbmQgYW55IHdyaXRlXG4gKiBvcGVyYXRpb25zIHdpbGwgYmUgcXVldWVkIHVudGlsIHRoZSBuZXR3b3JrIGlzIHJlc3RvcmVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBkaXNhYmxlZC5cbiAqLyBmdW5jdGlvbiBIYSh0KSB7XG4gICAgcmV0dXJuIFBhKFVhKHQgPSBqYyh0LCAkYSkpKTtcbn1cblxuLyoqXG4gKiBUZXJtaW5hdGVzIHRoZSBwcm92aWRlZCB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZS5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIGB0ZXJtaW5hdGUoKWAgb25seSB0aGUgYGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgZnVuY3Rpb25cbiAqIG1heSBiZSB1c2VkLiBBbnkgb3RoZXIgZnVuY3Rpb24gd2lsbCB0aHJvdyBhIGBGaXJlc3RvcmVFcnJvcmAuXG4gKlxuICogVG8gcmVzdGFydCBhZnRlciB0ZXJtaW5hdGlvbiwgY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEZpcmViYXNlRmlyZXN0b3JlIHdpdGhcbiAqIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS5cbiAqXG4gKiBUZXJtaW5hdGlvbiBkb2VzIG5vdCBjYW5jZWwgYW55IHBlbmRpbmcgd3JpdGVzLCBhbmQgYW55IHByb21pc2VzIHRoYXQgYXJlXG4gKiBhd2FpdGluZyBhIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlciB3aWxsIG5vdCBiZSByZXNvbHZlZC4gSWYgeW91IGhhdmVcbiAqIHBlcnNpc3RlbmNlIGVuYWJsZWQsIHRoZSBuZXh0IHRpbWUgeW91IHN0YXJ0IHRoaXMgaW5zdGFuY2UsIGl0IHdpbGwgcmVzdW1lXG4gKiBzZW5kaW5nIHRoZXNlIHdyaXRlcyB0byB0aGUgc2VydmVyLlxuICpcbiAqIE5vdGU6IFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCBjYWxsaW5nIGB0ZXJtaW5hdGUoKWAgaXMgbm90IHJlcXVpcmVkLiBUaGlzXG4gKiBmdW5jdGlvbiBpcyB1c2VmdWwgb25seSB3aGVuIHlvdSB3YW50IHRvIGZvcmNlIHRoaXMgaW5zdGFuY2UgdG8gcmVsZWFzZSBhbGxcbiAqIG9mIGl0cyByZXNvdXJjZXMgb3IgaW4gY29tYmluYXRpb24gd2l0aCBgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCB0b1xuICogZW5zdXJlIHRoYXQgYWxsIGxvY2FsIHN0YXRlIGlzIGRlc3Ryb3llZCBiZXR3ZWVuIHRlc3QgcnVucy5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIGluc3RhbmNlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseVxuICogdGVybWluYXRlZC5cbiAqLyBmdW5jdGlvbiBKYSh0KSB7XG4gICAgcmV0dXJuIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UodC5hcHAsIFwiZmlyZXN0b3JlXCIsIHQuX2RhdGFiYXNlSWQuZGF0YWJhc2UpLCB0Ll9kZWxldGUoKTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgbG9jYWwgY2FjaGUuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBsb2FkIGJ1bmRsZXMgZm9yLlxuICogQHBhcmFtIGJ1bmRsZURhdGEgLSBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBidW5kbGUgdG8gYmUgbG9hZGVkLiBWYWxpZFxuICogb2JqZWN0cyBhcmUgYEFycmF5QnVmZmVyYCwgYFJlYWRhYmxlU3RyZWFtPFVpbnQ4QXJyYXk+YCBvciBgc3RyaW5nYC5cbiAqXG4gKiBAcmV0dXJucyBBIGBMb2FkQnVuZGxlVGFza2Agb2JqZWN0LCB3aGljaCBub3RpZmllcyBjYWxsZXJzIHdpdGggcHJvZ3Jlc3NcbiAqIHVwZGF0ZXMsIGFuZCBjb21wbGV0aW9uIG9yIGVycm9yIGV2ZW50cy4gSXQgY2FuIGJlIHVzZWQgYXMgYVxuICogYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz5gLlxuICovIGZ1bmN0aW9uIFlhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVWEodCA9IGpjKHQsICRhKSksIHMgPSBuZXcgTWE7XG4gICAgcmV0dXJuIHhhKG4sIHQuX2RhdGFiYXNlSWQsIGUsIHMpLCBzO1xufVxuXG4vKipcbiAqIFJlYWRzIGEgRmlyZXN0b3JlIHtAbGluayBRdWVyeX0gZnJvbSBsb2NhbCBjYWNoZSwgaWRlbnRpZmllZCBieSB0aGUgZ2l2ZW5cbiAqIG5hbWUuXG4gKlxuICogVGhlIG5hbWVkIHF1ZXJpZXMgYXJlIHBhY2thZ2VkICBpbnRvIGJ1bmRsZXMgb24gdGhlIHNlcnZlciBzaWRlIChhbG9uZ1xuICogd2l0aCByZXN1bHRpbmcgZG9jdW1lbnRzKSwgYW5kIGxvYWRlZCB0byBsb2NhbCBjYWNoZSB1c2luZyBgbG9hZEJ1bmRsZWAuIE9uY2VcbiAqIGluIGxvY2FsIGNhY2hlLCB1c2UgdGhpcyBtZXRob2QgdG8gZXh0cmFjdCBhIHtAbGluayBRdWVyeX0gYnkgbmFtZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIHJlYWQgdGhlIHF1ZXJ5IGZyb20uXG4gKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBxdWVyeS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgUXVlcnkgb3IgYG51bGxgLlxuICovIGZ1bmN0aW9uIFhhKHQsIGUpIHtcbiAgICByZXR1cm4gTmEoVWEodCA9IGpjKHQsICRhKSksIGUpLnRoZW4oKGUgPT4gZSA/IG5ldyBaYyh0LCBudWxsLCBlLnF1ZXJ5KSA6IG51bGwpKTtcbn1cblxuZnVuY3Rpb24gWmEodCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCB8fCB0Ll90ZXJtaW5hdGVkKSB0aHJvdyBuZXcgTChCLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgcGVyc2lzdGVuY2UgY2FuIG5vIGxvbmdlciBiZSBlbmFibGVkLiBZb3UgY2FuIG9ubHkgZW5hYmxlIHBlcnNpc3RlbmNlIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbW11dGFibGUgb2JqZWN0IHJlcHJlc2VudGluZyBhbiBhcnJheSBvZiBieXRlcy5cbiAqL1xuY2xhc3MgdGgge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLl9ieXRlU3RyaW5nID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgQnl0ZXNgIG9iamVjdCBmcm9tIHRoZSBnaXZlbiBCYXNlNjQgc3RyaW5nLCBjb252ZXJ0aW5nIGl0IHRvXG4gICAgICogYnl0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYmFzZTY0IC0gVGhlIEJhc2U2NCBzdHJpbmcgdXNlZCB0byBjcmVhdGUgdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbUJhc2U2NFN0cmluZyh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHRoKFd0LmZyb21CYXNlNjRTdHJpbmcodCkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiRmFpbGVkIHRvIGNvbnN0cnVjdCBkYXRhIGZyb20gQmFzZTY0IHN0cmluZzogXCIgKyB0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGBCeXRlc2Agb2JqZWN0IGZyb20gdGhlIGdpdmVuIFVpbnQ4QXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXJyYXkgLSBUaGUgVWludDhBcnJheSB1c2VkIHRvIGNyZWF0ZSB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdGgoV3QuZnJvbVVpbnQ4QXJyYXkodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB1bmRlcmx5aW5nIGJ5dGVzIGFzIGEgQmFzZTY0LWVuY29kZWQgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIEJhc2U2NC1lbmNvZGVkIHN0cmluZyBjcmVhdGVkIGZyb20gdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICB0b0Jhc2U2NCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcudG9CYXNlNjQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBpbiBhIG5ldyBgVWludDhBcnJheWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgVWludDhBcnJheSBjcmVhdGVkIGZyb20gdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICB0b1VpbnQ4QXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvVWludDhBcnJheSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIkJ5dGVzKGJhc2U2NDogXCIgKyB0aGlzLnRvQmFzZTY0KCkgKyBcIilcIjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEJ5dGVzYCBvYmplY3QgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgQnl0ZXNgIG9iamVjdCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy5pc0VxdWFsKHQuX2J5dGVTdHJpbmcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBgRmllbGRQYXRoYCByZWZlcnMgdG8gYSBmaWVsZCBpbiBhIGRvY3VtZW50LiBUaGUgcGF0aCBtYXkgY29uc2lzdCBvZiBhXG4gKiBzaW5nbGUgZmllbGQgbmFtZSAocmVmZXJyaW5nIHRvIGEgdG9wLWxldmVsIGZpZWxkIGluIHRoZSBkb2N1bWVudCksIG9yIGFcbiAqIGxpc3Qgb2YgZmllbGQgbmFtZXMgKHJlZmVycmluZyB0byBhIG5lc3RlZCBmaWVsZCBpbiB0aGUgZG9jdW1lbnQpLlxuICpcbiAqIENyZWF0ZSBhIGBGaWVsZFBhdGhgIGJ5IHByb3ZpZGluZyBmaWVsZCBuYW1lcy4gSWYgbW9yZSB0aGFuIG9uZSBmaWVsZFxuICogbmFtZSBpcyBwcm92aWRlZCwgdGhlIHBhdGggd2lsbCBwb2ludCB0byBhIG5lc3RlZCBmaWVsZCBpbiBhIGRvY3VtZW50LlxuICovIGNsYXNzIGVoIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYEZpZWxkUGF0aGAgZnJvbSB0aGUgcHJvdmlkZWQgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcbiAgICAgKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGROYW1lcyAtIEEgbGlzdCBvZiBmaWVsZCBuYW1lcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciguLi50KSB7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdC5sZW5ndGg7ICsrZSkgaWYgKDAgPT09IHRbZV0ubGVuZ3RoKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBuYW1lIGF0IGFyZ3VtZW50ICQoaSArIDEpLiBGaWVsZCBuYW1lcyBtdXN0IG5vdCBiZSBlbXB0eS5cIik7XG4gICAgICAgIHRoaXMuX2ludGVybmFsUGF0aCA9IG5ldyB1dCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEZpZWxkUGF0aGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgRmllbGRQYXRoYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBGaWVsZFBhdGhgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJuYWxQYXRoLmlzRXF1YWwodC5faW50ZXJuYWxQYXRoKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgc2VudGluZWwgYEZpZWxkUGF0aGAgdG8gcmVmZXIgdG8gdGhlIElEIG9mIGEgZG9jdW1lbnQuXG4gKiBJdCBjYW4gYmUgdXNlZCBpbiBxdWVyaWVzIHRvIHNvcnQgb3IgZmlsdGVyIGJ5IHRoZSBkb2N1bWVudCBJRC5cbiAqLyBmdW5jdGlvbiBuaCgpIHtcbiAgICByZXR1cm4gbmV3IGVoKFwiX19uYW1lX19cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNlbnRpbmVsIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIHdoZW4gd3JpdGluZyBkb2N1bWVudCBmaWVsZHMgd2l0aCBgc2V0KClgXG4gKiBvciBgdXBkYXRlKClgLlxuICovIGNsYXNzIHNoIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gX21ldGhvZE5hbWUgLSBUaGUgcHVibGljIEFQSSBlbmRwb2ludCB0aGF0IHJldHVybnMgdGhpcyBjbGFzcy5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLl9tZXRob2ROYW1lID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGEgZ2VvZ3JhcGhpYyBsb2NhdGlvbiBpbiBGaXJlc3RvcmUuIFRoZVxuICogbG9jYXRpb24gaXMgcmVwcmVzZW50ZWQgYXMgbGF0aXR1ZGUvbG9uZ2l0dWRlIHBhaXIuXG4gKlxuICogTGF0aXR1ZGUgdmFsdWVzIGFyZSBpbiB0aGUgcmFuZ2Ugb2YgWy05MCwgOTBdLlxuICogTG9uZ2l0dWRlIHZhbHVlcyBhcmUgaW4gdGhlIHJhbmdlIG9mIFstMTgwLCAxODBdLlxuICovIGNsYXNzIGloIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGltbXV0YWJsZSBgR2VvUG9pbnRgIG9iamVjdCB3aXRoIHRoZSBwcm92aWRlZCBsYXRpdHVkZSBhbmRcbiAgICAgKiBsb25naXR1ZGUgdmFsdWVzLlxuICAgICAqIEBwYXJhbSBsYXRpdHVkZSAtIFRoZSBsYXRpdHVkZSBhcyBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLlxuICAgICAqIEBwYXJhbSBsb25naXR1ZGUgLSBUaGUgbG9uZ2l0dWRlIGFzIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIGlmICghaXNGaW5pdGUodCkgfHwgdCA8IC05MCB8fCB0ID4gOTApIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJMYXRpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MCwgYnV0IHdhczogXCIgKyB0KTtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShlKSB8fCBlIDwgLTE4MCB8fCBlID4gMTgwKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiTG9uZ2l0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAsIGJ1dCB3YXM6IFwiICsgZSk7XG4gICAgICAgIHRoaXMuX2xhdCA9IHQsIHRoaXMuX2xvbmcgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbGF0aXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbGF0aXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBsb25naXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbG9uZ2l0dWRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9uZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEdlb1BvaW50YCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBHZW9Qb2ludGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgR2VvUG9pbnRgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGF0ID09PSB0Ll9sYXQgJiYgdGhpcy5fbG9uZyA9PT0gdC5fbG9uZztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIEdlb1BvaW50LiAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogdGhpcy5fbGF0LFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiB0aGlzLl9sb25nXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXG4gICAgICovICAgIF9jb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gWih0aGlzLl9sYXQsIHQuX2xhdCkgfHwgWih0aGlzLl9sb25nLCB0Ll9sb25nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHJoID0gL15fXy4qX18kLztcblxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBkb2N1bWVudCBkYXRhIChlLmcuIGZvciBhIHNldERhdGEgY2FsbCkuICovIGNsYXNzIG9oIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IHQsIHRoaXMuZmllbGRNYXNrID0gZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBuO1xuICAgIH1cbiAgICB0b011dGF0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuZmllbGRNYXNrID8gbmV3IEduKHQsIHRoaXMuZGF0YSwgdGhpcy5maWVsZE1hc2ssIGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKSA6IG5ldyBLbih0LCB0aGlzLmRhdGEsIGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKTtcbiAgICB9XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgXCJ1cGRhdGVcIiBkYXRhIChpLmUuIGZvciBhbiB1cGRhdGVEYXRhIGNhbGwpLiAqLyBjbGFzcyB1aCB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLy8gVGhlIGZpZWxkTWFzayBkb2VzIG5vdCBpbmNsdWRlIGRvY3VtZW50IHRyYW5zZm9ybXMuXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmRhdGEgPSB0LCB0aGlzLmZpZWxkTWFzayA9IGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gbjtcbiAgICB9XG4gICAgdG9NdXRhdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgR24odCwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2godCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSAwIC8qIFNldCAqLyA6XG4gLy8gZmFsbCB0aHJvdWdoXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBNZXJnZVNldCAqLyA6XG4gLy8gZmFsbCB0aHJvdWdoXG4gICAgICAgICAgICAgIGNhc2UgMSAvKiBVcGRhdGUgKi8gOlxuICAgICAgICByZXR1cm4gITA7XG5cbiAgICAgIGNhc2UgMyAvKiBBcmd1bWVudCAqLyA6XG4gICAgICBjYXNlIDQgLyogQXJyYXlBcmd1bWVudCAqLyA6XG4gICAgICAgIHJldHVybiAhMTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgTygpO1xuICAgIH1cbn1cblxuLyoqIEEgXCJjb250ZXh0XCIgb2JqZWN0IHBhc3NlZCBhcm91bmQgd2hpbGUgcGFyc2luZyB1c2VyIGRhdGEuICovIGNsYXNzIGFoIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIFBhcnNlQ29udGV4dCB3aXRoIHRoZSBnaXZlbiBzb3VyY2UgYW5kIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2V0dGluZ3MgLSBUaGUgc2V0dGluZ3MgZm9yIHRoZSBwYXJzZXIuXG4gICAgICogQHBhcmFtIGRhdGFiYXNlSWQgLSBUaGUgZGF0YWJhc2UgSUQgb2YgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0gc2VyaWFsaXplciAtIFRoZSBzZXJpYWxpemVyIHRvIHVzZSB0byBnZW5lcmF0ZSB0aGUgVmFsdWUgcHJvdG8uXG4gICAgICogQHBhcmFtIGlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgLSBXaGV0aGVyIHRvIGlnbm9yZSB1bmRlZmluZWQgcHJvcGVydGllc1xuICAgICAqIHJhdGhlciB0aGFuIHRocm93LlxuICAgICAqIEBwYXJhbSBmaWVsZFRyYW5zZm9ybXMgLSBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCB0cmFuc2Zvcm1zIGVuY291bnRlcmVkXG4gICAgICogd2hpbGUgcGFyc2luZyB0aGUgZGF0YS5cbiAgICAgKiBAcGFyYW0gZmllbGRNYXNrIC0gQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgcGF0aHMgZW5jb3VudGVyZWQgd2hpbGUgcGFyc2luZ1xuICAgICAqIHRoZSBkYXRhLlxuICAgICAqXG4gICAgICogVE9ETyhiLzM0ODcxMTMxKTogV2UgZG9uJ3Qgc3VwcG9ydCBhcnJheSBwYXRocyByaWdodCBub3csIHNvIHBhdGggY2FuIGJlXG4gICAgICogbnVsbCB0byBpbmRpY2F0ZSB0aGUgY29udGV4dCByZXByZXNlbnRzIGFueSBsb2NhdGlvbiB3aXRoaW4gYW4gYXJyYXkgKGluXG4gICAgICogd2hpY2ggY2FzZSBjZXJ0YWluIGZlYXR1cmVzIHdpbGwgbm90IHdvcmsgYW5kIGVycm9ycyB3aWxsIGJlIHNvbWV3aGF0XG4gICAgICogY29tcHJvbWlzZWQpLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHQsIHRoaXMuZGF0YWJhc2VJZCA9IGUsIHRoaXMuSXQgPSBuLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSBzLCBcbiAgICAgICAgLy8gTWlub3IgaGFjazogSWYgZmllbGRUcmFuc2Zvcm1zIGlzIHVuZGVmaW5lZCwgd2UgYXNzdW1lIHRoaXMgaXMgYW5cbiAgICAgICAgLy8gZXh0ZXJuYWwgY2FsbCBhbmQgd2UgbmVlZCB0byB2YWxpZGF0ZSB0aGUgZW50aXJlIHBhdGguXG4gICAgICAgIHZvaWQgMCA9PT0gaSAmJiB0aGlzLm5hKCksIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gaSB8fCBbXSwgdGhpcy5maWVsZE1hc2sgPSByIHx8IFtdO1xuICAgIH1cbiAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MucGF0aDtcbiAgICB9XG4gICAgZ2V0IHNhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5zYTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBuZXcgY29udGV4dCB3aXRoIHRoZSBzcGVjaWZpZWQgc2V0dGluZ3Mgb3ZlcndyaXR0ZW4uICovICAgIGlhKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhaChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2V0dGluZ3MpLCB0KSwgdGhpcy5kYXRhYmFzZUlkLCB0aGlzLkl0LCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XG4gICAgfVxuICAgIHJhKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuaWEoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIG9hOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMudWEodCksIHM7XG4gICAgfVxuICAgIGNhKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuaWEoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIG9hOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMubmEoKSwgcztcbiAgICB9XG4gICAgYWEodCkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdzsgc28gbWFrZSBwYXRoXG4gICAgICAgIC8vIHVuZGVmaW5lZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuaWEoe1xuICAgICAgICAgICAgcGF0aDogdm9pZCAwLFxuICAgICAgICAgICAgb2E6ICEwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYSh0KSB7XG4gICAgICAgIHJldHVybiBTaCh0LCB0aGlzLnNldHRpbmdzLm1ldGhvZE5hbWUsIHRoaXMuc2V0dGluZ3MubGEgfHwgITEsIHRoaXMucGF0aCwgdGhpcy5zZXR0aW5ncy5mYSk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zICd0cnVlJyBpZiAnZmllbGRQYXRoJyB3YXMgdHJhdmVyc2VkIHdoZW4gY3JlYXRpbmcgdGhpcyBjb250ZXh0LiAqLyAgICBjb250YWlucyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZmllbGRNYXNrLmZpbmQoKGUgPT4gdC5pc1ByZWZpeE9mKGUpKSkgfHwgdm9pZCAwICE9PSB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5maW5kKChlID0+IHQuaXNQcmVmaXhPZihlLmZpZWxkKSkpO1xuICAgIH1cbiAgICBuYSgpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogUmVtb3ZlIG51bGwgY2hlY2sgb25jZSB3ZSBoYXZlIHByb3BlciBwYXRocyBmb3IgZmllbGRzXG4gICAgICAgIC8vIHdpdGhpbiBhcnJheXMuXG4gICAgICAgIGlmICh0aGlzLnBhdGgpIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5wYXRoLmxlbmd0aDsgdCsrKSB0aGlzLnVhKHRoaXMucGF0aC5nZXQodCkpO1xuICAgIH1cbiAgICB1YSh0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgdGhyb3cgdGhpcy5oYShcIkRvY3VtZW50IGZpZWxkcyBtdXN0IG5vdCBiZSBlbXB0eVwiKTtcbiAgICAgICAgaWYgKGNoKHRoaXMuc2EpICYmIHJoLnRlc3QodCkpIHRocm93IHRoaXMuaGEoJ0RvY3VtZW50IGZpZWxkcyBjYW5ub3QgYmVnaW4gYW5kIGVuZCB3aXRoIFwiX19cIicpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgZm9yIHBhcnNpbmcgcmF3IHVzZXIgaW5wdXQgKHByb3ZpZGVkIHZpYSB0aGUgQVBJKSBpbnRvIGludGVybmFsIG1vZGVsXG4gKiBjbGFzc2VzLlxuICovIGNsYXNzIGhoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9IGUsIHRoaXMuSXQgPSBuIHx8IFpvKHQpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyB0b3AtbGV2ZWwgcGFyc2UgY29udGV4dC4gKi8gICAgZGEodCwgZSwgbiwgcyA9ICExKSB7XG4gICAgICAgIHJldHVybiBuZXcgYWgoe1xuICAgICAgICAgICAgc2E6IHQsXG4gICAgICAgICAgICBtZXRob2ROYW1lOiBlLFxuICAgICAgICAgICAgZmE6IG4sXG4gICAgICAgICAgICBwYXRoOiB1dC5lbXB0eVBhdGgoKSxcbiAgICAgICAgICAgIG9hOiAhMSxcbiAgICAgICAgICAgIGxhOiBzXG4gICAgICAgIH0sIHRoaXMuZGF0YWJhc2VJZCwgdGhpcy5JdCwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxoKHQpIHtcbiAgICBjb25zdCBlID0gdC5fZnJlZXplU2V0dGluZ3MoKSwgbiA9IFpvKHQuX2RhdGFiYXNlSWQpO1xuICAgIHJldHVybiBuZXcgaGgodC5fZGF0YWJhc2VJZCwgISFlLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIG4pO1xufVxuXG4vKiogUGFyc2UgZG9jdW1lbnQgZGF0YSBmcm9tIGEgc2V0KCkgY2FsbC4gKi8gZnVuY3Rpb24gZmgodCwgZSwgbiwgcywgaSwgciA9IHt9KSB7XG4gICAgY29uc3QgbyA9IHQuZGEoci5tZXJnZSB8fCByLm1lcmdlRmllbGRzID8gMiAvKiBNZXJnZVNldCAqLyA6IDAgLyogU2V0ICovICwgZSwgbiwgaSk7XG4gICAgYmgoXCJEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOlwiLCBvLCBzKTtcbiAgICBjb25zdCB1ID0gQWgocywgbyk7XG4gICAgbGV0IGMsIGE7XG4gICAgaWYgKHIubWVyZ2UpIGMgPSBuZXcgUXQoby5maWVsZE1hc2spLCBhID0gby5maWVsZFRyYW5zZm9ybXM7IGVsc2UgaWYgKHIubWVyZ2VGaWVsZHMpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2Ygci5tZXJnZUZpZWxkcykge1xuICAgICAgICAgICAgY29uc3QgaSA9IFBoKGUsIHMsIG4pO1xuICAgICAgICAgICAgaWYgKCFvLmNvbnRhaW5zKGkpKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBGaWVsZCAnJHtpfScgaXMgc3BlY2lmaWVkIGluIHlvdXIgZmllbGQgbWFzayBidXQgbWlzc2luZyBmcm9tIHlvdXIgaW5wdXQgZGF0YS5gKTtcbiAgICAgICAgICAgIERoKHQsIGkpIHx8IHQucHVzaChpKTtcbiAgICAgICAgfVxuICAgICAgICBjID0gbmV3IFF0KHQpLCBhID0gby5maWVsZFRyYW5zZm9ybXMuZmlsdGVyKCh0ID0+IGMuY292ZXJzKHQuZmllbGQpKSk7XG4gICAgfSBlbHNlIGMgPSBudWxsLCBhID0gby5maWVsZFRyYW5zZm9ybXM7XG4gICAgcmV0dXJuIG5ldyBvaChuZXcgdmUodSksIGMsIGEpO1xufVxuXG5jbGFzcyBkaCBleHRlbmRzIHNoIHtcbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIGlmICgyIC8qIE1lcmdlU2V0ICovICE9PSB0LnNhKSB0aHJvdyAxIC8qIFVwZGF0ZSAqLyA9PT0gdC5zYSA/IHQuaGEoYCR7dGhpcy5fbWV0aG9kTmFtZX0oKSBjYW4gb25seSBhcHBlYXIgYXQgdGhlIHRvcCBsZXZlbCBvZiB5b3VyIHVwZGF0ZSBkYXRhYCkgOiB0LmhhKGAke3RoaXMuX21ldGhvZE5hbWV9KCkgY2Fubm90IGJlIHVzZWQgd2l0aCBzZXQoKSB1bmxlc3MgeW91IHBhc3Mge21lcmdlOnRydWV9YCk7XG4gICAgICAgIC8vIE5vIHRyYW5zZm9ybSB0byBhZGQgZm9yIGEgZGVsZXRlLCBidXQgd2UgbmVlZCB0byBhZGQgaXQgdG8gb3VyXG4gICAgICAgIC8vIGZpZWxkTWFzayBzbyBpdCBnZXRzIGRlbGV0ZWQuXG4gICAgICAgIHJldHVybiB0LmZpZWxkTWFzay5wdXNoKHQucGF0aCksIG51bGw7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIGRoO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgY2hpbGQgY29udGV4dCBmb3IgcGFyc2luZyBTZXJpYWxpemFibGVGaWVsZFZhbHVlcy5cbiAqXG4gKiBUaGlzIGlzIGRpZmZlcmVudCB0aGFuIGNhbGxpbmcgYFBhcnNlQ29udGV4dC5jb250ZXh0V2l0aGAgYmVjYXVzZSBpdCBrZWVwc1xuICogdGhlIGZpZWxkVHJhbnNmb3JtcyBhbmQgZmllbGRNYXNrIHNlcGFyYXRlLlxuICpcbiAqIFRoZSBjcmVhdGVkIGNvbnRleHQgaGFzIGl0cyBgZGF0YVNvdXJjZWAgc2V0IHRvIGBVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudGAuXG4gKiBBbHRob3VnaCB0aGVzZSB2YWx1ZXMgYXJlIHVzZWQgd2l0aCB3cml0ZXMsIGFueSBlbGVtZW50cyBpbiB0aGVzZSBGaWVsZFZhbHVlc1xuICogYXJlIG5vdCBjb25zaWRlcmVkIHdyaXRlcyBzaW5jZSB0aGV5IGNhbm5vdCBjb250YWluIGFueSBGaWVsZFZhbHVlIHNlbnRpbmVscyxcbiAqIGV0Yy5cbiAqXG4gKiBAcGFyYW0gZmllbGRWYWx1ZSAtIFRoZSBzZW50aW5lbCBGaWVsZFZhbHVlIGZvciB3aGljaCB0byBjcmVhdGUgYSBjaGlsZFxuICogICAgIGNvbnRleHQuXG4gKiBAcGFyYW0gY29udGV4dCAtIFRoZSBwYXJlbnQgY29udGV4dC5cbiAqIEBwYXJhbSBhcnJheUVsZW1lbnQgLSBXaGV0aGVyIG9yIG5vdCB0aGUgRmllbGRWYWx1ZSBoYXMgYW4gYXJyYXkuXG4gKi8gZnVuY3Rpb24gX2godCwgZSwgbikge1xuICAgIHJldHVybiBuZXcgYWgoe1xuICAgICAgICBzYTogMyAvKiBBcmd1bWVudCAqLyAsXG4gICAgICAgIGZhOiBlLnNldHRpbmdzLmZhLFxuICAgICAgICBtZXRob2ROYW1lOiB0Ll9tZXRob2ROYW1lLFxuICAgICAgICBvYTogblxuICAgIH0sIGUuZGF0YWJhc2VJZCwgZS5JdCwgZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbn1cblxuY2xhc3Mgd2ggZXh0ZW5kcyBzaCB7XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICByZXR1cm4gbmV3IHhuKHQucGF0aCwgbmV3IFJuKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2Ygd2g7XG4gICAgfVxufVxuXG5jbGFzcyBtaCBleHRlbmRzIHNoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLl9hID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gX2godGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5fYS5tYXAoKHQgPT4gRWgodCwgZSkpKSwgcyA9IG5ldyBibihuKTtcbiAgICAgICAgcmV0dXJuIG5ldyB4bih0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBnaCBleHRlbmRzIHNoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLl9hID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gX2godGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5fYS5tYXAoKHQgPT4gRWgodCwgZSkpKSwgcyA9IG5ldyB2bihuKTtcbiAgICAgICAgcmV0dXJuIG5ldyB4bih0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyB5aCBleHRlbmRzIHNoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLndhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IFNuKHQuSXQsIHBuKHQuSXQsIHRoaXMud2EpKTtcbiAgICAgICAgcmV0dXJuIG5ldyB4bih0LnBhdGgsIGUpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG4vKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhbiB1cGRhdGUoKSBjYWxsLiAqLyBmdW5jdGlvbiBwaCh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IHQuZGEoMSAvKiBVcGRhdGUgKi8gLCBlLCBuKTtcbiAgICBiaChcIkRhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6XCIsIGksIHMpO1xuICAgIGNvbnN0IHIgPSBbXSwgbyA9IHZlLmVtcHR5KCk7XG4gICAgRnQocywgKCh0LCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IHUgPSBWaChlLCB0LCBuKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIHMgPSBnZXRNb2R1bGFySW5zdGFuY2Uocyk7XG4gICAgICAgIGNvbnN0IGMgPSBpLmNhKHUpO1xuICAgICAgICBpZiAocyBpbnN0YW5jZW9mIGRoKSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIHIucHVzaCh1KTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gRWgocywgYyk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKHIucHVzaCh1KSwgby5zZXQodSwgdCkpO1xuICAgICAgICB9XG4gICAgfSkpO1xuICAgIGNvbnN0IHUgPSBuZXcgUXQocik7XG4gICAgcmV0dXJuIG5ldyB1aChvLCB1LCBpLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKiBQYXJzZSB1cGRhdGUgZGF0YSBmcm9tIGEgbGlzdCBvZiBmaWVsZC92YWx1ZSBhcmd1bWVudHMuICovIGZ1bmN0aW9uIEloKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICBjb25zdCBvID0gdC5kYSgxIC8qIFVwZGF0ZSAqLyAsIGUsIG4pLCB1ID0gWyBQaChlLCBzLCBuKSBdLCBjID0gWyBpIF07XG4gICAgaWYgKHIubGVuZ3RoICUgMiAhPSAwKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke2V9KCkgbmVlZHMgdG8gYmUgY2FsbGVkIHdpdGggYW4gZXZlbiBudW1iZXIgb2YgYXJndW1lbnRzIHRoYXQgYWx0ZXJuYXRlIGJldHdlZW4gZmllbGQgbmFtZXMgYW5kIHZhbHVlcy5gKTtcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHIubGVuZ3RoOyB0ICs9IDIpIHUucHVzaChQaChlLCByW3RdKSksIGMucHVzaChyW3QgKyAxXSk7XG4gICAgY29uc3QgYSA9IFtdLCBoID0gdmUuZW1wdHkoKTtcbiAgICAvLyBXZSBpdGVyYXRlIGluIHJldmVyc2Ugb3JkZXIgdG8gcGljayB0aGUgbGFzdCB2YWx1ZSBmb3IgYSBmaWVsZCBpZiB0aGVcbiAgICAvLyB1c2VyIHNwZWNpZmllZCB0aGUgZmllbGQgbXVsdGlwbGUgdGltZXMuXG4gICAgZm9yIChsZXQgdCA9IHUubGVuZ3RoIC0gMTsgdCA+PSAwOyAtLXQpIGlmICghRGgoYSwgdVt0XSkpIHtcbiAgICAgICAgY29uc3QgZSA9IHVbdF07XG4gICAgICAgIGxldCBuID0gY1t0XTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIG4gPSBnZXRNb2R1bGFySW5zdGFuY2Uobik7XG4gICAgICAgIGNvbnN0IHMgPSBvLmNhKGUpO1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIGRoKSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIGEucHVzaChlKTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gRWgobiwgcyk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKGEucHVzaChlKSwgaC5zZXQoZSwgdCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGwgPSBuZXcgUXQoYSk7XG4gICAgcmV0dXJuIG5ldyB1aChoLCBsLCBvLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKlxuICogUGFyc2UgYSBcInF1ZXJ5IHZhbHVlXCIgKGUuZy4gdmFsdWUgaW4gYSB3aGVyZSBmaWx0ZXIgb3IgYSB2YWx1ZSBpbiBhIGN1cnNvclxuICogYm91bmQpLlxuICpcbiAqIEBwYXJhbSBhbGxvd0FycmF5cyAtIFdoZXRoZXIgdGhlIHF1ZXJ5IHZhbHVlIGlzIGFuIGFycmF5IHRoYXQgbWF5IGRpcmVjdGx5XG4gKiBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlLmcuIHRoZSBvcGVyYW5kIG9mIGFuIGBpbmAgcXVlcnkpLlxuICovIGZ1bmN0aW9uIFRoKHQsIGUsIG4sIHMgPSAhMSkge1xuICAgIHJldHVybiBFaChuLCB0LmRhKHMgPyA0IC8qIEFycmF5QXJndW1lbnQgKi8gOiAzIC8qIEFyZ3VtZW50ICovICwgZSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB1c2VyIGRhdGEgdG8gUHJvdG9idWYgVmFsdWVzLlxuICpcbiAqIEBwYXJhbSBpbnB1dCAtIERhdGEgdG8gYmUgcGFyc2VkLlxuICogQHBhcmFtIGNvbnRleHQgLSBBIGNvbnRleHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBwYXRoIGJlaW5nIHBhcnNlZCxcbiAqIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgYmVpbmcgcGFyc2VkLCBldGMuXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlLCBvciBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBGaWVsZFZhbHVlIHNlbnRpbmVsXG4gKiB0aGF0IHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdGluZyBwYXJzZWQgZGF0YS5cbiAqLyBmdW5jdGlvbiBFaCh0LCBlKSB7XG4gICAgaWYgKFJoKFxuICAgIC8vIFVud3JhcCB0aGUgQVBJIHR5cGUgZnJvbSB0aGUgQ29tcGF0IFNESy4gVGhpcyB3aWxsIHJldHVybiB0aGUgQVBJIHR5cGVcbiAgICAvLyBmcm9tIGZpcmVzdG9yZS1leHAuXG4gICAgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkpIHJldHVybiBiaChcIlVuc3VwcG9ydGVkIGZpZWxkIHZhbHVlOlwiLCBlLCB0KSwgQWgodCwgZSk7XG4gICAgaWYgKHQgaW5zdGFuY2VvZiBzaCkgXG4gICAgLy8gRmllbGRWYWx1ZXMgdXN1YWxseSBwYXJzZSBpbnRvIHRyYW5zZm9ybXMgKGV4Y2VwdCBkZWxldGVGaWVsZCgpKVxuICAgIC8vIGluIHdoaWNoIGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gaW5jbHVkZSB0aGlzIGZpZWxkIGluIG91ciBwYXJzZWQgZGF0YVxuICAgIC8vIChhcyBkb2luZyBzbyB3aWxsIG92ZXJ3cml0ZSB0aGUgZmllbGQgZGlyZWN0bHkgcHJpb3IgdG8gdGhlIHRyYW5zZm9ybVxuICAgIC8vIHRyeWluZyB0byB0cmFuc2Zvcm0gaXQpLiBTbyB3ZSBkb24ndCBhZGQgdGhpcyBsb2NhdGlvbiB0b1xuICAgIC8vIGNvbnRleHQuZmllbGRNYXNrIGFuZCB3ZSByZXR1cm4gbnVsbCBhcyBvdXIgcGFyc2luZyByZXN1bHQuXG4gICAgLyoqXG4gKiBcIlBhcnNlc1wiIHRoZSBwcm92aWRlZCBGaWVsZFZhbHVlSW1wbCwgYWRkaW5nIGFueSBuZWNlc3NhcnkgdHJhbnNmb3JtcyB0b1xuICogY29udGV4dC5maWVsZFRyYW5zZm9ybXMuXG4gKi9cbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBTZW50aW5lbHMgYXJlIG9ubHkgc3VwcG9ydGVkIHdpdGggd3JpdGVzLCBhbmQgbm90IHdpdGhpbiBhcnJheXMuXG4gICAgICAgIGlmICghY2goZS5zYSkpIHRocm93IGUuaGEoYCR7dC5fbWV0aG9kTmFtZX0oKSBjYW4gb25seSBiZSB1c2VkIHdpdGggdXBkYXRlKCkgYW5kIHNldCgpYCk7XG4gICAgICAgIGlmICghZS5wYXRoKSB0aHJvdyBlLmhhKGAke3QuX21ldGhvZE5hbWV9KCkgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW5zaWRlIGFycmF5c2ApO1xuICAgICAgICBjb25zdCBuID0gdC5fdG9GaWVsZFRyYW5zZm9ybShlKTtcbiAgICAgICAgbiAmJiBlLmZpZWxkVHJhbnNmb3Jtcy5wdXNoKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEhlbHBlciB0byBwYXJzZSBhIHNjYWxhciB2YWx1ZSAoaS5lLiBub3QgYW4gT2JqZWN0LCBBcnJheSwgb3IgRmllbGRWYWx1ZSlcbiAqXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlXG4gKi8gKHQsIGUpLCBudWxsO1xuICAgIGlmICh2b2lkIDAgPT09IHQgJiYgZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKSBcbiAgICAvLyBJZiB0aGUgaW5wdXQgaXMgdW5kZWZpbmVkIGl0IGNhbiBuZXZlciBwYXJ0aWNpcGF0ZSBpbiB0aGUgZmllbGRNYXNrLCBzb1xuICAgIC8vIGRvbid0IGhhbmRsZSB0aGlzIGJlbG93LiBJZiBgaWdub3JlVW5kZWZpbmVkUHJvcGVydGllc2AgaXMgZmFsc2UsXG4gICAgLy8gYHBhcnNlU2NhbGFyVmFsdWVgIHdpbGwgcmVqZWN0IGFuIHVuZGVmaW5lZCB2YWx1ZS5cbiAgICByZXR1cm4gbnVsbDtcbiAgICBpZiAoXG4gICAgLy8gSWYgY29udGV4dC5wYXRoIGlzIG51bGwgd2UgYXJlIGluc2lkZSBhbiBhcnJheSBhbmQgd2UgZG9uJ3Qgc3VwcG9ydFxuICAgIC8vIGZpZWxkIG1hc2sgcGF0aHMgbW9yZSBncmFudWxhciB0aGFuIHRoZSB0b3AtbGV2ZWwgYXJyYXkuXG4gICAgZS5wYXRoICYmIGUuZmllbGRNYXNrLnB1c2goZS5wYXRoKSwgdCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IEluY2x1ZGUgdGhlIHBhdGggY29udGFpbmluZyB0aGUgYXJyYXkgaW4gdGhlIGVycm9yXG4gICAgICAgIC8vIG1lc3NhZ2UuXG4gICAgICAgIC8vIEluIHRoZSBjYXNlIG9mIElOIHF1ZXJpZXMsIHRoZSBwYXJzZWQgZGF0YSBpcyBhbiBhcnJheSAocmVwcmVzZW50aW5nXG4gICAgICAgIC8vIHRoZSBzZXQgb2YgdmFsdWVzIHRvIGJlIGluY2x1ZGVkIGZvciB0aGUgSU4gcXVlcnkpIHRoYXQgbWF5IGRpcmVjdGx5XG4gICAgICAgIC8vIGNvbnRhaW4gYWRkaXRpb25hbCBhcnJheXMgKGVhY2ggcmVwcmVzZW50aW5nIGFuIGluZGl2aWR1YWwgZmllbGRcbiAgICAgICAgLy8gdmFsdWUpLCBzbyB3ZSBkaXNhYmxlIHRoaXMgdmFsaWRhdGlvbi5cbiAgICAgICAgaWYgKGUuc2V0dGluZ3Mub2EgJiYgNCAvKiBBcnJheUFyZ3VtZW50ICovICE9PSBlLnNhKSB0aHJvdyBlLmhhKFwiTmVzdGVkIGFycmF5cyBhcmUgbm90IHN1cHBvcnRlZFwiKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XG4gICAgICAgICAgICAgICAgbGV0IHQgPSBFaChpLCBlLmFhKHMpKTtcbiAgICAgICAgICAgICAgICBudWxsID09IHQgJiYgKFxuICAgICAgICAgICAgICAgIC8vIEp1c3QgaW5jbHVkZSBudWxscyBpbiB0aGUgYXJyYXkgZm9yIGZpZWxkcyBiZWluZyByZXBsYWNlZCB3aXRoIGFcbiAgICAgICAgICAgICAgICAvLyBzZW50aW5lbC5cbiAgICAgICAgICAgICAgICB0ID0ge1xuICAgICAgICAgICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgICAgICAgICAgfSksIG4ucHVzaCh0KSwgcysrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCwgZSk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGlmIChudWxsID09PSAodCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkpIHJldHVybiB7XG4gICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0KSByZXR1cm4gcG4oZS5JdCwgdCk7XG4gICAgICAgIGlmIChcImJvb2xlYW5cIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGJvb2xlYW5WYWx1ZTogdFxuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiB0XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IG50LmZyb21EYXRlKHQpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBWYWx1ZTogdnMoZS5JdCwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBudCkge1xuICAgICAgICAgICAgLy8gRmlyZXN0b3JlIGJhY2tlbmQgdHJ1bmNhdGVzIHByZWNpc2lvbiBkb3duIHRvIG1pY3Jvc2Vjb25kcy4gVG8gZW5zdXJlXG4gICAgICAgICAgICAvLyBvZmZsaW5lIG1vZGUgd29ya3MgdGhlIHNhbWUgd2l0aCByZWdhcmRzIHRvIHRydW5jYXRpb24sIHBlcmZvcm0gdGhlXG4gICAgICAgICAgICAvLyB0cnVuY2F0aW9uIGltbWVkaWF0ZWx5IHdpdGhvdXQgd2FpdGluZyBmb3IgdGhlIGJhY2tlbmQgdG8gZG8gdGhhdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgbnQodC5zZWNvbmRzLCAxZTMgKiBNYXRoLmZsb29yKHQubmFub3NlY29uZHMgLyAxZTMpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IHZzKGUuSXQsIG4pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgaWgpIHJldHVybiB7XG4gICAgICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgbGF0aXR1ZGU6IHQubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiB0LmxvbmdpdHVkZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIHRoKSByZXR1cm4ge1xuICAgICAgICAgICAgYnl0ZXNWYWx1ZTogVnMoZS5JdCwgdC5fYnl0ZVN0cmluZylcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBYYykge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUuZGF0YWJhc2VJZCwgcyA9IHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkO1xuICAgICAgICAgICAgaWYgKCFzLmlzRXF1YWwobikpIHRocm93IGUuaGEoYERvY3VtZW50IHJlZmVyZW5jZSBpcyBmb3IgZGF0YWJhc2UgJHtzLnByb2plY3RJZH0vJHtzLmRhdGFiYXNlfSBidXQgc2hvdWxkIGJlIGZvciBkYXRhYmFzZSAke24ucHJvamVjdElkfS8ke24uZGF0YWJhc2V9YCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZVZhbHVlOiBDcyh0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCB8fCBlLmRhdGFiYXNlSWQsIHQuX2tleS5wYXRoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlLmhhKGBVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTogJHtRYyh0KX1gKTtcbiAgICB9XG4gICAgLyoqXG4gKiBDaGVja3Mgd2hldGhlciBhbiBvYmplY3QgbG9va3MgbGlrZSBhIEpTT04gb2JqZWN0IHRoYXQgc2hvdWxkIGJlIGNvbnZlcnRlZFxuICogaW50byBhIHN0cnVjdC4gTm9ybWFsIGNsYXNzL3Byb3RvdHlwZSBpbnN0YW5jZXMgYXJlIGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlXG4gKiBKU09OIG9iamVjdHMgc2luY2UgdGhleSBzaG91bGQgYmUgY29udmVydGVkIHRvIGEgc3RydWN0IHZhbHVlLiBBcnJheXMsIERhdGVzLFxuICogR2VvUG9pbnRzLCBldGMuIGFyZSBub3QgY29uc2lkZXJlZCB0byBsb29rIGxpa2UgSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgbWFwXG4gKiB0byBzcGVjaWZpYyBGaWVsZFZhbHVlIHR5cGVzIG90aGVyIHRoYW4gT2JqZWN0VmFsdWUuXG4gKi8gKHQsIGUpO1xufVxuXG5mdW5jdGlvbiBBaCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IHt9O1xuICAgIHJldHVybiAkdCh0KSA/IFxuICAgIC8vIElmIHdlIGVuY291bnRlciBhbiBlbXB0eSBvYmplY3QsIHdlIGV4cGxpY2l0bHkgYWRkIGl0IHRvIHRoZSB1cGRhdGVcbiAgICAvLyBtYXNrIHRvIGVuc3VyZSB0aGF0IHRoZSBzZXJ2ZXIgY3JlYXRlcyBhIG1hcCBlbnRyeS5cbiAgICBlLnBhdGggJiYgZS5wYXRoLmxlbmd0aCA+IDAgJiYgZS5maWVsZE1hc2sucHVzaChlLnBhdGgpIDogRnQodCwgKCh0LCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IGkgPSBFaChzLCBlLnJhKHQpKTtcbiAgICAgICAgbnVsbCAhPSBpICYmIChuW3RdID0gaSk7XG4gICAgfSkpLCB7XG4gICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICBmaWVsZHM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIFJoKHQpIHtcbiAgICByZXR1cm4gIShcIm9iamVjdFwiICE9IHR5cGVvZiB0IHx8IG51bGwgPT09IHQgfHwgdCBpbnN0YW5jZW9mIEFycmF5IHx8IHQgaW5zdGFuY2VvZiBEYXRlIHx8IHQgaW5zdGFuY2VvZiBudCB8fCB0IGluc3RhbmNlb2YgaWggfHwgdCBpbnN0YW5jZW9mIHRoIHx8IHQgaW5zdGFuY2VvZiBYYyB8fCB0IGluc3RhbmNlb2Ygc2gpO1xufVxuXG5mdW5jdGlvbiBiaCh0LCBlLCBuKSB7XG4gICAgaWYgKCFSaChuKSB8fCAhZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gXCJvYmplY3RcIiA9PSB0eXBlb2YgdCAmJiBudWxsICE9PSB0ICYmIChPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkgPT09IE9iamVjdC5wcm90b3R5cGUgfHwgbnVsbCA9PT0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpKTtcbiAgICB9KG4pKSB7XG4gICAgICAgIGNvbnN0IHMgPSBRYyhuKTtcbiAgICAgICAgdGhyb3cgXCJhbiBvYmplY3RcIiA9PT0gcyA/IGUuaGEodCArIFwiIGEgY3VzdG9tIG9iamVjdFwiKSA6IGUuaGEodCArIFwiIFwiICsgcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0aGF0IGNhbGxzIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcoKSBidXQgd3JhcHMgYW55IGVycm9yIHRocm93bi5cbiAqLyBmdW5jdGlvbiBQaCh0LCBlLCBuKSB7XG4gICAgaWYgKChcbiAgICAvLyBJZiByZXF1aXJlZCwgcmVwbGFjZSB0aGUgRmllbGRQYXRoIENvbXBhdCBjbGFzcyB3aXRoIHdpdGggdGhlIGZpcmVzdG9yZS1leHBcbiAgICAvLyBGaWVsZFBhdGguXG4gICAgZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSkgaW5zdGFuY2VvZiBlaCkgcmV0dXJuIGUuX2ludGVybmFsUGF0aDtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSkgcmV0dXJuIFZoKHQsIGUpO1xuICAgIHRocm93IFNoKFwiRmllbGQgcGF0aCBhcmd1bWVudHMgbXVzdCBiZSBvZiB0eXBlIHN0cmluZyBvciBcIiwgdCwgXG4gICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbn1cblxuLyoqXG4gKiBNYXRjaGVzIGFueSBjaGFyYWN0ZXJzIGluIGEgZmllbGQgcGF0aCBzdHJpbmcgdGhhdCBhcmUgcmVzZXJ2ZWQuXG4gKi8gY29uc3QgdmggPSBuZXcgUmVnRXhwKFwiW35cXFxcKi9cXFxcW1xcXFxdXVwiKTtcblxuLyoqXG4gKiBXcmFwcyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCB0aGUgbWV0aG9kIHRoYXRcbiAqIHdhcyB0aHJvd24uXG4gKiBAcGFyYW0gbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWNseSB2aXNpYmxlIG1ldGhvZCBuYW1lXG4gKiBAcGFyYW0gcGF0aCAtIFRoZSBkb3Qtc2VwYXJhdGVkIHN0cmluZyBmb3JtIG9mIGEgZmllbGQgcGF0aCB3aGljaCB3aWxsIGJlXG4gKiBzcGxpdCBvbiBkb3RzLlxuICogQHBhcmFtIHRhcmdldERvYyAtIFRoZSBkb2N1bWVudCBhZ2FpbnN0IHdoaWNoIHRoZSBmaWVsZCBwYXRoIHdpbGwgYmVcbiAqIGV2YWx1YXRlZC5cbiAqLyBmdW5jdGlvbiBWaCh0LCBlLCBuKSB7XG4gICAgaWYgKGUuc2VhcmNoKHZoKSA+PSAwKSB0aHJvdyBTaChgSW52YWxpZCBmaWVsZCBwYXRoICgke2V9KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAnficsICcqJywgJy8nLCAnWycsIG9yICddJ2AsIHQsIFxuICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgIC8qIHBhdGg9ICovIHZvaWQgMCwgbik7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG5ldyBlaCguLi5lLnNwbGl0KFwiLlwiKSkuX2ludGVybmFsUGF0aDtcbiAgICB9IGNhdGNoIChzKSB7XG4gICAgICAgIHRocm93IFNoKGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7ZX0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCwgdCwgXG4gICAgICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgICAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gU2godCwgZSwgbiwgcywgaSkge1xuICAgIGNvbnN0IHIgPSBzICYmICFzLmlzRW1wdHkoKSwgbyA9IHZvaWQgMCAhPT0gaTtcbiAgICBsZXQgdSA9IGBGdW5jdGlvbiAke2V9KCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhYDtcbiAgICBuICYmICh1ICs9IFwiICh2aWEgYHRvRmlyZXN0b3JlKClgKVwiKSwgdSArPSBcIi4gXCI7XG4gICAgbGV0IGMgPSBcIlwiO1xuICAgIHJldHVybiAociB8fCBvKSAmJiAoYyArPSBcIiAoZm91bmRcIiwgciAmJiAoYyArPSBgIGluIGZpZWxkICR7c31gKSwgbyAmJiAoYyArPSBgIGluIGRvY3VtZW50ICR7aX1gKSwgXG4gICAgYyArPSBcIilcIiksIG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgdSArIHQgKyBjKTtcbn1cblxuLyoqIENoZWNrcyBgaGF5c3RhY2tgIGlmIEZpZWxkUGF0aCBgbmVlZGxlYCBpcyBwcmVzZW50LiBSdW5zIGluIE8obikuICovIGZ1bmN0aW9uIERoKHQsIGUpIHtcbiAgICByZXR1cm4gdC5zb21lKCh0ID0+IHQuaXNFcXVhbChlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXIgRmlyZXN0b3JlXG4gKiBkYXRhYmFzZS4gVGhlIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG9cbiAqIGdldCBhIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEZvciBhIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHBvaW50cyB0byBhIG5vbi1leGlzdGluZyBkb2N1bWVudCwgYW55IGRhdGFcbiAqIGFjY2VzcyB3aWxsIHJldHVybiAndW5kZWZpbmVkJy4gWW91IGNhbiB1c2UgdGhlIGBleGlzdHMoKWAgbWV0aG9kIHRvXG4gKiBleHBsaWNpdGx5IHZlcmlmeSBhIGRvY3VtZW50J3MgZXhpc3RlbmNlLlxuICovIGNsYXNzIENoIHtcbiAgICAvLyBOb3RlOiBUaGlzIGNsYXNzIGlzIHN0cmlwcGVkIGRvd24gdmVyc2lvbiBvZiB0aGUgRG9jdW1lbnRTbmFwc2hvdCBpblxuICAgIC8vIHRoZSBsZWdhY3kgU0RLLiBUaGUgY2hhbmdlcyBhcmU6XG4gICAgLy8gLSBObyBzdXBwb3J0IGZvciBTbmFwc2hvdE1ldGFkYXRhLlxuICAgIC8vIC0gTm8gc3VwcG9ydCBmb3IgU25hcHNob3RPcHRpb25zLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fdXNlckRhdGFXcml0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCB0aGlzLl9kb2N1bWVudCA9IHMsIFxuICAgICAgICB0aGlzLl9jb252ZXJ0ZXIgPSBpO1xuICAgIH1cbiAgICAvKiogUHJvcGVydHkgb2YgdGhlIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHByb3ZpZGVzIHRoZSBkb2N1bWVudCdzIElELiAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgYERvY3VtZW50UmVmZXJlbmNlYCBmb3IgdGhlIGRvY3VtZW50IGluY2x1ZGVkIGluIHRoZSBgRG9jdW1lbnRTbmFwc2hvdGAuXG4gICAgICovICAgIGdldCByZWYoKSB7XG4gICAgICAgIHJldHVybiBuZXcgWGModGhpcy5fZmlyZXN0b3JlLCB0aGlzLl9jb252ZXJ0ZXIsIHRoaXMuX2tleSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNpZ25hbHMgd2hldGhlciBvciBub3QgdGhlIGRvY3VtZW50IGF0IHRoZSBzbmFwc2hvdCdzIGxvY2F0aW9uIGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGV4aXN0cy5cbiAgICAgKi8gICAgZXhpc3RzKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5fZG9jdW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBhcyBhbiBgT2JqZWN0YC4gUmV0dXJucyBgdW5kZWZpbmVkYCBpZlxuICAgICAqIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBvciBgdW5kZWZpbmVkYFxuICAgICAqIGlmIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqLyAgICBkYXRhKCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb252ZXJ0ZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBvbmx5IHdhbnQgdG8gdXNlIHRoZSBjb252ZXJ0ZXIgYW5kIGNyZWF0ZSBhIG5ldyBEb2N1bWVudFNuYXBzaG90XG4gICAgICAgICAgICAgICAgLy8gaWYgYSBjb252ZXJ0ZXIgaGFzIGJlZW4gcHJvdmlkZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyB4aCh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCB0aGlzLl9rZXksIHRoaXMuX2RvY3VtZW50LCBcbiAgICAgICAgICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0ZXIuZnJvbUZpcmVzdG9yZSh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUodGhpcy5fZG9jdW1lbnQuZGF0YS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCAoZm9yIGV4YW1wbGUgJ2Zvbycgb3IgJ2Zvby5iYXInKSB0byBhIHNwZWNpZmljXG4gICAgICogZmllbGQuXG4gICAgICogQHJldHVybnMgVGhlIGRhdGEgYXQgdGhlIHNwZWNpZmllZCBmaWVsZCBsb2NhdGlvbiBvciB1bmRlZmluZWQgaWYgbm8gc3VjaFxuICAgICAqIGZpZWxkIGV4aXN0cyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgLy8gV2UgYXJlIHVzaW5nIGBhbnlgIGhlcmUgdG8gYXZvaWQgYW4gZXhwbGljaXQgY2FzdCBieSBvdXIgdXNlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBnZXQodCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKE5oKFwiRG9jdW1lbnRTbmFwc2hvdC5nZXRcIiwgdCkpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUpIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUoZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyB4aCBleHRlbmRzIENoIHtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcmV0dXJucyBBbiBgT2JqZWN0YCBjb250YWluaW5nIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIGRhdGEoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5kYXRhKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0aGF0IGNhbGxzIGBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKClgIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxuICovIGZ1bmN0aW9uIE5oKHQsIGUpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IFZoKHQsIGUpIDogZSBpbnN0YW5jZW9mIGVoID8gZS5faW50ZXJuYWxQYXRoIDogZS5fZGVsZWdhdGUuX2ludGVybmFsUGF0aDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24ga2godCkge1xuICAgIGlmIChcIkxcIiAvKiBMYXN0ICovID09PSB0LmxpbWl0VHlwZSAmJiAwID09PSB0LmV4cGxpY2l0T3JkZXJCeS5sZW5ndGgpIHRocm93IG5ldyBMKEIuVU5JTVBMRU1FTlRFRCwgXCJsaW1pdFRvTGFzdCgpIHF1ZXJpZXMgcmVxdWlyZSBzcGVjaWZ5aW5nIGF0IGxlYXN0IG9uZSBvcmRlckJ5KCkgY2xhdXNlXCIpO1xufVxuXG4vKipcbiAqIEEgYFF1ZXJ5Q29uc3RyYWludGAgaXMgdXNlZCB0byBuYXJyb3cgdGhlIHNldCBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnkgYVxuICogRmlyZXN0b3JlIHF1ZXJ5LiBgUXVlcnlDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIHdoZXJlfSxcbiAqIHtAbGluayBvcmRlckJ5fSwge0BsaW5rIChzdGFydEF0OjEpfSwge0BsaW5rIChzdGFydEFmdGVyOjEpfSwge0BsaW5rXG4gKiBlbmRCZWZvcmU6MX0sIHtAbGluayAoZW5kQXQ6MSl9LCB7QGxpbmsgbGltaXR9IG9yIHtAbGluayBsaW1pdFRvTGFzdH0gYW5kXG4gKiBjYW4gdGhlbiBiZSBwYXNzZWQgdG8ge0BsaW5rIHF1ZXJ5fSB0byBjcmVhdGUgYSBuZXcgcXVlcnkgaW5zdGFuY2UgdGhhdFxuICogYWxzbyBjb250YWlucyB0aGlzIGBRdWVyeUNvbnN0cmFpbnRgLlxuICovIGNsYXNzIE9oIHt9XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBpbW11dGFibGUgaW5zdGFuY2Ugb2Yge0BsaW5rIFF1ZXJ5fSB0aGF0IGlzIGV4dGVuZGVkIHRvIGFsc28gaW5jbHVkZVxuICogYWRkaXRpb25hbCBxdWVyeSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gcXVlcnkgLSBUaGUge0BsaW5rIFF1ZXJ5fSBpbnN0YW5jZSB0byB1c2UgYXMgYSBiYXNlIGZvciB0aGUgbmV3IGNvbnN0cmFpbnRzLlxuICogQHBhcmFtIHF1ZXJ5Q29uc3RyYWludHMgLSBUaGUgbGlzdCBvZiB7QGxpbmsgUXVlcnlDb25zdHJhaW50fXMgdG8gYXBwbHkuXG4gKiBAdGhyb3dzIGlmIGFueSBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgY29uc3RyYWludHMgY2Fubm90IGJlIGNvbWJpbmVkIHdpdGggdGhlXG4gKiBleGlzdGluZyBvciBuZXcgY29uc3RyYWludHMuXG4gKi8gZnVuY3Rpb24gTWgodCwgLi4uZSkge1xuICAgIGZvciAoY29uc3QgbiBvZiBlKSB0ID0gbi5fYXBwbHkodCk7XG4gICAgcmV0dXJuIHQ7XG59XG5cbmNsYXNzIEZoIGV4dGVuZHMgT2gge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5tYSA9IHQsIHRoaXMuZ2EgPSBlLCB0aGlzLnlhID0gbiwgdGhpcy50eXBlID0gXCJ3aGVyZVwiO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gbGgodC5maXJlc3RvcmUpLCBuID0gZnVuY3Rpb24odCwgZSwgbiwgcywgaSwgciwgbykge1xuICAgICAgICAgICAgbGV0IHU7XG4gICAgICAgICAgICBpZiAoaS5pc0tleUZpZWxkKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovID09PSByIHx8IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSByKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIFF1ZXJ5LiBZb3UgY2FuJ3QgcGVyZm9ybSAnJHtyfScgcXVlcmllcyBvbiBkb2N1bWVudElkKCkuYCk7XG4gICAgICAgICAgICAgICAgaWYgKFwiaW5cIiAvKiBJTiAqLyA9PT0gciB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gcikge1xuICAgICAgICAgICAgICAgICAgICBYaChvLCByKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbykgZS5wdXNoKFloKHMsIHQsIG4pKTtcbiAgICAgICAgICAgICAgICAgICAgdSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgdSA9IFloKHMsIHQsIG8pO1xuICAgICAgICAgICAgfSBlbHNlIFwiaW5cIiAvKiBJTiAqLyAhPT0gciAmJiBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAhPT0gciAmJiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAhPT0gciB8fCBYaChvLCByKSwgXG4gICAgICAgICAgICB1ID0gVGgobiwgZSwgbywgXG4gICAgICAgICAgICAvKiBhbGxvd0FycmF5cz0gKi8gXCJpblwiIC8qIElOICovID09PSByIHx8IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSByKTtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBCZS5jcmVhdGUoaSwgciwgdSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLmR0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHJuKHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gbiAmJiAhbi5pc0VxdWFsKGUuZmllbGQpKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBBbGwgd2hlcmUgZmlsdGVycyB3aXRoIGFuIGluZXF1YWxpdHkgKDwsIDw9LCAhPSwgbm90LWluLCA+LCBvciA+PSkgbXVzdCBiZSBvbiB0aGUgc2FtZSBmaWVsZC4gQnV0IHlvdSBoYXZlIGluZXF1YWxpdHkgZmlsdGVycyBvbiAnJHtuLnRvU3RyaW5nKCl9JyBhbmQgJyR7ZS5maWVsZC50b1N0cmluZygpfSdgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHNuKHQpO1xuICAgICAgICAgICAgICAgICAgICBudWxsICE9PSBzICYmIFpoKHQsIGUuZmllbGQsIHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoZS5pbmRleE9mKG4ub3ApID49IDApIHJldHVybiBuLm9wO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9KHQsIFxuICAgICAgICAgICAgICAgIC8qKlxuICogR2l2ZW4gYW4gb3BlcmF0b3IsIHJldHVybnMgdGhlIHNldCBvZiBvcGVyYXRvcnMgdGhhdCBjYW5ub3QgYmUgdXNlZCB3aXRoIGl0LlxuICpcbiAqIE9wZXJhdG9ycyBpbiBhIHF1ZXJ5IG11c3QgYWRoZXJlIHRvIHRoZSBmb2xsb3dpbmcgc2V0IG9mIHJ1bGVzOlxuICogMS4gT25seSBvbmUgYXJyYXkgb3BlcmF0b3IgaXMgYWxsb3dlZC5cbiAqIDIuIE9ubHkgb25lIGRpc2p1bmN0aXZlIG9wZXJhdG9yIGlzIGFsbG93ZWQuXG4gKiAzLiBgTk9UX0VRVUFMYCBjYW5ub3QgYmUgdXNlZCB3aXRoIGFub3RoZXIgYE5PVF9FUVVBTGAgb3BlcmF0b3IuXG4gKiA0LiBgTk9UX0lOYCBjYW5ub3QgYmUgdXNlZCB3aXRoIGFycmF5LCBkaXNqdW5jdGl2ZSwgb3IgYE5PVF9FUVVBTGAgb3BlcmF0b3JzLlxuICpcbiAqIEFycmF5IG9wZXJhdG9yczogYEFSUkFZX0NPTlRBSU5TYCwgYEFSUkFZX0NPTlRBSU5TX0FOWWBcbiAqIERpc2p1bmN0aXZlIG9wZXJhdG9yczogYElOYCwgYEFSUkFZX0NPTlRBSU5TX0FOWWAsIGBOT1RfSU5gXG4gKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcIiE9XCIgLyogTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpblwiIC8qIElOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJpblwiIC8qIElOICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovICwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcImluXCIgLyogSU4gKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gLCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAsIFwiaW5cIiAvKiBJTiAqLyAsIFwibm90LWluXCIgLyogTk9UX0lOICovICwgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0oZS5vcCkpO1xuICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBuKSBcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2Ugd2hlbiBpdCdzIGEgZHVwbGljYXRlIG9wIHRvIGdpdmUgYSBzbGlnaHRseSBjbGVhcmVyIGVycm9yIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgdGhyb3cgbiA9PT0gZS5vcCA/IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFlvdSBjYW5ub3QgdXNlIG1vcmUgdGhhbiBvbmUgJyR7ZS5vcC50b1N0cmluZygpfScgZmlsdGVyLmApIDogbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgJyR7ZS5vcC50b1N0cmluZygpfScgZmlsdGVycyB3aXRoICcke24udG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG4gICAgICAgICAgICB9KHQsIGMpLCBjO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBcIndoZXJlXCIsIGUsIHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCB0aGlzLm1hLCB0aGlzLmdhLCB0aGlzLnlhKTtcbiAgICAgICAgcmV0dXJuIG5ldyBaYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmZpbHRlcnMuY29uY2F0KFsgZSBdKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWmUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgbiwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG4gICAgICAgIH0odC5fcXVlcnksIG4pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHtAbGluayBRdWVyeUNvbnN0cmFpbnR9IHRoYXQgZW5mb3JjZXMgdGhhdCBkb2N1bWVudHMgbXVzdCBjb250YWluIHRoZVxuICogc3BlY2lmaWVkIGZpZWxkIGFuZCB0aGF0IHRoZSB2YWx1ZSBzaG91bGQgc2F0aXNmeSB0aGUgcmVsYXRpb24gY29uc3RyYWludFxuICogcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIHRvIGNvbXBhcmVcbiAqIEBwYXJhbSBvcFN0ciAtIFRoZSBvcGVyYXRpb24gc3RyaW5nIChlLmcgXCImbHQ7XCIsIFwiJmx0Oz1cIiwgXCI9PVwiLCBcIiZsdDtcIixcbiAqICAgXCImbHQ7PVwiLCBcIiE9XCIpLlxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIGZvciBjb21wYXJpc29uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uICRoKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gZSwgaSA9IE5oKFwid2hlcmVcIiwgdCk7XG4gICAgcmV0dXJuIG5ldyBGaChpLCBzLCBuKTtcbn1cblxuY2xhc3MgQmggZXh0ZW5kcyBPaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLm1hID0gdCwgdGhpcy5wYSA9IGUsIHRoaXMudHlwZSA9IFwib3JkZXJCeVwiO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQuc3RhcnRBdCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFlvdSBtdXN0IG5vdCBjYWxsIHN0YXJ0QXQoKSBvciBzdGFydEFmdGVyKCkgYmVmb3JlIGNhbGxpbmcgb3JkZXJCeSgpLlwiKTtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSB0LmVuZEF0KSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgZW5kQXQoKSBvciBlbmRCZWZvcmUoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBIZShlLCBuKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IHNuKHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IG9yZGVyIGJ5LiBJdCBtdXN0IG1hdGNoIGFueSBpbmVxdWFsaXR5LlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gcm4odCk7XG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT09IG4gJiYgWmgodCwgbiwgZS5maWVsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSh0LCBzKSwgcztcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIENyZWF0ZSBhIGBCb3VuZGAgZnJvbSBhIHF1ZXJ5IGFuZCBhIGRvY3VtZW50LlxuICpcbiAqIE5vdGUgdGhhdCB0aGUgYEJvdW5kYCB3aWxsIGFsd2F5cyBpbmNsdWRlIHRoZSBrZXkgb2YgdGhlIGRvY3VtZW50XG4gKiBhbmQgc28gb25seSB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgd2lsbCBjb21wYXJlIGVxdWFsIHRvIHRoZSByZXR1cm5lZFxuICogcG9zaXRpb24uXG4gKlxuICogV2lsbCB0aHJvdyBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgY29udGFpbiBhbGwgZmllbGRzIG9mIHRoZSBvcmRlciBieVxuICogb2YgdGhlIHF1ZXJ5IG9yIGlmIGFueSBvZiB0aGUgZmllbGRzIGluIHRoZSBvcmRlciBieSBhcmUgYW4gdW5jb21taXR0ZWRcbiAqIHNlcnZlciB0aW1lc3RhbXAuXG4gKi8gKHQuX3F1ZXJ5LCB0aGlzLm1hLCB0aGlzLnBhKTtcbiAgICAgICAgcmV0dXJuIG5ldyBaYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGUgdGhhdCBvcmRlckJ5IGRvZXMgbm90IGxpc3QgdGhlIHNhbWUga2V5IHR3aWNlLlxuICAgICAgICAgICAgY29uc3QgbiA9IHQuZXhwbGljaXRPcmRlckJ5LmNvbmNhdChbIGUgXSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFplKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIG4sIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBzb3J0cyB0aGUgcXVlcnkgcmVzdWx0IGJ5IHRoZVxuICogc3BlY2lmaWVkIGZpZWxkLCBvcHRpb25hbGx5IGluIGRlc2NlbmRpbmcgb3JkZXIgaW5zdGVhZCBvZiBhc2NlbmRpbmcuXG4gKlxuICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBmaWVsZCB0byBzb3J0IGJ5LlxuICogQHBhcmFtIGRpcmVjdGlvblN0ciAtIE9wdGlvbmFsIGRpcmVjdGlvbiB0byBzb3J0IGJ5ICgnYXNjJyBvciAnZGVzYycpLiBJZlxuICogbm90IHNwZWNpZmllZCwgb3JkZXIgd2lsbCBiZSBhc2NlbmRpbmcuXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIExoKHQsIGUgPSBcImFzY1wiKSB7XG4gICAgY29uc3QgbiA9IGUsIHMgPSBOaChcIm9yZGVyQnlcIiwgdCk7XG4gICAgcmV0dXJuIG5ldyBCaChzLCBuKTtcbn1cblxuY2xhc3MgVWggZXh0ZW5kcyBPaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLklhID0gZSwgdGhpcy5UYSA9IG47XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWmModC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBhbih0Ll9xdWVyeSwgdGhpcy5JYSwgdGhpcy5UYSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGZpcnN0IG1hdGNoaW5nIGRvY3VtZW50cy5cbiAqXG4gKiBAcGFyYW0gbGltaXQgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5fS5cbiAqLyBmdW5jdGlvbiBxaCh0KSB7XG4gICAgcmV0dXJuIFdjKFwibGltaXRcIiwgdCksIG5ldyBVaChcImxpbWl0XCIsIHQsIFwiRlwiIC8qIEZpcnN0ICovKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGxhc3QgbWF0Y2hpbmcgZG9jdW1lbnRzLlxuICpcbiAqIFlvdSBtdXN0IHNwZWNpZnkgYXQgbGVhc3Qgb25lIGBvcmRlckJ5YCBjbGF1c2UgZm9yIGBsaW1pdFRvTGFzdGAgcXVlcmllcyxcbiAqIG90aGVyd2lzZSBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24gZHVyaW5nIGV4ZWN1dGlvbi5cbiAqXG4gKiBAcGFyYW0gbGltaXQgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5fS5cbiAqLyBmdW5jdGlvbiBLaCh0KSB7XG4gICAgcmV0dXJuIFdjKFwibGltaXRUb0xhc3RcIiwgdCksIG5ldyBVaChcImxpbWl0VG9MYXN0XCIsIHQsIFwiTFwiIC8qIExhc3QgKi8pO1xufVxuXG5jbGFzcyBHaCBleHRlbmRzIE9oIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMudHlwZSA9IHQsIHRoaXMuRWEgPSBlLCB0aGlzLkFhID0gbjtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEpoKHQsIHRoaXMudHlwZSwgdGhpcy5FYSwgdGhpcy5BYSk7XG4gICAgICAgIHJldHVybiBuZXcgWmModC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFplKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgZSwgdC5lbmRBdCk7XG4gICAgICAgIH0odC5fcXVlcnksIGUpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFFoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IEdoKFwic3RhcnRBdFwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMCk7XG59XG5cbmZ1bmN0aW9uIGpoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IEdoKFwic3RhcnRBZnRlclwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbmNsYXNzIFdoIGV4dGVuZHMgT2gge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gdCwgdGhpcy5FYSA9IGUsIHRoaXMuQWEgPSBuO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gSmgodCwgdGhpcy50eXBlLCB0aGlzLkVhLCB0aGlzLkFhKTtcbiAgICAgICAgcmV0dXJuIG5ldyBaYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWmUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIGUpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBlKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB6aCguLi50KSB7XG4gICAgcmV0dXJuIG5ldyBXaChcImVuZEJlZm9yZVwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbmZ1bmN0aW9uIEhoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IFdoKFwiZW5kQXRcIiwgdCwgLyppbmNsdXNpdmU9Ki8gITApO1xufVxuXG4vKiogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGJvdW5kIGZyb20gYSBkb2N1bWVudCBvciBmaWVsZHMgKi8gZnVuY3Rpb24gSmgodCwgZSwgbiwgcykge1xuICAgIGlmIChuWzBdID0gZ2V0TW9kdWxhckluc3RhbmNlKG5bMF0pLCBuWzBdIGluc3RhbmNlb2YgQ2gpIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGlmICghcykgdGhyb3cgbmV3IEwoQi5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHVuKHQpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHIucHVzaCh3ZShlLCBzLmtleSkpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLmRhdGEuZmllbGQobi5maWVsZCk7XG4gICAgICAgICAgICBpZiAoWHQodCkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIGRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJyR7dH0nICh1c2VkIGFzIHRoZSBvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHplKHIsIGkpO1xuICAgIH1cbiAgICAvKipcbiAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBgQm91bmRgIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZSwgblswXS5fZG9jdW1lbnQsIHMpO1xuICAgIHtcbiAgICAgICAgY29uc3QgaSA9IGxoKHQuZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gdC5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvICR7c30oKS4gVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvcmRlckJ5KCkgY2xhdXNlc2ApO1xuICAgICAgICAgICAgY29uc3QgdSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBpLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGlbcl07XG4gICAgICAgICAgICAgICAgaWYgKG9bcl0uZmllbGQuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBjKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gJHtzfSgpLCBidXQgZ290IGEgJHt0eXBlb2YgY31gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvbih0KSAmJiAtMSAhPT0gYy5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCBiZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7Y30nIGNvbnRhaW5zIGEgc2xhc2guYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnBhdGguY2hpbGQocnQuZnJvbVN0cmluZyhjKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY3QuaXNEb2N1bWVudEtleShuKSkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7bn0nIGlzIG5vdCBiZWNhdXNlIGl0IGNvbnRhaW5zIGFuIG9kZCBudW1iZXIgb2Ygc2VnbWVudHMuYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgY3Qobik7XG4gICAgICAgICAgICAgICAgICAgIHUucHVzaCh3ZShlLCBpKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IFRoKG4sIHMsIGMpO1xuICAgICAgICAgICAgICAgICAgICB1LnB1c2godCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyB6ZSh1LCByKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGRvY3VtZW50SWRWYWx1ZWAgaW50byBhIGBSZWZlcmVuY2VWYWx1ZWAsIHRocm93aW5nXG4gKiBhcHByb3ByaWF0ZSBlcnJvcnMgaWYgdGhlIHZhbHVlIGlzIGFueXRoaW5nIG90aGVyIHRoYW4gYSBgRG9jdW1lbnRSZWZlcmVuY2VgXG4gKiBvciBgc3RyaW5nYCwgb3IgaWYgdGhlIHN0cmluZyBpcyBtYWxmb3JtZWQuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgaSwgZSwgbiwgcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBZaCh0LCBlLCBuKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIChuID0gZ2V0TW9kdWxhckluc3RhbmNlKG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgd2l0aCBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSB2YWxpZCBkb2N1bWVudCBJRCwgYnV0IGl0IHdhcyBhbiBlbXB0eSBzdHJpbmcuXCIpO1xuICAgICAgICBpZiAoIW9uKGUpICYmIC0xICE9PSBuLmluZGV4T2YoXCIvXCIpKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBieSBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSBwbGFpbiBkb2N1bWVudCBJRCwgYnV0ICcke259JyBjb250YWlucyBhICcvJyBjaGFyYWN0ZXIuYCk7XG4gICAgICAgIGNvbnN0IHMgPSBlLnBhdGguY2hpbGQocnQuZnJvbVN0cmluZyhuKSk7XG4gICAgICAgIGlmICghY3QuaXNEb2N1bWVudEtleShzKSkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYnkgZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcHJvdmlkZWQgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7c30nIGlzIG5vdCBiZWNhdXNlIGl0IGhhcyBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzICgke3MubGVuZ3RofSkuYCk7XG4gICAgICAgIHJldHVybiB3ZSh0LCBuZXcgY3QocykpO1xuICAgIH1cbiAgICBpZiAobiBpbnN0YW5jZW9mIFhjKSByZXR1cm4gd2UodCwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgc3RyaW5nIG9yIGEgRG9jdW1lbnRSZWZlcmVuY2UsIGJ1dCBpdCB3YXM6ICR7UWMobil9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSB2YWx1ZSBwYXNzZWQgaW50byBhIGRpc2p1bmN0aXZlIGZpbHRlciBzYXRpc2ZpZXMgYWxsXG4gKiBhcnJheSByZXF1aXJlbWVudHMuXG4gKi8gZnVuY3Rpb24gWGgodCwgZSkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheSh0KSB8fCAwID09PSB0Lmxlbmd0aCkgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gQSBub24tZW1wdHkgYXJyYXkgaXMgcmVxdWlyZWQgZm9yICcke2UudG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG4gICAgaWYgKHQubGVuZ3RoID4gMTApIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuICcke2UudG9TdHJpbmcoKX0nIGZpbHRlcnMgc3VwcG9ydCBhIG1heGltdW0gb2YgMTAgZWxlbWVudHMgaW4gdGhlIHZhbHVlIGFycmF5LmApO1xufVxuXG5mdW5jdGlvbiBaaCh0LCBlLCBuKSB7XG4gICAgaWYgKCFuLmlzRXF1YWwoZSkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFlvdSBoYXZlIGEgd2hlcmUgZmlsdGVyIHdpdGggYW4gaW5lcXVhbGl0eSAoPCwgPD0sICE9LCBub3QtaW4sID4sIG9yID49KSBvbiBmaWVsZCAnJHtlLnRvU3RyaW5nKCl9JyBhbmQgc28geW91IG11c3QgYWxzbyB1c2UgJyR7ZS50b1N0cmluZygpfScgYXMgeW91ciBmaXJzdCBhcmd1bWVudCB0byBvcmRlckJ5KCksIGJ1dCB5b3VyIGZpcnN0IG9yZGVyQnkoKSBpcyBvbiBmaWVsZCAnJHtuLnRvU3RyaW5nKCl9JyBpbnN0ZWFkLmApO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDb252ZXJ0cyBGaXJlc3RvcmUncyBpbnRlcm5hbCB0eXBlcyB0byB0aGUgSmF2YVNjcmlwdCB0eXBlcyB0aGF0IHdlIGV4cG9zZVxuICogdG8gdGhlIHVzZXIuXG4gKlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgdGwge1xuICAgIGNvbnZlcnRWYWx1ZSh0LCBlID0gXCJub25lXCIpIHtcbiAgICAgICAgc3dpdGNoIChjZSh0KSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBOdWxsVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBjYXNlIDEgLyogQm9vbGVhblZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0LmJvb2xlYW5WYWx1ZTtcblxuICAgICAgICAgIGNhc2UgMiAvKiBOdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gSnQodC5pbnRlZ2VyVmFsdWUgfHwgdC5kb3VibGVWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFRpbWVzdGFtcCh0LnRpbWVzdGFtcFZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgNCAvKiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0U2VydmVyVGltZXN0YW1wKHQsIGUpO1xuXG4gICAgICAgICAgY2FzZSA1IC8qIFN0cmluZ1ZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0LnN0cmluZ1ZhbHVlO1xuXG4gICAgICAgICAgY2FzZSA2IC8qIEJsb2JWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0Qnl0ZXMoWXQodC5ieXRlc1ZhbHVlKSk7XG5cbiAgICAgICAgICBjYXNlIDcgLyogUmVmVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFJlZmVyZW5jZSh0LnJlZmVyZW5jZVZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgOCAvKiBHZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRHZW9Qb2ludCh0Lmdlb1BvaW50VmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA5IC8qIEFycmF5VmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEFycmF5KHQuYXJyYXlWYWx1ZSwgZSk7XG5cbiAgICAgICAgICBjYXNlIDEwIC8qIE9iamVjdFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRPYmplY3QodC5tYXBWYWx1ZSwgZSk7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgTygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnZlcnRPYmplY3QodCwgZSkge1xuICAgICAgICBjb25zdCBuID0ge307XG4gICAgICAgIHJldHVybiBGdCh0LmZpZWxkcywgKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBuW3RdID0gdGhpcy5jb252ZXJ0VmFsdWUocywgZSk7XG4gICAgICAgIH0pKSwgbjtcbiAgICB9XG4gICAgY29udmVydEdlb1BvaW50KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBpaChKdCh0LmxhdGl0dWRlKSwgSnQodC5sb25naXR1ZGUpKTtcbiAgICB9XG4gICAgY29udmVydEFycmF5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICh0LnZhbHVlcyB8fCBbXSkubWFwKCh0ID0+IHRoaXMuY29udmVydFZhbHVlKHQsIGUpKSk7XG4gICAgfVxuICAgIGNvbnZlcnRTZXJ2ZXJUaW1lc3RhbXAodCwgZSkge1xuICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICBjYXNlIFwicHJldmlvdXNcIjpcbiAgICAgICAgICAgIGNvbnN0IG4gPSBadCh0KTtcbiAgICAgICAgICAgIHJldHVybiBudWxsID09IG4gPyBudWxsIDogdGhpcy5jb252ZXJ0VmFsdWUobiwgZSk7XG5cbiAgICAgICAgICBjYXNlIFwiZXN0aW1hdGVcIjpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAodGUodCkpO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnZlcnRUaW1lc3RhbXAodCkge1xuICAgICAgICBjb25zdCBlID0gSHQodCk7XG4gICAgICAgIHJldHVybiBuZXcgbnQoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbiAgICB9XG4gICAgY29udmVydERvY3VtZW50S2V5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHJ0LmZyb21TdHJpbmcodCk7XG4gICAgICAgIE0oaWkobikpO1xuICAgICAgICBjb25zdCBzID0gbmV3IG5lKG4uZ2V0KDEpLCBuLmdldCgzKSksIGkgPSBuZXcgY3Qobi5wb3BGaXJzdCg1KSk7XG4gICAgICAgIHJldHVybiBzLmlzRXF1YWwoZSkgfHwgXG4gICAgICAgIC8vIFRPRE8oYi82NDEzMDIwMik6IFNvbWVob3cgc3VwcG9ydCBmb3JlaWduIHJlZmVyZW5jZXMuXG4gICAgICAgIHgoYERvY3VtZW50ICR7aX0gY29udGFpbnMgYSBkb2N1bWVudCByZWZlcmVuY2Ugd2l0aGluIGEgZGlmZmVyZW50IGRhdGFiYXNlICgke3MucHJvamVjdElkfS8ke3MuZGF0YWJhc2V9KSB3aGljaCBpcyBub3Qgc3VwcG9ydGVkLiBJdCB3aWxsIGJlIHRyZWF0ZWQgYXMgYSByZWZlcmVuY2UgaW4gdGhlIGN1cnJlbnQgZGF0YWJhc2UgKCR7ZS5wcm9qZWN0SWR9LyR7ZS5kYXRhYmFzZX0pIGluc3RlYWQuYCksIFxuICAgICAgICBpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgY3VzdG9tIG1vZGVsIG9iamVjdCBvZiB0eXBlIFQgaW50byBgRG9jdW1lbnREYXRhYCBieSBhcHBseWluZyB0aGVcbiAqIGNvbnZlcnRlciBpZiBpdCBleGlzdHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHdoZW4gY29udmVydGluZyB1c2VyIG9iamVjdHMgdG8gYERvY3VtZW50RGF0YWBcbiAqIGJlY2F1c2Ugd2Ugd2FudCB0byBwcm92aWRlIHRoZSB1c2VyIHdpdGggYSBtb3JlIHNwZWNpZmljIGVycm9yIG1lc3NhZ2UgaWZcbiAqIHRoZWlyIGBzZXQoKWAgb3IgZmFpbHMgZHVlIHRvIGludmFsaWQgZGF0YSBvcmlnaW5hdGluZyBmcm9tIGEgYHRvRmlyZXN0b3JlKClgXG4gKiBjYWxsLlxuICovIGZ1bmN0aW9uIGVsKHQsIGUsIG4pIHtcbiAgICBsZXQgcztcbiAgICAvLyBDYXN0IHRvIGBhbnlgIGluIG9yZGVyIHRvIHNhdGlzZnkgdGhlIHVuaW9uIHR5cGUgY29uc3RyYWludCBvblxuICAgIC8vIHRvRmlyZXN0b3JlKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICByZXR1cm4gcyA9IHQgPyBuICYmIChuLm1lcmdlIHx8IG4ubWVyZ2VGaWVsZHMpID8gdC50b0ZpcmVzdG9yZShlLCBuKSA6IHQudG9GaXJlc3RvcmUoZSkgOiBlLCBcbiAgICBzO1xufVxuXG5jbGFzcyBubCBleHRlbmRzIHRsIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB0aCh0KTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleSh0LCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgWGModGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBNZXRhZGF0YSBhYm91dCBhIHNuYXBzaG90LCBkZXNjcmliaW5nIHRoZSBzdGF0ZSBvZiB0aGUgc25hcHNob3QuXG4gKi8gY2xhc3Mgc2wge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPSB0LCB0aGlzLmZyb21DYWNoZSA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBTbmFwc2hvdE1ldGFkYXRhYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzUGVuZGluZ1dyaXRlcyA9PT0gdC5oYXNQZW5kaW5nV3JpdGVzICYmIHRoaXMuZnJvbUNhY2hlID09PSB0LmZyb21DYWNoZTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyIEZpcmVzdG9yZVxuICogZGF0YWJhc2UuIFRoZSBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvXG4gKiBnZXQgYSBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBGb3IgYSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwb2ludHMgdG8gYSBub24tZXhpc3RpbmcgZG9jdW1lbnQsIGFueSBkYXRhXG4gKiBhY2Nlc3Mgd2lsbCByZXR1cm4gJ3VuZGVmaW5lZCcuIFlvdSBjYW4gdXNlIHRoZSBgZXhpc3RzKClgIG1ldGhvZCB0b1xuICogZXhwbGljaXRseSB2ZXJpZnkgYSBkb2N1bWVudCdzIGV4aXN0ZW5jZS5cbiAqLyBjbGFzcyBpbCBleHRlbmRzIENoIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4sIHMsIHIpLCB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl9maXJlc3RvcmVJbXBsID0gdCwgdGhpcy5tZXRhZGF0YSA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGRhdGEgZXhpc3RzLiBUcnVlIGlmIHRoZSBkb2N1bWVudCBleGlzdHMuXG4gICAgICovICAgIGV4aXN0cygpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmV4aXN0cygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgcmwodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgdGhpcy5tZXRhZGF0YSwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUoZSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUsIHQuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGEgYHNlcnZlclRpbWVzdGFtcCgpYCB0aGF0IGhhcyBub3QgeWV0IGJlZW4gc2V0IHRvXG4gICAgICogaXRzIGZpbmFsIHZhbHVlIHdpbGwgYmUgcmV0dXJuZWQgYXMgYG51bGxgLiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgYnlcbiAgICAgKiBwYXNzaW5nIGFuIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIChmb3IgZXhhbXBsZSAnZm9vJyBvciAnZm9vLmJhcicpIHRvIGEgc3BlY2lmaWNcbiAgICAgKiBmaWVsZC5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgdGhlIGZpZWxkIGlzIHJldHJpZXZlZFxuICAgICAqIGZyb20gdGhlIHNuYXBzaG90IChmb3IgZXhhbXBsZSB0aGUgZGVzaXJlZCBiZWhhdmlvciBmb3Igc2VydmVyIHRpbWVzdGFtcHNcbiAgICAgKiB0aGF0IGhhdmUgbm90IHlldCBiZWVuIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSkuXG4gICAgICogQHJldHVybnMgVGhlIGRhdGEgYXQgdGhlIHNwZWNpZmllZCBmaWVsZCBsb2NhdGlvbiBvciB1bmRlZmluZWQgaWYgbm8gc3VjaFxuICAgICAqIGZpZWxkIGV4aXN0cyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgLy8gV2UgYXJlIHVzaW5nIGBhbnlgIGhlcmUgdG8gYXZvaWQgYW4gZXhwbGljaXQgY2FzdCBieSBvdXIgdXNlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBnZXQodCwgZSA9IHt9KSB7XG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2RvY3VtZW50LmRhdGEuZmllbGQoTmgoXCJEb2N1bWVudFNuYXBzaG90LmdldFwiLCB0KSk7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gbikgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZShuLCBlLnNlcnZlclRpbWVzdGFtcHMpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UgYXMgcGFydCBvZiBhIHF1ZXJ5LiBUaGUgZG9jdW1lbnQgaXMgZ3VhcmFudGVlZCB0byBleGlzdFxuICogYW5kIGl0cyBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvIGdldCBhXG4gKiBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIG9mZmVycyB0aGUgc2FtZSBBUEkgc3VyZmFjZSBhcyBhXG4gKiBgRG9jdW1lbnRTbmFwc2hvdGAuIFNpbmNlIHF1ZXJ5IHJlc3VsdHMgY29udGFpbiBvbmx5IGV4aXN0aW5nIGRvY3VtZW50cywgdGhlXG4gKiBgZXhpc3RzYCBwcm9wZXJ0eSB3aWxsIGFsd2F5cyBiZSB0cnVlIGFuZCBgZGF0YSgpYCB3aWxsIG5ldmVyIHJldHVyblxuICogJ3VuZGVmaW5lZCcuXG4gKi8gY2xhc3MgcmwgZXh0ZW5kcyBpbCB7XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLlxuICAgICAqXG4gICAgICogQnkgZGVmYXVsdCwgYHNlcnZlclRpbWVzdGFtcCgpYCB2YWx1ZXMgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlblxuICAgICAqIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSB3aWxsIGJlIHJldHVybmVkIGFzIGBudWxsYC4gWW91IGNhbiBvdmVycmlkZVxuICAgICAqIHRoaXMgYnkgcGFzc2luZyBhbiBvcHRpb25zIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb3B0aW9ucyBvYmplY3QgdG8gY29uZmlndXJlIGhvdyBkYXRhIGlzIHJldHJpZXZlZCBmcm9tXG4gICAgICogdGhlIHNuYXBzaG90IChmb3IgZXhhbXBsZSB0aGUgZGVzaXJlZCBiZWhhdmlvciBmb3Igc2VydmVyIHRpbWVzdGFtcHMgdGhhdFxuICAgICAqIGhhdmUgbm90IHlldCBiZWVuIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSkuXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBkYXRhKHQgPSB7fSkge1xuICAgICAgICByZXR1cm4gc3VwZXIuZGF0YSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlTbmFwc2hvdGAgY29udGFpbnMgemVybyBvciBtb3JlIGBEb2N1bWVudFNuYXBzaG90YCBvYmplY3RzXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdHMgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50cyBjYW4gYmUgYWNjZXNzZWQgYXMgYW5cbiAqIGFycmF5IHZpYSB0aGUgYGRvY3NgIHByb3BlcnR5IG9yIGVudW1lcmF0ZWQgdXNpbmcgdGhlIGBmb3JFYWNoYCBtZXRob2QuIFRoZVxuICogbnVtYmVyIG9mIGRvY3VtZW50cyBjYW4gYmUgZGV0ZXJtaW5lZCB2aWEgdGhlIGBlbXB0eWAgYW5kIGBzaXplYFxuICogcHJvcGVydGllcy5cbiAqLyBjbGFzcyBvbCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX3VzZXJEYXRhV3JpdGVyID0gZSwgdGhpcy5fc25hcHNob3QgPSBzLCB0aGlzLm1ldGFkYXRhID0gbmV3IHNsKHMuaGFzUGVuZGluZ1dyaXRlcywgcy5mcm9tQ2FjaGUpLCBcbiAgICAgICAgdGhpcy5xdWVyeSA9IG47XG4gICAgfVxuICAgIC8qKiBBbiBhcnJheSBvZiBhbGwgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLiAqLyAgICBnZXQgZG9jcygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHQucHVzaChlKSkpLCB0O1xuICAgIH1cbiAgICAvKiogVGhlIG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zbmFwc2hvdC5kb2NzLnNpemU7XG4gICAgfVxuICAgIC8qKiBUcnVlIGlmIHRoZXJlIGFyZSBubyBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gMCA9PT0gdGhpcy5zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbnVtZXJhdGVzIGFsbCBvZiB0aGUgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBBIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aXRoIGEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgZm9yXG4gICAgICogZWFjaCBkb2N1bWVudCBpbiB0aGUgc25hcHNob3QuXG4gICAgICogQHBhcmFtIHRoaXNBcmcgLSBUaGUgYHRoaXNgIGJpbmRpbmcgZm9yIHRoZSBjYWxsYmFjay5cbiAgICAgKi8gICAgZm9yRWFjaCh0LCBlKSB7XG4gICAgICAgIHRoaXMuX3NuYXBzaG90LmRvY3MuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICB0LmNhbGwoZSwgbmV3IHJsKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIsIG4ua2V5LCBuLCBuZXcgc2wodGhpcy5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKG4ua2V5KSwgdGhpcy5fc25hcHNob3QuZnJvbUNhY2hlKSwgdGhpcy5xdWVyeS5jb252ZXJ0ZXIpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIHRoZSBkb2N1bWVudHMgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCBzbmFwc2hvdC4gSWYgdGhpc1xuICAgICAqIGlzIHRoZSBmaXJzdCBzbmFwc2hvdCwgYWxsIGRvY3VtZW50cyB3aWxsIGJlIGluIHRoZSBsaXN0IGFzICdhZGRlZCdcbiAgICAgKiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBgU25hcHNob3RMaXN0ZW5PcHRpb25zYCB0aGF0IGNvbnRyb2wgd2hldGhlciBtZXRhZGF0YS1vbmx5XG4gICAgICogY2hhbmdlcyAoaS5lLiBvbmx5IGBEb2N1bWVudFNuYXBzaG90Lm1ldGFkYXRhYCBjaGFuZ2VkKSBzaG91bGQgdHJpZ2dlclxuICAgICAqIHNuYXBzaG90IGV2ZW50cy5cbiAgICAgKi8gICAgZG9jQ2hhbmdlcyh0ID0ge30pIHtcbiAgICAgICAgY29uc3QgZSA9ICEhdC5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzO1xuICAgICAgICBpZiAoZSAmJiB0aGlzLl9zbmFwc2hvdC5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcykgdGhyb3cgbmV3IEwoQi5JTlZBTElEX0FSR1VNRU5ULCBcIlRvIGluY2x1ZGUgbWV0YWRhdGEgY2hhbmdlcyB3aXRoIHlvdXIgZG9jdW1lbnQgY2hhbmdlcywgeW91IG11c3QgYWxzbyBwYXNzIHsgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczp0cnVlIH0gdG8gb25TbmFwc2hvdCgpLlwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZENoYW5nZXMgJiYgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPT09IGUgfHwgKHRoaXMuX2NhY2hlZENoYW5nZXMgPSBcbiAgICAgICAgLyoqIENhbGN1bGF0ZXMgdGhlIGFycmF5IG9mIGBEb2N1bWVudENoYW5nZWBzIGZvciBhIGdpdmVuIGBWaWV3U25hcHNob3RgLiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAodC5fc25hcHNob3Qub2xkRG9jcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuX3NuYXBzaG90LmRvY0NoYW5nZXMubWFwKChuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBybCh0Ll9maXJlc3RvcmUsIHQuX3VzZXJEYXRhV3JpdGVyLCBuLmRvYy5rZXksIG4uZG9jLCBuZXcgc2wodC5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKG4uZG9jLmtleSksIHQuX3NuYXBzaG90LmZyb21DYWNoZSksIHQucXVlcnkuY29udmVydGVyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uZG9jLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFkZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2M6IHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRJbmRleDogLTEsXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleDogZSsrXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIEEgYERvY3VtZW50U2V0YCB0aGF0IGlzIHVwZGF0ZWQgaW5jcmVtZW50YWxseSBhcyBjaGFuZ2VzIGFyZSBhcHBsaWVkIHRvIHVzZVxuICAgICAgICAgICAgICAgIC8vIHRvIGxvb2t1cCB0aGUgaW5kZXggb2YgYSBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IHQuX3NuYXBzaG90Lm9sZERvY3M7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuX3NuYXBzaG90LmRvY0NoYW5nZXMuZmlsdGVyKCh0ID0+IGUgfHwgMyAvKiBNZXRhZGF0YSAqLyAhPT0gdC50eXBlKSkubWFwKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBybCh0Ll9maXJlc3RvcmUsIHQuX3VzZXJEYXRhV3JpdGVyLCBlLmRvYy5rZXksIGUuZG9jLCBuZXcgc2wodC5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGUuZG9jLmtleSksIHQuX3NuYXBzaG90LmZyb21DYWNoZSksIHQucXVlcnkuY29udmVydGVyKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAtMSwgciA9IC0xO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCAvKiBBZGRlZCAqLyAhPT0gZS50eXBlICYmIChpID0gbi5pbmRleE9mKGUuZG9jLmtleSksIG4gPSBuLmRlbGV0ZShlLmRvYy5rZXkpKSwgXG4gICAgICAgICAgICAgICAgICAgIDEgLyogUmVtb3ZlZCAqLyAhPT0gZS50eXBlICYmIChuID0gbi5hZGQoZS5kb2MpLCByID0gbi5pbmRleE9mKGUuZG9jLmtleSkpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB1bChlLnR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleDogclxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0aGlzLCBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlcztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVsKHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgIHJldHVybiBcImFkZGVkXCI7XG5cbiAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICBjYXNlIDMgLyogTWV0YWRhdGEgKi8gOlxuICAgICAgICByZXR1cm4gXCJtb2RpZmllZFwiO1xuXG4gICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgIHJldHVybiBcInJlbW92ZWRcIjtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE8oKTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JlZXhwKTogQWRkIHRlc3RzIGZvciBzbmFwc2hvdEVxdWFsIHdpdGggZGlmZmVyZW50IHNuYXBzaG90XG4vLyBtZXRhZGF0YVxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHNuYXBzaG90cyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBzbmFwc2hvdHMgYXJlIGVxdWFsLlxuICovIGZ1bmN0aW9uIGNsKHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIGlsICYmIGUgaW5zdGFuY2VvZiBpbCA/IHQuX2ZpcmVzdG9yZSA9PT0gZS5fZmlyZXN0b3JlICYmIHQuX2tleS5pc0VxdWFsKGUuX2tleSkgJiYgKG51bGwgPT09IHQuX2RvY3VtZW50ID8gbnVsbCA9PT0gZS5fZG9jdW1lbnQgOiB0Ll9kb2N1bWVudC5pc0VxdWFsKGUuX2RvY3VtZW50KSkgJiYgdC5fY29udmVydGVyID09PSBlLl9jb252ZXJ0ZXIgOiB0IGluc3RhbmNlb2Ygb2wgJiYgZSBpbnN0YW5jZW9mIG9sICYmICh0Ll9maXJlc3RvcmUgPT09IGUuX2ZpcmVzdG9yZSAmJiByYSh0LnF1ZXJ5LCBlLnF1ZXJ5KSAmJiB0Lm1ldGFkYXRhLmlzRXF1YWwoZS5tZXRhZGF0YSkgJiYgdC5fc25hcHNob3QuaXNFcXVhbChlLl9zbmFwc2hvdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIE5vdGU6IGBnZXREb2MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieSB3YWl0aW5nXG4gKiBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWYgeW91IGFyZVxuICogb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLCBpbnZva2VcbiAqIHtAbGluayBnZXREb2NGcm9tQ2FjaGV9IG9yIHtAbGluayBnZXREb2NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gVGhlIHJlZmVyZW5jZSBvZiB0aGUgZG9jdW1lbnQgdG8gZmV0Y2guXG4gKiBAcmV0dXJucyBBIFByb21pc2UgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqLyBmdW5jdGlvbiBhbCh0KSB7XG4gICAgdCA9IGpjKHQsIFhjKTtcbiAgICBjb25zdCBlID0gamModC5maXJlc3RvcmUsICRhKTtcbiAgICByZXR1cm4gVmEoVWEoZSksIHQuX2tleSkudGhlbigobiA9PiBBbChlLCB0LCBuKSkpO1xufVxuXG5jbGFzcyBobCBleHRlbmRzIHRsIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB0aCh0KTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleSh0LCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgWGModGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGlzIGBEb2N1bWVudFJlZmVyZW5jZWAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIGRvY3VtZW50IGlzIG5vdCBjdXJyZW50bHkgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbmluZyB0aGVcbiAqIGN1cnJlbnQgZG9jdW1lbnQgY29udGVudHMuXG4gKi8gZnVuY3Rpb24gbGwodCkge1xuICAgIHQgPSBqYyh0LCBYYyk7XG4gICAgY29uc3QgZSA9IGpjKHQuZmlyZXN0b3JlLCAkYSksIG4gPSBVYShlKSwgcyA9IG5ldyBobChlKTtcbiAgICByZXR1cm4gdmEobiwgdC5fa2V5KS50aGVuKChuID0+IG5ldyBpbChlLCBzLCB0Ll9rZXksIG4sIG5ldyBzbChudWxsICE9PSBuICYmIG4uaGFzTG9jYWxNdXRhdGlvbnMsIFxuICAgIC8qIGZyb21DYWNoZT0gKi8gITApLCB0LmNvbnZlcnRlcikpKTtcbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gdGhlIHNlcnZlci5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG5ldHdvcmsgaXMgbm90IGF2YWlsYWJsZS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGZsKHQpIHtcbiAgICB0ID0gamModCwgWGMpO1xuICAgIGNvbnN0IGUgPSBqYyh0LmZpcmVzdG9yZSwgJGEpO1xuICAgIHJldHVybiBWYShVYShlKSwgdC5fa2V5LCB7XG4gICAgICAgIHNvdXJjZTogXCJzZXJ2ZXJcIlxuICAgIH0pLnRoZW4oKG4gPT4gQWwoZSwgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAuXG4gKlxuICogTm90ZTogYGdldERvY3MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieVxuICogd2FpdGluZyBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWZcbiAqIHlvdSBhcmUgb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLFxuICogaW52b2tlIHtAbGluayBnZXREb2NzRnJvbUNhY2hlfSBvciB7QGxpbmsgZ2V0RG9jc0Zyb21TZXJ2ZXJ9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBkbCh0KSB7XG4gICAgdCA9IGpjKHQsIFpjKTtcbiAgICBjb25zdCBlID0gamModC5maXJlc3RvcmUsICRhKSwgbiA9IFVhKGUpLCBzID0gbmV3IGhsKGUpO1xuICAgIHJldHVybiBraCh0Ll9xdWVyeSksIERhKG4sIHQuX3F1ZXJ5KS50aGVuKChuID0+IG5ldyBvbChlLCBzLCB0LCBuKSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBxdWVyeSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyBhcyBhIGBRdWVyeVNuYXBzaG90YCBmcm9tIGNhY2hlLlxuICogUmV0dXJucyBhbiBlcnJvciBpZiB0aGUgZG9jdW1lbnQgaXMgbm90IGN1cnJlbnRseSBjYWNoZWQuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5LlxuICovIGZ1bmN0aW9uIF9sKHQpIHtcbiAgICB0ID0gamModCwgWmMpO1xuICAgIGNvbnN0IGUgPSBqYyh0LmZpcmVzdG9yZSwgJGEpLCBuID0gVWEoZSksIHMgPSBuZXcgaGwoZSk7XG4gICAgcmV0dXJuIFNhKG4sIHQuX3F1ZXJ5KS50aGVuKChuID0+IG5ldyBvbChlLCBzLCB0LCBuKSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBxdWVyeSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyBhcyBhIGBRdWVyeVNuYXBzaG90YCBmcm9tIHRoZVxuICogc2VydmVyLiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBuZXR3b3JrIGlzIG5vdCBhdmFpbGFibGUuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5LlxuICovIGZ1bmN0aW9uIHdsKHQpIHtcbiAgICB0ID0gamModCwgWmMpO1xuICAgIGNvbnN0IGUgPSBqYyh0LmZpcmVzdG9yZSwgJGEpLCBuID0gVWEoZSksIHMgPSBuZXcgaGwoZSk7XG4gICAgcmV0dXJuIERhKG4sIHQuX3F1ZXJ5LCB7XG4gICAgICAgIHNvdXJjZTogXCJzZXJ2ZXJcIlxuICAgIH0pLnRoZW4oKG4gPT4gbmV3IG9sKGUsIHMsIHQsIG4pKSk7XG59XG5cbmZ1bmN0aW9uIG1sKHQsIGUsIG4pIHtcbiAgICB0ID0gamModCwgWGMpO1xuICAgIGNvbnN0IHMgPSBqYyh0LmZpcmVzdG9yZSwgJGEpLCBpID0gZWwodC5jb252ZXJ0ZXIsIGUsIG4pO1xuICAgIHJldHVybiBFbChzLCBbIGZoKGxoKHMpLCBcInNldERvY1wiLCB0Ll9rZXksIGksIG51bGwgIT09IHQuY29udmVydGVyLCBuKS50b011dGF0aW9uKHQuX2tleSwgT24ubm9uZSgpKSBdKTtcbn1cblxuZnVuY3Rpb24gZ2wodCwgZSwgbiwgLi4ucykge1xuICAgIHQgPSBqYyh0LCBYYyk7XG4gICAgY29uc3QgaSA9IGpjKHQuZmlyZXN0b3JlLCAkYSksIHIgPSBsaChpKTtcbiAgICBsZXQgbztcbiAgICBvID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKFxuICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgIGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIHx8IGUgaW5zdGFuY2VvZiBlaCA/IEloKHIsIFwidXBkYXRlRG9jXCIsIHQuX2tleSwgZSwgbiwgcykgOiBwaChyLCBcInVwZGF0ZURvY1wiLCB0Ll9rZXksIGUpO1xuICAgIHJldHVybiBFbChpLCBbIG8udG9NdXRhdGlvbih0Ll9rZXksIE9uLmV4aXN0cyghMCkpIF0pO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoZSBzcGVjaWZpZWQgYERvY3VtZW50UmVmZXJlbmNlYC5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGRlbGV0ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSByZXNvbHZlZCBvbmNlIHRoZSBkb2N1bWVudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHlcbiAqIGRlbGV0ZWQgZnJvbSB0aGUgYmFja2VuZCAobm90ZSB0aGF0IGl0IHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIHlsKHQpIHtcbiAgICByZXR1cm4gRWwoamModC5maXJlc3RvcmUsICRhKSwgWyBuZXcgem4odC5fa2V5LCBPbi5ub25lKCkpIF0pO1xufVxuXG4vKipcbiAqIEFkZCBhIG5ldyBkb2N1bWVudCB0byBzcGVjaWZpZWQgYENvbGxlY3Rpb25SZWZlcmVuY2VgIHdpdGggdGhlIGdpdmVuIGRhdGEsXG4gKiBhc3NpZ25pbmcgaXQgYSBkb2N1bWVudCBJRCBhdXRvbWF0aWNhbGx5LlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBBIHJlZmVyZW5jZSB0byB0aGUgY29sbGVjdGlvbiB0byBhZGQgdGhpcyBkb2N1bWVudCB0by5cbiAqIEBwYXJhbSBkYXRhIC0gQW4gT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGRhdGEgZm9yIHRoZSBuZXcgZG9jdW1lbnQuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50UmVmZXJlbmNlYCBwb2ludGluZyB0byB0aGVcbiAqIG5ld2x5IGNyZWF0ZWQgZG9jdW1lbnQgYWZ0ZXIgaXQgaGFzIGJlZW4gd3JpdHRlbiB0byB0aGUgYmFja2VuZCAoTm90ZSB0aGF0IGl0XG4gKiB3b24ndCByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAqLyBmdW5jdGlvbiBwbCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGpjKHQuZmlyZXN0b3JlLCAkYSksIHMgPSBzYSh0KSwgaSA9IGVsKHQuY29udmVydGVyLCBlKTtcbiAgICByZXR1cm4gRWwobiwgWyBmaChsaCh0LmZpcmVzdG9yZSksIFwiYWRkRG9jXCIsIHMuX2tleSwgaSwgbnVsbCAhPT0gdC5jb252ZXJ0ZXIsIHt9KS50b011dGF0aW9uKHMuX2tleSwgT24uZXhpc3RzKCExKSkgXSkudGhlbigoKCkgPT4gcykpO1xufVxuXG5mdW5jdGlvbiBJbCh0LCAuLi5lKSB7XG4gICAgdmFyIG4sIHMsIGk7XG4gICAgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KTtcbiAgICBsZXQgciA9IHtcbiAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITFcbiAgICB9LCBvID0gMDtcbiAgICBcIm9iamVjdFwiICE9IHR5cGVvZiBlW29dIHx8IE9hKGVbb10pIHx8IChyID0gZVtvXSwgbysrKTtcbiAgICBjb25zdCB1ID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiByLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXNcbiAgICB9O1xuICAgIGlmIChPYShlW29dKSkge1xuICAgICAgICBjb25zdCB0ID0gZVtvXTtcbiAgICAgICAgZVtvXSA9IG51bGwgPT09IChuID0gdC5uZXh0KSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLmJpbmQodCksIGVbbyArIDFdID0gbnVsbCA9PT0gKHMgPSB0LmVycm9yKSB8fCB2b2lkIDAgPT09IHMgPyB2b2lkIDAgOiBzLmJpbmQodCksIFxuICAgICAgICBlW28gKyAyXSA9IG51bGwgPT09IChpID0gdC5jb21wbGV0ZSkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5iaW5kKHQpO1xuICAgIH1cbiAgICBsZXQgYywgYSwgaDtcbiAgICBpZiAodCBpbnN0YW5jZW9mIFhjKSBhID0gamModC5maXJlc3RvcmUsICRhKSwgaCA9IGVuKHQuX2tleS5wYXRoKSwgYyA9IHtcbiAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICBlW29dICYmIGVbb10oQWwoYSwgdCwgbikpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZVtvICsgMV0sXG4gICAgICAgIGNvbXBsZXRlOiBlW28gKyAyXVxuICAgIH07IGVsc2Uge1xuICAgICAgICBjb25zdCBuID0gamModCwgWmMpO1xuICAgICAgICBhID0gamMobi5maXJlc3RvcmUsICRhKSwgaCA9IG4uX3F1ZXJ5O1xuICAgICAgICBjb25zdCBzID0gbmV3IGhsKGEpO1xuICAgICAgICBjID0ge1xuICAgICAgICAgICAgbmV4dDogdCA9PiB7XG4gICAgICAgICAgICAgICAgZVtvXSAmJiBlW29dKG5ldyBvbChhLCBzLCBuLCB0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGVbbyArIDFdLFxuICAgICAgICAgICAgY29tcGxldGU6IGVbbyArIDJdXG4gICAgICAgIH0sIGtoKHQuX3F1ZXJ5KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyB1YShzKSwgciA9IG5ldyB6dShlLCBpLCBuKTtcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBLdShhd2FpdCBSYSh0KSwgcikpKSwgKCkgPT4ge1xuICAgICAgICAgICAgaS5iYygpLCB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gR3UoYXdhaXQgUmEodCksIHIpKSk7XG4gICAgICAgIH07XG4gICAgfShVYShhKSwgaCwgdSwgYyk7XG59XG5cbmZ1bmN0aW9uIFRsKHQsIGUpIHtcbiAgICByZXR1cm4gQ2EoVWEodCA9IGpjKHQsICRhKSksIE9hKGUpID8gZSA6IHtcbiAgICAgICAgbmV4dDogZVxuICAgIH0pO1xufVxuXG4vKipcbiAqIExvY2FsbHkgd3JpdGVzIGBtdXRhdGlvbnNgIG9uIHRoZSBhc3luYyBxdWV1ZS5cbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIEVsKHQsIGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFU7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gY2MoYXdhaXQgRWEodCksIGUsIG4pKSksIG4ucHJvbWlzZTtcbiAgICB9KFVhKHQpLCBlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHtAbGluayBWaWV3U25hcHNob3R9IHRoYXQgY29udGFpbnMgdGhlIHNpbmdsZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHJlZmBcbiAqIHRvIGEge0BsaW5rIERvY3VtZW50U25hcHNob3R9LlxuICovIGZ1bmN0aW9uIEFsKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbi5kb2NzLmdldChlLl9rZXkpLCBpID0gbmV3IGhsKHQpO1xuICAgIHJldHVybiBuZXcgaWwodCwgaSwgZS5fa2V5LCBzLCBuZXcgc2wobi5oYXNQZW5kaW5nV3JpdGVzLCBuLmZyb21DYWNoZSksIGUuY29udmVydGVyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29tcGFyZXMgdHdvIGBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90YCBpbnN0YW5jZXMgZm9yIGVxdWFsaXR5LlxuICpcbiAqIFR3byBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIFwiZXF1YWxcIiBpZiB0aGV5IGhhdmVcbiAqIHVuZGVybHlpbmcgcXVlcmllcyB0aGF0IGNvbXBhcmUgZXF1YWwsIGFuZCB0aGUgc2FtZSBkYXRhLlxuICpcbiAqIEBwYXJhbSBsZWZ0IC0gVGhlIGZpcnN0IGBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gVGhlIHNlY29uZCBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgdG8gY29tcGFyZS5cbiAqXG4gKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIFwiZXF1YWxcIiwgYXMgZGVmaW5lZCBhYm92ZSwgb3IgYGZhbHNlYFxuICogb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIFJsKHQsIGUpIHtcbiAgICByZXR1cm4gcmEodC5xdWVyeSwgZS5xdWVyeSkgJiYgZGVlcEVxdWFsKHQuZGF0YSgpLCBlLmRhdGEoKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIHJlc3VsdCBzZXQgb2YgdGhlIGdpdmVuIHF1ZXJ5LFxuICogd2l0aG91dCBhY3R1YWxseSBkb3dubG9hZGluZyB0aGUgZG9jdW1lbnRzLlxuICpcbiAqIFVzaW5nIHRoaXMgZnVuY3Rpb24gdG8gY291bnQgdGhlIGRvY3VtZW50cyBpcyBlZmZpY2llbnQgYmVjYXVzZSBvbmx5IHRoZVxuICogZmluYWwgY291bnQsIG5vdCB0aGUgZG9jdW1lbnRzJyBkYXRhLCBpcyBkb3dubG9hZGVkLiBUaGlzIGZ1bmN0aW9uIGNhbiBldmVuXG4gKiBjb3VudCB0aGUgZG9jdW1lbnRzIGlmIHRoZSByZXN1bHQgc2V0IHdvdWxkIGJlIHByb2hpYml0aXZlbHkgbGFyZ2UgdG9cbiAqIGRvd25sb2FkIGVudGlyZWx5IChlLmcuIHRob3VzYW5kcyBvZiBkb2N1bWVudHMpLlxuICpcbiAqIFRoZSByZXN1bHQgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyIGlzIHByZXNlbnRlZCwgdW5hbHRlcmVkLCB3aXRob3V0XG4gKiBjb25zaWRlcmluZyBhbnkgbG9jYWwgc3RhdGUuIFRoYXQgaXMsIGRvY3VtZW50cyBpbiB0aGUgbG9jYWwgY2FjaGUgYXJlIG5vdFxuICogdGFrZW4gaW50byBjb25zaWRlcmF0aW9uLCBuZWl0aGVyIGFyZSBsb2NhbCBtb2RpZmljYXRpb25zIG5vdCB5ZXRcbiAqIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzZXJ2ZXIuIFByZXZpb3VzbHktZG93bmxvYWRlZCByZXN1bHRzLCBpZiBhbnksIGFyZSBub3RcbiAqIHVzZWQ6IGV2ZXJ5IHJlcXVlc3QgdXNpbmcgdGhpcyBzb3VyY2UgbmVjZXNzYXJpbHkgaW52b2x2ZXMgYSByb3VuZCB0cmlwIHRvXG4gKiB0aGUgc2VydmVyLlxuICpcbiAqIEBwYXJhbSBxdWVyeSAtIFRoZSBxdWVyeSB3aG9zZSByZXN1bHQgc2V0IHNpemUgdG8gY2FsY3VsYXRlLlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSBjb3VudDsgdGhlIGNvdW50IGNhbiBiZVxuICogcmV0cmlldmVkIGZyb20gYHNuYXBzaG90LmRhdGEoKS5jb3VudGAsIHdoZXJlIGBzbmFwc2hvdGAgaXMgdGhlXG4gKiBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGAgdG8gd2hpY2ggdGhlIHJldHVybmVkIFByb21pc2UgcmVzb2x2ZXMuXG4gKi8gZnVuY3Rpb24gYmwodCkge1xuICAgIGNvbnN0IGUgPSBqYyh0LmZpcmVzdG9yZSwgJGEpO1xuICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgVTtcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChtdShhd2FpdCBUYSh0KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGF3YWl0IEFhKHQpLCByID0gbmV3IGxhKGUsIGksIG4pLnJ1bigpO1xuICAgICAgICAgICAgICAgICAgICBzLnJlc29sdmUocik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHMucmVqZWN0KG5ldyBMKEIuVU5BVkFJTEFCTEUsIFwiRmFpbGVkIHRvIGdldCBjb3VudCByZXN1bHQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBzLnJlamVjdCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCBzLnByb21pc2U7XG4gICAgfShVYShlKSwgdCwgbmV3IGhsKGUpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgUGwgPSB7XG4gICAgbWF4QXR0ZW1wdHM6IDVcbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgd3JpdGUgYmF0Y2gsIHVzZWQgdG8gcGVyZm9ybSBtdWx0aXBsZSB3cml0ZXMgYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gKlxuICogQSBgV3JpdGVCYXRjaGAgb2JqZWN0IGNhbiBiZSBhY3F1aXJlZCBieSBjYWxsaW5nIHtAbGluayB3cml0ZUJhdGNofS4gSXRcbiAqIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGFkZGluZyB3cml0ZXMgdG8gdGhlIHdyaXRlIGJhdGNoLiBOb25lIG9mIHRoZSB3cml0ZXNcbiAqIHdpbGwgYmUgY29tbWl0dGVkIChvciB2aXNpYmxlIGxvY2FsbHkpIHVudGlsIHtAbGluayBXcml0ZUJhdGNoLmNvbW1pdH0gaXNcbiAqIGNhbGxlZC5cbiAqL1xuY2xhc3Mgdmwge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl9jb21taXRIYW5kbGVyID0gZSwgdGhpcy5fbXV0YXRpb25zID0gW10sIHRoaXMuX2NvbW1pdHRlZCA9ICExLCBcbiAgICAgICAgdGhpcy5fZGF0YVJlYWRlciA9IGxoKHQpO1xuICAgIH1cbiAgICBzZXQodCwgZSwgbikge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgcyA9IFZsKHQsIHRoaXMuX2ZpcmVzdG9yZSksIGkgPSBlbChzLmNvbnZlcnRlciwgZSwgbiksIHIgPSBmaCh0aGlzLl9kYXRhUmVhZGVyLCBcIldyaXRlQmF0Y2guc2V0XCIsIHMuX2tleSwgaSwgbnVsbCAhPT0gcy5jb252ZXJ0ZXIsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5fbXV0YXRpb25zLnB1c2goci50b011dGF0aW9uKHMuX2tleSwgT24ubm9uZSgpKSksIHRoaXM7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlLCBuLCAuLi5zKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeU5vdENvbW1pdHRlZCgpO1xuICAgICAgICBjb25zdCBpID0gVmwodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gciA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpKSB8fCBlIGluc3RhbmNlb2YgZWggPyBJaCh0aGlzLl9kYXRhUmVhZGVyLCBcIldyaXRlQmF0Y2gudXBkYXRlXCIsIGkuX2tleSwgZSwgbiwgcykgOiBwaCh0aGlzLl9kYXRhUmVhZGVyLCBcIldyaXRlQmF0Y2gudXBkYXRlXCIsIGkuX2tleSwgZSksIFxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMucHVzaChyLnRvTXV0YXRpb24oaS5fa2V5LCBPbi5leGlzdHMoITApKSksIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZXMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoZSBwcm92aWRlZCB7QGxpbmsgRG9jdW1lbnRSZWZlcmVuY2V9LlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50UmVmIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGJlIGRlbGV0ZWQuXG4gICAgICogQHJldHVybnMgVGhpcyBgV3JpdGVCYXRjaGAgaW5zdGFuY2UuIFVzZWQgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IGUgPSBWbCh0LCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fbXV0YXRpb25zID0gdGhpcy5fbXV0YXRpb25zLmNvbmNhdChuZXcgem4oZS5fa2V5LCBPbi5ub25lKCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tbWl0cyBhbGwgb2YgdGhlIHdyaXRlcyBpbiB0aGlzIHdyaXRlIGJhdGNoIGFzIGEgc2luZ2xlIGF0b21pYyB1bml0LlxuICAgICAqXG4gICAgICogVGhlIHJlc3VsdCBvZiB0aGVzZSB3cml0ZXMgd2lsbCBvbmx5IGJlIHJlZmxlY3RlZCBpbiBkb2N1bWVudCByZWFkcyB0aGF0XG4gICAgICogb2NjdXIgYWZ0ZXIgdGhlIHJldHVybmVkIHByb21pc2UgcmVzb2x2ZXMuIElmIHRoZSBjbGllbnQgaXMgb2ZmbGluZSwgdGhlXG4gICAgICogd3JpdGUgZmFpbHMuIElmIHlvdSB3b3VsZCBsaWtlIHRvIHNlZSBsb2NhbCBtb2RpZmljYXRpb25zIG9yIGJ1ZmZlciB3cml0ZXNcbiAgICAgKiB1bnRpbCB0aGUgY2xpZW50IGlzIG9ubGluZSwgdXNlIHRoZSBmdWxsIEZpcmVzdG9yZSBTREsuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCBvbmNlIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoZSBiYXRjaCBoYXZlIGJlZW5cbiAgICAgKiBzdWNjZXNzZnVsbHkgd3JpdHRlbiB0byB0aGUgYmFja2VuZCBhcyBhbiBhdG9taWMgdW5pdCAobm90ZSB0aGF0IGl0IHdvbid0XG4gICAgICogcmVzb2x2ZSB3aGlsZSB5b3UncmUgb2ZmbGluZSkuXG4gICAgICovICAgIGNvbW1pdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZlcmlmeU5vdENvbW1pdHRlZCgpLCB0aGlzLl9jb21taXR0ZWQgPSAhMCwgdGhpcy5fbXV0YXRpb25zLmxlbmd0aCA+IDAgPyB0aGlzLl9jb21taXRIYW5kbGVyKHRoaXMuX211dGF0aW9ucykgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgX3ZlcmlmeU5vdENvbW1pdHRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2NvbW1pdHRlZCkgdGhyb3cgbmV3IEwoQi5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkEgd3JpdGUgYmF0Y2ggY2FuIG5vIGxvbmdlciBiZSB1c2VkIGFmdGVyIGNvbW1pdCgpIGhhcyBiZWVuIGNhbGxlZC5cIik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBWbCh0LCBlKSB7XG4gICAgaWYgKCh0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpKS5maXJlc3RvcmUgIT09IGUpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJQcm92aWRlZCBkb2N1bWVudCByZWZlcmVuY2UgaXMgZnJvbSBhIGRpZmZlcmVudCBGaXJlc3RvcmUgaW5zdGFuY2UuXCIpO1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVE9ETyhtcnNjaG1pZHQpIENvbnNpZGVyIHVzaW5nIGBCYXNlVHJhbnNhY3Rpb25gIGFzIHRoZSBiYXNlIGNsYXNzIGluIHRoZVxuLy8gbGVnYWN5IFNESy5cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHJlZmVyZW5jZSB0byBhIHRyYW5zYWN0aW9uLlxuICpcbiAqIFRoZSBgVHJhbnNhY3Rpb25gIG9iamVjdCBwYXNzZWQgdG8gYSB0cmFuc2FjdGlvbidzIGB1cGRhdGVGdW5jdGlvbmAgcHJvdmlkZXNcbiAqIHRoZSBtZXRob2RzIHRvIHJlYWQgYW5kIHdyaXRlIGRhdGEgd2l0aGluIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0LiBTZWVcbiAqIHtAbGluayBydW5UcmFuc2FjdGlvbn0uXG4gKi9cbmNsYXNzIFNsIGV4dGVuZHMgY2xhc3Mge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl90cmFuc2FjdGlvbiA9IGUsIHRoaXMuX2RhdGFSZWFkZXIgPSBsaCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBWbCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IG5sKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5sb29rdXAoWyBlLl9rZXkgXSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQgfHwgMSAhPT0gdC5sZW5ndGgpIHJldHVybiBPKCk7XG4gICAgICAgICAgICBjb25zdCBzID0gdFswXTtcbiAgICAgICAgICAgIGlmIChzLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gbmV3IENoKHRoaXMuX2ZpcmVzdG9yZSwgbiwgcy5rZXksIHMsIGUuY29udmVydGVyKTtcbiAgICAgICAgICAgIGlmIChzLmlzTm9Eb2N1bWVudCgpKSByZXR1cm4gbmV3IENoKHRoaXMuX2ZpcmVzdG9yZSwgbiwgZS5fa2V5LCBudWxsLCBlLmNvbnZlcnRlcik7XG4gICAgICAgICAgICB0aHJvdyBPKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFZsKHQsIHRoaXMuX2ZpcmVzdG9yZSksIGkgPSBlbChzLmNvbnZlcnRlciwgZSwgbiksIHIgPSBmaCh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLnNldChzLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICBjb25zdCBpID0gVmwodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gciA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpKSB8fCBlIGluc3RhbmNlb2YgZWggPyBJaCh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnVwZGF0ZVwiLCBpLl9rZXksIGUsIG4sIHMpIDogcGgodGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLnVwZGF0ZShpLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSBkZWxldGVkLlxuICAgICAqIEByZXR1cm5zIFRoaXMgYFRyYW5zYWN0aW9uYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gVmwodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLmRlbGV0ZShlLl9rZXkpLCB0aGlzO1xuICAgIH1cbn0ge1xuICAgIC8vIFRoaXMgY2xhc3MgaW1wbGVtZW50cyB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgVHJhbnNhY3Rpb24gQVBJIGluIHRoZSBMaXRlIFNES1xuICAgIC8vIGJ1dCBpcyBzdWJjbGFzc2VkIGluIG9yZGVyIHRvIHJldHVybiBpdHMgb3duIERvY3VtZW50U25hcHNob3QgdHlwZXMuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIGUpLCB0aGlzLl9maXJlc3RvcmUgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJlbmNlZCBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSByZWFkLlxuICAgICAqIEByZXR1cm5zIEEgYERvY3VtZW50U25hcHNob3RgIHdpdGggdGhlIHJlYWQgZGF0YS5cbiAgICAgKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFZsKHQsIHRoaXMuX2ZpcmVzdG9yZSksIG4gPSBuZXcgaGwodGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldCh0KS50aGVuKCh0ID0+IG5ldyBpbCh0aGlzLl9maXJlc3RvcmUsIG4sIGUuX2tleSwgdC5fZG9jdW1lbnQsIG5ldyBzbChcbiAgICAgICAgLyogaGFzUGVuZGluZ1dyaXRlcz0gKi8gITEsIFxuICAgICAgICAvKiBmcm9tQ2FjaGU9ICovICExKSwgZS5jb252ZXJ0ZXIpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBnaXZlbiBgdXBkYXRlRnVuY3Rpb25gIGFuZCB0aGVuIGF0dGVtcHRzIHRvIGNvbW1pdCB0aGUgY2hhbmdlc1xuICogYXBwbGllZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uLiBJZiBhbnkgZG9jdW1lbnQgcmVhZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBoYXMgY2hhbmdlZCwgQ2xvdWQgRmlyZXN0b3JlIHJldHJpZXMgdGhlIGB1cGRhdGVGdW5jdGlvbmAuIElmIGl0IGZhaWxzIHRvXG4gKiBjb21taXQgYWZ0ZXIgNSBhdHRlbXB0cywgdGhlIHRyYW5zYWN0aW9uIGZhaWxzLlxuICpcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3cml0ZXMgYWxsb3dlZCBpbiBhIHNpbmdsZSB0cmFuc2FjdGlvbiBpcyA1MDAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBGaXJlc3RvcmUgZGF0YWJhc2UgdG8gcnVuIHRoaXNcbiAqIHRyYW5zYWN0aW9uIGFnYWluc3QuXG4gKiBAcGFyYW0gdXBkYXRlRnVuY3Rpb24gLSBUaGUgZnVuY3Rpb24gdG8gZXhlY3V0ZSB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBjb250ZXh0LlxuICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvcHRpb25zIG9iamVjdCB0byBjb25maWd1cmUgbWF4aW11bSBudW1iZXIgb2YgYXR0ZW1wdHMgdG9cbiAqIGNvbW1pdC5cbiAqIEByZXR1cm5zIElmIHRoZSB0cmFuc2FjdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IG9yIHdhcyBleHBsaWNpdGx5IGFib3J0ZWRcbiAqICh0aGUgYHVwZGF0ZUZ1bmN0aW9uYCByZXR1cm5lZCBhIGZhaWxlZCBwcm9taXNlKSwgdGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhlXG4gKiBgdXBkYXRlRnVuY3Rpb24gYGlzIHJldHVybmVkIGhlcmUuIE90aGVyd2lzZSwgaWYgdGhlIHRyYW5zYWN0aW9uIGZhaWxlZCwgYVxuICogcmVqZWN0ZWQgcHJvbWlzZSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGZhaWx1cmUgZXJyb3IgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gRGwodCwgZSwgbikge1xuICAgIHQgPSBqYyh0LCAkYSk7XG4gICAgY29uc3QgcyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgUGwpLCBuKTtcbiAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAodC5tYXhBdHRlbXB0cyA8IDEpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJNYXggYXR0ZW1wdHMgbXVzdCBiZSBhdCBsZWFzdCAxXCIpO1xuICAgIH0ocyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBVO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBhd2FpdCBBYSh0KTtcbiAgICAgICAgICAgIG5ldyBkYSh0LmFzeW5jUXVldWUsIGksIG4sIGUsIHMpLnJ1bigpO1xuICAgICAgICB9KSksIHMucHJvbWlzZTtcbiAgICB9KFVhKHQpLCAobiA9PiBlKG5ldyBTbCh0LCBuKSkpLCBzKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhIHNlbnRpbmVsIGZvciB1c2Ugd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IG9yXG4gKiB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IHdpdGggYHttZXJnZTogdHJ1ZX1gIHRvIG1hcmsgYSBmaWVsZCBmb3IgZGVsZXRpb24uXG4gKi8gZnVuY3Rpb24gQ2woKSB7XG4gICAgcmV0dXJuIG5ldyBkaChcImRlbGV0ZUZpZWxkXCIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzZW50aW5lbCB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IHRvXG4gKiBpbmNsdWRlIGEgc2VydmVyLWdlbmVyYXRlZCB0aW1lc3RhbXAgaW4gdGhlIHdyaXR0ZW4gZGF0YS5cbiAqLyBmdW5jdGlvbiB4bCgpIHtcbiAgICByZXR1cm4gbmV3IHdoKFwic2VydmVyVGltZXN0YW1wXCIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IG9yIHtAbGlua1xuICogQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IHRoYXQgdGVsbHMgdGhlIHNlcnZlciB0byB1bmlvbiB0aGUgZ2l2ZW4gZWxlbWVudHMgd2l0aCBhbnkgYXJyYXlcbiAqIHZhbHVlIHRoYXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIHNlcnZlci4gRWFjaCBzcGVjaWZpZWQgZWxlbWVudCB0aGF0IGRvZXNuJ3RcbiAqIGFscmVhZHkgZXhpc3QgaW4gdGhlIGFycmF5IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVuZC4gSWYgdGhlIGZpZWxkIGJlaW5nXG4gKiBtb2RpZmllZCBpcyBub3QgYWxyZWFkeSBhbiBhcnJheSBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggYW4gYXJyYXlcbiAqIGNvbnRhaW5pbmcgZXhhY3RseSB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzLlxuICpcbiAqIEBwYXJhbSBlbGVtZW50cyAtIFRoZSBlbGVtZW50cyB0byB1bmlvbiBpbnRvIHRoZSBhcnJheS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYC5cbiAqLyBmdW5jdGlvbiBObCguLi50KSB7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgYWN0dWFsbHkgcGFyc2UgdGhlIGRhdGEgdW50aWwgaXQncyB1c2VkIGluIHNldCgpIG9yXG4gICAgLy8gdXBkYXRlKCkgc2luY2Ugd2UnZCBuZWVkIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UgdG8gZG8gdGhpcy5cbiAgICByZXR1cm4gbmV3IG1oKFwiYXJyYXlVbmlvblwiLCB0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIChzZXREb2M6MSl9IG9yIHtAbGlua1xuICogdXBkYXRlRG9jOjF9IHRoYXQgdGVsbHMgdGhlIHNlcnZlciB0byByZW1vdmUgdGhlIGdpdmVuIGVsZW1lbnRzIGZyb20gYW55XG4gKiBhcnJheSB2YWx1ZSB0aGF0IGFscmVhZHkgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIuIEFsbCBpbnN0YW5jZXMgb2YgZWFjaCBlbGVtZW50XG4gKiBzcGVjaWZpZWQgd2lsbCBiZSByZW1vdmVkIGZyb20gdGhlIGFycmF5LiBJZiB0aGUgZmllbGQgYmVpbmcgbW9kaWZpZWQgaXMgbm90XG4gKiBhbHJlYWR5IGFuIGFycmF5IGl0IHdpbGwgYmUgb3ZlcndyaXR0ZW4gd2l0aCBhbiBlbXB0eSBhcnJheS5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudHMgLSBUaGUgZWxlbWVudHMgdG8gcmVtb3ZlIGZyb20gdGhlIGFycmF5LlxuICogQHJldHVybnMgVGhlIGBGaWVsZFZhbHVlYCBzZW50aW5lbCBmb3IgdXNlIGluIGEgY2FsbCB0byBgc2V0RG9jKClgIG9yXG4gKiBgdXBkYXRlRG9jKClgXG4gKi8gZnVuY3Rpb24ga2woLi4udCkge1xuICAgIC8vIE5PVEU6IFdlIGRvbid0IGFjdHVhbGx5IHBhcnNlIHRoZSBkYXRhIHVudGlsIGl0J3MgdXNlZCBpbiBzZXQoKSBvclxuICAgIC8vIHVwZGF0ZSgpIHNpbmNlIHdlJ2QgbmVlZCB0aGUgRmlyZXN0b3JlIGluc3RhbmNlIHRvIGRvIHRoaXMuXG4gICAgcmV0dXJuIG5ldyBnaChcImFycmF5UmVtb3ZlXCIsIHQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IG9yIHtAbGlua1xuICogQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyh1cGRhdGVEb2M6MSl9IHRoYXQgdGVsbHMgdGhlIHNlcnZlciB0byBpbmNyZW1lbnQgdGhlIGZpZWxkJ3MgY3VycmVudCB2YWx1ZSBieVxuICogdGhlIGdpdmVuIHZhbHVlLlxuICpcbiAqIElmIGVpdGhlciB0aGUgb3BlcmFuZCBvciB0aGUgY3VycmVudCBmaWVsZCB2YWx1ZSB1c2VzIGZsb2F0aW5nIHBvaW50XG4gKiBwcmVjaXNpb24sIGFsbCBhcml0aG1ldGljIGZvbGxvd3MgSUVFRSA3NTQgc2VtYW50aWNzLiBJZiBib3RoIHZhbHVlcyBhcmVcbiAqIGludGVnZXJzLCB2YWx1ZXMgb3V0c2lkZSBvZiBKYXZhU2NyaXB0J3Mgc2FmZSBudW1iZXIgcmFuZ2VcbiAqIChgTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJgIHRvIGBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUmApIGFyZSBhbHNvIHN1YmplY3QgdG9cbiAqIHByZWNpc2lvbiBsb3NzLiBGdXJ0aGVybW9yZSwgb25jZSBwcm9jZXNzZWQgYnkgdGhlIEZpcmVzdG9yZSBiYWNrZW5kLCBhbGxcbiAqIGludGVnZXIgb3BlcmF0aW9ucyBhcmUgY2FwcGVkIGJldHdlZW4gLTJeNjMgYW5kIDJeNjMtMS5cbiAqXG4gKiBJZiB0aGUgY3VycmVudCBmaWVsZCB2YWx1ZSBpcyBub3Qgb2YgdHlwZSBgbnVtYmVyYCwgb3IgaWYgdGhlIGZpZWxkIGRvZXMgbm90XG4gKiB5ZXQgZXhpc3QsIHRoZSB0cmFuc2Zvcm1hdGlvbiBzZXRzIHRoZSBmaWVsZCB0byB0aGUgZ2l2ZW4gdmFsdWUuXG4gKlxuICogQHBhcmFtIG4gLSBUaGUgdmFsdWUgdG8gaW5jcmVtZW50IGJ5LlxuICogQHJldHVybnMgVGhlIGBGaWVsZFZhbHVlYCBzZW50aW5lbCBmb3IgdXNlIGluIGEgY2FsbCB0byBgc2V0RG9jKClgIG9yXG4gKiBgdXBkYXRlRG9jKClgXG4gKi8gZnVuY3Rpb24gT2wodCkge1xuICAgIHJldHVybiBuZXcgeWgoXCJpbmNyZW1lbnRcIiwgdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSB3cml0ZSBiYXRjaCwgdXNlZCBmb3IgcGVyZm9ybWluZyBtdWx0aXBsZSB3cml0ZXMgYXMgYSBzaW5nbGVcbiAqIGF0b21pYyBvcGVyYXRpb24uIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3cml0ZXMgYWxsb3dlZCBpbiBhIHNpbmdsZSB7QGxpbmsgV3JpdGVCYXRjaH1cbiAqIGlzIDUwMC5cbiAqXG4gKiBVbmxpa2UgdHJhbnNhY3Rpb25zLCB3cml0ZSBiYXRjaGVzIGFyZSBwZXJzaXN0ZWQgb2ZmbGluZSBhbmQgdGhlcmVmb3JlIGFyZVxuICogcHJlZmVyYWJsZSB3aGVuIHlvdSBkb24ndCBuZWVkIHRvIGNvbmRpdGlvbiB5b3VyIHdyaXRlcyBvbiByZWFkIGRhdGEuXG4gKlxuICogQHJldHVybnMgQSB7QGxpbmsgV3JpdGVCYXRjaH0gdGhhdCBjYW4gYmUgdXNlZCB0byBhdG9taWNhbGx5IGV4ZWN1dGUgbXVsdGlwbGVcbiAqIHdyaXRlcy5cbiAqLyBmdW5jdGlvbiBNbCh0KSB7XG4gICAgcmV0dXJuIFVhKHQgPSBqYyh0LCAkYSkpLCBuZXcgdmwodCwgKGUgPT4gRWwodCwgZSkpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gRmwodCwgZSkge1xuICAgIHZhciBuO1xuICAgIGNvbnN0IHMgPSBVYSh0ID0gamModCwgJGEpKTtcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IHJldHVybiBhbiBlcnJvciBpZiB0aGUgdXNlciBoYXMgbm90IGVuYWJsZWRcbiAgICAvLyBwZXJzaXN0ZW5jZSBzaW5jZSBgZW5hYmxlSW5kZXhlZGRiUGVyc2lzdGVuY2UoKWAgY2FuIGZhaWwgb24gdGhlIFdlYi5cbiAgICAgICAgaWYgKCEobnVsbCA9PT0gKG4gPSBzLm9mZmxpbmVDb21wb25lbnRzKSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlcikpIHJldHVybiBOKFwiQ2Fubm90IGVuYWJsZSBpbmRleGVzIHdoZW4gcGVyc2lzdGVuY2UgaXMgZGlzYWJsZWRcIiksIFxuICAgIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGNvbnN0IGkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHQpO1xuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgXCJGYWlsZWQgdG8gcGFyc2UgSlNPTjogXCIgKyAobnVsbCA9PT0gKGUgPSB0KSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLm1lc3NhZ2UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0KSA6IHQsIG4gPSBbXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZS5pbmRleGVzKSkgZm9yIChjb25zdCB0IG9mIGUuaW5kZXhlcykge1xuICAgICAgICAgICAgY29uc3QgZSA9ICRsKHQsIFwiY29sbGVjdGlvbkdyb3VwXCIpLCBzID0gW107XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0LmZpZWxkcykpIGZvciAoY29uc3QgZSBvZiB0LmZpZWxkcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBWaChcInNldEluZGV4Q29uZmlndXJhdGlvblwiLCAkbChlLCBcImZpZWxkUGF0aFwiKSk7XG4gICAgICAgICAgICAgICAgXCJDT05UQUlOU1wiID09PSBlLmFycmF5Q29uZmlnID8gcy5wdXNoKG5ldyBkdCh0LCAyIC8qIENPTlRBSU5TICovKSkgOiBcIkFTQ0VORElOR1wiID09PSBlLm9yZGVyID8gcy5wdXNoKG5ldyBkdCh0LCAwIC8qIEFTQ0VORElORyAqLykpIDogXCJERVNDRU5ESU5HXCIgPT09IGUub3JkZXIgJiYgcy5wdXNoKG5ldyBkdCh0LCAxIC8qIERFU0NFTkRJTkcgKi8pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG4ucHVzaChuZXcgYXQoYXQuVU5LTk9XTl9JRCwgZSwgcywgd3QuZW1wdHkoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuO1xuICAgIH0oZSk7XG4gICAgcmV0dXJuIElhKHMpLnRoZW4oKHQgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gJCh0KSwgcyA9IG4uaW5kZXhNYW5hZ2VyLCBpID0gW107XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQ29uZmlndXJlIGluZGV4ZXNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gcy5nZXRGaWVsZEluZGV4ZXModCkubmV4dCgobiA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgICAgICB0ID0gWyAuLi50IF0sIGUgPSBbIC4uLmUgXSwgdC5zb3J0KG4pLCBlLnNvcnQobik7XG4gICAgICAgICAgICBjb25zdCByID0gdC5sZW5ndGgsIG8gPSBlLmxlbmd0aDtcbiAgICAgICAgICAgIGxldCB1ID0gMCwgYyA9IDA7XG4gICAgICAgICAgICBmb3IgKDt1IDwgbyAmJiBjIDwgcjsgKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4odFtjXSwgZVt1XSk7XG4gICAgICAgICAgICAgICAgciA8IDAgPyBcbiAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgcmVtb3ZlZCBpZiB0aGUgbmV4dCBlbGVtZW50IGluIG91ciBvcmRlcmVkXG4gICAgICAgICAgICAgICAgLy8gd2Fsa3Rocm91Z2ggaXMgb25seSBpbiBgYmVmb3JlYC5cbiAgICAgICAgICAgICAgICBpKHRbYysrXSkgOiByID4gMCA/IFxuICAgICAgICAgICAgICAgIC8vIFRoZSBlbGVtZW50IHdhcyBhZGRlZCBpZiB0aGUgbmV4dCBlbGVtZW50IGluIG91ciBvcmRlcmVkIHdhbGt0aHJvdWdoXG4gICAgICAgICAgICAgICAgLy8gaXMgb25seSBpbiBgYWZ0ZXJgLlxuICAgICAgICAgICAgICAgIHMoZVt1KytdKSA6ICh1KyssIGMrKyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKDt1IDwgbzsgKSBzKGVbdSsrXSk7XG4gICAgICAgICAgICBmb3IgKDtjIDwgcjsgKSBpKHRbYysrXSk7XG4gICAgICAgIH0obiwgZSwgZnQsIChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLmFkZEZpZWxkSW5kZXgodCwgZSkpO1xuICAgICAgICB9KSwgKGUgPT4ge1xuICAgICAgICAgICAgaS5wdXNoKHMuZGVsZXRlRmllbGRJbmRleCh0LCBlKSk7XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IEF0LndhaXRGb3IoaSkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgIC8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGNsaWVudCBzdGF0ZSBpczpcbiAgICAvLyAgICAgZmlyZXN0b3JlX2NsaWVudHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGluc3RhbmNlX2tleT5cbiAgICAodCwgaSkpKTtcbn1cblxuZnVuY3Rpb24gJGwodCwgZSkge1xuICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiB0W2VdKSB0aHJvdyBuZXcgTChCLklOVkFMSURfQVJHVU1FTlQsIFwiTWlzc2luZyBzdHJpbmcgdmFsdWUgZm9yOiBcIiArIGUpO1xuICAgIHJldHVybiB0W2VdO1xufVxuXG4vKipcbiAqIENsb3VkIEZpcmVzdG9yZVxuICpcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxuICovICFmdW5jdGlvbih0LCBlID0gITApIHtcbiAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICB2ID0gdDtcbiAgICB9KFNES19WRVJTSU9OKSwgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoXCJmaXJlc3RvcmVcIiwgKCh0LCB7aW5zdGFuY2VJZGVudGlmaWVyOiBuLCBvcHRpb25zOiBzfSkgPT4ge1xuICAgICAgICBjb25zdCBpID0gdC5nZXRQcm92aWRlcihcImFwcFwiKS5nZXRJbW1lZGlhdGUoKSwgciA9IG5ldyAkYShuZXcgUSh0LmdldFByb3ZpZGVyKFwiYXV0aC1pbnRlcm5hbFwiKSksIG5ldyBIKHQuZ2V0UHJvdmlkZXIoXCJhcHAtY2hlY2staW50ZXJuYWxcIikpLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuYXBwbHkodC5vcHRpb25zLCBbIFwicHJvamVjdElkXCIgXSkpIHRocm93IG5ldyBMKEIuSU5WQUxJRF9BUkdVTUVOVCwgJ1wicHJvamVjdElkXCIgbm90IHByb3ZpZGVkIGluIGZpcmViYXNlLmluaXRpYWxpemVBcHAuJyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IG5lKHQub3B0aW9ucy5wcm9qZWN0SWQsIGUpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgICAgIC8qKiBTZW50aW5lbCB2YWx1ZSB0aGF0IHNvcnRzIGJlZm9yZSBhbnkgTXV0YXRpb24gQmF0Y2ggSUQuICovIChpLCBuKSwgaSk7XG4gICAgICAgIHJldHVybiBzID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB1c2VGZXRjaFN0cmVhbXM6IGVcbiAgICAgICAgfSwgcyksIHIuX3NldFNldHRpbmdzKHMpLCByO1xuICAgIH0pLCBcIlBVQkxJQ1wiKS5zZXRNdWx0aXBsZUluc3RhbmNlcyghMCkpLCByZWdpc3RlclZlcnNpb24oYiwgXCIzLjcuM1wiLCB0KSwgXG4gICAgLy8gQlVJTERfVEFSR0VUIHdpbGwgYmUgcmVwbGFjZWQgYnkgdmFsdWVzIGxpa2UgZXNtNSwgZXNtMjAxNywgY2pzNSwgZXRjIGR1cmluZyB0aGUgY29tcGlsYXRpb25cbiAgICByZWdpc3RlclZlcnNpb24oYiwgXCIzLjcuM1wiLCBcImVzbTIwMTdcIik7XG59KCk7XG5cbmV4cG9ydCB7IHRsIGFzIEFic3RyYWN0VXNlckRhdGFXcml0ZXIsIGFhIGFzIEFnZ3JlZ2F0ZUZpZWxkLCBoYSBhcyBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90LCB0aCBhcyBCeXRlcywgRmEgYXMgQ0FDSEVfU0laRV9VTkxJTUlURUQsIHRhIGFzIENvbGxlY3Rpb25SZWZlcmVuY2UsIFhjIGFzIERvY3VtZW50UmVmZXJlbmNlLCBpbCBhcyBEb2N1bWVudFNuYXBzaG90LCBlaCBhcyBGaWVsZFBhdGgsIHNoIGFzIEZpZWxkVmFsdWUsICRhIGFzIEZpcmVzdG9yZSwgTCBhcyBGaXJlc3RvcmVFcnJvciwgaWggYXMgR2VvUG9pbnQsIE1hIGFzIExvYWRCdW5kbGVUYXNrLCBaYyBhcyBRdWVyeSwgT2ggYXMgUXVlcnlDb25zdHJhaW50LCBybCBhcyBRdWVyeURvY3VtZW50U25hcHNob3QsIG9sIGFzIFF1ZXJ5U25hcHNob3QsIHNsIGFzIFNuYXBzaG90TWV0YWRhdGEsIG50IGFzIFRpbWVzdGFtcCwgU2wgYXMgVHJhbnNhY3Rpb24sIHZsIGFzIFdyaXRlQmF0Y2gsIG5lIGFzIF9EYXRhYmFzZUlkLCBjdCBhcyBfRG9jdW1lbnRLZXksIEogYXMgX0VtcHR5QXBwQ2hlY2tUb2tlblByb3ZpZGVyLCBLIGFzIF9FbXB0eUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyLCB1dCBhcyBfRmllbGRQYXRoLCBqYyBhcyBfY2FzdCwgRiBhcyBfZGVidWdBc3NlcnQsIGp0IGFzIF9pc0Jhc2U2NEF2YWlsYWJsZSwgTiBhcyBfbG9nV2FybiwgcWMgYXMgX3ZhbGlkYXRlSXNOb3RVc2VkVG9nZXRoZXIsIHBsIGFzIGFkZERvYywgUmwgYXMgYWdncmVnYXRlUXVlcnlTbmFwc2hvdEVxdWFsLCBrbCBhcyBhcnJheVJlbW92ZSwgTmwgYXMgYXJyYXlVbmlvbiwgamEgYXMgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgZWEgYXMgY29sbGVjdGlvbiwgbmEgYXMgY29sbGVjdGlvbkdyb3VwLCBZYyBhcyBjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IsIHlsIGFzIGRlbGV0ZURvYywgQ2wgYXMgZGVsZXRlRmllbGQsIEhhIGFzIGRpc2FibGVOZXR3b3JrLCBzYSBhcyBkb2MsIG5oIGFzIGRvY3VtZW50SWQsIEthIGFzIGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlLCBHYSBhcyBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlLCB6YSBhcyBlbmFibGVOZXR3b3JrLCBIaCBhcyBlbmRBdCwgemggYXMgZW5kQmVmb3JlLCBVYSBhcyBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkLCBFbCBhcyBleGVjdXRlV3JpdGUsIGJsIGFzIGdldENvdW50RnJvbVNlcnZlciwgYWwgYXMgZ2V0RG9jLCBsbCBhcyBnZXREb2NGcm9tQ2FjaGUsIGZsIGFzIGdldERvY0Zyb21TZXJ2ZXIsIGRsIGFzIGdldERvY3MsIF9sIGFzIGdldERvY3NGcm9tQ2FjaGUsIHdsIGFzIGdldERvY3NGcm9tU2VydmVyLCBMYSBhcyBnZXRGaXJlc3RvcmUsIE9sIGFzIGluY3JlbWVudCwgQmEgYXMgaW5pdGlhbGl6ZUZpcmVzdG9yZSwgcWggYXMgbGltaXQsIEtoIGFzIGxpbWl0VG9MYXN0LCBZYSBhcyBsb2FkQnVuZGxlLCBYYSBhcyBuYW1lZFF1ZXJ5LCBJbCBhcyBvblNuYXBzaG90LCBUbCBhcyBvblNuYXBzaG90c0luU3luYywgTGggYXMgb3JkZXJCeSwgTWggYXMgcXVlcnksIHJhIGFzIHF1ZXJ5RXF1YWwsIGlhIGFzIHJlZkVxdWFsLCBEbCBhcyBydW5UcmFuc2FjdGlvbiwgeGwgYXMgc2VydmVyVGltZXN0YW1wLCBtbCBhcyBzZXREb2MsIEZsIGFzIHNldEluZGV4Q29uZmlndXJhdGlvbiwgRCBhcyBzZXRMb2dMZXZlbCwgY2wgYXMgc25hcHNob3RFcXVhbCwgamggYXMgc3RhcnRBZnRlciwgUWggYXMgc3RhcnRBdCwgSmEgYXMgdGVybWluYXRlLCBnbCBhcyB1cGRhdGVEb2MsIFdhIGFzIHdhaXRGb3JQZW5kaW5nV3JpdGVzLCAkaCBhcyB3aGVyZSwgTWwgYXMgd3JpdGVCYXRjaCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IGluaXRpYWxpemVBcHAgfSBmcm9tIFwiZmlyZWJhc2UvYXBwXCI7XG5pbXBvcnQge1xuICBnZXRGaXJlc3RvcmUsXG4gIGNvbGxlY3Rpb24sXG4gIGFkZERvYyxcbiAgZ2V0RG9jcyxcbiAgZGVsZXRlRG9jLFxuICBkb2MsXG4gIHVwZGF0ZURvYyxcbn0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5jb25zdCBmaXJlYmFzZUNvbmZpZyA9IHtcbiAgYXBpS2V5OiBcIkFJemFTeURHeEdDeGZKTjFZTmo3NERwSG9CYXFrMWxCbmNYQS10VVwiLFxuICBhdXRoRG9tYWluOiBcImxpYnJhcnktZmJmYTIuZmlyZWJhc2VhcHAuY29tXCIsXG4gIHByb2plY3RJZDogXCJsaWJyYXJ5LWZiZmEyXCIsXG4gIHN0b3JhZ2VCdWNrZXQ6IFwibGlicmFyeS1mYmZhMi5hcHBzcG90LmNvbVwiLFxuICBtZXNzYWdpbmdTZW5kZXJJZDogXCIxMjA1ODIwODAzNTNcIixcbiAgYXBwSWQ6IFwiMToxMjA1ODIwODAzNTM6d2ViOjBlMmY2ODY3M2NjZmI3OGE5ZGU3MjBcIixcbn07XG5cbmluaXRpYWxpemVBcHAoZmlyZWJhc2VDb25maWcpO1xuY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoKTtcblxubGV0IGJvb2tUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYm9va1wiKTtcbmxldCBhdXRob3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F1dGhvclwiKTtcbmxldCBwYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGFnZXNcIik7XG5sZXQgcmVhZFN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmVhZFwiKTtcbmxldCBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1Ym1pdFwiKTtcbmxldCBzaGVsZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hlbGZNYWluXCIpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IGRlbGV0ZUxpc3RlbmVyKGUpKTtcblxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlTGlzdGVuZXIoZSkge1xuICBsZXQgZWxlbWVudCA9IGUudGFyZ2V0O1xuICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJkZWxldGVCdG5cIikpIHtcbiAgICBjb25zdCBkb2NSZWYgPSBkb2MoZGIsIFwiYm9va3NcIiwgZWxlbWVudC5wYXJlbnROb2RlLmlkKTtcbiAgICBhd2FpdCBkZWxldGVEb2MoZG9jUmVmKTtcbiAgICBzaGVsZi5pbm5lckhUTUwgPSBcIlwiO1xuICAgIGxvYWRCb29rcygpO1xuICB9XG59XG5cbmJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBpZiAoYm9va1RpdGxlLnZhbHVlID09IFwiXCIgfHwgYXV0aG9yLnZhbHVlID09IFwiXCIgfHwgcGFnZXMudmFsdWUgPT0gXCJcIikge1xuICAgIGFsZXJ0KFwib25lIG9mIHRoZSB2YWx1ZXMgaXMgZW1wdHlcIik7XG4gIH0gZWxzZSB7XG4gICAgYWRkQm9va1RvTGlicmFyeShcbiAgICAgIGJvb2tUaXRsZS52YWx1ZSxcbiAgICAgIGF1dGhvci52YWx1ZSxcbiAgICAgIHBhZ2VzLnZhbHVlLFxuICAgICAgcmVhZFN0YXR1cy52YWx1ZVxuICAgICk7XG4gICAgc2hlbGYuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBsb2FkQm9va3MoKTtcbiAgfVxufSk7XG5cbmxldCBteUxpYnJhcnkgPSBbXTtcblxuYXN5bmMgZnVuY3Rpb24gbG9hZEJvb2tzKCkge1xuICBteUxpYnJhcnkuc3BsaWNlKDAsIG15TGlicmFyeS5sZW5ndGgpO1xuICBjb25zdCBjb2xSZWYgPSBjb2xsZWN0aW9uKGRiLCBcImJvb2tzXCIpO1xuICBjb25zdCBkb2NTbmFwID0gYXdhaXQgZ2V0RG9jcyhjb2xSZWYpO1xuICBkb2NTbmFwLmZvckVhY2goKGRvYykgPT4ge1xuICAgIG15TGlicmFyeS5wdXNoKHsgaWQ6IGRvYy5pZCwgLi4uZG9jLmRhdGEoKSB9KTtcbiAgfSk7XG4gIGFkZFRvU2hlbGYoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkQm9va1RvTGlicmFyeShib29rVGl0bGUsIGF1dGhvciwgcGFnZXMsIHJlYWRTdGF0dXMpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihnZXRGaXJlc3RvcmUoKSwgXCJib29rc1wiKSwge1xuICAgICAgdGl0bGU6IGJvb2tUaXRsZSxcbiAgICAgIGF1dGhvcjogYXV0aG9yLFxuICAgICAgcGFnZXM6IHBhZ2VzLFxuICAgICAgcmVhZDogcmVhZFN0YXR1cyxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJtZiB1aDogXCIsIGUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFkZFRvU2hlbGYoKSB7XG4gIGZvciAobGV0IGJvb2sgb2YgbXlMaWJyYXJ5KSB7XG4gICAgbGV0IHRpdGxlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBsZXQgYXV0aG9yRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBsZXQgcGFnZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgbGV0IHJlYWRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgbGV0IGRlbGV0ZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICByZWFkRWwuY2xhc3NMaXN0LmFkZChcInJlYWRCdG5cIik7XG4gICAgZGVsZXRlRWwuY2xhc3NMaXN0LmFkZChcImRlbGV0ZUJ0blwiKTtcbiAgICBkZWxldGVFbC50ZXh0Q29udGVudCArPSBcIkRFTEVURVwiO1xuICAgIGZvciAobGV0IGxhYmVsIGluIGJvb2spIHtcbiAgICAgIGlmIChsYWJlbCA9PSBcInRpdGxlXCIpIHtcbiAgICAgICAgdGl0bGVFbC50ZXh0Q29udGVudCArPSBib29rW2xhYmVsXTtcbiAgICAgIH0gZWxzZSBpZiAobGFiZWwgPT0gXCJhdXRob3JcIikge1xuICAgICAgICBhdXRob3JFbC50ZXh0Q29udGVudCArPSBib29rW2xhYmVsXTtcbiAgICAgIH0gZWxzZSBpZiAobGFiZWwgPT0gXCJwYWdlc1wiKSB7XG4gICAgICAgIHBhZ2VFbC50ZXh0Q29udGVudCArPSBib29rW2xhYmVsXTtcbiAgICAgIH0gZWxzZSBpZiAobGFiZWwgPT0gXCJyZWFkXCIpIHtcbiAgICAgICAgcmVhZEVsLnRleHRDb250ZW50ICs9IGJvb2tbbGFiZWxdO1xuICAgICAgfVxuICAgIH1cbiAgICBsZXQgbmV3Qm9vayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgbmV3Qm9vay5kYXRhc2V0Lm51bSA9IG15TGlicmFyeS5pbmRleE9mKGJvb2spO1xuICAgIG5ld0Jvb2suY2xhc3NMaXN0LmFkZChcImJvb2tPYmpcIik7XG4gICAgbmV3Qm9vay5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBib29rLmlkKTtcbiAgICBuZXdCb29rLmFwcGVuZENoaWxkKHRpdGxlRWwpO1xuICAgIG5ld0Jvb2suYXBwZW5kQ2hpbGQoYXV0aG9yRWwpO1xuICAgIG5ld0Jvb2suYXBwZW5kQ2hpbGQocGFnZUVsKTtcbiAgICBuZXdCb29rLmFwcGVuZENoaWxkKHJlYWRFbCk7XG4gICAgbmV3Qm9vay5hcHBlbmRDaGlsZChkZWxldGVFbCk7XG4gICAgc2hlbGYuYXBwZW5kQ2hpbGQobmV3Qm9vayk7XG4gIH1cbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlYWRMaXN0ZW5lcik7XG5cbmFzeW5jIGZ1bmN0aW9uIHJlYWRMaXN0ZW5lcihlKSB7XG4gIGxldCBlbGVtZW50ID0gZS50YXJnZXQ7XG4gIGlmIChlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInJlYWRCdG5cIikpIHtcbiAgICBpZiAoZWxlbWVudC5pbm5lclRleHQgPT0gXCJSRUFEXCIpIHtcbiAgICAgIGNvbnN0IGRvY1JlZiA9IGRvYyhkYiwgXCJib29rc1wiLCBlbGVtZW50LnBhcmVudE5vZGUuaWQpO1xuICAgICAgYXdhaXQgdXBkYXRlRG9jKGRvY1JlZiwgeyByZWFkOiBcIlVOUkVBRFwiIH0pO1xuICAgICAgZWxlbWVudC5pbm5lclRleHQgPSBcIlVOUkVBRFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBkb2NSZWYgPSBkb2MoZGIsIFwiYm9va3NcIiwgZWxlbWVudC5wYXJlbnROb2RlLmlkKTtcbiAgICAgIGF3YWl0IHVwZGF0ZURvYyhkb2NSZWYsIHsgcmVhZDogXCJSRUFEXCIgfSk7XG4gICAgICBlbGVtZW50LmlubmVyVGV4dCA9IFwiUkVBRFwiO1xuICAgIH1cbiAgfVxufVxuXG5sb2FkQm9va3MoKTtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZyIsImdsb2JhbFRoaXMiLCJ0aGlzIiwiRnVuY3Rpb24iLCJlIiwid2luZG93Iiwic3RyaW5nVG9CeXRlQXJyYXkkMSIsInN0ciIsIm91dCIsInAiLCJpIiwibGVuZ3RoIiwiYyIsImNoYXJDb2RlQXQiLCJiYXNlNjQiLCJieXRlVG9DaGFyTWFwXyIsImNoYXJUb0J5dGVNYXBfIiwiYnl0ZVRvQ2hhck1hcFdlYlNhZmVfIiwiY2hhclRvQnl0ZU1hcFdlYlNhZmVfIiwiRU5DT0RFRF9WQUxTX0JBU0UiLCJFTkNPREVEX1ZBTFMiLCJFTkNPREVEX1ZBTFNfV0VCU0FGRSIsIkhBU19OQVRJVkVfU1VQUE9SVCIsImF0b2IiLCJlbmNvZGVCeXRlQXJyYXkiLCJpbnB1dCIsIndlYlNhZmUiLCJBcnJheSIsImlzQXJyYXkiLCJFcnJvciIsImluaXRfIiwiYnl0ZVRvQ2hhck1hcCIsIm91dHB1dCIsImJ5dGUxIiwiaGF2ZUJ5dGUyIiwiYnl0ZTIiLCJoYXZlQnl0ZTMiLCJieXRlMyIsIm91dEJ5dGUxIiwib3V0Qnl0ZTIiLCJvdXRCeXRlMyIsIm91dEJ5dGU0IiwicHVzaCIsImpvaW4iLCJlbmNvZGVTdHJpbmciLCJidG9hIiwiZGVjb2RlU3RyaW5nIiwiYnl0ZXMiLCJwb3MiLCJjMSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImMyIiwidSIsImMzIiwiYnl0ZUFycmF5VG9TdHJpbmciLCJkZWNvZGVTdHJpbmdUb0J5dGVBcnJheSIsImNoYXJUb0J5dGVNYXAiLCJjaGFyQXQiLCJieXRlNCIsImJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nIiwidXRmOEJ5dGVzIiwiYmFzZTY0RW5jb2RlIiwicmVwbGFjZSIsImdldERlZmF1bHRzIiwic2VsZiIsImdldEdsb2JhbCIsIl9fRklSRUJBU0VfREVGQVVMVFNfXyIsInByb2Nlc3MiLCJlbnYiLCJkZWZhdWx0c0pzb25TdHJpbmciLCJKU09OIiwicGFyc2UiLCJnZXREZWZhdWx0c0Zyb21FbnZWYXJpYWJsZSIsImRvY3VtZW50IiwibWF0Y2giLCJjb29raWUiLCJkZWNvZGVkIiwiY29uc29sZSIsImVycm9yIiwiYmFzZTY0RGVjb2RlIiwiZ2V0RGVmYXVsdHNGcm9tQ29va2llIiwiaW5mbyIsIkRlZmVycmVkIiwiY29uc3RydWN0b3IiLCJyZWplY3QiLCJyZXNvbHZlIiwicHJvbWlzZSIsIlByb21pc2UiLCJ3cmFwQ2FsbGJhY2siLCJjYWxsYmFjayIsInZhbHVlIiwiY2F0Y2giLCJGaXJlYmFzZUVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJjdXN0b21EYXRhIiwic3VwZXIiLCJuYW1lIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIkVycm9yRmFjdG9yeSIsImNyZWF0ZSIsInNlcnZpY2UiLCJzZXJ2aWNlTmFtZSIsImVycm9ycyIsImRhdGEiLCJmdWxsQ29kZSIsInRlbXBsYXRlIiwiUEFUVEVSTiIsIl8iLCJrZXkiLCJyZXBsYWNlVGVtcGxhdGUiLCJmdWxsTWVzc2FnZSIsImEiLCJiIiwiYUtleXMiLCJrZXlzIiwiYktleXMiLCJrIiwiaW5jbHVkZXMiLCJhUHJvcCIsImJQcm9wIiwiaXNPYmplY3QiLCJ0aGluZyIsIl9kZWxlZ2F0ZSIsIkNvbXBvbmVudCIsImluc3RhbmNlRmFjdG9yeSIsInR5cGUiLCJtdWx0aXBsZUluc3RhbmNlcyIsInNlcnZpY2VQcm9wcyIsImluc3RhbnRpYXRpb25Nb2RlIiwib25JbnN0YW5jZUNyZWF0ZWQiLCJzZXRJbnN0YW50aWF0aW9uTW9kZSIsIm1vZGUiLCJzZXRNdWx0aXBsZUluc3RhbmNlcyIsInNldFNlcnZpY2VQcm9wcyIsInByb3BzIiwic2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2siLCJERUZBVUxUX0VOVFJZX05BTUUiLCJQcm92aWRlciIsImNvbnRhaW5lciIsImNvbXBvbmVudCIsImluc3RhbmNlcyIsIk1hcCIsImluc3RhbmNlc0RlZmVycmVkIiwiaW5zdGFuY2VzT3B0aW9ucyIsIm9uSW5pdENhbGxiYWNrcyIsImdldCIsImlkZW50aWZpZXIiLCJub3JtYWxpemVkSWRlbnRpZmllciIsIm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllciIsImhhcyIsImRlZmVycmVkIiwic2V0IiwiaXNJbml0aWFsaXplZCIsInNob3VsZEF1dG9Jbml0aWFsaXplIiwiaW5zdGFuY2UiLCJnZXRPckluaXRpYWxpemVTZXJ2aWNlIiwiaW5zdGFuY2VJZGVudGlmaWVyIiwiZ2V0SW1tZWRpYXRlIiwib3B0aW9ucyIsIl9hIiwib3B0aW9uYWwiLCJnZXRDb21wb25lbnQiLCJzZXRDb21wb25lbnQiLCJpc0NvbXBvbmVudEVhZ2VyIiwiaW5zdGFuY2VEZWZlcnJlZCIsImVudHJpZXMiLCJjbGVhckluc3RhbmNlIiwiZGVsZXRlIiwiYXN5bmMiLCJzZXJ2aWNlcyIsImZyb20iLCJ2YWx1ZXMiLCJhbGwiLCJmaWx0ZXIiLCJtYXAiLCJJTlRFUk5BTCIsIl9kZWxldGUiLCJpc0NvbXBvbmVudFNldCIsImdldE9wdGlvbnMiLCJpbml0aWFsaXplIiwib3B0cyIsIm9uSW5pdCIsImV4aXN0aW5nQ2FsbGJhY2tzIiwiU2V0IiwiYWRkIiwiZXhpc3RpbmdJbnN0YW5jZSIsImludm9rZU9uSW5pdENhbGxiYWNrcyIsImNhbGxiYWNrcyIsInVuZGVmaW5lZCIsIkNvbXBvbmVudENvbnRhaW5lciIsInByb3ZpZGVycyIsImFkZENvbXBvbmVudCIsInByb3ZpZGVyIiwiZ2V0UHJvdmlkZXIiLCJhZGRPck92ZXJ3cml0ZUNvbXBvbmVudCIsImdldFByb3ZpZGVycyIsIkxvZ0xldmVsIiwibGV2ZWxTdHJpbmdUb0VudW0iLCJERUJVRyIsIlZFUkJPU0UiLCJJTkZPIiwiV0FSTiIsIkVSUk9SIiwiU0lMRU5UIiwiZGVmYXVsdExvZ0xldmVsIiwiQ29uc29sZU1ldGhvZCIsImRlZmF1bHRMb2dIYW5kbGVyIiwibG9nVHlwZSIsImFyZ3MiLCJsb2dMZXZlbCIsIm5vdyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1ldGhvZCIsIkxvZ2dlciIsIl9sb2dMZXZlbCIsIl9sb2dIYW5kbGVyIiwiX3VzZXJMb2dIYW5kbGVyIiwidmFsIiwiVHlwZUVycm9yIiwic2V0TG9nTGV2ZWwiLCJsb2dIYW5kbGVyIiwidXNlckxvZ0hhbmRsZXIiLCJkZWJ1ZyIsImxvZyIsIndhcm4iLCJpZGJQcm94eWFibGVUeXBlcyIsImN1cnNvckFkdmFuY2VNZXRob2RzIiwiY3Vyc29yUmVxdWVzdE1hcCIsIldlYWtNYXAiLCJ0cmFuc2FjdGlvbkRvbmVNYXAiLCJ0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAiLCJ0cmFuc2Zvcm1DYWNoZSIsInJldmVyc2VUcmFuc2Zvcm1DYWNoZSIsImlkYlByb3h5VHJhcHMiLCJ0YXJnZXQiLCJwcm9wIiwicmVjZWl2ZXIiLCJJREJUcmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlTmFtZXMiLCJvYmplY3RTdG9yZSIsInRyYW5zZm9ybUNhY2hhYmxlVmFsdWUiLCJmdW5jIiwiSURCRGF0YWJhc2UiLCJ0cmFuc2FjdGlvbiIsIklEQkN1cnNvciIsImFkdmFuY2UiLCJjb250aW51ZSIsImNvbnRpbnVlUHJpbWFyeUtleSIsImFwcGx5IiwidW53cmFwIiwic3RvcmVOYW1lcyIsInR4IiwiY2FsbCIsInNvcnQiLCJkb25lIiwidW5saXN0ZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY29tcGxldGUiLCJET01FeGNlcHRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwiY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uIiwib2JqZWN0IiwiSURCT2JqZWN0U3RvcmUiLCJJREJJbmRleCIsInNvbWUiLCJQcm94eSIsIklEQlJlcXVlc3QiLCJyZXF1ZXN0Iiwic3VjY2VzcyIsInJlc3VsdCIsInRoZW4iLCJwcm9taXNpZnlSZXF1ZXN0IiwibmV3VmFsdWUiLCJyZWFkTWV0aG9kcyIsIndyaXRlTWV0aG9kcyIsImNhY2hlZE1ldGhvZHMiLCJnZXRNZXRob2QiLCJ0YXJnZXRGdW5jTmFtZSIsInVzZUluZGV4IiwiaXNXcml0ZSIsInN0b3JlTmFtZSIsInN0b3JlIiwiaW5kZXgiLCJzaGlmdCIsIm9sZFRyYXBzIiwiUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlSW1wbCIsImdldFBsYXRmb3JtSW5mb1N0cmluZyIsImlzVmVyc2lvblNlcnZpY2VQcm92aWRlciIsImxpYnJhcnkiLCJ2ZXJzaW9uIiwibG9nU3RyaW5nIiwibmFtZSRvIiwidmVyc2lvbiQxIiwibG9nZ2VyIiwiUExBVEZPUk1fTE9HX1NUUklORyIsIl9hcHBzIiwiX2NvbXBvbmVudHMiLCJfYWRkQ29tcG9uZW50IiwiYXBwIiwiX3JlZ2lzdGVyQ29tcG9uZW50IiwiY29tcG9uZW50TmFtZSIsIkVSUk9SX0ZBQ1RPUlkiLCJGaXJlYmFzZUFwcEltcGwiLCJjb25maWciLCJfaXNEZWxldGVkIiwiX29wdGlvbnMiLCJhc3NpZ24iLCJfY29uZmlnIiwiX25hbWUiLCJfYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiX2NvbnRhaW5lciIsImNoZWNrRGVzdHJveWVkIiwiaXNEZWxldGVkIiwiYXBwTmFtZSIsImluaXRpYWxpemVBcHAiLCJyYXdDb25maWciLCJnZXREZWZhdWx0QXBwQ29uZmlnIiwiZXhpc3RpbmdBcHAiLCJuZXdBcHAiLCJyZWdpc3RlclZlcnNpb24iLCJsaWJyYXJ5S2V5T3JOYW1lIiwidmFyaWFudCIsImxpYnJhcnlNaXNtYXRjaCIsInZlcnNpb25NaXNtYXRjaCIsIndhcm5pbmciLCJTVE9SRV9OQU1FIiwiZGJQcm9taXNlIiwiZ2V0RGJQcm9taXNlIiwiYmxvY2tlZCIsInVwZ3JhZGUiLCJibG9ja2luZyIsInRlcm1pbmF0ZWQiLCJpbmRleGVkREIiLCJvcGVuIiwib3BlblByb21pc2UiLCJldmVudCIsIm9sZFZlcnNpb24iLCJuZXdWZXJzaW9uIiwiZGIiLCJvcGVuREIiLCJjcmVhdGVPYmplY3RTdG9yZSIsIm9yaWdpbmFsRXJyb3JNZXNzYWdlIiwid3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIiLCJoZWFydGJlYXRPYmplY3QiLCJwdXQiLCJjb21wdXRlS2V5IiwiaWRiR2V0RXJyb3IiLCJhcHBJZCIsIkhlYXJ0YmVhdFNlcnZpY2VJbXBsIiwiX2hlYXJ0YmVhdHNDYWNoZSIsIl9zdG9yYWdlIiwiSGVhcnRiZWF0U3RvcmFnZUltcGwiLCJfaGVhcnRiZWF0c0NhY2hlUHJvbWlzZSIsInJlYWQiLCJhZ2VudCIsImRhdGUiLCJnZXRVVENEYXRlU3RyaW5nIiwibGFzdFNlbnRIZWFydGJlYXREYXRlIiwiaGVhcnRiZWF0cyIsInNpbmdsZURhdGVIZWFydGJlYXQiLCJoYlRpbWVzdGFtcCIsInZhbHVlT2YiLCJvdmVyd3JpdGUiLCJoZWFydGJlYXRzVG9TZW5kIiwidW5zZW50RW50cmllcyIsImhlYXJ0YmVhdHNDYWNoZSIsIm1heFNpemUiLCJzbGljZSIsImhlYXJ0YmVhdEVudHJ5IiwiZmluZCIsImhiIiwiZGF0ZXMiLCJjb3VudEJ5dGVzIiwicG9wIiwiZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIiLCJoZWFkZXJTdHJpbmciLCJzdHJpbmdpZnkiLCJzdWJzdHJpbmciLCJfY2FuVXNlSW5kZXhlZERCUHJvbWlzZSIsInJ1bkluZGV4ZWREQkVudmlyb25tZW50Q2hlY2siLCJwcmVFeGlzdCIsIkRCX0NIRUNLX05BTUUiLCJvbnN1Y2Nlc3MiLCJjbG9zZSIsImRlbGV0ZURhdGFiYXNlIiwib251cGdyYWRlbmVlZGVkIiwib25lcnJvciIsImlkYkhlYXJ0YmVhdE9iamVjdCIsInJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQiIsImhlYXJ0YmVhdHNPYmplY3QiLCJleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QiLCJjb21tb25qc0dsb2JhbCIsImVzbSIsImdvb2ciLCJsIiwiYWEiLCJiYSIsImRhIiwiTWF0aCIsInJhbmRvbSIsImVhIiwiZmEiLCJiaW5kIiwiYXJndW1lbnRzIiwiaGEiLCJkIiwidW5zaGlmdCIsInEiLCJ0b1N0cmluZyIsImluZGV4T2YiLCJpYSIsInQiLCJYIiwiV2IiLCJmIiwiaCIsIm4iLCJ2IiwicyIsIm8iLCJuYSIsIk0iLCJoYXNPd25Qcm9wZXJ0eSIsImxhIiwibWEiLCJ3IiwiZGVmYXVsdFByZXZlbnRlZCIsIm9hIiwiZGVmaW5lUHJvcGVydHkiLCJwYSIsInRlc3QiLCJxYSIsInRyaW0iLCJleGVjIiwicmEiLCJzYSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIngiLCJ0YSIsIkVhIiwid2EiLCJ5IiwieGEiLCJ5YSIsInphIiwidG9Mb3dlckNhc2UiLCJBYSIsIkJhIiwiZG9jdW1lbnRNb2RlIiwiRmEiLCJHYSIsIkhhIiwicGFyc2VGbG9hdCIsIkphIiwidmEiLCJJYSIsInNwbGl0IiwibWF4IiwicGFyc2VJbnQiLCJ1YSIsIkxhIiwieiIsInJlbGF0ZWRUYXJnZXQiLCJidXR0b24iLCJzY3JlZW5ZIiwic2NyZWVuWCIsImNsaWVudFkiLCJjbGllbnRYIiwibWV0YUtleSIsInNoaWZ0S2V5IiwiYWx0S2V5IiwiY3RybEtleSIsInN0YXRlIiwicG9pbnRlcklkIiwicG9pbnRlclR5cGUiLCJjaGFuZ2VkVG91Y2hlcyIsInNyY0VsZW1lbnQiLCJub2RlTmFtZSIsImZyb21FbGVtZW50IiwidG9FbGVtZW50IiwicGFnZVgiLCJwYWdlWSIsIk1hIiwicHJldmVudERlZmF1bHQiLCJyZXR1cm5WYWx1ZSIsIkEiLCJOYSIsIk9hIiwibGlzdGVuZXIiLCJwcm94eSIsInNyYyIsImNhcHR1cmUiLCJQYSIsIlFhIiwiUmEiLCJTYSIsIlRhIiwiVWEiLCJXYSIsInNwbGljZSIsIlZhIiwiWGEiLCJZYSIsIiRhIiwib25jZSIsImFiIiwiYmIiLCJOIiwiY2IiLCJnYiIsImViIiwiYXR0YWNoRXZlbnQiLCJmYiIsImFkZExpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXIiLCJPIiwiaWIiLCJkZXRhY2hFdmVudCIsImpiIiwiaGFuZGxlRXZlbnQiLCJCIiwiUCIsIkkiLCJDIiwia2IiLCJjb25jYXQiLCJsYiIsIm1iIiwibmIiLCJuZXh0IiwidWIiLCJwYiIsImoiLCJxYiIsInJlc2V0IiwicmIiLCJzZXRUaW1lb3V0Iiwic2IiLCJ4YiIsInZiIiwid2IiLCJ5YiIsInpiIiwiY2EiLCJSIiwiY2xlYXJUaW1lb3V0IiwiQWIiLCJOdW1iZXIiLCJCYiIsIm0iLCJzdGFydCIsIkNiIiwiRCIsIkRiIiwiRWIiLCJGYiIsIkdiIiwiRSIsIkpiIiwiRyIsIkxiIiwiTWIiLCJOYiIsIkgiLCJPYiIsIlNUQVRfRVZFTlQiLCJzdGF0IiwiUGIiLCJzaXplIiwiSiIsIlFiIiwiTk9fRVJST1IiLCJ0YiIsIlRJTUVPVVQiLCJSYiIsIlZiIiwiU2IiLCJUYiIsIlViIiwiWGIiLCJLIiwiT1BFTiIsIlliIiwiTCIsIlUiLCJTIiwiWmIiLCJUIiwiRiIsIlYiLCJZIiwiJCIsIloiLCIkYiIsIlhNTEh0dHBSZXF1ZXN0IiwiYWMiLCJiYyIsImNjIiwiZGMiLCJlYyIsImZjIiwiZ2MiLCJyIiwiSGIiLCJqYyIsIkRhIiwibGMiLCJuYyIsImtjIiwib2MiLCJRIiwiaXNOYU4iLCJzdWJzdHIiLCJwYyIsImljIiwibWMiLCJhYm9ydCIsInFjIiwicmMiLCJzYyIsInRjIiwidWMiLCJqYSIsImthIiwiQ2EiLCJnZXRSZXNwb25zZUhlYWRlciIsInZjIiwid2MiLCJ4YyIsInljIiwiemMiLCJBYyIsIkRjIiwiZm9yRWFjaCIsIlciLCJDYyIsIkJjIiwiaGMiLCJUZXh0RGVjb2RlciIsImRlY29kZSIsInN0cmVhbSIsIkliIiwiY2FuY2VsIiwiS2IiLCJFYyIsIlJlZ0V4cCIsIkdjIiwiSGMiLCJJYyIsIkpjIiwiS2MiLCJUYyIsIlFjIiwiTGMiLCJSYyIsImZsb29yIiwiYWJzIiwiZGVjb2RlVVJJIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJIiwiU2MiLCJNYyIsImVuY29kZVVSSUNvbXBvbmVudCIsIk5jIiwiT2MiLCJQYyIsIkZjIiwiVWMiLCJXYyIsIlhjIiwiUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nIiwicGVyZm9ybWFuY2UiLCJnZXRFbnRyaWVzQnlUeXBlIiwibmV4dEhvcFByb3RvY29sIiwiWWMiLCJaYyIsIiRjIiwiYWQiLCJiZCIsImRkIiwib25sb2FkIiwib25hYm9ydCIsIm9udGltZW91dCIsImVkIiwiZmQiLCJyZWFkeVN0YXRlIiwiZ2QiLCJzdGF0dXMiLCJyZXNwb25zZVR5cGUiLCJyZXNwb25zZVRleHQiLCJyZXNwb25zZSIsInN0YXR1c1RleHQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJIZWFkZXJzIiwiY2xlYXIiLCJqZCIsImdhIiwiaWQiLCJoZCIsInNlbmQiLCJoZWFkZXJzIiwiY3JlZGVudGlhbHMiLCJjYWNoZSIsImJvZHkiLCJmZXRjaCIsIlJlcXVlc3QiLCJhcnJheUJ1ZmZlciIsIlJlYWRhYmxlU3RyZWFtIiwiZ2V0UmVhZGVyIiwidGV4dCIsIlVpbnQ4QXJyYXkiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiYXBwZW5kIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwia2QiLCJsZCIsIm1kIiwibmQiLCJvZCIsInJkIiwic2QiLCJ0ZCIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJwZCIsIm1velJlc3BvbnNlQXJyYXlCdWZmZXIiLCJ1ZCIsInZkIiwid2QiLCJpbnRlcm5hbENoYW5uZWxQYXJhbXMiLCJ4ZCIsIlphIiwieG1sSHR0cEZhY3RvcnkiLCJzdXBwb3J0c0Nyb3NzRG9tYWluWGhyIiwiY29uY3VycmVudFJlcXVlc3RMaW1pdCIsImZhc3RIYW5kc2hha2UiLCJlbmNvZGVJbml0TWVzc2FnZUhlYWRlcnMiLCJmb3JjZUxvbmdQb2xsaW5nIiwiZGV0ZWN0QnVmZmVyaW5nUHJveHkiLCJ5ZCIsInpkIiwic2VuZEJlYWNvbiIsIkltYWdlIiwiQWQiLCJFZCIsIkRkIiwicm91bmQiLCJtaW4iLCJDZCIsIkZkIiwiQmQiLCJjZCIsImhvc3RuYW1lIiwicG9ydCIsIkthIiwiR2QiLCJIZCIsIm1lc3NhZ2VVcmxQYXJhbXMiLCJtZXNzYWdlSGVhZGVycyIsImNsaWVudFByb3RvY29sSGVhZGVyUmVxdWlyZWQiLCJpbml0TWVzc2FnZUhlYWRlcnMiLCJtZXNzYWdlQ29udGVudFR5cGUiLCJzZW5kUmF3SnNvbiIsImh0dHBTZXNzaW9uSWRQYXJhbSIsIklkIiwiX19zbV9fIiwiSmQiLCJ0b1VwcGVyQ2FzZSIsImdldFByb3RvdHlwZU9mIiwiRm9ybURhdGEiLCJ3aXRoQ3JlZGVudGlhbHMiLCJ0aW1lb3V0IiwicWQiLCJfX2RhdGFfXyIsImNyZWF0ZVdlYkNoYW5uZWwiLCJIVFRQX0VSUk9SIiwiQ09NUExFVEUiLCJFdmVudFR5cGUiLCJDTE9TRSIsIk1FU1NBR0UiLCJsaXN0ZW4iLCJsaXN0ZW5PbmNlIiwiZ2V0TGFzdEVycm9yIiwiZ2V0TGFzdEVycm9yQ29kZSIsImdldFN0YXR1cyIsImdldFJlc3BvbnNlSnNvbiIsImdldFJlc3BvbnNlVGV4dCIsInNldFdpdGhDcmVkZW50aWFscyIsImNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQiLCJnZXRTdGF0RXZlbnRUYXJnZXQiLCJFcnJvckNvZGUiLCJFdmVudCIsIlN0YXQiLCJQUk9YWSIsIk5PUFJPWFkiLCJvYiIsIkZldGNoWG1sSHR0cEZhY3RvcnkiLCJXZWJDaGFubmVsIiwiWGhySW8iLCJ1aWQiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ0b0tleSIsImlzRXF1YWwiLCJVTkFVVEhFTlRJQ0FURUQiLCJHT09HTEVfQ1JFREVOVElBTFMiLCJGSVJTVF9QQVJUWSIsIk1PQ0tfVVNFUiIsIk9LIiwiQ0FOQ0VMTEVEIiwiVU5LTk9XTiIsIklOVkFMSURfQVJHVU1FTlQiLCJERUFETElORV9FWENFRURFRCIsIk5PVF9GT1VORCIsIkFMUkVBRFlfRVhJU1RTIiwiUEVSTUlTU0lPTl9ERU5JRUQiLCJSRVNPVVJDRV9FWEhBVVNURUQiLCJGQUlMRURfUFJFQ09ORElUSU9OIiwiQUJPUlRFRCIsIk9VVF9PRl9SQU5HRSIsIlVOSU1QTEVNRU5URUQiLCJVTkFWQUlMQUJMRSIsIkRBVEFfTE9TUyIsInVzZXIiLCJnZXRUb2tlbiIsImludmFsaWRhdGVUb2tlbiIsImVucXVldWVSZXRyeWFibGUiLCJzaHV0ZG93biIsInRva2VuIiwiY2hhbmdlTGlzdGVuZXIiLCJjdXJyZW50VXNlciIsImZvcmNlUmVmcmVzaCIsImF1dGgiLCJhZGRBdXRoVG9rZW5MaXN0ZW5lciIsImFjY2Vzc1Rva2VuIiwicmVtb3ZlQXV0aFRva2VuTGlzdGVuZXIiLCJnZXRVaWQiLCJnZXRBdXRoSGVhZGVyVmFsdWVGb3JGaXJzdFBhcnR5IiwiYXBwQ2hlY2siLCJhZGRUb2tlbkxpc3RlbmVyIiwicmVtb3ZlVG9rZW5MaXN0ZW5lciIsImNyeXB0byIsIm1zQ3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwic3RhdGljIiwidHQiLCJldmVyeSIsIm50Iiwic2Vjb25kcyIsIm5hbm9zZWNvbmRzIiwiZnJvbU1pbGxpcyIsImdldFRpbWUiLCJ0b0RhdGUiLCJ0b01pbGxpcyIsIl9jb21wYXJlVG8iLCJ0b0pTT04iLCJwYWRTdGFydCIsInN0IiwidGltZXN0YW1wIiwiY29tcGFyZVRvIiwidG9NaWNyb3NlY29uZHMiLCJ0b1RpbWVzdGFtcCIsIml0Iiwic2VnbWVudHMiLCJvZmZzZXQiLCJsZW4iLCJjb21wYXJhdG9yIiwiY2hpbGQiLCJsaW1pdCIsImNvbnN0cnVjdCIsInBvcEZpcnN0IiwicG9wTGFzdCIsImZpcnN0U2VnbWVudCIsImxhc3RTZWdtZW50IiwiaXNFbXB0eSIsImlzUHJlZml4T2YiLCJpc0ltbWVkaWF0ZVBhcmVudE9mIiwidG9BcnJheSIsInJ0IiwiY2Fub25pY2FsU3RyaW5nIiwib3QiLCJ1dCIsImlzVmFsaWRJZGVudGlmaWVyIiwiaXNLZXlGaWVsZCIsImN0IiwicGF0aCIsImZyb21TdHJpbmciLCJlbXB0eVBhdGgiLCJjb2xsZWN0aW9uR3JvdXAiLCJoYXNDb2xsZWN0aW9uSWQiLCJnZXRDb2xsZWN0aW9uR3JvdXAiLCJnZXRDb2xsZWN0aW9uUGF0aCIsImd0IiwieXQiLCJyZWFkVGltZSIsImRvY3VtZW50S2V5IiwibGFyZ2VzdEJhdGNoSWQiLCJlbXB0eSIsInB0IiwiVHQiLCJvbkNvbW1pdHRlZExpc3RlbmVycyIsImFkZE9uQ29tbWl0dGVkTGlzdGVuZXIiLCJyYWlzZU9uQ29tbWl0dGVkRXZlbnQiLCJFdCIsIkF0IiwibmV4dENhbGxiYWNrIiwiY2F0Y2hDYWxsYmFjayIsImlzRG9uZSIsImNhbGxiYWNrQXR0YWNoZWQiLCJ3cmFwRmFpbHVyZSIsIndyYXBTdWNjZXNzIiwidG9Qcm9taXNlIiwid3JhcFVzZXJGdW5jdGlvbiIsIndhaXRGb3IiLCJWdCIsIk90IiwicHJldmlvdXNWYWx1ZSIsInNlcXVlbmNlTnVtYmVySGFuZGxlciIsIndyaXRlU2VxdWVuY2VOdW1iZXIiLCJNdCIsIkZ0IiwiJHQiLCJhdCIsIkJ0Iiwicm9vdCIsIlV0IiwiRU1QVFkiLCJpbnNlcnQiLCJjb3B5IiwiQkxBQ0siLCJyZW1vdmUiLCJsZWZ0IiwicmlnaHQiLCJtaW5LZXkiLCJtYXhLZXkiLCJpbm9yZGVyVHJhdmVyc2FsIiwicmV2ZXJzZVRyYXZlcnNhbCIsImdldEl0ZXJhdG9yIiwiTHQiLCJnZXRJdGVyYXRvckZyb20iLCJnZXRSZXZlcnNlSXRlcmF0b3IiLCJnZXRSZXZlcnNlSXRlcmF0b3JGcm9tIiwiaXNSZXZlcnNlIiwibm9kZVN0YWNrIiwiZ2V0TmV4dCIsImhhc05leHQiLCJwZWVrIiwiY29sb3IiLCJSRUQiLCJmaXhVcCIsInJlbW92ZU1pbiIsImlzUmVkIiwibW92ZVJlZExlZnQiLCJyb3RhdGVSaWdodCIsIm1vdmVSZWRSaWdodCIsInJvdGF0ZUxlZnQiLCJjb2xvckZsaXAiLCJjaGVja01heERlcHRoIiwiY2hlY2siLCJwb3ciLCJxdCIsImZpcnN0IiwibGFzdCIsImZvckVhY2hJblJhbmdlIiwiZm9yRWFjaFdoaWxlIiwiZmlyc3RBZnRlck9yRXF1YWwiLCJLdCIsInVuaW9uV2l0aCIsIml0ZXIiLCJRdCIsImZpZWxkcyIsImNvdmVycyIsIld0IiwiYmluYXJ5U3RyaW5nIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJ0b0Jhc2U2NCIsInRvVWludDhBcnJheSIsImFwcHJveGltYXRlQnl0ZVNpemUiLCJFTVBUWV9CWVRFX1NUUklORyIsInp0IiwiSHQiLCJuYW5vcyIsIkp0IiwiWXQiLCJmcm9tQmFzZTY0U3RyaW5nIiwiZnJvbVVpbnQ4QXJyYXkiLCJYdCIsIm1hcFZhbHVlIiwiX190eXBlX18iLCJzdHJpbmdWYWx1ZSIsIlp0IiwiX19wcmV2aW91c192YWx1ZV9fIiwidGUiLCJfX2xvY2FsX3dyaXRlX3RpbWVfXyIsInRpbWVzdGFtcFZhbHVlIiwiZWUiLCJkYXRhYmFzZUlkIiwicGVyc2lzdGVuY2VLZXkiLCJob3N0Iiwic3NsIiwiYXV0b0RldGVjdExvbmdQb2xsaW5nIiwidXNlRmV0Y2hTdHJlYW1zIiwibmUiLCJwcm9qZWN0SWQiLCJkYXRhYmFzZSIsImlzRGVmYXVsdERhdGFiYXNlIiwic2UiLCJpZSIsIm9lIiwiY2UiLCJFZSIsImFlIiwiYm9vbGVhblZhbHVlIiwiYnl0ZXNWYWx1ZSIsInJlZmVyZW5jZVZhbHVlIiwiZ2VvUG9pbnRWYWx1ZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaW50ZWdlclZhbHVlIiwiZG91YmxlVmFsdWUiLCJhcnJheVZhbHVlIiwiaGUiLCJsZSIsImZlIiwiZGUiLCJfZSIsImZyb21OYW1lIiwibWUiLCJnZSIsInllIiwicGUiLCJJZSIsIlRlIiwidmUiLCJmaWVsZCIsImdldEZpZWxkc01hcCIsInNldEFsbCIsImFwcGx5Q2hhbmdlcyIsImNsb25lIiwiVmUiLCJTZSIsImRvY3VtZW50VHlwZSIsImRvY3VtZW50U3RhdGUiLCJjb252ZXJ0VG9Gb3VuZERvY3VtZW50IiwiY29udmVydFRvTm9Eb2N1bWVudCIsImNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCIsInNldEhhc0NvbW1pdHRlZE11dGF0aW9ucyIsInNldEhhc0xvY2FsTXV0YXRpb25zIiwic2V0UmVhZFRpbWUiLCJoYXNMb2NhbE11dGF0aW9ucyIsImhhc0NvbW1pdHRlZE11dGF0aW9ucyIsImhhc1BlbmRpbmdXcml0ZXMiLCJpc1ZhbGlkRG9jdW1lbnQiLCJpc0ZvdW5kRG9jdW1lbnQiLCJpc05vRG9jdW1lbnQiLCJpc1Vua25vd25Eb2N1bWVudCIsIm11dGFibGVDb3B5IiwiRGUiLCJvcmRlckJ5IiwiZmlsdGVycyIsInN0YXJ0QXQiLCJlbmRBdCIsImh0IiwiQ2UiLCJ4ZSIsIm9wIiwiZGlyIiwiaW5jbHVzaXZlIiwicG9zaXRpb24iLCJrZSIsIkplIiwiWGUiLCJPZSIsImlzRG9jdW1lbnRLZXkiLCJCZSIsImx0IiwiTGUiLCJHZSIsIlFlIiwiamUiLCJXZSIsIlVlIiwicWUiLCJtYXRjaGVzIiwiZnQiLCJkdCIsIktlIiwibnVsbFZhbHVlIiwiemUiLCJIZSIsIlllIiwiWmUiLCJleHBsaWNpdE9yZGVyQnkiLCJsaW1pdFR5cGUiLCJfdCIsInd0IiwiZW4iLCJubiIsInVuIiwicm4iLCJzbiIsImtleUZpZWxkIiwiY24iLCJhbiIsImhuIiwibG4iLCJmbiIsIk5lIiwiZG4iLCJ3biIsIm1uIiwiZ24iLCJ5biIsInBuIiwiaXNJbnRlZ2VyIiwiTUFYX1NBRkVfSU5URUdFUiIsIk1JTl9TQUZFX0lOVEVHRVIiLCJyZSIsIkluIiwiVG4iLCJSbiIsImJuIiwiUG4iLCJ2biIsIlZuIiwiQW4iLCJEbiIsIkl0IiwiRW4iLCJTbiIsImVsZW1lbnRzIiwiQ24iLCJrbiIsInRyYW5zZm9ybVJlc3VsdHMiLCJPbiIsInVwZGF0ZVRpbWUiLCJleGlzdHMiLCJpc05vbmUiLCJNbiIsIkZuIiwiJG4iLCJ6biIsIm5vbmUiLCJLbiIsIkduIiwiQm4iLCJqbiIsImZpZWxkVHJhbnNmb3JtcyIsInByZWNvbmRpdGlvbiIsIlFuIiwiTG4iLCJXbiIsImZpZWxkTWFzayIsIlVuIiwidHJhbnNmb3JtIiwicW4iLCJObiIsImdldEZpZWxkTWFzayIsIkhuIiwiSm4iLCJjb3VudCIsIlluIiwiWG4iLCJ0cyIsImVzIiwibWFwS2V5Rm4iLCJlcXVhbHNGbiIsImlubmVyIiwiaW5uZXJTaXplIiwibnMiLCJzcyIsImlzIiwicnMiLCJvcyIsIm92ZXJsYXllZERvY3VtZW50IiwidXMiLCJhcyIsImNzIiwiaHMiLCJscyIsImZzIiwiZHMiLCJfcyIsIndzIiwic25hcHNob3RWZXJzaW9uIiwidGFyZ2V0Q2hhbmdlcyIsInRhcmdldE1pc21hdGNoZXMiLCJkb2N1bWVudFVwZGF0ZXMiLCJyZXNvbHZlZExpbWJvRG9jdW1lbnRzIiwibXMiLCJjcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UiLCJyZXN1bWVUb2tlbiIsImN1cnJlbnQiLCJhZGRlZERvY3VtZW50cyIsIm1vZGlmaWVkRG9jdW1lbnRzIiwicmVtb3ZlZERvY3VtZW50cyIsImdzIiwicmVtb3ZlZFRhcmdldElkcyIsInlzIiwidGFyZ2V0SWQiLCJwcyIsInRhcmdldElkcyIsImNhdXNlIiwiSXMiLCJSdCIsImJ0IiwiQXMiLCJQdCIsInZ0IiwiU3QiLCJEdCIsIkN0IiwieHQiLCJOdCIsImt0IiwiVHMiLCJFcyIsIkd0IiwianQiLCJmb3JFYWNoVGFyZ2V0IiwicmVtb3ZlVGFyZ2V0IiwibmV3Tm9Eb2N1bWVudCIsInB1cnBvc2UiLCJnZXRSZW1vdGVLZXlzRm9yVGFyZ2V0IiwiUnMiLCJhc2MiLCJkZXNjIiwiYnMiLCJpbiIsIlBzIiwidnMiLCJWcyIsIlNzIiwiRHMiLCJmcm9tVGltZXN0YW1wIiwiQ3MiLCJ4cyIsImlpIiwiTnMiLCJrcyIsIiRzIiwiT3MiLCJGcyIsIkJzIiwianMiLCJkb2N1bWVudHMiLCJXcyIsInN0cnVjdHVyZWRRdWVyeSIsInBhcmVudCIsImNvbGxlY3Rpb25JZCIsImFsbERlc2NlbmRhbnRzIiwidW5hcnlGaWx0ZXIiLCJacyIsImZpZWxkRmlsdGVyIiwiWHMiLCJjb21wb3NpdGVGaWx0ZXIiLCJ3aGVyZSIsImRpcmVjdGlvbiIsIllzIiwiYmVmb3JlIiwienMiLCJNcyIsIkpzIiwidGkiLCJ0biIsIm5pIiwiZWkiLCJyZWR1Y2UiLCJmaWVsZFBhdGgiLCJmcm9tU2VydmVyRm9ybWF0IiwiTmFOIiwic2kiLCJmaWVsZFBhdGhzIiwia2kiLCJiYXRjaElkIiwibG9jYWxXcml0ZVRpbWUiLCJiYXNlTXV0YXRpb25zIiwibXV0YXRpb25zIiwiYXBwbHlUb1JlbW90ZURvY3VtZW50IiwibXV0YXRpb25SZXN1bHRzIiwiYXBwbHlUb0xvY2FsVmlldyIsImFwcGx5VG9Mb2NhbERvY3VtZW50U2V0IiwibXV0YXRlZEZpZWxkcyIsIk9pIiwiYmF0Y2giLCJjb21taXRWZXJzaW9uIiwiZG9jVmVyc2lvbnMiLCJNaSIsIm11dGF0aW9uIiwiZ2V0S2V5IiwiRmkiLCJzZXF1ZW5jZU51bWJlciIsImxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24iLCJ3aXRoU2VxdWVuY2VOdW1iZXIiLCJ3aXRoUmVzdW1lVG9rZW4iLCJ3aXRoTGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiIsIiRpIiwiV2kiLCJuciIsIndlIiwiZHIiLCJfciIsImFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4IiwiZ2V0Q29sbGVjdGlvblBhcmVudHMiLCJnZXRFbnRyaWVzIiwiYWRkRmllbGRJbmRleCIsImRlbGV0ZUZpZWxkSW5kZXgiLCJnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCIsImdldEluZGV4VHlwZSIsImdldEZpZWxkSW5kZXhlcyIsImdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSIsImdldE1pbk9mZnNldCIsImdldE1pbk9mZnNldEZyb21Db2xsZWN0aW9uR3JvdXAiLCJ1cGRhdGVDb2xsZWN0aW9uR3JvdXAiLCJ1cGRhdGVJbmRleEVudHJpZXMiLCJBciIsImNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQiLCJwZXJjZW50aWxlVG9Db2xsZWN0IiwibWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCIsIkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFIiwiREVGQVVMVF9NQVhfU0VRVUVOQ0VfTlVNQkVSU19UT19DT0xMRUNUIiwiREVGQVVMVCIsIkRJU0FCTEVEIiwiQ3IiLCJxciIsImNoYW5nZXMiLCJjaGFuZ2VzQXBwbGllZCIsImFkZEVudHJ5IiwiYXNzZXJ0Tm90QXBwbGllZCIsInJlbW92ZUVudHJ5IiwibmV3SW52YWxpZERvY3VtZW50IiwiZ2V0RW50cnkiLCJnZXRGcm9tQ2FjaGUiLCJnZXRBbGxGcm9tQ2FjaGUiLCJZciIsIlhyIiwicmVtb3RlRG9jdW1lbnRDYWNoZSIsIm11dGF0aW9uUXVldWUiLCJkb2N1bWVudE92ZXJsYXlDYWNoZSIsImluZGV4TWFuYWdlciIsImdldERvY3VtZW50IiwiZ2V0T3ZlcmxheSIsImdldEJhc2VEb2N1bWVudCIsImdldERvY3VtZW50cyIsImdldExvY2FsVmlld09mRG9jdW1lbnRzIiwicG9wdWxhdGVPdmVybGF5cyIsImNvbXB1dGVWaWV3cyIsImdldE92ZXJsYXllZERvY3VtZW50cyIsImdldE92ZXJsYXlzIiwicmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXMiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMiLCJzYXZlT3ZlcmxheXMiLCJyZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyIsImdldERvY3VtZW50c01hdGNoaW5nUXVlcnkiLCJnZXREb2N1bWVudHNNYXRjaGluZ0RvY3VtZW50UXVlcnkiLCJvbiIsImdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvbkdyb3VwUXVlcnkiLCJnZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25RdWVyeSIsImdldE5leHREb2N1bWVudHMiLCJnZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwIiwiZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uR3JvdXAiLCJnZXRBbGxGcm9tQ29sbGVjdGlvbiIsImdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbiIsIlpyIiwiWm4iLCJnZXRCdW5kbGVNZXRhZGF0YSIsInNhdmVCdW5kbGVNZXRhZGF0YSIsImNyZWF0ZVRpbWUiLCJnZXROYW1lZFF1ZXJ5Iiwic2F2ZU5hbWVkUXVlcnkiLCJxdWVyeSIsImJ1bmRsZWRRdWVyeSIsInRvIiwib3ZlcmxheXMiLCJ1ZSIsInJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCIsImVvIiwibm8iLCJhZGRSZWZlcmVuY2UiLCJyZW1vdmVSZWZlcmVuY2UiLCJjb250YWluc0tleSIsInNvIiwicmVmZXJlbmNlRGVsZWdhdGUiLCJjaGVja0VtcHR5IiwiYWRkTXV0YXRpb25CYXRjaCIsImxvb2t1cE11dGF0aW9uQmF0Y2giLCJnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCIsImdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXMiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSIsIlBPU0lUSVZFX0lORklOSVRZIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkiLCJyZW1vdmVNdXRhdGlvbkJhdGNoIiwibWFya1BvdGVudGlhbGx5T3JwaGFuZWQiLCJwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayIsImlvIiwiZG9jcyIsInNldEluZGV4TWFuYWdlciIsIm5ld0NoYW5nZUJ1ZmZlciIsInJvIiwiZ2V0U2l6ZSIsIm9vIiwicGVyc2lzdGVuY2UiLCJsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uIiwiaGlnaGVzdFRhcmdldElkIiwidGFyZ2V0Q291bnQiLCJnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uIiwiZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyIiwiYWxsb2NhdGVUYXJnZXRJZCIsInNldFRhcmdldHNNZXRhZGF0YSIsImFkZFRhcmdldERhdGEiLCJ1cGRhdGVUYXJnZXREYXRhIiwicmVtb3ZlVGFyZ2V0RGF0YSIsInJlbW92ZVRhcmdldHMiLCJyZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCIsImdldFRhcmdldENvdW50IiwiZ2V0VGFyZ2V0RGF0YSIsImFkZE1hdGNoaW5nS2V5cyIsInJlbW92ZU1hdGNoaW5nS2V5cyIsImdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkIiwidW8iLCJzdGFydGVkIiwic2V0RGF0YWJhc2VEZWxldGVkTGlzdGVuZXIiLCJzZXROZXR3b3JrRW5hYmxlZCIsImdldEluZGV4TWFuYWdlciIsImdldERvY3VtZW50T3ZlcmxheUNhY2hlIiwiZ2V0TXV0YXRpb25RdWV1ZSIsImdldFRhcmdldENhY2hlIiwiZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSIsImdldEJ1bmRsZUNhY2hlIiwicnVuVHJhbnNhY3Rpb24iLCJjbyIsIm9yIiwiY3VycmVudFNlcXVlbmNlTnVtYmVyIiwiYW8iLCJMcyIsImZyb21QYXRoIiwiVXMiLCJ1cGRhdGVMaW1ib0RvY3VtZW50IiwieW8iLCJmcm9tQ2FjaGUiLCJTaSIsIkRpIiwiZG9jQ2hhbmdlcyIsImRvYyIsInBvIiwieGkiLCJOaSIsIkJpIiwibXQiLCJJbyIsIkxpIiwiVWkiLCJxaSIsIktpIiwiR2kiLCJRaSIsImxvY2FsRG9jdW1lbnRzIiwiY29sbGVjdEdhcmJhZ2UiLCJjb2xsZWN0IiwiRW8iLCJqaSIsInJlbW92ZWRCYXRjaElkcyIsImFkZGVkQmF0Y2hJZHMiLCJSbyIsInZvIiwiU28iLCJEbyIsIk5vIiwiX24iLCJIaSIsIktvIiwiYWN0aXZlVGFyZ2V0SWRzIiwiZXIiLCJ0ciIsInVwZGF0ZVRpbWVNcyIsIlFvIiwiTHIiLCJVciIsIm9ubGluZVN0YXRlSGFuZGxlciIsImFkZFBlbmRpbmdNdXRhdGlvbiIsInVwZGF0ZU11dGF0aW9uU3RhdGUiLCJhZGRMb2NhbFF1ZXJ5VGFyZ2V0IiwidXBkYXRlUXVlcnlTdGF0ZSIsInJlbW92ZUxvY2FsUXVlcnlUYXJnZXQiLCJpc0xvY2FsUXVlcnlUYXJnZXQiLCJjbGVhclF1ZXJ5U3RhdGUiLCJnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMiLCJpc0FjdGl2ZVF1ZXJ5VGFyZ2V0IiwiaGFuZGxlVXNlckNoYW5nZSIsInNldE9ubGluZVN0YXRlIiwibm90aWZ5QnVuZGxlTG9hZGVkIiwiam8iLCJXbyIsIktyIiwiR3IiLCJRciIsImpyIiwiV3IiLCJ6ciIsInpvIiwiQmF0Y2hHZXREb2N1bWVudHMiLCJDb21taXQiLCJSdW5RdWVyeSIsIlJ1bkFnZ3JlZ2F0aW9uUXVlcnkiLCJIbyIsIkhyIiwiSnIiLCJvbk1lc3NhZ2UiLCJKbyIsImRhdGFiYXNlSW5mbyIsImhvIiwibG8iLCJmbyIsIl9vIiwid28iLCJmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXMiLCJYbyIsIlpvIiwidHUiLCJIcyIsInRpbWVySWQiLCJtbyIsIlRvIiwiQW8iLCJibyIsImVucXVldWVBZnRlckRlbGF5IiwiUG8iLCJza2lwRGVsYXkiLCJldSIsIlZvIiwiY29ubmVjdGlvbiIsImF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyIiwiYXBwQ2hlY2tDcmVkZW50aWFsc1Byb3ZpZGVyIiwiQ28iLCJ4byIsImtvIiwiT28iLCJNbyIsIkZvIiwiJG8iLCJCbyIsIkxvIiwiVW8iLCJxbyIsIkdvIiwiZW5xdWV1ZUFuZEZvcmdldCIsIm51IiwidGFyZ2V0Q2hhbmdlIiwidGFyZ2V0Q2hhbmdlVHlwZSIsImRvY3VtZW50Q2hhbmdlIiwibmV3Rm91bmREb2N1bWVudCIsImRvY3VtZW50RGVsZXRlIiwiZG9jdW1lbnRSZW1vdmUiLCJxcyIsImFkZFRhcmdldCIsImxhYmVscyIsInN1IiwiWW8iLCJsYXN0U3RyZWFtVG9rZW4iLCJzdHJlYW1Ub2tlbiIsIlFzIiwid3JpdGVSZXN1bHRzIiwiY29tbWl0VGltZSIsIndyaXRlcyIsInVwZGF0ZSIsInVwZGF0ZU1hc2siLCJ2ZXJpZnkiLCJ1cGRhdGVUcmFuc2Zvcm1zIiwic2V0VG9TZXJ2ZXJWYWx1ZSIsImFwcGVuZE1pc3NpbmdFbGVtZW50cyIsInJlbW92ZUFsbEZyb21BcnJheSIsImluY3JlbWVudCIsImN1cnJlbnREb2N1bWVudCIsIktzIiwiaXUiLCJhdXRoQ3JlZGVudGlhbHMiLCJhcHBDaGVja0NyZWRlbnRpYWxzIiwidGVybWluYXRlIiwib3UiLCJhc3luY1F1ZXVlIiwicnUiLCJ1dSIsImN1IiwiYXUiLCJodSIsImx1IiwibG9jYWxTdG9yZSIsImRhdGFzdG9yZSIsInJlbW90ZVN5bmNlciIsImZ1IiwiZHUiLCJfdSIsInd1IiwibXUiLCJndSIsImt1IiwieXUiLCJwdSIsIkl1IiwicmVqZWN0TGlzdGVuIiwiVHUiLCJhcHBseVJlbW90ZUV2ZW50IiwiRXUiLCJBdSIsIk91IiwiUnUiLCJidSIsIlB1IiwidnUiLCJWdSIsIlN1IiwiRHUiLCJhcHBseVN1Y2Nlc3NmdWxXcml0ZSIsIkN1IiwicmVqZWN0RmFpbGVkV3JpdGUiLCJ4dSIsInZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MiLCJoYW5kbGVDcmVkZW50aWFsQ2hhbmdlIiwic3RvcCIsIk11IiwidGFyZ2V0VGltZU1zIiwicmVtb3ZhbENhbGxiYWNrIiwidGltZXJIYW5kbGUiLCJoYW5kbGVEZWxheUVsYXBzZWQiLCJGdSIsIiR1Iiwia2V5ZWRNYXAiLCJzb3J0ZWRTZXQiLCJCdSIsInRyYWNrIiwiTHUiLCJvbGREb2NzIiwibXV0YXRlZEtleXMiLCJzeW5jU3RhdGVDaGFuZ2VkIiwiZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMiLCJoYXNDYWNoZWRSZXN1bHRzIiwiZW1wdHlTZXQiLCJVdSIsImxpc3RlbmVycyIsInF1IiwicXVlcmllcyIsIm9ubGluZVN0YXRlIiwiUXUiLCJXdSIsImp1Iiwib25FcnJvciIsInp1IiwiaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyIsIk51IiwiZnJvbUluaXRpYWxEb2N1bWVudHMiLCJadSIsIkt1IiwiR3UiLCJIdSIsIkp1IiwiWXUiLCJzbmFwc2hvdCIsIlh1IiwidmlldyIsInJlbW90ZVN0b3JlIiwiZXZlbnRNYW5hZ2VyIiwic2hhcmVkQ2xpZW50U3RhdGUiLCJtYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucyIsImlzUHJpbWFyeUNsaWVudCIsIl9jIiwidHJhY2tSZW1vdmFscyIsInppIiwiQ2kiLCJzeW5jaHJvbml6ZVRhYnMiLCJnY1NjaGVkdWxlciIsImluZGV4QmFja2ZpbGxlclNjaGVkdWxlciIsImluaXRpYWxVc2VyIiwiY3JlYXRlRGF0YXN0b3JlIiwiY3JlYXRlUmVtb3RlU3RvcmUiLCJjcmVhdGVFdmVudE1hbmFnZXIiLCJzeW5jRW5naW5lIiwiY3JlYXRlU3luY0VuZ2luZSIsImlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMiLCJjYWNoZVNpemVCeXRlcyIsImV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmciLCJleHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmciLCJfYXV0aENyZWRlbnRpYWxzIiwiX2FwcENoZWNrQ3JlZGVudGlhbHMiLCJfZGF0YWJhc2VJZCIsIl9hcHAiLCJfcGVyc2lzdGVuY2VLZXkiLCJfc2V0dGluZ3MiLCJfc2V0dGluZ3NGcm96ZW4iLCJfaW5pdGlhbGl6ZWQiLCJfdGVybWluYXRlZCIsIl90ZXJtaW5hdGVUYXNrIiwiX3NldFNldHRpbmdzIiwiY2xpZW50Iiwic2Vzc2lvbkluZGV4IiwiaWFtVG9rZW4iLCJhdXRoVG9rZW5GYWN0b3J5IiwiX2dldFNldHRpbmdzIiwiX2ZyZWV6ZVNldHRpbmdzIiwiX3Rlcm1pbmF0ZSIsInNldHRpbmdzIiwiY29udmVydGVyIiwiX2tleSIsImZpcmVzdG9yZSIsIl9wYXRoIiwid2l0aENvbnZlcnRlciIsIl9xdWVyeSIsIm9ic2VydmVyIiwibXV0ZWQiLCJjbGllbnRJZCIsImF1dGhDcmVkZW50aWFsTGlzdGVuZXIiLCJhcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciIsInNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciIsInNldEFwcENoZWNrVG9rZW5DaGFuZ2VMaXN0ZW5lciIsInZlcmlmeU5vdFRlcm1pbmF0ZWQiLCJpc1NodXR0aW5nRG93biIsImVudGVyUmVzdHJpY3RlZE1vZGUiLCJlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCIsIm9ubGluZUNvbXBvbmVudHMiLCJvZmZsaW5lQ29tcG9uZW50cyIsImdldENvbmZpZ3VyYXRpb24iLCJvbkxpc3RlbiIsIm9uVW5saXN0ZW4iLCJzb3VyY2UiLCJ2aXNpYmlsaXR5U3RhdGUiLCJlbnF1ZXVlIiwic3RhY2siLCJjcmVhdGVBbmRTY2hlZHVsZSIsIl9xdWV1ZSIsIl9maXJlc3RvcmVDbGllbnQiLCJoZWFydGJlYXRDb250cm9sbGVyIiwidHJpZ2dlckhlYXJ0YmVhdCIsImdldEFwcCIsInByb2R1Y3ROYW1lIiwiX2IiLCJlbXVsYXRvckhvc3RzIiwiZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCIsInNlcGFyYXRvckluZGV4IiwibGFzdEluZGV4T2YiLCJnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQiLCJtb2NrVXNlclRva2VuIiwicHJvamVjdCIsImlhdCIsInN1YiIsInVzZXJfaWQiLCJwYXlsb2FkIiwiaXNzIiwiYXVkIiwiZXhwIiwiYXV0aF90aW1lIiwiZmlyZWJhc2UiLCJzaWduX2luX3Byb3ZpZGVyIiwiaWRlbnRpdGllcyIsImFsZyIsImNyZWF0ZU1vY2tVc2VyVG9rZW4iLCJ0aCIsIl9ieXRlU3RyaW5nIiwiZWgiLCJfaW50ZXJuYWxQYXRoIiwic2giLCJfbWV0aG9kTmFtZSIsImloIiwiaXNGaW5pdGUiLCJfbGF0IiwiX2xvbmciLCJyaCIsIm9oIiwidG9NdXRhdGlvbiIsInVoIiwiY2giLCJhaCIsIlNoIiwibWV0aG9kTmFtZSIsImNvbnRhaW5zIiwiaGgiLCJsaCIsImZoIiwibWVyZ2UiLCJtZXJnZUZpZWxkcyIsImJoIiwiQWgiLCJQaCIsIkRoIiwiZGgiLCJfdG9GaWVsZFRyYW5zZm9ybSIsIkVoIiwiUmgiLCJmcm9tRGF0ZSIsIlZoIiwidmgiLCJzZWFyY2giLCJDaCIsIl9maXJlc3RvcmUiLCJfdXNlckRhdGFXcml0ZXIiLCJfZG9jdW1lbnQiLCJfY29udmVydGVyIiwicmVmIiwieGgiLCJmcm9tRmlyZXN0b3JlIiwiY29udmVydFZhbHVlIiwiTmgiLCJ0bCIsImNvbnZlcnRUaW1lc3RhbXAiLCJjb252ZXJ0U2VydmVyVGltZXN0YW1wIiwiY29udmVydEJ5dGVzIiwiY29udmVydFJlZmVyZW5jZSIsImNvbnZlcnRHZW9Qb2ludCIsImNvbnZlcnRBcnJheSIsImNvbnZlcnRPYmplY3QiLCJjb252ZXJ0RG9jdW1lbnRLZXkiLCJzbCIsImlsIiwiX2ZpcmVzdG9yZUltcGwiLCJtZXRhZGF0YSIsInJsIiwic2VydmVyVGltZXN0YW1wcyIsIm9sIiwiX3NuYXBzaG90IiwiX2NhY2hlZENoYW5nZXMiLCJfY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMiLCJvbGRJbmRleCIsIm5ld0luZGV4IiwidWwiLCJobCIsImdsIiwiSWgiLCJwaCIsIkVsIiwiU0RLX1ZFUlNJT04iLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwic3RvcmFnZUJ1Y2tldCIsIm1lc3NhZ2luZ1NlbmRlcklkIiwiYm9va1RpdGxlIiwicXVlcnlTZWxlY3RvciIsImF1dGhvciIsInBhZ2VzIiwicmVhZFN0YXR1cyIsImJ0biIsInNoZWxmIiwiZWxlbWVudCIsImNsYXNzTGlzdCIsImRvY1JlZiIsInBhcmVudE5vZGUiLCJpbm5lckhUTUwiLCJsb2FkQm9va3MiLCJkZWxldGVMaXN0ZW5lciIsImFsZXJ0IiwidG9GaXJlc3RvcmUiLCJlbCIsInRpdGxlIiwiYWRkQm9va1RvTGlicmFyeSIsIm15TGlicmFyeSIsImNvbFJlZiIsImRvY1NuYXAiLCJraCIsImJvb2siLCJ0aXRsZUVsIiwiY3JlYXRlRWxlbWVudCIsImF1dGhvckVsIiwicGFnZUVsIiwicmVhZEVsIiwiZGVsZXRlRWwiLCJ0ZXh0Q29udGVudCIsImxhYmVsIiwibmV3Qm9vayIsImRhdGFzZXQiLCJudW0iLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImFkZFRvU2hlbGYiLCJpbm5lclRleHQiXSwic291cmNlUm9vdCI6IiJ9